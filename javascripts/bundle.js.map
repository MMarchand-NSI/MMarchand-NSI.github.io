{
  "version": 3,
  "sources": ["../../node_modules/file-saver/src/FileSaver.js", "../../node_modules/json5/dist/index.js", "../../node_modules/lz-string/libs/lz-string.js", "../../node_modules/png-metadata-writer/crc32.js", "../../node_modules/png-metadata-writer/index.js", "../../node_modules/fp-ts/lib/function.js", "../../node_modules/fp-ts/lib/internal.js", "../../node_modules/fp-ts/lib/Apply.js", "../../node_modules/fp-ts/lib/Functor.js", "../../node_modules/fp-ts/lib/Applicative.js", "../../node_modules/fp-ts/lib/Chain.js", "../../node_modules/fp-ts/lib/ChainRec.js", "../../node_modules/fp-ts/lib/FromEither.js", "../../node_modules/fp-ts/lib/Separated.js", "../../node_modules/fp-ts/lib/Witherable.js", "../../node_modules/fp-ts/lib/Either.js", "../../node_modules/io-ts/lib/index.js", "../../node_modules/json5/lib/unicode.js", "../../node_modules/json5/lib/util.js", "../../node_modules/io-ts/lib/PathReporter.js", "../../node_modules/dialog-polyfill/dist/dialog-polyfill.esm.js", "../src/LogicEditor.ts", "../src/ComponentFactory.ts", "../src/Serialization.ts", "../src/utils.ts", "../src/DataMigration.ts", "../src/TestSuite.ts", "../src/images.ts", "../src/htmlgen.ts", "../src/strings.ts", "../../node_modules/bezier-js/src/utils.js", "../../node_modules/bezier-js/src/poly-bezier.js", "../../node_modules/bezier-js/src/bezier.js", "../src/components/Wire.ts", "../src/components/Component.ts", "../src/UIPermissions.ts", "../src/components/Drawable.ts", "../src/components/Node.ts", "../src/drawutils.ts", "../src/components/Passthrough.ts", "../src/components/WirePath.ts", "../src/components/ALU.ts", "../src/components/GateTypes.ts", "../src/components/Adder.ts", "../src/components/AdderArray.ts", "../src/components/Clock.ts", "../src/components/Input.ts", "../src/components/Comparator.ts", "../src/components/ControlledInverter.ts", "../src/components/Counter.ts", "../src/components/FlipflopOrLatch.ts", "../src/components/CustomComponent.ts", "../src/ComponentList.ts", "../src/NodeManager.ts", "../src/RedrawRecalcManager.ts", "../src/SVGRenderingContext.ts", "../src/components/Output.ts", "../src/components/Decoder.ts", "../src/components/Decoder16Seg.ts", "../src/components/Decoder7Seg.ts", "../src/components/DecoderBCD4.ts", "../src/components/Demux.ts", "../src/components/Display.ts", "../src/components/Display16Seg.ts", "../src/components/DisplayBar.ts", "../src/components/Display7Seg.ts", "../src/components/DisplayAscii.ts", "../src/components/FlipflopD.ts", "../src/components/FlipflopJK.ts", "../src/components/FlipflopT.ts", "../src/components/Gate.ts", "../src/components/GateArray.ts", "../src/components/HalfAdder.ts", "../src/components/Label.ts", "../src/components/LatchSR.ts", "../src/components/Mux.ts", "../src/components/Pixel.ts", "../src/components/RAM.ts", "../src/components/ROM.ts", "../src/components/Random.ts", "../src/components/Register.ts", "../src/components/Rectangle.ts", "../src/components/ShiftDisplay.ts", "../src/components/ShiftRegister.ts", "../src/components/TristateBuffer.ts", "../src/components/TristateBufferArray.ts", "../src/ComponentMenu.ts", "../src/MessageBar.ts", "../src/MoveManager.ts", "../src/Tests.ts", "../src/TestsPalette.ts", "../src/Timeline.ts", "../src/TopBar.ts", "../../node_modules/@popperjs/core/lib/enums.js", "../../node_modules/@popperjs/core/lib/dom-utils/getNodeName.js", "../../node_modules/@popperjs/core/lib/dom-utils/getWindow.js", "../../node_modules/@popperjs/core/lib/dom-utils/instanceOf.js", "../../node_modules/@popperjs/core/lib/modifiers/applyStyles.js", "../../node_modules/@popperjs/core/lib/utils/getBasePlacement.js", "../../node_modules/@popperjs/core/lib/dom-utils/getBoundingClientRect.js", "../../node_modules/@popperjs/core/lib/dom-utils/getLayoutRect.js", "../../node_modules/@popperjs/core/lib/dom-utils/contains.js", "../../node_modules/@popperjs/core/lib/dom-utils/getComputedStyle.js", "../../node_modules/@popperjs/core/lib/dom-utils/isTableElement.js", "../../node_modules/@popperjs/core/lib/dom-utils/getDocumentElement.js", "../../node_modules/@popperjs/core/lib/dom-utils/getParentNode.js", "../../node_modules/@popperjs/core/lib/dom-utils/getOffsetParent.js", "../../node_modules/@popperjs/core/lib/utils/getMainAxisFromPlacement.js", "../../node_modules/@popperjs/core/lib/utils/math.js", "../../node_modules/@popperjs/core/lib/utils/within.js", "../../node_modules/@popperjs/core/lib/utils/getFreshSideObject.js", "../../node_modules/@popperjs/core/lib/utils/mergePaddingObject.js", "../../node_modules/@popperjs/core/lib/utils/expandToHashMap.js", "../../node_modules/@popperjs/core/lib/modifiers/arrow.js", "../../node_modules/@popperjs/core/lib/modifiers/computeStyles.js", "../../node_modules/@popperjs/core/lib/modifiers/eventListeners.js", "../../node_modules/@popperjs/core/lib/utils/getOppositePlacement.js", "../../node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js", "../../node_modules/@popperjs/core/lib/dom-utils/getWindowScroll.js", "../../node_modules/@popperjs/core/lib/dom-utils/getWindowScrollBarX.js", "../../node_modules/@popperjs/core/lib/dom-utils/getViewportRect.js", "../../node_modules/@popperjs/core/lib/dom-utils/getDocumentRect.js", "../../node_modules/@popperjs/core/lib/dom-utils/isScrollParent.js", "../../node_modules/@popperjs/core/lib/dom-utils/getScrollParent.js", "../../node_modules/@popperjs/core/lib/dom-utils/listScrollParents.js", "../../node_modules/@popperjs/core/lib/utils/rectToClientRect.js", "../../node_modules/@popperjs/core/lib/dom-utils/getClippingRect.js", "../../node_modules/@popperjs/core/lib/utils/getVariation.js", "../../node_modules/@popperjs/core/lib/utils/computeOffsets.js", "../../node_modules/@popperjs/core/lib/utils/detectOverflow.js", "../../node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js", "../../node_modules/@popperjs/core/lib/modifiers/flip.js", "../../node_modules/@popperjs/core/lib/modifiers/hide.js", "../../node_modules/@popperjs/core/lib/modifiers/offset.js", "../../node_modules/@popperjs/core/lib/modifiers/popperOffsets.js", "../../node_modules/@popperjs/core/lib/utils/getAltAxis.js", "../../node_modules/@popperjs/core/lib/modifiers/preventOverflow.js", "../../node_modules/@popperjs/core/lib/dom-utils/getHTMLElementScroll.js", "../../node_modules/@popperjs/core/lib/dom-utils/getNodeScroll.js", "../../node_modules/@popperjs/core/lib/dom-utils/getCompositeRect.js", "../../node_modules/@popperjs/core/lib/utils/orderModifiers.js", "../../node_modules/@popperjs/core/lib/utils/debounce.js", "../../node_modules/@popperjs/core/lib/utils/mergeByName.js", "../../node_modules/@popperjs/core/lib/createPopper.js", "../../node_modules/@popperjs/core/lib/popper.js", "../src/UIEventManager.ts", "../src/UndoManager.ts", "../src/gallery.ts"],
  "sourcesContent": ["/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nvar _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  var xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  var xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\n// Detect WebView inside a native macOS app by ruling out all browsers\n// We just need to check for 'Safari' because all other browsers (besides Firefox) include that too\n// https://www.whatismybrowser.com/guides/the-latest-user-agent/macos\nvar isMacOSWebView = _global.navigator && /Macintosh/.test(navigator.userAgent) && /AppleWebKit/.test(navigator.userAgent) && !/Safari/.test(navigator.userAgent)\n\nvar saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile) unless this is a macOS WebView\n  : ('download' in HTMLAnchorElement.prototype && !isMacOSWebView)\n  ? function saveAs (blob, name, opts) {\n    var URL = _global.URL || _global.webkitURL\n    var a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        var a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    var force = blob.type === 'application/octet-stream'\n    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari) || isMacOSWebView) && typeof FileReader !== 'undefined') {\n      // Safari doesn't allow downloading of blob URLs\n      var reader = new FileReader()\n      reader.onloadend = function () {\n        var url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) popup.location.href = url\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      var URL = _global.URL || _global.webkitURL\n      var url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs\n\nif (typeof module !== 'undefined') {\n  module.exports = saveAs;\n}\n", "(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.JSON5 = factory());\n}(this, (function () { 'use strict';\n\n\tfunction createCommonjsModule(fn, module) {\n\t\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n\t}\n\n\tvar _global = createCommonjsModule(function (module) {\n\t// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\n\tvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n\t  ? window : typeof self != 'undefined' && self.Math == Math ? self\n\t  // eslint-disable-next-line no-new-func\n\t  : Function('return this')();\n\tif (typeof __g == 'number') { __g = global; } // eslint-disable-line no-undef\n\t});\n\n\tvar _core = createCommonjsModule(function (module) {\n\tvar core = module.exports = { version: '2.6.5' };\n\tif (typeof __e == 'number') { __e = core; } // eslint-disable-line no-undef\n\t});\n\tvar _core_1 = _core.version;\n\n\tvar _isObject = function (it) {\n\t  return typeof it === 'object' ? it !== null : typeof it === 'function';\n\t};\n\n\tvar _anObject = function (it) {\n\t  if (!_isObject(it)) { throw TypeError(it + ' is not an object!'); }\n\t  return it;\n\t};\n\n\tvar _fails = function (exec) {\n\t  try {\n\t    return !!exec();\n\t  } catch (e) {\n\t    return true;\n\t  }\n\t};\n\n\t// Thank's IE8 for his funny defineProperty\n\tvar _descriptors = !_fails(function () {\n\t  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n\t});\n\n\tvar document = _global.document;\n\t// typeof document.createElement is 'object' in old IE\n\tvar is = _isObject(document) && _isObject(document.createElement);\n\tvar _domCreate = function (it) {\n\t  return is ? document.createElement(it) : {};\n\t};\n\n\tvar _ie8DomDefine = !_descriptors && !_fails(function () {\n\t  return Object.defineProperty(_domCreate('div'), 'a', { get: function () { return 7; } }).a != 7;\n\t});\n\n\t// 7.1.1 ToPrimitive(input [, PreferredType])\n\n\t// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n\t// and the second argument - flag - preferred type is a string\n\tvar _toPrimitive = function (it, S) {\n\t  if (!_isObject(it)) { return it; }\n\t  var fn, val;\n\t  if (S && typeof (fn = it.toString) == 'function' && !_isObject(val = fn.call(it))) { return val; }\n\t  if (typeof (fn = it.valueOf) == 'function' && !_isObject(val = fn.call(it))) { return val; }\n\t  if (!S && typeof (fn = it.toString) == 'function' && !_isObject(val = fn.call(it))) { return val; }\n\t  throw TypeError(\"Can't convert object to primitive value\");\n\t};\n\n\tvar dP = Object.defineProperty;\n\n\tvar f = _descriptors ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n\t  _anObject(O);\n\t  P = _toPrimitive(P, true);\n\t  _anObject(Attributes);\n\t  if (_ie8DomDefine) { try {\n\t    return dP(O, P, Attributes);\n\t  } catch (e) { /* empty */ } }\n\t  if ('get' in Attributes || 'set' in Attributes) { throw TypeError('Accessors not supported!'); }\n\t  if ('value' in Attributes) { O[P] = Attributes.value; }\n\t  return O;\n\t};\n\n\tvar _objectDp = {\n\t\tf: f\n\t};\n\n\tvar _propertyDesc = function (bitmap, value) {\n\t  return {\n\t    enumerable: !(bitmap & 1),\n\t    configurable: !(bitmap & 2),\n\t    writable: !(bitmap & 4),\n\t    value: value\n\t  };\n\t};\n\n\tvar _hide = _descriptors ? function (object, key, value) {\n\t  return _objectDp.f(object, key, _propertyDesc(1, value));\n\t} : function (object, key, value) {\n\t  object[key] = value;\n\t  return object;\n\t};\n\n\tvar hasOwnProperty = {}.hasOwnProperty;\n\tvar _has = function (it, key) {\n\t  return hasOwnProperty.call(it, key);\n\t};\n\n\tvar id = 0;\n\tvar px = Math.random();\n\tvar _uid = function (key) {\n\t  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n\t};\n\n\tvar _library = false;\n\n\tvar _shared = createCommonjsModule(function (module) {\n\tvar SHARED = '__core-js_shared__';\n\tvar store = _global[SHARED] || (_global[SHARED] = {});\n\n\t(module.exports = function (key, value) {\n\t  return store[key] || (store[key] = value !== undefined ? value : {});\n\t})('versions', []).push({\n\t  version: _core.version,\n\t  mode: _library ? 'pure' : 'global',\n\t  copyright: '\u00A9 2019 Denis Pushkarev (zloirock.ru)'\n\t});\n\t});\n\n\tvar _functionToString = _shared('native-function-to-string', Function.toString);\n\n\tvar _redefine = createCommonjsModule(function (module) {\n\tvar SRC = _uid('src');\n\n\tvar TO_STRING = 'toString';\n\tvar TPL = ('' + _functionToString).split(TO_STRING);\n\n\t_core.inspectSource = function (it) {\n\t  return _functionToString.call(it);\n\t};\n\n\t(module.exports = function (O, key, val, safe) {\n\t  var isFunction = typeof val == 'function';\n\t  if (isFunction) { _has(val, 'name') || _hide(val, 'name', key); }\n\t  if (O[key] === val) { return; }\n\t  if (isFunction) { _has(val, SRC) || _hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key))); }\n\t  if (O === _global) {\n\t    O[key] = val;\n\t  } else if (!safe) {\n\t    delete O[key];\n\t    _hide(O, key, val);\n\t  } else if (O[key]) {\n\t    O[key] = val;\n\t  } else {\n\t    _hide(O, key, val);\n\t  }\n\t// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n\t})(Function.prototype, TO_STRING, function toString() {\n\t  return typeof this == 'function' && this[SRC] || _functionToString.call(this);\n\t});\n\t});\n\n\tvar _aFunction = function (it) {\n\t  if (typeof it != 'function') { throw TypeError(it + ' is not a function!'); }\n\t  return it;\n\t};\n\n\t// optional / simple context binding\n\n\tvar _ctx = function (fn, that, length) {\n\t  _aFunction(fn);\n\t  if (that === undefined) { return fn; }\n\t  switch (length) {\n\t    case 1: return function (a) {\n\t      return fn.call(that, a);\n\t    };\n\t    case 2: return function (a, b) {\n\t      return fn.call(that, a, b);\n\t    };\n\t    case 3: return function (a, b, c) {\n\t      return fn.call(that, a, b, c);\n\t    };\n\t  }\n\t  return function (/* ...args */) {\n\t    return fn.apply(that, arguments);\n\t  };\n\t};\n\n\tvar PROTOTYPE = 'prototype';\n\n\tvar $export = function (type, name, source) {\n\t  var IS_FORCED = type & $export.F;\n\t  var IS_GLOBAL = type & $export.G;\n\t  var IS_STATIC = type & $export.S;\n\t  var IS_PROTO = type & $export.P;\n\t  var IS_BIND = type & $export.B;\n\t  var target = IS_GLOBAL ? _global : IS_STATIC ? _global[name] || (_global[name] = {}) : (_global[name] || {})[PROTOTYPE];\n\t  var exports = IS_GLOBAL ? _core : _core[name] || (_core[name] = {});\n\t  var expProto = exports[PROTOTYPE] || (exports[PROTOTYPE] = {});\n\t  var key, own, out, exp;\n\t  if (IS_GLOBAL) { source = name; }\n\t  for (key in source) {\n\t    // contains in native\n\t    own = !IS_FORCED && target && target[key] !== undefined;\n\t    // export native or passed\n\t    out = (own ? target : source)[key];\n\t    // bind timers to global for call from export context\n\t    exp = IS_BIND && own ? _ctx(out, _global) : IS_PROTO && typeof out == 'function' ? _ctx(Function.call, out) : out;\n\t    // extend global\n\t    if (target) { _redefine(target, key, out, type & $export.U); }\n\t    // export\n\t    if (exports[key] != out) { _hide(exports, key, exp); }\n\t    if (IS_PROTO && expProto[key] != out) { expProto[key] = out; }\n\t  }\n\t};\n\t_global.core = _core;\n\t// type bitmap\n\t$export.F = 1;   // forced\n\t$export.G = 2;   // global\n\t$export.S = 4;   // static\n\t$export.P = 8;   // proto\n\t$export.B = 16;  // bind\n\t$export.W = 32;  // wrap\n\t$export.U = 64;  // safe\n\t$export.R = 128; // real proto method for `library`\n\tvar _export = $export;\n\n\t// 7.1.4 ToInteger\n\tvar ceil = Math.ceil;\n\tvar floor = Math.floor;\n\tvar _toInteger = function (it) {\n\t  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n\t};\n\n\t// 7.2.1 RequireObjectCoercible(argument)\n\tvar _defined = function (it) {\n\t  if (it == undefined) { throw TypeError(\"Can't call method on  \" + it); }\n\t  return it;\n\t};\n\n\t// true  -> String#at\n\t// false -> String#codePointAt\n\tvar _stringAt = function (TO_STRING) {\n\t  return function (that, pos) {\n\t    var s = String(_defined(that));\n\t    var i = _toInteger(pos);\n\t    var l = s.length;\n\t    var a, b;\n\t    if (i < 0 || i >= l) { return TO_STRING ? '' : undefined; }\n\t    a = s.charCodeAt(i);\n\t    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n\t      ? TO_STRING ? s.charAt(i) : a\n\t      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n\t  };\n\t};\n\n\tvar $at = _stringAt(false);\n\t_export(_export.P, 'String', {\n\t  // 21.1.3.3 String.prototype.codePointAt(pos)\n\t  codePointAt: function codePointAt(pos) {\n\t    return $at(this, pos);\n\t  }\n\t});\n\n\tvar codePointAt = _core.String.codePointAt;\n\n\tvar max = Math.max;\n\tvar min = Math.min;\n\tvar _toAbsoluteIndex = function (index, length) {\n\t  index = _toInteger(index);\n\t  return index < 0 ? max(index + length, 0) : min(index, length);\n\t};\n\n\tvar fromCharCode = String.fromCharCode;\n\tvar $fromCodePoint = String.fromCodePoint;\n\n\t// length should be 1, old FF problem\n\t_export(_export.S + _export.F * (!!$fromCodePoint && $fromCodePoint.length != 1), 'String', {\n\t  // 21.1.2.2 String.fromCodePoint(...codePoints)\n\t  fromCodePoint: function fromCodePoint(x) {\n\t    var arguments$1 = arguments;\n\t // eslint-disable-line no-unused-vars\n\t    var res = [];\n\t    var aLen = arguments.length;\n\t    var i = 0;\n\t    var code;\n\t    while (aLen > i) {\n\t      code = +arguments$1[i++];\n\t      if (_toAbsoluteIndex(code, 0x10ffff) !== code) { throw RangeError(code + ' is not a valid code point'); }\n\t      res.push(code < 0x10000\n\t        ? fromCharCode(code)\n\t        : fromCharCode(((code -= 0x10000) >> 10) + 0xd800, code % 0x400 + 0xdc00)\n\t      );\n\t    } return res.join('');\n\t  }\n\t});\n\n\tvar fromCodePoint = _core.String.fromCodePoint;\n\n\t// This is a generated file. Do not edit.\n\tvar Space_Separator = /[\\u1680\\u2000-\\u200A\\u202F\\u205F\\u3000]/;\n\tvar ID_Start = /[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u0860-\\u086A\\u08A0-\\u08B4\\u08B6-\\u08BD\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u09FC\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0AF9\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58-\\u0C5A\\u0C60\\u0C61\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D54-\\u0D56\\u0D5F-\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1C80-\\u1C88\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312E\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FEA\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7AE\\uA7B0-\\uA7B7\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA8FD\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB65\\uAB70-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]|\\uD800[\\uDC00-\\uDC0B\\uDC0D-\\uDC26\\uDC28-\\uDC3A\\uDC3C\\uDC3D\\uDC3F-\\uDC4D\\uDC50-\\uDC5D\\uDC80-\\uDCFA\\uDD40-\\uDD74\\uDE80-\\uDE9C\\uDEA0-\\uDED0\\uDF00-\\uDF1F\\uDF2D-\\uDF4A\\uDF50-\\uDF75\\uDF80-\\uDF9D\\uDFA0-\\uDFC3\\uDFC8-\\uDFCF\\uDFD1-\\uDFD5]|\\uD801[\\uDC00-\\uDC9D\\uDCB0-\\uDCD3\\uDCD8-\\uDCFB\\uDD00-\\uDD27\\uDD30-\\uDD63\\uDE00-\\uDF36\\uDF40-\\uDF55\\uDF60-\\uDF67]|\\uD802[\\uDC00-\\uDC05\\uDC08\\uDC0A-\\uDC35\\uDC37\\uDC38\\uDC3C\\uDC3F-\\uDC55\\uDC60-\\uDC76\\uDC80-\\uDC9E\\uDCE0-\\uDCF2\\uDCF4\\uDCF5\\uDD00-\\uDD15\\uDD20-\\uDD39\\uDD80-\\uDDB7\\uDDBE\\uDDBF\\uDE00\\uDE10-\\uDE13\\uDE15-\\uDE17\\uDE19-\\uDE33\\uDE60-\\uDE7C\\uDE80-\\uDE9C\\uDEC0-\\uDEC7\\uDEC9-\\uDEE4\\uDF00-\\uDF35\\uDF40-\\uDF55\\uDF60-\\uDF72\\uDF80-\\uDF91]|\\uD803[\\uDC00-\\uDC48\\uDC80-\\uDCB2\\uDCC0-\\uDCF2]|\\uD804[\\uDC03-\\uDC37\\uDC83-\\uDCAF\\uDCD0-\\uDCE8\\uDD03-\\uDD26\\uDD50-\\uDD72\\uDD76\\uDD83-\\uDDB2\\uDDC1-\\uDDC4\\uDDDA\\uDDDC\\uDE00-\\uDE11\\uDE13-\\uDE2B\\uDE80-\\uDE86\\uDE88\\uDE8A-\\uDE8D\\uDE8F-\\uDE9D\\uDE9F-\\uDEA8\\uDEB0-\\uDEDE\\uDF05-\\uDF0C\\uDF0F\\uDF10\\uDF13-\\uDF28\\uDF2A-\\uDF30\\uDF32\\uDF33\\uDF35-\\uDF39\\uDF3D\\uDF50\\uDF5D-\\uDF61]|\\uD805[\\uDC00-\\uDC34\\uDC47-\\uDC4A\\uDC80-\\uDCAF\\uDCC4\\uDCC5\\uDCC7\\uDD80-\\uDDAE\\uDDD8-\\uDDDB\\uDE00-\\uDE2F\\uDE44\\uDE80-\\uDEAA\\uDF00-\\uDF19]|\\uD806[\\uDCA0-\\uDCDF\\uDCFF\\uDE00\\uDE0B-\\uDE32\\uDE3A\\uDE50\\uDE5C-\\uDE83\\uDE86-\\uDE89\\uDEC0-\\uDEF8]|\\uD807[\\uDC00-\\uDC08\\uDC0A-\\uDC2E\\uDC40\\uDC72-\\uDC8F\\uDD00-\\uDD06\\uDD08\\uDD09\\uDD0B-\\uDD30\\uDD46]|\\uD808[\\uDC00-\\uDF99]|\\uD809[\\uDC00-\\uDC6E\\uDC80-\\uDD43]|[\\uD80C\\uD81C-\\uD820\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879][\\uDC00-\\uDFFF]|\\uD80D[\\uDC00-\\uDC2E]|\\uD811[\\uDC00-\\uDE46]|\\uD81A[\\uDC00-\\uDE38\\uDE40-\\uDE5E\\uDED0-\\uDEED\\uDF00-\\uDF2F\\uDF40-\\uDF43\\uDF63-\\uDF77\\uDF7D-\\uDF8F]|\\uD81B[\\uDF00-\\uDF44\\uDF50\\uDF93-\\uDF9F\\uDFE0\\uDFE1]|\\uD821[\\uDC00-\\uDFEC]|\\uD822[\\uDC00-\\uDEF2]|\\uD82C[\\uDC00-\\uDD1E\\uDD70-\\uDEFB]|\\uD82F[\\uDC00-\\uDC6A\\uDC70-\\uDC7C\\uDC80-\\uDC88\\uDC90-\\uDC99]|\\uD835[\\uDC00-\\uDC54\\uDC56-\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDEA5\\uDEA8-\\uDEC0\\uDEC2-\\uDEDA\\uDEDC-\\uDEFA\\uDEFC-\\uDF14\\uDF16-\\uDF34\\uDF36-\\uDF4E\\uDF50-\\uDF6E\\uDF70-\\uDF88\\uDF8A-\\uDFA8\\uDFAA-\\uDFC2\\uDFC4-\\uDFCB]|\\uD83A[\\uDC00-\\uDCC4\\uDD00-\\uDD43]|\\uD83B[\\uDE00-\\uDE03\\uDE05-\\uDE1F\\uDE21\\uDE22\\uDE24\\uDE27\\uDE29-\\uDE32\\uDE34-\\uDE37\\uDE39\\uDE3B\\uDE42\\uDE47\\uDE49\\uDE4B\\uDE4D-\\uDE4F\\uDE51\\uDE52\\uDE54\\uDE57\\uDE59\\uDE5B\\uDE5D\\uDE5F\\uDE61\\uDE62\\uDE64\\uDE67-\\uDE6A\\uDE6C-\\uDE72\\uDE74-\\uDE77\\uDE79-\\uDE7C\\uDE7E\\uDE80-\\uDE89\\uDE8B-\\uDE9B\\uDEA1-\\uDEA3\\uDEA5-\\uDEA9\\uDEAB-\\uDEBB]|\\uD869[\\uDC00-\\uDED6\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF34\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]/;\n\tvar ID_Continue = /[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u0860-\\u086A\\u08A0-\\u08B4\\u08B6-\\u08BD\\u08D4-\\u08E1\\u08E3-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u09FC\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0AF9-\\u0AFF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58-\\u0C5A\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C80-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D00-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D54-\\u0D57\\u0D5F-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1C80-\\u1C88\\u1CD0-\\u1CD2\\u1CD4-\\u1CF9\\u1D00-\\u1DF9\\u1DFB-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312E\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FEA\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7AE\\uA7B0-\\uA7B7\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C5\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA8FD\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB65\\uAB70-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2F\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]|\\uD800[\\uDC00-\\uDC0B\\uDC0D-\\uDC26\\uDC28-\\uDC3A\\uDC3C\\uDC3D\\uDC3F-\\uDC4D\\uDC50-\\uDC5D\\uDC80-\\uDCFA\\uDD40-\\uDD74\\uDDFD\\uDE80-\\uDE9C\\uDEA0-\\uDED0\\uDEE0\\uDF00-\\uDF1F\\uDF2D-\\uDF4A\\uDF50-\\uDF7A\\uDF80-\\uDF9D\\uDFA0-\\uDFC3\\uDFC8-\\uDFCF\\uDFD1-\\uDFD5]|\\uD801[\\uDC00-\\uDC9D\\uDCA0-\\uDCA9\\uDCB0-\\uDCD3\\uDCD8-\\uDCFB\\uDD00-\\uDD27\\uDD30-\\uDD63\\uDE00-\\uDF36\\uDF40-\\uDF55\\uDF60-\\uDF67]|\\uD802[\\uDC00-\\uDC05\\uDC08\\uDC0A-\\uDC35\\uDC37\\uDC38\\uDC3C\\uDC3F-\\uDC55\\uDC60-\\uDC76\\uDC80-\\uDC9E\\uDCE0-\\uDCF2\\uDCF4\\uDCF5\\uDD00-\\uDD15\\uDD20-\\uDD39\\uDD80-\\uDDB7\\uDDBE\\uDDBF\\uDE00-\\uDE03\\uDE05\\uDE06\\uDE0C-\\uDE13\\uDE15-\\uDE17\\uDE19-\\uDE33\\uDE38-\\uDE3A\\uDE3F\\uDE60-\\uDE7C\\uDE80-\\uDE9C\\uDEC0-\\uDEC7\\uDEC9-\\uDEE6\\uDF00-\\uDF35\\uDF40-\\uDF55\\uDF60-\\uDF72\\uDF80-\\uDF91]|\\uD803[\\uDC00-\\uDC48\\uDC80-\\uDCB2\\uDCC0-\\uDCF2]|\\uD804[\\uDC00-\\uDC46\\uDC66-\\uDC6F\\uDC7F-\\uDCBA\\uDCD0-\\uDCE8\\uDCF0-\\uDCF9\\uDD00-\\uDD34\\uDD36-\\uDD3F\\uDD50-\\uDD73\\uDD76\\uDD80-\\uDDC4\\uDDCA-\\uDDCC\\uDDD0-\\uDDDA\\uDDDC\\uDE00-\\uDE11\\uDE13-\\uDE37\\uDE3E\\uDE80-\\uDE86\\uDE88\\uDE8A-\\uDE8D\\uDE8F-\\uDE9D\\uDE9F-\\uDEA8\\uDEB0-\\uDEEA\\uDEF0-\\uDEF9\\uDF00-\\uDF03\\uDF05-\\uDF0C\\uDF0F\\uDF10\\uDF13-\\uDF28\\uDF2A-\\uDF30\\uDF32\\uDF33\\uDF35-\\uDF39\\uDF3C-\\uDF44\\uDF47\\uDF48\\uDF4B-\\uDF4D\\uDF50\\uDF57\\uDF5D-\\uDF63\\uDF66-\\uDF6C\\uDF70-\\uDF74]|\\uD805[\\uDC00-\\uDC4A\\uDC50-\\uDC59\\uDC80-\\uDCC5\\uDCC7\\uDCD0-\\uDCD9\\uDD80-\\uDDB5\\uDDB8-\\uDDC0\\uDDD8-\\uDDDD\\uDE00-\\uDE40\\uDE44\\uDE50-\\uDE59\\uDE80-\\uDEB7\\uDEC0-\\uDEC9\\uDF00-\\uDF19\\uDF1D-\\uDF2B\\uDF30-\\uDF39]|\\uD806[\\uDCA0-\\uDCE9\\uDCFF\\uDE00-\\uDE3E\\uDE47\\uDE50-\\uDE83\\uDE86-\\uDE99\\uDEC0-\\uDEF8]|\\uD807[\\uDC00-\\uDC08\\uDC0A-\\uDC36\\uDC38-\\uDC40\\uDC50-\\uDC59\\uDC72-\\uDC8F\\uDC92-\\uDCA7\\uDCA9-\\uDCB6\\uDD00-\\uDD06\\uDD08\\uDD09\\uDD0B-\\uDD36\\uDD3A\\uDD3C\\uDD3D\\uDD3F-\\uDD47\\uDD50-\\uDD59]|\\uD808[\\uDC00-\\uDF99]|\\uD809[\\uDC00-\\uDC6E\\uDC80-\\uDD43]|[\\uD80C\\uD81C-\\uD820\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879][\\uDC00-\\uDFFF]|\\uD80D[\\uDC00-\\uDC2E]|\\uD811[\\uDC00-\\uDE46]|\\uD81A[\\uDC00-\\uDE38\\uDE40-\\uDE5E\\uDE60-\\uDE69\\uDED0-\\uDEED\\uDEF0-\\uDEF4\\uDF00-\\uDF36\\uDF40-\\uDF43\\uDF50-\\uDF59\\uDF63-\\uDF77\\uDF7D-\\uDF8F]|\\uD81B[\\uDF00-\\uDF44\\uDF50-\\uDF7E\\uDF8F-\\uDF9F\\uDFE0\\uDFE1]|\\uD821[\\uDC00-\\uDFEC]|\\uD822[\\uDC00-\\uDEF2]|\\uD82C[\\uDC00-\\uDD1E\\uDD70-\\uDEFB]|\\uD82F[\\uDC00-\\uDC6A\\uDC70-\\uDC7C\\uDC80-\\uDC88\\uDC90-\\uDC99\\uDC9D\\uDC9E]|\\uD834[\\uDD65-\\uDD69\\uDD6D-\\uDD72\\uDD7B-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD\\uDE42-\\uDE44]|\\uD835[\\uDC00-\\uDC54\\uDC56-\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDEA5\\uDEA8-\\uDEC0\\uDEC2-\\uDEDA\\uDEDC-\\uDEFA\\uDEFC-\\uDF14\\uDF16-\\uDF34\\uDF36-\\uDF4E\\uDF50-\\uDF6E\\uDF70-\\uDF88\\uDF8A-\\uDFA8\\uDFAA-\\uDFC2\\uDFC4-\\uDFCB\\uDFCE-\\uDFFF]|\\uD836[\\uDE00-\\uDE36\\uDE3B-\\uDE6C\\uDE75\\uDE84\\uDE9B-\\uDE9F\\uDEA1-\\uDEAF]|\\uD838[\\uDC00-\\uDC06\\uDC08-\\uDC18\\uDC1B-\\uDC21\\uDC23\\uDC24\\uDC26-\\uDC2A]|\\uD83A[\\uDC00-\\uDCC4\\uDCD0-\\uDCD6\\uDD00-\\uDD4A\\uDD50-\\uDD59]|\\uD83B[\\uDE00-\\uDE03\\uDE05-\\uDE1F\\uDE21\\uDE22\\uDE24\\uDE27\\uDE29-\\uDE32\\uDE34-\\uDE37\\uDE39\\uDE3B\\uDE42\\uDE47\\uDE49\\uDE4B\\uDE4D-\\uDE4F\\uDE51\\uDE52\\uDE54\\uDE57\\uDE59\\uDE5B\\uDE5D\\uDE5F\\uDE61\\uDE62\\uDE64\\uDE67-\\uDE6A\\uDE6C-\\uDE72\\uDE74-\\uDE77\\uDE79-\\uDE7C\\uDE7E\\uDE80-\\uDE89\\uDE8B-\\uDE9B\\uDEA1-\\uDEA3\\uDEA5-\\uDEA9\\uDEAB-\\uDEBB]|\\uD869[\\uDC00-\\uDED6\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF34\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]|\\uDB40[\\uDD00-\\uDDEF]/;\n\n\tvar unicode = {\n\t\tSpace_Separator: Space_Separator,\n\t\tID_Start: ID_Start,\n\t\tID_Continue: ID_Continue\n\t};\n\n\tvar util = {\n\t    isSpaceSeparator: function isSpaceSeparator (c) {\n\t        return typeof c === 'string' && unicode.Space_Separator.test(c)\n\t    },\n\n\t    isIdStartChar: function isIdStartChar (c) {\n\t        return typeof c === 'string' && (\n\t            (c >= 'a' && c <= 'z') ||\n\t        (c >= 'A' && c <= 'Z') ||\n\t        (c === '$') || (c === '_') ||\n\t        unicode.ID_Start.test(c)\n\t        )\n\t    },\n\n\t    isIdContinueChar: function isIdContinueChar (c) {\n\t        return typeof c === 'string' && (\n\t            (c >= 'a' && c <= 'z') ||\n\t        (c >= 'A' && c <= 'Z') ||\n\t        (c >= '0' && c <= '9') ||\n\t        (c === '$') || (c === '_') ||\n\t        (c === '\\u200C') || (c === '\\u200D') ||\n\t        unicode.ID_Continue.test(c)\n\t        )\n\t    },\n\n\t    isDigit: function isDigit (c) {\n\t        return typeof c === 'string' && /[0-9]/.test(c)\n\t    },\n\n\t    isHexDigit: function isHexDigit (c) {\n\t        return typeof c === 'string' && /[0-9A-Fa-f]/.test(c)\n\t    },\n\t};\n\n\tvar source;\n\tvar parseState;\n\tvar stack;\n\tvar pos;\n\tvar line;\n\tvar column;\n\tvar token;\n\tvar key;\n\tvar root;\n\n\tvar parse = function parse (text, reviver) {\n\t    source = String(text);\n\t    parseState = 'start';\n\t    stack = [];\n\t    pos = 0;\n\t    line = 1;\n\t    column = 0;\n\t    token = undefined;\n\t    key = undefined;\n\t    root = undefined;\n\n\t    do {\n\t        token = lex();\n\n\t        // This code is unreachable.\n\t        // if (!parseStates[parseState]) {\n\t        //     throw invalidParseState()\n\t        // }\n\n\t        parseStates[parseState]();\n\t    } while (token.type !== 'eof')\n\n\t    if (typeof reviver === 'function') {\n\t        return internalize({'': root}, '', reviver)\n\t    }\n\n\t    return root\n\t};\n\n\tfunction internalize (holder, name, reviver) {\n\t    var value = holder[name];\n\t    if (value != null && typeof value === 'object') {\n\t        if (Array.isArray(value)) {\n\t            for (var i = 0; i < value.length; i++) {\n\t                var key = String(i);\n\t                var replacement = internalize(value, key, reviver);\n\t                if (replacement === undefined) {\n\t                    delete value[key];\n\t                } else {\n\t                    Object.defineProperty(value, key, {\n\t                        value: replacement,\n\t                        writable: true,\n\t                        enumerable: true,\n\t                        configurable: true,\n\t                    });\n\t                }\n\t            }\n\t        } else {\n\t            for (var key$1 in value) {\n\t                var replacement$1 = internalize(value, key$1, reviver);\n\t                if (replacement$1 === undefined) {\n\t                    delete value[key$1];\n\t                } else {\n\t                    Object.defineProperty(value, key$1, {\n\t                        value: replacement$1,\n\t                        writable: true,\n\t                        enumerable: true,\n\t                        configurable: true,\n\t                    });\n\t                }\n\t            }\n\t        }\n\t    }\n\n\t    return reviver.call(holder, name, value)\n\t}\n\n\tvar lexState;\n\tvar buffer;\n\tvar doubleQuote;\n\tvar sign;\n\tvar c;\n\n\tfunction lex () {\n\t    lexState = 'default';\n\t    buffer = '';\n\t    doubleQuote = false;\n\t    sign = 1;\n\n\t    for (;;) {\n\t        c = peek();\n\n\t        // This code is unreachable.\n\t        // if (!lexStates[lexState]) {\n\t        //     throw invalidLexState(lexState)\n\t        // }\n\n\t        var token = lexStates[lexState]();\n\t        if (token) {\n\t            return token\n\t        }\n\t    }\n\t}\n\n\tfunction peek () {\n\t    if (source[pos]) {\n\t        return String.fromCodePoint(source.codePointAt(pos))\n\t    }\n\t}\n\n\tfunction read () {\n\t    var c = peek();\n\n\t    if (c === '\\n') {\n\t        line++;\n\t        column = 0;\n\t    } else if (c) {\n\t        column += c.length;\n\t    } else {\n\t        column++;\n\t    }\n\n\t    if (c) {\n\t        pos += c.length;\n\t    }\n\n\t    return c\n\t}\n\n\tvar lexStates = {\n\t    default: function default$1 () {\n\t        switch (c) {\n\t        case '\\t':\n\t        case '\\v':\n\t        case '\\f':\n\t        case ' ':\n\t        case '\\u00A0':\n\t        case '\\uFEFF':\n\t        case '\\n':\n\t        case '\\r':\n\t        case '\\u2028':\n\t        case '\\u2029':\n\t            read();\n\t            return\n\n\t        case '/':\n\t            read();\n\t            lexState = 'comment';\n\t            return\n\n\t        case undefined:\n\t            read();\n\t            return newToken('eof')\n\t        }\n\n\t        if (util.isSpaceSeparator(c)) {\n\t            read();\n\t            return\n\t        }\n\n\t        // This code is unreachable.\n\t        // if (!lexStates[parseState]) {\n\t        //     throw invalidLexState(parseState)\n\t        // }\n\n\t        return lexStates[parseState]()\n\t    },\n\n\t    comment: function comment () {\n\t        switch (c) {\n\t        case '*':\n\t            read();\n\t            lexState = 'multiLineComment';\n\t            return\n\n\t        case '/':\n\t            read();\n\t            lexState = 'singleLineComment';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    multiLineComment: function multiLineComment () {\n\t        switch (c) {\n\t        case '*':\n\t            read();\n\t            lexState = 'multiLineCommentAsterisk';\n\t            return\n\n\t        case undefined:\n\t            throw invalidChar(read())\n\t        }\n\n\t        read();\n\t    },\n\n\t    multiLineCommentAsterisk: function multiLineCommentAsterisk () {\n\t        switch (c) {\n\t        case '*':\n\t            read();\n\t            return\n\n\t        case '/':\n\t            read();\n\t            lexState = 'default';\n\t            return\n\n\t        case undefined:\n\t            throw invalidChar(read())\n\t        }\n\n\t        read();\n\t        lexState = 'multiLineComment';\n\t    },\n\n\t    singleLineComment: function singleLineComment () {\n\t        switch (c) {\n\t        case '\\n':\n\t        case '\\r':\n\t        case '\\u2028':\n\t        case '\\u2029':\n\t            read();\n\t            lexState = 'default';\n\t            return\n\n\t        case undefined:\n\t            read();\n\t            return newToken('eof')\n\t        }\n\n\t        read();\n\t    },\n\n\t    value: function value () {\n\t        switch (c) {\n\t        case '{':\n\t        case '[':\n\t            return newToken('punctuator', read())\n\n\t        case 'n':\n\t            read();\n\t            literal('ull');\n\t            return newToken('null', null)\n\n\t        case 't':\n\t            read();\n\t            literal('rue');\n\t            return newToken('boolean', true)\n\n\t        case 'f':\n\t            read();\n\t            literal('alse');\n\t            return newToken('boolean', false)\n\n\t        case '-':\n\t        case '+':\n\t            if (read() === '-') {\n\t                sign = -1;\n\t            }\n\n\t            lexState = 'sign';\n\t            return\n\n\t        case '.':\n\t            buffer = read();\n\t            lexState = 'decimalPointLeading';\n\t            return\n\n\t        case '0':\n\t            buffer = read();\n\t            lexState = 'zero';\n\t            return\n\n\t        case '1':\n\t        case '2':\n\t        case '3':\n\t        case '4':\n\t        case '5':\n\t        case '6':\n\t        case '7':\n\t        case '8':\n\t        case '9':\n\t            buffer = read();\n\t            lexState = 'decimalInteger';\n\t            return\n\n\t        case 'I':\n\t            read();\n\t            literal('nfinity');\n\t            return newToken('numeric', Infinity)\n\n\t        case 'N':\n\t            read();\n\t            literal('aN');\n\t            return newToken('numeric', NaN)\n\n\t        case '\"':\n\t        case \"'\":\n\t            doubleQuote = (read() === '\"');\n\t            buffer = '';\n\t            lexState = 'string';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    identifierNameStartEscape: function identifierNameStartEscape () {\n\t        if (c !== 'u') {\n\t            throw invalidChar(read())\n\t        }\n\n\t        read();\n\t        var u = unicodeEscape();\n\t        switch (u) {\n\t        case '$':\n\t        case '_':\n\t            break\n\n\t        default:\n\t            if (!util.isIdStartChar(u)) {\n\t                throw invalidIdentifier()\n\t            }\n\n\t            break\n\t        }\n\n\t        buffer += u;\n\t        lexState = 'identifierName';\n\t    },\n\n\t    identifierName: function identifierName () {\n\t        switch (c) {\n\t        case '$':\n\t        case '_':\n\t        case '\\u200C':\n\t        case '\\u200D':\n\t            buffer += read();\n\t            return\n\n\t        case '\\\\':\n\t            read();\n\t            lexState = 'identifierNameEscape';\n\t            return\n\t        }\n\n\t        if (util.isIdContinueChar(c)) {\n\t            buffer += read();\n\t            return\n\t        }\n\n\t        return newToken('identifier', buffer)\n\t    },\n\n\t    identifierNameEscape: function identifierNameEscape () {\n\t        if (c !== 'u') {\n\t            throw invalidChar(read())\n\t        }\n\n\t        read();\n\t        var u = unicodeEscape();\n\t        switch (u) {\n\t        case '$':\n\t        case '_':\n\t        case '\\u200C':\n\t        case '\\u200D':\n\t            break\n\n\t        default:\n\t            if (!util.isIdContinueChar(u)) {\n\t                throw invalidIdentifier()\n\t            }\n\n\t            break\n\t        }\n\n\t        buffer += u;\n\t        lexState = 'identifierName';\n\t    },\n\n\t    sign: function sign$1 () {\n\t        switch (c) {\n\t        case '.':\n\t            buffer = read();\n\t            lexState = 'decimalPointLeading';\n\t            return\n\n\t        case '0':\n\t            buffer = read();\n\t            lexState = 'zero';\n\t            return\n\n\t        case '1':\n\t        case '2':\n\t        case '3':\n\t        case '4':\n\t        case '5':\n\t        case '6':\n\t        case '7':\n\t        case '8':\n\t        case '9':\n\t            buffer = read();\n\t            lexState = 'decimalInteger';\n\t            return\n\n\t        case 'I':\n\t            read();\n\t            literal('nfinity');\n\t            return newToken('numeric', sign * Infinity)\n\n\t        case 'N':\n\t            read();\n\t            literal('aN');\n\t            return newToken('numeric', NaN)\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    zero: function zero () {\n\t        switch (c) {\n\t        case '.':\n\t            buffer += read();\n\t            lexState = 'decimalPoint';\n\t            return\n\n\t        case 'e':\n\t        case 'E':\n\t            buffer += read();\n\t            lexState = 'decimalExponent';\n\t            return\n\n\t        case 'x':\n\t        case 'X':\n\t            buffer += read();\n\t            lexState = 'hexadecimal';\n\t            return\n\t        }\n\n\t        return newToken('numeric', sign * 0)\n\t    },\n\n\t    decimalInteger: function decimalInteger () {\n\t        switch (c) {\n\t        case '.':\n\t            buffer += read();\n\t            lexState = 'decimalPoint';\n\t            return\n\n\t        case 'e':\n\t        case 'E':\n\t            buffer += read();\n\t            lexState = 'decimalExponent';\n\t            return\n\t        }\n\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            return\n\t        }\n\n\t        return newToken('numeric', sign * Number(buffer))\n\t    },\n\n\t    decimalPointLeading: function decimalPointLeading () {\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            lexState = 'decimalFraction';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    decimalPoint: function decimalPoint () {\n\t        switch (c) {\n\t        case 'e':\n\t        case 'E':\n\t            buffer += read();\n\t            lexState = 'decimalExponent';\n\t            return\n\t        }\n\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            lexState = 'decimalFraction';\n\t            return\n\t        }\n\n\t        return newToken('numeric', sign * Number(buffer))\n\t    },\n\n\t    decimalFraction: function decimalFraction () {\n\t        switch (c) {\n\t        case 'e':\n\t        case 'E':\n\t            buffer += read();\n\t            lexState = 'decimalExponent';\n\t            return\n\t        }\n\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            return\n\t        }\n\n\t        return newToken('numeric', sign * Number(buffer))\n\t    },\n\n\t    decimalExponent: function decimalExponent () {\n\t        switch (c) {\n\t        case '+':\n\t        case '-':\n\t            buffer += read();\n\t            lexState = 'decimalExponentSign';\n\t            return\n\t        }\n\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            lexState = 'decimalExponentInteger';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    decimalExponentSign: function decimalExponentSign () {\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            lexState = 'decimalExponentInteger';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    decimalExponentInteger: function decimalExponentInteger () {\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            return\n\t        }\n\n\t        return newToken('numeric', sign * Number(buffer))\n\t    },\n\n\t    hexadecimal: function hexadecimal () {\n\t        if (util.isHexDigit(c)) {\n\t            buffer += read();\n\t            lexState = 'hexadecimalInteger';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    hexadecimalInteger: function hexadecimalInteger () {\n\t        if (util.isHexDigit(c)) {\n\t            buffer += read();\n\t            return\n\t        }\n\n\t        return newToken('numeric', sign * Number(buffer))\n\t    },\n\n\t    string: function string () {\n\t        switch (c) {\n\t        case '\\\\':\n\t            read();\n\t            buffer += escape();\n\t            return\n\n\t        case '\"':\n\t            if (doubleQuote) {\n\t                read();\n\t                return newToken('string', buffer)\n\t            }\n\n\t            buffer += read();\n\t            return\n\n\t        case \"'\":\n\t            if (!doubleQuote) {\n\t                read();\n\t                return newToken('string', buffer)\n\t            }\n\n\t            buffer += read();\n\t            return\n\n\t        case '\\n':\n\t        case '\\r':\n\t            throw invalidChar(read())\n\n\t        case '\\u2028':\n\t        case '\\u2029':\n\t            separatorChar(c);\n\t            break\n\n\t        case undefined:\n\t            throw invalidChar(read())\n\t        }\n\n\t        buffer += read();\n\t    },\n\n\t    start: function start () {\n\t        switch (c) {\n\t        case '{':\n\t        case '[':\n\t            return newToken('punctuator', read())\n\n\t        // This code is unreachable since the default lexState handles eof.\n\t        // case undefined:\n\t        //     return newToken('eof')\n\t        }\n\n\t        lexState = 'value';\n\t    },\n\n\t    beforePropertyName: function beforePropertyName () {\n\t        switch (c) {\n\t        case '$':\n\t        case '_':\n\t            buffer = read();\n\t            lexState = 'identifierName';\n\t            return\n\n\t        case '\\\\':\n\t            read();\n\t            lexState = 'identifierNameStartEscape';\n\t            return\n\n\t        case '}':\n\t            return newToken('punctuator', read())\n\n\t        case '\"':\n\t        case \"'\":\n\t            doubleQuote = (read() === '\"');\n\t            lexState = 'string';\n\t            return\n\t        }\n\n\t        if (util.isIdStartChar(c)) {\n\t            buffer += read();\n\t            lexState = 'identifierName';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    afterPropertyName: function afterPropertyName () {\n\t        if (c === ':') {\n\t            return newToken('punctuator', read())\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    beforePropertyValue: function beforePropertyValue () {\n\t        lexState = 'value';\n\t    },\n\n\t    afterPropertyValue: function afterPropertyValue () {\n\t        switch (c) {\n\t        case ',':\n\t        case '}':\n\t            return newToken('punctuator', read())\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    beforeArrayValue: function beforeArrayValue () {\n\t        if (c === ']') {\n\t            return newToken('punctuator', read())\n\t        }\n\n\t        lexState = 'value';\n\t    },\n\n\t    afterArrayValue: function afterArrayValue () {\n\t        switch (c) {\n\t        case ',':\n\t        case ']':\n\t            return newToken('punctuator', read())\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    end: function end () {\n\t        // This code is unreachable since it's handled by the default lexState.\n\t        // if (c === undefined) {\n\t        //     read()\n\t        //     return newToken('eof')\n\t        // }\n\n\t        throw invalidChar(read())\n\t    },\n\t};\n\n\tfunction newToken (type, value) {\n\t    return {\n\t        type: type,\n\t        value: value,\n\t        line: line,\n\t        column: column,\n\t    }\n\t}\n\n\tfunction literal (s) {\n\t    for (var i = 0, list = s; i < list.length; i += 1) {\n\t        var c = list[i];\n\n\t        var p = peek();\n\n\t        if (p !== c) {\n\t            throw invalidChar(read())\n\t        }\n\n\t        read();\n\t    }\n\t}\n\n\tfunction escape () {\n\t    var c = peek();\n\t    switch (c) {\n\t    case 'b':\n\t        read();\n\t        return '\\b'\n\n\t    case 'f':\n\t        read();\n\t        return '\\f'\n\n\t    case 'n':\n\t        read();\n\t        return '\\n'\n\n\t    case 'r':\n\t        read();\n\t        return '\\r'\n\n\t    case 't':\n\t        read();\n\t        return '\\t'\n\n\t    case 'v':\n\t        read();\n\t        return '\\v'\n\n\t    case '0':\n\t        read();\n\t        if (util.isDigit(peek())) {\n\t            throw invalidChar(read())\n\t        }\n\n\t        return '\\0'\n\n\t    case 'x':\n\t        read();\n\t        return hexEscape()\n\n\t    case 'u':\n\t        read();\n\t        return unicodeEscape()\n\n\t    case '\\n':\n\t    case '\\u2028':\n\t    case '\\u2029':\n\t        read();\n\t        return ''\n\n\t    case '\\r':\n\t        read();\n\t        if (peek() === '\\n') {\n\t            read();\n\t        }\n\n\t        return ''\n\n\t    case '1':\n\t    case '2':\n\t    case '3':\n\t    case '4':\n\t    case '5':\n\t    case '6':\n\t    case '7':\n\t    case '8':\n\t    case '9':\n\t        throw invalidChar(read())\n\n\t    case undefined:\n\t        throw invalidChar(read())\n\t    }\n\n\t    return read()\n\t}\n\n\tfunction hexEscape () {\n\t    var buffer = '';\n\t    var c = peek();\n\n\t    if (!util.isHexDigit(c)) {\n\t        throw invalidChar(read())\n\t    }\n\n\t    buffer += read();\n\n\t    c = peek();\n\t    if (!util.isHexDigit(c)) {\n\t        throw invalidChar(read())\n\t    }\n\n\t    buffer += read();\n\n\t    return String.fromCodePoint(parseInt(buffer, 16))\n\t}\n\n\tfunction unicodeEscape () {\n\t    var buffer = '';\n\t    var count = 4;\n\n\t    while (count-- > 0) {\n\t        var c = peek();\n\t        if (!util.isHexDigit(c)) {\n\t            throw invalidChar(read())\n\t        }\n\n\t        buffer += read();\n\t    }\n\n\t    return String.fromCodePoint(parseInt(buffer, 16))\n\t}\n\n\tvar parseStates = {\n\t    start: function start () {\n\t        if (token.type === 'eof') {\n\t            throw invalidEOF()\n\t        }\n\n\t        push();\n\t    },\n\n\t    beforePropertyName: function beforePropertyName () {\n\t        switch (token.type) {\n\t        case 'identifier':\n\t        case 'string':\n\t            key = token.value;\n\t            parseState = 'afterPropertyName';\n\t            return\n\n\t        case 'punctuator':\n\t            // This code is unreachable since it's handled by the lexState.\n\t            // if (token.value !== '}') {\n\t            //     throw invalidToken()\n\t            // }\n\n\t            pop();\n\t            return\n\n\t        case 'eof':\n\t            throw invalidEOF()\n\t        }\n\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // throw invalidToken()\n\t    },\n\n\t    afterPropertyName: function afterPropertyName () {\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // if (token.type !== 'punctuator' || token.value !== ':') {\n\t        //     throw invalidToken()\n\t        // }\n\n\t        if (token.type === 'eof') {\n\t            throw invalidEOF()\n\t        }\n\n\t        parseState = 'beforePropertyValue';\n\t    },\n\n\t    beforePropertyValue: function beforePropertyValue () {\n\t        if (token.type === 'eof') {\n\t            throw invalidEOF()\n\t        }\n\n\t        push();\n\t    },\n\n\t    beforeArrayValue: function beforeArrayValue () {\n\t        if (token.type === 'eof') {\n\t            throw invalidEOF()\n\t        }\n\n\t        if (token.type === 'punctuator' && token.value === ']') {\n\t            pop();\n\t            return\n\t        }\n\n\t        push();\n\t    },\n\n\t    afterPropertyValue: function afterPropertyValue () {\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // if (token.type !== 'punctuator') {\n\t        //     throw invalidToken()\n\t        // }\n\n\t        if (token.type === 'eof') {\n\t            throw invalidEOF()\n\t        }\n\n\t        switch (token.value) {\n\t        case ',':\n\t            parseState = 'beforePropertyName';\n\t            return\n\n\t        case '}':\n\t            pop();\n\t        }\n\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // throw invalidToken()\n\t    },\n\n\t    afterArrayValue: function afterArrayValue () {\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // if (token.type !== 'punctuator') {\n\t        //     throw invalidToken()\n\t        // }\n\n\t        if (token.type === 'eof') {\n\t            throw invalidEOF()\n\t        }\n\n\t        switch (token.value) {\n\t        case ',':\n\t            parseState = 'beforeArrayValue';\n\t            return\n\n\t        case ']':\n\t            pop();\n\t        }\n\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // throw invalidToken()\n\t    },\n\n\t    end: function end () {\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // if (token.type !== 'eof') {\n\t        //     throw invalidToken()\n\t        // }\n\t    },\n\t};\n\n\tfunction push () {\n\t    var value;\n\n\t    switch (token.type) {\n\t    case 'punctuator':\n\t        switch (token.value) {\n\t        case '{':\n\t            value = {};\n\t            break\n\n\t        case '[':\n\t            value = [];\n\t            break\n\t        }\n\n\t        break\n\n\t    case 'null':\n\t    case 'boolean':\n\t    case 'numeric':\n\t    case 'string':\n\t        value = token.value;\n\t        break\n\n\t    // This code is unreachable.\n\t    // default:\n\t    //     throw invalidToken()\n\t    }\n\n\t    if (root === undefined) {\n\t        root = value;\n\t    } else {\n\t        var parent = stack[stack.length - 1];\n\t        if (Array.isArray(parent)) {\n\t            parent.push(value);\n\t        } else {\n\t            Object.defineProperty(parent, key, {\n\t                value: value,\n\t                writable: true,\n\t                enumerable: true,\n\t                configurable: true,\n\t            });\n\t        }\n\t    }\n\n\t    if (value !== null && typeof value === 'object') {\n\t        stack.push(value);\n\n\t        if (Array.isArray(value)) {\n\t            parseState = 'beforeArrayValue';\n\t        } else {\n\t            parseState = 'beforePropertyName';\n\t        }\n\t    } else {\n\t        var current = stack[stack.length - 1];\n\t        if (current == null) {\n\t            parseState = 'end';\n\t        } else if (Array.isArray(current)) {\n\t            parseState = 'afterArrayValue';\n\t        } else {\n\t            parseState = 'afterPropertyValue';\n\t        }\n\t    }\n\t}\n\n\tfunction pop () {\n\t    stack.pop();\n\n\t    var current = stack[stack.length - 1];\n\t    if (current == null) {\n\t        parseState = 'end';\n\t    } else if (Array.isArray(current)) {\n\t        parseState = 'afterArrayValue';\n\t    } else {\n\t        parseState = 'afterPropertyValue';\n\t    }\n\t}\n\n\t// This code is unreachable.\n\t// function invalidParseState () {\n\t//     return new Error(`JSON5: invalid parse state '${parseState}'`)\n\t// }\n\n\t// This code is unreachable.\n\t// function invalidLexState (state) {\n\t//     return new Error(`JSON5: invalid lex state '${state}'`)\n\t// }\n\n\tfunction invalidChar (c) {\n\t    if (c === undefined) {\n\t        return syntaxError((\"JSON5: invalid end of input at \" + line + \":\" + column))\n\t    }\n\n\t    return syntaxError((\"JSON5: invalid character '\" + (formatChar(c)) + \"' at \" + line + \":\" + column))\n\t}\n\n\tfunction invalidEOF () {\n\t    return syntaxError((\"JSON5: invalid end of input at \" + line + \":\" + column))\n\t}\n\n\t// This code is unreachable.\n\t// function invalidToken () {\n\t//     if (token.type === 'eof') {\n\t//         return syntaxError(`JSON5: invalid end of input at ${line}:${column}`)\n\t//     }\n\n\t//     const c = String.fromCodePoint(token.value.codePointAt(0))\n\t//     return syntaxError(`JSON5: invalid character '${formatChar(c)}' at ${line}:${column}`)\n\t// }\n\n\tfunction invalidIdentifier () {\n\t    column -= 5;\n\t    return syntaxError((\"JSON5: invalid identifier character at \" + line + \":\" + column))\n\t}\n\n\tfunction separatorChar (c) {\n\t    console.warn((\"JSON5: '\" + (formatChar(c)) + \"' in strings is not valid ECMAScript; consider escaping\"));\n\t}\n\n\tfunction formatChar (c) {\n\t    var replacements = {\n\t        \"'\": \"\\\\'\",\n\t        '\"': '\\\\\"',\n\t        '\\\\': '\\\\\\\\',\n\t        '\\b': '\\\\b',\n\t        '\\f': '\\\\f',\n\t        '\\n': '\\\\n',\n\t        '\\r': '\\\\r',\n\t        '\\t': '\\\\t',\n\t        '\\v': '\\\\v',\n\t        '\\0': '\\\\0',\n\t        '\\u2028': '\\\\u2028',\n\t        '\\u2029': '\\\\u2029',\n\t    };\n\n\t    if (replacements[c]) {\n\t        return replacements[c]\n\t    }\n\n\t    if (c < ' ') {\n\t        var hexString = c.charCodeAt(0).toString(16);\n\t        return '\\\\x' + ('00' + hexString).substring(hexString.length)\n\t    }\n\n\t    return c\n\t}\n\n\tfunction syntaxError (message) {\n\t    var err = new SyntaxError(message);\n\t    err.lineNumber = line;\n\t    err.columnNumber = column;\n\t    return err\n\t}\n\n\tvar stringify = function stringify (value, replacer, space) {\n\t    var stack = [];\n\t    var indent = '';\n\t    var propertyList;\n\t    var replacerFunc;\n\t    var gap = '';\n\t    var quote;\n\n\t    if (\n\t        replacer != null &&\n\t        typeof replacer === 'object' &&\n\t        !Array.isArray(replacer)\n\t    ) {\n\t        space = replacer.space;\n\t        quote = replacer.quote;\n\t        replacer = replacer.replacer;\n\t    }\n\n\t    if (typeof replacer === 'function') {\n\t        replacerFunc = replacer;\n\t    } else if (Array.isArray(replacer)) {\n\t        propertyList = [];\n\t        for (var i = 0, list = replacer; i < list.length; i += 1) {\n\t            var v = list[i];\n\n\t            var item = (void 0);\n\n\t            if (typeof v === 'string') {\n\t                item = v;\n\t            } else if (\n\t                typeof v === 'number' ||\n\t                v instanceof String ||\n\t                v instanceof Number\n\t            ) {\n\t                item = String(v);\n\t            }\n\n\t            if (item !== undefined && propertyList.indexOf(item) < 0) {\n\t                propertyList.push(item);\n\t            }\n\t        }\n\t    }\n\n\t    if (space instanceof Number) {\n\t        space = Number(space);\n\t    } else if (space instanceof String) {\n\t        space = String(space);\n\t    }\n\n\t    if (typeof space === 'number') {\n\t        if (space > 0) {\n\t            space = Math.min(10, Math.floor(space));\n\t            gap = '          '.substr(0, space);\n\t        }\n\t    } else if (typeof space === 'string') {\n\t        gap = space.substr(0, 10);\n\t    }\n\n\t    return serializeProperty('', {'': value})\n\n\t    function serializeProperty (key, holder) {\n\t        var value = holder[key];\n\t        if (value != null) {\n\t            if (typeof value.toJSON5 === 'function') {\n\t                value = value.toJSON5(key);\n\t            } else if (typeof value.toJSON === 'function') {\n\t                value = value.toJSON(key);\n\t            }\n\t        }\n\n\t        if (replacerFunc) {\n\t            value = replacerFunc.call(holder, key, value);\n\t        }\n\n\t        if (value instanceof Number) {\n\t            value = Number(value);\n\t        } else if (value instanceof String) {\n\t            value = String(value);\n\t        } else if (value instanceof Boolean) {\n\t            value = value.valueOf();\n\t        }\n\n\t        switch (value) {\n\t        case null: return 'null'\n\t        case true: return 'true'\n\t        case false: return 'false'\n\t        }\n\n\t        if (typeof value === 'string') {\n\t            return quoteString(value, false)\n\t        }\n\n\t        if (typeof value === 'number') {\n\t            return String(value)\n\t        }\n\n\t        if (typeof value === 'object') {\n\t            return Array.isArray(value) ? serializeArray(value) : serializeObject(value)\n\t        }\n\n\t        return undefined\n\t    }\n\n\t    function quoteString (value) {\n\t        var quotes = {\n\t            \"'\": 0.1,\n\t            '\"': 0.2,\n\t        };\n\n\t        var replacements = {\n\t            \"'\": \"\\\\'\",\n\t            '\"': '\\\\\"',\n\t            '\\\\': '\\\\\\\\',\n\t            '\\b': '\\\\b',\n\t            '\\f': '\\\\f',\n\t            '\\n': '\\\\n',\n\t            '\\r': '\\\\r',\n\t            '\\t': '\\\\t',\n\t            '\\v': '\\\\v',\n\t            '\\0': '\\\\0',\n\t            '\\u2028': '\\\\u2028',\n\t            '\\u2029': '\\\\u2029',\n\t        };\n\n\t        var product = '';\n\n\t        for (var i = 0; i < value.length; i++) {\n\t            var c = value[i];\n\t            switch (c) {\n\t            case \"'\":\n\t            case '\"':\n\t                quotes[c]++;\n\t                product += c;\n\t                continue\n\n\t            case '\\0':\n\t                if (util.isDigit(value[i + 1])) {\n\t                    product += '\\\\x00';\n\t                    continue\n\t                }\n\t            }\n\n\t            if (replacements[c]) {\n\t                product += replacements[c];\n\t                continue\n\t            }\n\n\t            if (c < ' ') {\n\t                var hexString = c.charCodeAt(0).toString(16);\n\t                product += '\\\\x' + ('00' + hexString).substring(hexString.length);\n\t                continue\n\t            }\n\n\t            product += c;\n\t        }\n\n\t        var quoteChar = quote || Object.keys(quotes).reduce(function (a, b) { return (quotes[a] < quotes[b]) ? a : b; });\n\n\t        product = product.replace(new RegExp(quoteChar, 'g'), replacements[quoteChar]);\n\n\t        return quoteChar + product + quoteChar\n\t    }\n\n\t    function serializeObject (value) {\n\t        if (stack.indexOf(value) >= 0) {\n\t            throw TypeError('Converting circular structure to JSON5')\n\t        }\n\n\t        stack.push(value);\n\n\t        var stepback = indent;\n\t        indent = indent + gap;\n\n\t        var keys = propertyList || Object.keys(value);\n\t        var partial = [];\n\t        for (var i = 0, list = keys; i < list.length; i += 1) {\n\t            var key = list[i];\n\n\t            var propertyString = serializeProperty(key, value);\n\t            if (propertyString !== undefined) {\n\t                var member = serializeKey(key) + ':';\n\t                if (gap !== '') {\n\t                    member += ' ';\n\t                }\n\t                member += propertyString;\n\t                partial.push(member);\n\t            }\n\t        }\n\n\t        var final;\n\t        if (partial.length === 0) {\n\t            final = '{}';\n\t        } else {\n\t            var properties;\n\t            if (gap === '') {\n\t                properties = partial.join(',');\n\t                final = '{' + properties + '}';\n\t            } else {\n\t                var separator = ',\\n' + indent;\n\t                properties = partial.join(separator);\n\t                final = '{\\n' + indent + properties + ',\\n' + stepback + '}';\n\t            }\n\t        }\n\n\t        stack.pop();\n\t        indent = stepback;\n\t        return final\n\t    }\n\n\t    function serializeKey (key) {\n\t        if (key.length === 0) {\n\t            return quoteString(key, true)\n\t        }\n\n\t        var firstChar = String.fromCodePoint(key.codePointAt(0));\n\t        if (!util.isIdStartChar(firstChar)) {\n\t            return quoteString(key, true)\n\t        }\n\n\t        for (var i = firstChar.length; i < key.length; i++) {\n\t            if (!util.isIdContinueChar(String.fromCodePoint(key.codePointAt(i)))) {\n\t                return quoteString(key, true)\n\t            }\n\t        }\n\n\t        return key\n\t    }\n\n\t    function serializeArray (value) {\n\t        if (stack.indexOf(value) >= 0) {\n\t            throw TypeError('Converting circular structure to JSON5')\n\t        }\n\n\t        stack.push(value);\n\n\t        var stepback = indent;\n\t        indent = indent + gap;\n\n\t        var partial = [];\n\t        for (var i = 0; i < value.length; i++) {\n\t            var propertyString = serializeProperty(String(i), value);\n\t            partial.push((propertyString !== undefined) ? propertyString : 'null');\n\t        }\n\n\t        var final;\n\t        if (partial.length === 0) {\n\t            final = '[]';\n\t        } else {\n\t            if (gap === '') {\n\t                var properties = partial.join(',');\n\t                final = '[' + properties + ']';\n\t            } else {\n\t                var separator = ',\\n' + indent;\n\t                var properties$1 = partial.join(separator);\n\t                final = '[\\n' + indent + properties$1 + ',\\n' + stepback + ']';\n\t            }\n\t        }\n\n\t        stack.pop();\n\t        indent = stepback;\n\t        return final\n\t    }\n\t};\n\n\tvar JSON5 = {\n\t    parse: parse,\n\t    stringify: stringify,\n\t};\n\n\tvar lib = JSON5;\n\n\tvar es5 = lib;\n\n\treturn es5;\n\n})));\n", "// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>\n// This work is free. You can redistribute it and/or modify it\n// under the terms of the WTFPL, Version 2\n// For more information see LICENSE.txt or http://www.wtfpl.net/\n//\n// For more information, the home page:\n// http://pieroxy.net/blog/pages/lz-string/testing.html\n//\n// LZ-based compression algorithm, version 1.4.4\nvar LZString = (function() {\n\n// private property\nvar f = String.fromCharCode;\nvar keyStrBase64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\nvar keyStrUriSafe = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$\";\nvar baseReverseDic = {};\n\nfunction getBaseValue(alphabet, character) {\n  if (!baseReverseDic[alphabet]) {\n    baseReverseDic[alphabet] = {};\n    for (var i=0 ; i<alphabet.length ; i++) {\n      baseReverseDic[alphabet][alphabet.charAt(i)] = i;\n    }\n  }\n  return baseReverseDic[alphabet][character];\n}\n\nvar LZString = {\n  compressToBase64 : function (input) {\n    if (input == null) return \"\";\n    var res = LZString._compress(input, 6, function(a){return keyStrBase64.charAt(a);});\n    switch (res.length % 4) { // To produce valid Base64\n    default: // When could this happen ?\n    case 0 : return res;\n    case 1 : return res+\"===\";\n    case 2 : return res+\"==\";\n    case 3 : return res+\"=\";\n    }\n  },\n\n  decompressFromBase64 : function (input) {\n    if (input == null) return \"\";\n    if (input == \"\") return null;\n    return LZString._decompress(input.length, 32, function(index) { return getBaseValue(keyStrBase64, input.charAt(index)); });\n  },\n\n  compressToUTF16 : function (input) {\n    if (input == null) return \"\";\n    return LZString._compress(input, 15, function(a){return f(a+32);}) + \" \";\n  },\n\n  decompressFromUTF16: function (compressed) {\n    if (compressed == null) return \"\";\n    if (compressed == \"\") return null;\n    return LZString._decompress(compressed.length, 16384, function(index) { return compressed.charCodeAt(index) - 32; });\n  },\n\n  //compress into uint8array (UCS-2 big endian format)\n  compressToUint8Array: function (uncompressed) {\n    var compressed = LZString.compress(uncompressed);\n    var buf=new Uint8Array(compressed.length*2); // 2 bytes per character\n\n    for (var i=0, TotalLen=compressed.length; i<TotalLen; i++) {\n      var current_value = compressed.charCodeAt(i);\n      buf[i*2] = current_value >>> 8;\n      buf[i*2+1] = current_value % 256;\n    }\n    return buf;\n  },\n\n  //decompress from uint8array (UCS-2 big endian format)\n  decompressFromUint8Array:function (compressed) {\n    if (compressed===null || compressed===undefined){\n        return LZString.decompress(compressed);\n    } else {\n        var buf=new Array(compressed.length/2); // 2 bytes per character\n        for (var i=0, TotalLen=buf.length; i<TotalLen; i++) {\n          buf[i]=compressed[i*2]*256+compressed[i*2+1];\n        }\n\n        var result = [];\n        buf.forEach(function (c) {\n          result.push(f(c));\n        });\n        return LZString.decompress(result.join(''));\n\n    }\n\n  },\n\n\n  //compress into a string that is already URI encoded\n  compressToEncodedURIComponent: function (input) {\n    if (input == null) return \"\";\n    return LZString._compress(input, 6, function(a){return keyStrUriSafe.charAt(a);});\n  },\n\n  //decompress from an output of compressToEncodedURIComponent\n  decompressFromEncodedURIComponent:function (input) {\n    if (input == null) return \"\";\n    if (input == \"\") return null;\n    input = input.replace(/ /g, \"+\");\n    return LZString._decompress(input.length, 32, function(index) { return getBaseValue(keyStrUriSafe, input.charAt(index)); });\n  },\n\n  compress: function (uncompressed) {\n    return LZString._compress(uncompressed, 16, function(a){return f(a);});\n  },\n  _compress: function (uncompressed, bitsPerChar, getCharFromInt) {\n    if (uncompressed == null) return \"\";\n    var i, value,\n        context_dictionary= {},\n        context_dictionaryToCreate= {},\n        context_c=\"\",\n        context_wc=\"\",\n        context_w=\"\",\n        context_enlargeIn= 2, // Compensate for the first entry which should not count\n        context_dictSize= 3,\n        context_numBits= 2,\n        context_data=[],\n        context_data_val=0,\n        context_data_position=0,\n        ii;\n\n    for (ii = 0; ii < uncompressed.length; ii += 1) {\n      context_c = uncompressed.charAt(ii);\n      if (!Object.prototype.hasOwnProperty.call(context_dictionary,context_c)) {\n        context_dictionary[context_c] = context_dictSize++;\n        context_dictionaryToCreate[context_c] = true;\n      }\n\n      context_wc = context_w + context_c;\n      if (Object.prototype.hasOwnProperty.call(context_dictionary,context_wc)) {\n        context_w = context_wc;\n      } else {\n        if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)) {\n          if (context_w.charCodeAt(0)<256) {\n            for (i=0 ; i<context_numBits ; i++) {\n              context_data_val = (context_data_val << 1);\n              if (context_data_position == bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n            }\n            value = context_w.charCodeAt(0);\n            for (i=0 ; i<8 ; i++) {\n              context_data_val = (context_data_val << 1) | (value&1);\n              if (context_data_position == bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = value >> 1;\n            }\n          } else {\n            value = 1;\n            for (i=0 ; i<context_numBits ; i++) {\n              context_data_val = (context_data_val << 1) | value;\n              if (context_data_position ==bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = 0;\n            }\n            value = context_w.charCodeAt(0);\n            for (i=0 ; i<16 ; i++) {\n              context_data_val = (context_data_val << 1) | (value&1);\n              if (context_data_position == bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = value >> 1;\n            }\n          }\n          context_enlargeIn--;\n          if (context_enlargeIn == 0) {\n            context_enlargeIn = Math.pow(2, context_numBits);\n            context_numBits++;\n          }\n          delete context_dictionaryToCreate[context_w];\n        } else {\n          value = context_dictionary[context_w];\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n\n\n        }\n        context_enlargeIn--;\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits);\n          context_numBits++;\n        }\n        // Add wc to the dictionary.\n        context_dictionary[context_wc] = context_dictSize++;\n        context_w = String(context_c);\n      }\n    }\n\n    // Output the code for w.\n    if (context_w !== \"\") {\n      if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)) {\n        if (context_w.charCodeAt(0)<256) {\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n          }\n          value = context_w.charCodeAt(0);\n          for (i=0 ; i<8 ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n        } else {\n          value = 1;\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1) | value;\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = 0;\n          }\n          value = context_w.charCodeAt(0);\n          for (i=0 ; i<16 ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n        }\n        context_enlargeIn--;\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits);\n          context_numBits++;\n        }\n        delete context_dictionaryToCreate[context_w];\n      } else {\n        value = context_dictionary[context_w];\n        for (i=0 ; i<context_numBits ; i++) {\n          context_data_val = (context_data_val << 1) | (value&1);\n          if (context_data_position == bitsPerChar-1) {\n            context_data_position = 0;\n            context_data.push(getCharFromInt(context_data_val));\n            context_data_val = 0;\n          } else {\n            context_data_position++;\n          }\n          value = value >> 1;\n        }\n\n\n      }\n      context_enlargeIn--;\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits);\n        context_numBits++;\n      }\n    }\n\n    // Mark the end of the stream\n    value = 2;\n    for (i=0 ; i<context_numBits ; i++) {\n      context_data_val = (context_data_val << 1) | (value&1);\n      if (context_data_position == bitsPerChar-1) {\n        context_data_position = 0;\n        context_data.push(getCharFromInt(context_data_val));\n        context_data_val = 0;\n      } else {\n        context_data_position++;\n      }\n      value = value >> 1;\n    }\n\n    // Flush the last char\n    while (true) {\n      context_data_val = (context_data_val << 1);\n      if (context_data_position == bitsPerChar-1) {\n        context_data.push(getCharFromInt(context_data_val));\n        break;\n      }\n      else context_data_position++;\n    }\n    return context_data.join('');\n  },\n\n  decompress: function (compressed) {\n    if (compressed == null) return \"\";\n    if (compressed == \"\") return null;\n    return LZString._decompress(compressed.length, 32768, function(index) { return compressed.charCodeAt(index); });\n  },\n\n  _decompress: function (length, resetValue, getNextValue) {\n    var dictionary = [],\n        next,\n        enlargeIn = 4,\n        dictSize = 4,\n        numBits = 3,\n        entry = \"\",\n        result = [],\n        i,\n        w,\n        bits, resb, maxpower, power,\n        c,\n        data = {val:getNextValue(0), position:resetValue, index:1};\n\n    for (i = 0; i < 3; i += 1) {\n      dictionary[i] = i;\n    }\n\n    bits = 0;\n    maxpower = Math.pow(2,2);\n    power=1;\n    while (power!=maxpower) {\n      resb = data.val & data.position;\n      data.position >>= 1;\n      if (data.position == 0) {\n        data.position = resetValue;\n        data.val = getNextValue(data.index++);\n      }\n      bits |= (resb>0 ? 1 : 0) * power;\n      power <<= 1;\n    }\n\n    switch (next = bits) {\n      case 0:\n          bits = 0;\n          maxpower = Math.pow(2,8);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n        c = f(bits);\n        break;\n      case 1:\n          bits = 0;\n          maxpower = Math.pow(2,16);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n        c = f(bits);\n        break;\n      case 2:\n        return \"\";\n    }\n    dictionary[3] = c;\n    w = c;\n    result.push(c);\n    while (true) {\n      if (data.index > length) {\n        return \"\";\n      }\n\n      bits = 0;\n      maxpower = Math.pow(2,numBits);\n      power=1;\n      while (power!=maxpower) {\n        resb = data.val & data.position;\n        data.position >>= 1;\n        if (data.position == 0) {\n          data.position = resetValue;\n          data.val = getNextValue(data.index++);\n        }\n        bits |= (resb>0 ? 1 : 0) * power;\n        power <<= 1;\n      }\n\n      switch (c = bits) {\n        case 0:\n          bits = 0;\n          maxpower = Math.pow(2,8);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n\n          dictionary[dictSize++] = f(bits);\n          c = dictSize-1;\n          enlargeIn--;\n          break;\n        case 1:\n          bits = 0;\n          maxpower = Math.pow(2,16);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n          dictionary[dictSize++] = f(bits);\n          c = dictSize-1;\n          enlargeIn--;\n          break;\n        case 2:\n          return result.join('');\n      }\n\n      if (enlargeIn == 0) {\n        enlargeIn = Math.pow(2, numBits);\n        numBits++;\n      }\n\n      if (dictionary[c]) {\n        entry = dictionary[c];\n      } else {\n        if (c === dictSize) {\n          entry = w + w.charAt(0);\n        } else {\n          return null;\n        }\n      }\n      result.push(entry);\n\n      // Add w+entry[0] to the dictionary.\n      dictionary[dictSize++] = w + entry.charAt(0);\n      enlargeIn--;\n\n      w = entry;\n\n      if (enlargeIn == 0) {\n        enlargeIn = Math.pow(2, numBits);\n        numBits++;\n      }\n\n    }\n  }\n};\n  return LZString;\n})();\n\nif (typeof define === 'function' && define.amd) {\n  define(function () { return LZString; });\n} else if( typeof module !== 'undefined' && module != null ) {\n  module.exports = LZString\n}\n", "/* crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*exported CRC32 */\nvar Crc32;\n(function (factory) {\n  /*jshint ignore:start */\n  /*eslint-disable */\n  if (typeof DO_NOT_EXPORT_CRC === \"undefined\") {\n    if (\"object\" === typeof exports) {\n      factory(exports);\n    } else if (\"function\" === typeof define && define.amd) {\n      define(function () {\n        var module = {};\n        factory(module);\n        return module;\n      });\n    } else {\n      factory((Crc32 = {}));\n    }\n  } else {\n    factory((Crc32 = {}));\n  }\n  /*eslint-enable */\n  /*jshint ignore:end */\n})(function (CRC32) {\n  CRC32.version = \"1.2.0\";\n  /* see perf/crc32table.js */\n  /*global Int32Array */\n  function signed_crc_table() {\n    var c = 0,\n      table = new Array(256);\n\n    for (var n = 0; n != 256; ++n) {\n      c = n;\n      c = c & 1 ? -306674912 ^ (c >>> 1) : c >>> 1;\n      c = c & 1 ? -306674912 ^ (c >>> 1) : c >>> 1;\n      c = c & 1 ? -306674912 ^ (c >>> 1) : c >>> 1;\n      c = c & 1 ? -306674912 ^ (c >>> 1) : c >>> 1;\n      c = c & 1 ? -306674912 ^ (c >>> 1) : c >>> 1;\n      c = c & 1 ? -306674912 ^ (c >>> 1) : c >>> 1;\n      c = c & 1 ? -306674912 ^ (c >>> 1) : c >>> 1;\n      c = c & 1 ? -306674912 ^ (c >>> 1) : c >>> 1;\n      table[n] = c;\n    }\n\n    return typeof Int32Array !== \"undefined\" ? new Int32Array(table) : table;\n  }\n\n  var T = signed_crc_table();\n  function crc32_bstr(bstr, seed) {\n    var C = seed ^ -1,\n      L = bstr.length - 1;\n    for (var i = 0; i < L; ) {\n      C = (C >>> 8) ^ T[(C ^ bstr.charCodeAt(i++)) & 0xff];\n      C = (C >>> 8) ^ T[(C ^ bstr.charCodeAt(i++)) & 0xff];\n    }\n    if (i === L) C = (C >>> 8) ^ T[(C ^ bstr.charCodeAt(i)) & 0xff];\n    return C ^ -1;\n  }\n\n  function crc32_buf(buf, seed) {\n    if (buf.length > 10000) return crc32_buf_8(buf, seed);\n    var C = seed ^ -1,\n      L = buf.length - 3;\n    for (var i = 0; i < L; ) {\n      C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n      C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n      C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n      C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n    }\n    while (i < L + 3) C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n    return C ^ -1;\n  }\n\n  function crc32_buf_8(buf, seed) {\n    var C = seed ^ -1,\n      L = buf.length - 7;\n    for (var i = 0; i < L; ) {\n      C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n      C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n      C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n      C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n      C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n      C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n      C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n      C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n    }\n    while (i < L + 7) C = (C >>> 8) ^ T[(C ^ buf[i++]) & 0xff];\n    return C ^ -1;\n  }\n\n  function crc32_str(str, seed) {\n    var C = seed ^ -1;\n    for (var i = 0, L = str.length, c, d; i < L; ) {\n      c = str.charCodeAt(i++);\n      if (c < 0x80) {\n        C = (C >>> 8) ^ T[(C ^ c) & 0xff];\n      } else if (c < 0x800) {\n        C = (C >>> 8) ^ T[(C ^ (192 | ((c >> 6) & 31))) & 0xff];\n        C = (C >>> 8) ^ T[(C ^ (128 | (c & 63))) & 0xff];\n      } else if (c >= 0xd800 && c < 0xe000) {\n        c = (c & 1023) + 64;\n        d = str.charCodeAt(i++) & 1023;\n        C = (C >>> 8) ^ T[(C ^ (240 | ((c >> 8) & 7))) & 0xff];\n        C = (C >>> 8) ^ T[(C ^ (128 | ((c >> 2) & 63))) & 0xff];\n        C =\n          (C >>> 8) ^ T[(C ^ (128 | ((d >> 6) & 15) | ((c & 3) << 4))) & 0xff];\n        C = (C >>> 8) ^ T[(C ^ (128 | (d & 63))) & 0xff];\n      } else {\n        C = (C >>> 8) ^ T[(C ^ (224 | ((c >> 12) & 15))) & 0xff];\n        C = (C >>> 8) ^ T[(C ^ (128 | ((c >> 6) & 63))) & 0xff];\n        C = (C >>> 8) ^ T[(C ^ (128 | (c & 63))) & 0xff];\n      }\n    }\n    return C ^ -1;\n  }\n  CRC32.table = T;\n  // $FlowIgnore\n  CRC32.bstr = crc32_bstr;\n  // $FlowIgnore\n  CRC32.buf = crc32_buf;\n  // $FlowIgnore\n  CRC32.str = crc32_str;\n});\n", "/**\n * library to read and write PNG Metadata\n *\n * References:\n * w3 PNG Chunks specification: https://www.w3.org/TR/PNG-Chunks.html\n * The Metadata in PNG files: https://dev.exiv2.org/projects/exiv2/wiki/The_Metadata_in_PNG_files\n */\n\nlet crc32 = require(\"./crc32\");\n\n// Used for fast-ish conversion between uint8s and uint32s/int32s.\n// Also required in order to remain agnostic for both Node Buffers and\n// Uint8Arrays.\nlet uint8 = new Uint8Array(4);\nlet int32 = new Int32Array(uint8.buffer);\nlet uint32 = new Uint32Array(uint8.buffer);\n\nconst RESOLUTION_UNITS = { UNDEFINED: 0, METERS: 1, INCHES: 2 };\n\n/**\n * https://github.com/aheckmann/sliced\n * An Array.prototype.slice.call(arguments) alternative\n * @param {Object} args something with a length\n * @param {Number} slice\n * @param {Number} sliceEnd\n * @api public\n */\nfunction sliced(args, slice, sliceEnd) {\n  var ret = [];\n  var len = args.length;\n\n  if (0 === len) return ret;\n\n  var start = slice < 0 ? Math.max(0, slice + len) : slice || 0;\n\n  if (sliceEnd !== undefined) {\n    len = sliceEnd < 0 ? sliceEnd + len : sliceEnd;\n  }\n\n  while (len-- > start) {\n    ret[len - start] = args[len];\n  }\n\n  return ret;\n}\n\n/**\n * https://github.com/hughsk/png-chunk-text\n * Returns a chunk object containing the metadata for a given key and value:\n * @param keyword\n * @param content\n * @param chunkName\n * @returns {{data: Uint8Array, name: 'tEXt'}}\n */\nfunction textEncode(keyword, content, chunkName = \"tEXt\") {\n  keyword = String(keyword);\n  content = String(content);\n\n  if (\n    content.length &&\n    (!/^[\\x00-\\xFF]+$/.test(keyword) || !/^[\\x00-\\xFF]+$/.test(content))\n  ) {\n    throw new Error(\n      \"Only Latin-1 characters are permitted in PNG tEXt chunks. You might want to consider base64 encoding and/or zEXt compression\"\n    );\n  }\n\n  if (keyword.length >= 80) {\n    throw new Error(\n      'Keyword \"' +\n        keyword +\n        '\" is longer than the 79-character limit imposed by the PNG specification'\n    );\n  }\n\n  let totalSize = keyword.length + content.length + 1;\n  let output = new Uint8Array(totalSize);\n  let idx = 0;\n  let code;\n\n  for (let i = 0; i < keyword.length; i++) {\n    if (!(code = keyword.charCodeAt(i))) {\n      throw new Error(\"0x00 character is not permitted in tEXt keywords\");\n    }\n\n    output[idx++] = code;\n  }\n\n  output[idx++] = 0;\n\n  for (let j = 0; j < content.length; j++) {\n    if (!(code = content.charCodeAt(j))) {\n      throw new Error(\"0x00 character is not permitted in tEXt content\");\n    }\n\n    output[idx++] = code;\n  }\n\n  return {\n    name: chunkName,\n    data: output,\n  };\n}\n\n/**\n * https://github.com/hughsk/png-chunk-text\n * Reads a Uint8Array or Node.js Buffer instance containing a tEXt PNG chunk's data and returns its keyword/text:\n * @param data\n * @returns {{text: string, keyword: string}}\n */\nfunction textDecode(data) {\n  if (data.data && data.name) {\n    data = data.data;\n  }\n\n  let naming = true;\n  let text = \"\";\n  let name = \"\";\n\n  for (let i = 0; i < data.length; i++) {\n    let code = data[i];\n\n    if (naming) {\n      if (code) {\n        name += String.fromCharCode(code);\n      } else {\n        naming = false;\n      }\n    } else {\n      if (code) {\n        text += String.fromCharCode(code);\n      } else {\n        throw new Error(\n          \"Invalid NULL character found. 0x00 character is not permitted in tEXt content\"\n        );\n      }\n    }\n  }\n\n  return {\n    keyword: name,\n    text: text,\n  };\n}\n\n/**\n * https://github.com/hughsk/png-chunks-extract\n * Extract the data chunks from a PNG file.\n * Useful for reading the metadata of a PNG image, or as the base of a more complete PNG parser.\n * Takes the raw image file data as a Uint8Array or Node.js Buffer, and returns an array of chunks. Each chunk has a name and data buffer:\n * @param data {Uint8Array}\n * @returns {[{name: String, data: Uint8Array}]}\n */\nfunction extractChunks(data) {\n  if (data[0] !== 0x89) throw new Error(\"Invalid .png file header\");\n  if (data[1] !== 0x50) throw new Error(\"Invalid .png file header\");\n  if (data[2] !== 0x4e) throw new Error(\"Invalid .png file header\");\n  if (data[3] !== 0x47) throw new Error(\"Invalid .png file header\");\n  if (data[4] !== 0x0d)\n    throw new Error(\n      \"Invalid .png file header: possibly caused by DOS-Unix line ending conversion?\"\n    );\n  if (data[5] !== 0x0a)\n    throw new Error(\n      \"Invalid .png file header: possibly caused by DOS-Unix line ending conversion?\"\n    );\n  if (data[6] !== 0x1a) throw new Error(\"Invalid .png file header\");\n  if (data[7] !== 0x0a)\n    throw new Error(\n      \"Invalid .png file header: possibly caused by DOS-Unix line ending conversion?\"\n    );\n\n  let ended = false;\n  let chunks = [];\n  let idx = 8;\n\n  while (idx < data.length) {\n    // Read the length of the current chunk,\n    // which is stored as a Uint32.\n    uint8[3] = data[idx++];\n    uint8[2] = data[idx++];\n    uint8[1] = data[idx++];\n    uint8[0] = data[idx++];\n\n    // Chunk includes name/type for CRC check (see below).\n    let length = uint32[0] + 4;\n    let chunk = new Uint8Array(length);\n    chunk[0] = data[idx++];\n    chunk[1] = data[idx++];\n    chunk[2] = data[idx++];\n    chunk[3] = data[idx++];\n\n    // Get the name in ASCII for identification.\n    let name =\n      String.fromCharCode(chunk[0]) +\n      String.fromCharCode(chunk[1]) +\n      String.fromCharCode(chunk[2]) +\n      String.fromCharCode(chunk[3]);\n\n    // The IHDR header MUST come first.\n    if (!chunks.length && name !== \"IHDR\") {\n      throw new Error(\"IHDR header missing\");\n    }\n\n    // The IEND header marks the end of the file,\n    // so on discovering it break out of the loop.\n    if (name === \"IEND\") {\n      ended = true;\n      chunks.push({\n        name: name,\n        data: new Uint8Array(0),\n      });\n\n      break;\n    }\n\n    // Read the contents of the chunk out of the main buffer.\n    for (let i = 4; i < length; i++) {\n      chunk[i] = data[idx++];\n    }\n\n    // Read out the CRC value for comparison.\n    // It's stored as an Int32.\n    uint8[3] = data[idx++];\n    uint8[2] = data[idx++];\n    uint8[1] = data[idx++];\n    uint8[0] = data[idx++];\n\n    let crcActual = int32[0];\n    let crcExpect = crc32.buf(chunk);\n    if (crcExpect !== crcActual) {\n      throw new Error(\n        \"CRC values for \" +\n          name +\n          \" header do not match, PNG file is likely corrupted\"\n      );\n    }\n\n    // The chunk data is now copied to remove the 4 preceding\n    // bytes used for the chunk name/type.\n    let chunkData = new Uint8Array(chunk.buffer.slice(4));\n\n    chunks.push({\n      name: name,\n      data: chunkData,\n    });\n  }\n\n  if (!ended) {\n    throw new Error(\".png file ended prematurely: no IEND header was found\");\n  }\n\n  return chunks;\n}\n\n/**\n * https://github.com/hughsk/png-chunks-encode\n * Return a fresh PNG buffer given a set of PNG chunks. Useful in combination with png-chunks-encode to easily modify or add to the data of a PNG file.\n * Takes an array of chunks, each with a name and data:\n * @param chunks {[{name: String, data: Uint8Array}]}\n * @returns {Uint8Array}\n */\nfunction encodeChunks(chunks) {\n  let totalSize = 8;\n  let idx = totalSize;\n  let i;\n\n  for (i = 0; i < chunks.length; i++) {\n    totalSize += chunks[i].data.length;\n    totalSize += 12;\n  }\n\n  let output = new Uint8Array(totalSize);\n\n  output[0] = 0x89;\n  output[1] = 0x50;\n  output[2] = 0x4e;\n  output[3] = 0x47;\n  output[4] = 0x0d;\n  output[5] = 0x0a;\n  output[6] = 0x1a;\n  output[7] = 0x0a;\n\n  for (i = 0; i < chunks.length; i++) {\n    let chunk = chunks[i];\n    let name = chunk.name;\n    let data = chunk.data;\n    let size = data.length;\n    let nameChars = [\n      name.charCodeAt(0),\n      name.charCodeAt(1),\n      name.charCodeAt(2),\n      name.charCodeAt(3),\n    ];\n\n    uint32[0] = size;\n    output[idx++] = uint8[3];\n    output[idx++] = uint8[2];\n    output[idx++] = uint8[1];\n    output[idx++] = uint8[0];\n\n    output[idx++] = nameChars[0];\n    output[idx++] = nameChars[1];\n    output[idx++] = nameChars[2];\n    output[idx++] = nameChars[3];\n\n    for (let j = 0; j < size; ) {\n      output[idx++] = data[j++];\n    }\n\n    let crcCheck = nameChars.concat(sliced(data));\n    int32[0] = crc32.buf(crcCheck);\n    output[idx++] = uint8[3];\n    output[idx++] = uint8[2];\n    output[idx++] = uint8[1];\n    output[idx++] = uint8[0];\n  }\n\n  return output;\n}\n\n/**\n * read 4 bytes number from UInt8Array.\n * @param uint8array\n * @param offset\n * @returns {number}\n */\nfunction readUint32(uint8array, offset) {\n  let byte1, byte2, byte3, byte4;\n  byte1 = uint8array[offset++];\n  byte2 = uint8array[offset++];\n  byte3 = uint8array[offset++];\n  byte4 = uint8array[offset];\n  return 0 | (byte1 << 24) | (byte2 << 16) | (byte3 << 8) | byte4;\n}\n\n/**\n * write 4 bytes number to UInt8Array.\n * @param uint8array\n * @param num\n * @param offset\n */\nfunction writeUInt32(uint8array, num, offset) {\n  uint8array[offset] = (num & 0xff000000) >> 24;\n  uint8array[offset + 1] = (num & 0x00ff0000) >> 16;\n  uint8array[offset + 2] = (num & 0x0000ff00) >> 8;\n  uint8array[offset + 3] = num & 0x000000ff;\n}\n\n/**\n * Get object with PNG metadata. only tEXt and pHYs chunks are parsed\n * @param buffer {Buffer}\n * @returns {{tEXt: {keyword: value}, pHYs: {x: number, y: number, units: RESOLUTION_UNITS}, [string]: true}}\n */\nfunction readMetadata(buffer) {\n  let result = {};\n  const chunks = extractChunks(buffer);\n  chunks.forEach((chunk) => {\n    switch (chunk.name) {\n      case \"tEXt\":\n        if (!result.tEXt) {\n          result.tEXt = {};\n        }\n        let textChunk = textDecode(chunk.data);\n        result.tEXt[textChunk.keyword] = textChunk.text;\n        break;\n      case \"pHYs\":\n        result.pHYs = {\n          // Pixels per unit, X axis: 4 bytes (unsigned integer)\n          x: readUint32(chunk.data, 0),\n          // Pixels per unit, Y axis: 4 bytes (unsigned integer)\n          y: readUint32(chunk.data, 4),\n          unit: chunk.data[8],\n        };\n        break;\n      case \"gAMA\":\n      case \"cHRM\":\n      case \"sRGB\":\n      case \"IHDR\":\n      case \"iCCP\":\n      default:\n        result[chunk.name] = true;\n    }\n  });\n  return result;\n}\n\n/**\n * create new Buffer with metadata. only tEXt and pHYs chunks are supported.\n * @param buffer {Buffer}\n * @param metadata {{tEXt: {keyword: value}, pHYs: {x: number, y: number, units: RESOLUTION_UNITS}}}\n * @returns {Buffer}\n */\nfunction writeMetadata(buffer, metadata) {\n  const chunks = extractChunks(buffer);\n  insertMetadata(chunks, metadata);\n  return new Buffer.from(encodeChunks(chunks));\n}\n\nfunction insertMetadata(chunks, metadata) {\n  if (metadata.clear) {\n    for (let i = chunks.length - 1; i--; ) {\n      switch (chunks[i].name) {\n        case \"IHDR\":\n        case \"IDAT\":\n        case \"IEND\":\n          break;\n        default:\n          chunks.splice(i, 1);\n      }\n    }\n  }\n  if (metadata.tEXt) {\n    for (var keyword in metadata.tEXt) {\n      chunks.splice(-1, 0, textEncode(keyword, metadata.tEXt[keyword]));\n    }\n  }\n\n  if (metadata.pHYs) {\n    const data = new Uint8Array(9);\n    writeUInt32(data, metadata.pHYs.x, 0);\n    writeUInt32(data, metadata.pHYs.y, 4);\n    data[8] = metadata.pHYs.units; // inches\n\n    let pHYs = chunks.find((chunk) => chunk.name === \"pHYs\");\n    if (pHYs) {\n      pHYs.data = data;\n    } else {\n      chunks.splice(1, 0, { name: \"pHYs\", data: data });\n    }\n  }\n}\n\nmodule.exports = {\n  RESOLUTION_UNITS: RESOLUTION_UNITS,\n  insertMetadata: insertMetadata,\n  readMetadata: readMetadata,\n  writeMetadata: writeMetadata,\n  textEncode: textEncode,\n  textDecode: textDecode,\n  extractChunks: extractChunks,\n  encodeChunks: encodeChunks,\n};\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getEndomorphismMonoid = exports.not = exports.SK = exports.hole = exports.pipe = exports.untupled = exports.tupled = exports.absurd = exports.decrement = exports.increment = exports.tuple = exports.flow = exports.flip = exports.constVoid = exports.constUndefined = exports.constNull = exports.constFalse = exports.constTrue = exports.constant = exports.unsafeCoerce = exports.identity = exports.apply = exports.getRing = exports.getSemiring = exports.getMonoid = exports.getSemigroup = exports.getBooleanAlgebra = void 0;\n// -------------------------------------------------------------------------------------\n// instances\n// -------------------------------------------------------------------------------------\n/**\n * @category instances\n * @since 2.10.0\n */\nvar getBooleanAlgebra = function (B) {\n    return function () { return ({\n        meet: function (x, y) { return function (a) { return B.meet(x(a), y(a)); }; },\n        join: function (x, y) { return function (a) { return B.join(x(a), y(a)); }; },\n        zero: function () { return B.zero; },\n        one: function () { return B.one; },\n        implies: function (x, y) { return function (a) { return B.implies(x(a), y(a)); }; },\n        not: function (x) { return function (a) { return B.not(x(a)); }; }\n    }); };\n};\nexports.getBooleanAlgebra = getBooleanAlgebra;\n/**\n * Unary functions form a semigroup as long as you can provide a semigroup for the codomain.\n *\n * @example\n * import { Predicate, getSemigroup } from 'fp-ts/function'\n * import * as B from 'fp-ts/boolean'\n *\n * const f: Predicate<number> = (n) => n <= 2\n * const g: Predicate<number> = (n) => n >= 0\n *\n * const S1 = getSemigroup(B.SemigroupAll)<number>()\n *\n * assert.deepStrictEqual(S1.concat(f, g)(1), true)\n * assert.deepStrictEqual(S1.concat(f, g)(3), false)\n *\n * const S2 = getSemigroup(B.SemigroupAny)<number>()\n *\n * assert.deepStrictEqual(S2.concat(f, g)(1), true)\n * assert.deepStrictEqual(S2.concat(f, g)(3), true)\n *\n * @category instances\n * @since 2.10.0\n */\nvar getSemigroup = function (S) {\n    return function () { return ({\n        concat: function (f, g) { return function (a) { return S.concat(f(a), g(a)); }; }\n    }); };\n};\nexports.getSemigroup = getSemigroup;\n/**\n * Unary functions form a monoid as long as you can provide a monoid for the codomain.\n *\n * @example\n * import { Predicate } from 'fp-ts/Predicate'\n * import { getMonoid } from 'fp-ts/function'\n * import * as B from 'fp-ts/boolean'\n *\n * const f: Predicate<number> = (n) => n <= 2\n * const g: Predicate<number> = (n) => n >= 0\n *\n * const M1 = getMonoid(B.MonoidAll)<number>()\n *\n * assert.deepStrictEqual(M1.concat(f, g)(1), true)\n * assert.deepStrictEqual(M1.concat(f, g)(3), false)\n *\n * const M2 = getMonoid(B.MonoidAny)<number>()\n *\n * assert.deepStrictEqual(M2.concat(f, g)(1), true)\n * assert.deepStrictEqual(M2.concat(f, g)(3), true)\n *\n * @category instances\n * @since 2.10.0\n */\nvar getMonoid = function (M) {\n    var getSemigroupM = (0, exports.getSemigroup)(M);\n    return function () { return ({\n        concat: getSemigroupM().concat,\n        empty: function () { return M.empty; }\n    }); };\n};\nexports.getMonoid = getMonoid;\n/**\n * @category instances\n * @since 2.10.0\n */\nvar getSemiring = function (S) { return ({\n    add: function (f, g) { return function (x) { return S.add(f(x), g(x)); }; },\n    zero: function () { return S.zero; },\n    mul: function (f, g) { return function (x) { return S.mul(f(x), g(x)); }; },\n    one: function () { return S.one; }\n}); };\nexports.getSemiring = getSemiring;\n/**\n * @category instances\n * @since 2.10.0\n */\nvar getRing = function (R) {\n    var S = (0, exports.getSemiring)(R);\n    return {\n        add: S.add,\n        mul: S.mul,\n        one: S.one,\n        zero: S.zero,\n        sub: function (f, g) { return function (x) { return R.sub(f(x), g(x)); }; }\n    };\n};\nexports.getRing = getRing;\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.11.0\n */\nvar apply = function (a) {\n    return function (f) {\n        return f(a);\n    };\n};\nexports.apply = apply;\n/**\n * @since 2.0.0\n */\nfunction identity(a) {\n    return a;\n}\nexports.identity = identity;\n/**\n * @since 2.0.0\n */\nexports.unsafeCoerce = identity;\n/**\n * @since 2.0.0\n */\nfunction constant(a) {\n    return function () { return a; };\n}\nexports.constant = constant;\n/**\n * A thunk that returns always `true`.\n *\n * @since 2.0.0\n */\nexports.constTrue = constant(true);\n/**\n * A thunk that returns always `false`.\n *\n * @since 2.0.0\n */\nexports.constFalse = constant(false);\n/**\n * A thunk that returns always `null`.\n *\n * @since 2.0.0\n */\nexports.constNull = constant(null);\n/**\n * A thunk that returns always `undefined`.\n *\n * @since 2.0.0\n */\nexports.constUndefined = constant(undefined);\n/**\n * A thunk that returns always `void`.\n *\n * @since 2.0.0\n */\nexports.constVoid = exports.constUndefined;\nfunction flip(f) {\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (args.length > 1) {\n            return f(args[1], args[0]);\n        }\n        return function (a) { return f(a)(args[0]); };\n    };\n}\nexports.flip = flip;\nfunction flow(ab, bc, cd, de, ef, fg, gh, hi, ij) {\n    switch (arguments.length) {\n        case 1:\n            return ab;\n        case 2:\n            return function () {\n                return bc(ab.apply(this, arguments));\n            };\n        case 3:\n            return function () {\n                return cd(bc(ab.apply(this, arguments)));\n            };\n        case 4:\n            return function () {\n                return de(cd(bc(ab.apply(this, arguments))));\n            };\n        case 5:\n            return function () {\n                return ef(de(cd(bc(ab.apply(this, arguments)))));\n            };\n        case 6:\n            return function () {\n                return fg(ef(de(cd(bc(ab.apply(this, arguments))))));\n            };\n        case 7:\n            return function () {\n                return gh(fg(ef(de(cd(bc(ab.apply(this, arguments)))))));\n            };\n        case 8:\n            return function () {\n                return hi(gh(fg(ef(de(cd(bc(ab.apply(this, arguments))))))));\n            };\n        case 9:\n            return function () {\n                return ij(hi(gh(fg(ef(de(cd(bc(ab.apply(this, arguments)))))))));\n            };\n    }\n    return;\n}\nexports.flow = flow;\n/**\n * @since 2.0.0\n */\nfunction tuple() {\n    var t = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        t[_i] = arguments[_i];\n    }\n    return t;\n}\nexports.tuple = tuple;\n/**\n * @since 2.0.0\n */\nfunction increment(n) {\n    return n + 1;\n}\nexports.increment = increment;\n/**\n * @since 2.0.0\n */\nfunction decrement(n) {\n    return n - 1;\n}\nexports.decrement = decrement;\n/**\n * @since 2.0.0\n */\nfunction absurd(_) {\n    throw new Error('Called `absurd` function which should be uncallable');\n}\nexports.absurd = absurd;\n/**\n * Creates a tupled version of this function: instead of `n` arguments, it accepts a single tuple argument.\n *\n * @example\n * import { tupled } from 'fp-ts/function'\n *\n * const add = tupled((x: number, y: number): number => x + y)\n *\n * assert.strictEqual(add([1, 2]), 3)\n *\n * @since 2.4.0\n */\nfunction tupled(f) {\n    return function (a) { return f.apply(void 0, a); };\n}\nexports.tupled = tupled;\n/**\n * Inverse function of `tupled`\n *\n * @since 2.4.0\n */\nfunction untupled(f) {\n    return function () {\n        var a = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            a[_i] = arguments[_i];\n        }\n        return f(a);\n    };\n}\nexports.untupled = untupled;\nfunction pipe(a, ab, bc, cd, de, ef, fg, gh, hi) {\n    switch (arguments.length) {\n        case 1:\n            return a;\n        case 2:\n            return ab(a);\n        case 3:\n            return bc(ab(a));\n        case 4:\n            return cd(bc(ab(a)));\n        case 5:\n            return de(cd(bc(ab(a))));\n        case 6:\n            return ef(de(cd(bc(ab(a)))));\n        case 7:\n            return fg(ef(de(cd(bc(ab(a))))));\n        case 8:\n            return gh(fg(ef(de(cd(bc(ab(a)))))));\n        case 9:\n            return hi(gh(fg(ef(de(cd(bc(ab(a))))))));\n        default: {\n            var ret = arguments[0];\n            for (var i = 1; i < arguments.length; i++) {\n                ret = arguments[i](ret);\n            }\n            return ret;\n        }\n    }\n}\nexports.pipe = pipe;\n/**\n * Type hole simulation\n *\n * @since 2.7.0\n */\nexports.hole = absurd;\n/**\n * @since 2.11.0\n */\nvar SK = function (_, b) { return b; };\nexports.SK = SK;\n/**\n * Use `Predicate` module instead.\n *\n * @category zone of death\n * @since 2.0.0\n * @deprecated\n */\nfunction not(predicate) {\n    return function (a) { return !predicate(a); };\n}\nexports.not = not;\n/**\n * Use `Endomorphism` module instead.\n *\n * @category zone of death\n * @since 2.10.0\n * @deprecated\n */\nvar getEndomorphismMonoid = function () { return ({\n    concat: function (first, second) { return flow(first, second); },\n    empty: identity\n}); };\nexports.getEndomorphismMonoid = getEndomorphismMonoid;\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.fromReadonlyNonEmptyArray = exports.has = exports.emptyRecord = exports.emptyReadonlyArray = exports.tail = exports.head = exports.isNonEmpty = exports.singleton = exports.right = exports.left = exports.isRight = exports.isLeft = exports.some = exports.none = exports.isSome = exports.isNone = void 0;\n// -------------------------------------------------------------------------------------\n// Option\n// -------------------------------------------------------------------------------------\n/** @internal */\nvar isNone = function (fa) { return fa._tag === 'None'; };\nexports.isNone = isNone;\n/** @internal */\nvar isSome = function (fa) { return fa._tag === 'Some'; };\nexports.isSome = isSome;\n/** @internal */\nexports.none = { _tag: 'None' };\n/** @internal */\nvar some = function (a) { return ({ _tag: 'Some', value: a }); };\nexports.some = some;\n// -------------------------------------------------------------------------------------\n// Either\n// -------------------------------------------------------------------------------------\n/** @internal */\nvar isLeft = function (ma) { return ma._tag === 'Left'; };\nexports.isLeft = isLeft;\n/** @internal */\nvar isRight = function (ma) { return ma._tag === 'Right'; };\nexports.isRight = isRight;\n/** @internal */\nvar left = function (e) { return ({ _tag: 'Left', left: e }); };\nexports.left = left;\n/** @internal */\nvar right = function (a) { return ({ _tag: 'Right', right: a }); };\nexports.right = right;\n// -------------------------------------------------------------------------------------\n// ReadonlyNonEmptyArray\n// -------------------------------------------------------------------------------------\n/** @internal */\nvar singleton = function (a) { return [a]; };\nexports.singleton = singleton;\n/** @internal */\nvar isNonEmpty = function (as) { return as.length > 0; };\nexports.isNonEmpty = isNonEmpty;\n/** @internal */\nvar head = function (as) { return as[0]; };\nexports.head = head;\n/** @internal */\nvar tail = function (as) { return as.slice(1); };\nexports.tail = tail;\n// -------------------------------------------------------------------------------------\n// empty\n// -------------------------------------------------------------------------------------\n/** @internal */\nexports.emptyReadonlyArray = [];\n/** @internal */\nexports.emptyRecord = {};\n// -------------------------------------------------------------------------------------\n// Record\n// -------------------------------------------------------------------------------------\n/** @internal */\nexports.has = Object.prototype.hasOwnProperty;\n// -------------------------------------------------------------------------------------\n// NonEmptyArray\n// -------------------------------------------------------------------------------------\n/** @internal */\nvar fromReadonlyNonEmptyArray = function (as) { return __spreadArray([as[0]], as.slice(1), true); };\nexports.fromReadonlyNonEmptyArray = fromReadonlyNonEmptyArray;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sequenceS = exports.sequenceT = exports.getApplySemigroup = exports.apS = exports.apSecond = exports.apFirst = exports.ap = void 0;\nvar function_1 = require(\"./function\");\nvar _ = __importStar(require(\"./internal\"));\nfunction ap(F, G) {\n    return function (fa) {\n        return function (fab) {\n            return F.ap(F.map(fab, function (gab) { return function (ga) { return G.ap(gab, ga); }; }), fa);\n        };\n    };\n}\nexports.ap = ap;\nfunction apFirst(A) {\n    return function (second) { return function (first) {\n        return A.ap(A.map(first, function (a) { return function () { return a; }; }), second);\n    }; };\n}\nexports.apFirst = apFirst;\nfunction apSecond(A) {\n    return function (second) {\n        return function (first) {\n            return A.ap(A.map(first, function () { return function (b) { return b; }; }), second);\n        };\n    };\n}\nexports.apSecond = apSecond;\nfunction apS(F) {\n    return function (name, fb) {\n        return function (fa) {\n            return F.ap(F.map(fa, function (a) { return function (b) {\n                var _a;\n                return Object.assign({}, a, (_a = {}, _a[name] = b, _a));\n            }; }), fb);\n        };\n    };\n}\nexports.apS = apS;\nfunction getApplySemigroup(F) {\n    return function (S) { return ({\n        concat: function (first, second) {\n            return F.ap(F.map(first, function (x) { return function (y) { return S.concat(x, y); }; }), second);\n        }\n    }); };\n}\nexports.getApplySemigroup = getApplySemigroup;\nfunction curried(f, n, acc) {\n    return function (x) {\n        var combined = Array(acc.length + 1);\n        for (var i = 0; i < acc.length; i++) {\n            combined[i] = acc[i];\n        }\n        combined[acc.length] = x;\n        return n === 0 ? f.apply(null, combined) : curried(f, n - 1, combined);\n    };\n}\nvar tupleConstructors = {\n    1: function (a) { return [a]; },\n    2: function (a) { return function (b) { return [a, b]; }; },\n    3: function (a) { return function (b) { return function (c) { return [a, b, c]; }; }; },\n    4: function (a) { return function (b) { return function (c) { return function (d) { return [a, b, c, d]; }; }; }; },\n    5: function (a) { return function (b) { return function (c) { return function (d) { return function (e) { return [a, b, c, d, e]; }; }; }; }; }\n};\nfunction getTupleConstructor(len) {\n    if (!_.has.call(tupleConstructors, len)) {\n        tupleConstructors[len] = curried(function_1.tuple, len - 1, []);\n    }\n    return tupleConstructors[len];\n}\nfunction sequenceT(F) {\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var len = args.length;\n        var f = getTupleConstructor(len);\n        var fas = F.map(args[0], f);\n        for (var i = 1; i < len; i++) {\n            fas = F.ap(fas, args[i]);\n        }\n        return fas;\n    };\n}\nexports.sequenceT = sequenceT;\nfunction getRecordConstructor(keys) {\n    var len = keys.length;\n    switch (len) {\n        case 1:\n            return function (a) {\n                var _a;\n                return (_a = {}, _a[keys[0]] = a, _a);\n            };\n        case 2:\n            return function (a) { return function (b) {\n                var _a;\n                return (_a = {}, _a[keys[0]] = a, _a[keys[1]] = b, _a);\n            }; };\n        case 3:\n            return function (a) { return function (b) { return function (c) {\n                var _a;\n                return (_a = {}, _a[keys[0]] = a, _a[keys[1]] = b, _a[keys[2]] = c, _a);\n            }; }; };\n        case 4:\n            return function (a) { return function (b) { return function (c) { return function (d) {\n                var _a;\n                return (_a = {},\n                    _a[keys[0]] = a,\n                    _a[keys[1]] = b,\n                    _a[keys[2]] = c,\n                    _a[keys[3]] = d,\n                    _a);\n            }; }; }; };\n        case 5:\n            return function (a) { return function (b) { return function (c) { return function (d) { return function (e) {\n                var _a;\n                return (_a = {},\n                    _a[keys[0]] = a,\n                    _a[keys[1]] = b,\n                    _a[keys[2]] = c,\n                    _a[keys[3]] = d,\n                    _a[keys[4]] = e,\n                    _a);\n            }; }; }; }; };\n        default:\n            return curried(function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                var r = {};\n                for (var i = 0; i < len; i++) {\n                    r[keys[i]] = args[i];\n                }\n                return r;\n            }, len - 1, []);\n    }\n}\nfunction sequenceS(F) {\n    return function (r) {\n        var keys = Object.keys(r);\n        var len = keys.length;\n        var f = getRecordConstructor(keys);\n        var fr = F.map(r[keys[0]], f);\n        for (var i = 1; i < len; i++) {\n            fr = F.ap(fr, r[keys[i]]);\n        }\n        return fr;\n    };\n}\nexports.sequenceS = sequenceS;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getFunctorComposition = exports.let = exports.bindTo = exports.flap = exports.map = void 0;\n/**\n * A `Functor` is a type constructor which supports a mapping operation `map`.\n *\n * `map` can be used to turn functions `a -> b` into functions `f a -> f b` whose argument and return types use the type\n * constructor `f` to represent some computational context.\n *\n * Instances must satisfy the following laws:\n *\n * 1. Identity: `F.map(fa, a => a) <-> fa`\n * 2. Composition: `F.map(fa, a => bc(ab(a))) <-> F.map(F.map(fa, ab), bc)`\n *\n * @since 2.0.0\n */\nvar function_1 = require(\"./function\");\nfunction map(F, G) {\n    return function (f) { return function (fa) { return F.map(fa, function (ga) { return G.map(ga, f); }); }; };\n}\nexports.map = map;\nfunction flap(F) {\n    return function (a) { return function (fab) { return F.map(fab, function (f) { return f(a); }); }; };\n}\nexports.flap = flap;\nfunction bindTo(F) {\n    return function (name) { return function (fa) { return F.map(fa, function (a) {\n        var _a;\n        return (_a = {}, _a[name] = a, _a);\n    }); }; };\n}\nexports.bindTo = bindTo;\nfunction let_(F) {\n    return function (name, f) { return function (fa) { return F.map(fa, function (a) {\n        var _a;\n        return Object.assign({}, a, (_a = {}, _a[name] = f(a), _a));\n    }); }; };\n}\nexports.let = let_;\n/** @deprecated */\nfunction getFunctorComposition(F, G) {\n    var _map = map(F, G);\n    return {\n        map: function (fga, f) { return (0, function_1.pipe)(fga, _map(f)); }\n    };\n}\nexports.getFunctorComposition = getFunctorComposition;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getApplicativeComposition = exports.getApplicativeMonoid = void 0;\n/**\n * The `Applicative` type class extends the `Apply` type class with a `of` function, which can be used to create values\n * of type `f a` from values of type `a`.\n *\n * Where `Apply` provides the ability to lift functions of two or more arguments to functions whose arguments are\n * wrapped using `f`, and `Functor` provides the ability to lift functions of one argument, `pure` can be seen as the\n * function which lifts functions of _zero_ arguments. That is, `Applicative` functors support a lifting operation for\n * any number of function arguments.\n *\n * Instances must satisfy the following laws in addition to the `Apply` laws:\n *\n * 1. Identity: `A.ap(A.of(a => a), fa) <-> fa`\n * 2. Homomorphism: `A.ap(A.of(ab), A.of(a)) <-> A.of(ab(a))`\n * 3. Interchange: `A.ap(fab, A.of(a)) <-> A.ap(A.of(ab => ab(a)), fab)`\n *\n * Note. `Functor`'s `map` can be derived: `A.map(x, f) = A.ap(A.of(f), x)`\n *\n * @since 2.0.0\n */\nvar Apply_1 = require(\"./Apply\");\nvar function_1 = require(\"./function\");\nvar Functor_1 = require(\"./Functor\");\nfunction getApplicativeMonoid(F) {\n    var f = (0, Apply_1.getApplySemigroup)(F);\n    return function (M) { return ({\n        concat: f(M).concat,\n        empty: F.of(M.empty)\n    }); };\n}\nexports.getApplicativeMonoid = getApplicativeMonoid;\n/** @deprecated */\nfunction getApplicativeComposition(F, G) {\n    var map = (0, Functor_1.getFunctorComposition)(F, G).map;\n    var _ap = (0, Apply_1.ap)(F, G);\n    return {\n        map: map,\n        of: function (a) { return F.of(G.of(a)); },\n        ap: function (fgab, fga) { return (0, function_1.pipe)(fgab, _ap(fga)); }\n    };\n}\nexports.getApplicativeComposition = getApplicativeComposition;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.bind = exports.chainFirst = void 0;\nfunction chainFirst(M) {\n    return function (f) { return function (first) { return M.chain(first, function (a) { return M.map(f(a), function () { return a; }); }); }; };\n}\nexports.chainFirst = chainFirst;\nfunction bind(M) {\n    return function (name, f) { return function (ma) { return M.chain(ma, function (a) { return M.map(f(a), function (b) {\n        var _a;\n        return Object.assign({}, a, (_a = {}, _a[name] = b, _a));\n    }); }); }; };\n}\nexports.bind = bind;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.tailRec = void 0;\n/**\n * @since 2.0.0\n */\nvar tailRec = function (startWith, f) {\n    var ab = f(startWith);\n    while (ab._tag === 'Left') {\n        ab = f(ab.left);\n    }\n    return ab.right;\n};\nexports.tailRec = tailRec;\n", "\"use strict\";\n/**\n * The `FromEither` type class represents those data types which support errors.\n *\n * @since 2.10.0\n */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.filterOrElse = exports.chainFirstEitherK = exports.chainEitherK = exports.fromEitherK = exports.chainOptionK = exports.fromOptionK = exports.fromPredicate = exports.fromOption = void 0;\nvar Chain_1 = require(\"./Chain\");\nvar function_1 = require(\"./function\");\nvar _ = __importStar(require(\"./internal\"));\nfunction fromOption(F) {\n    return function (onNone) { return function (ma) { return F.fromEither(_.isNone(ma) ? _.left(onNone()) : _.right(ma.value)); }; };\n}\nexports.fromOption = fromOption;\nfunction fromPredicate(F) {\n    return function (predicate, onFalse) {\n        return function (a) {\n            return F.fromEither(predicate(a) ? _.right(a) : _.left(onFalse(a)));\n        };\n    };\n}\nexports.fromPredicate = fromPredicate;\nfunction fromOptionK(F) {\n    var fromOptionF = fromOption(F);\n    return function (onNone) {\n        var from = fromOptionF(onNone);\n        return function (f) { return (0, function_1.flow)(f, from); };\n    };\n}\nexports.fromOptionK = fromOptionK;\nfunction chainOptionK(F, M) {\n    var fromOptionKF = fromOptionK(F);\n    return function (onNone) {\n        var from = fromOptionKF(onNone);\n        return function (f) { return function (ma) { return M.chain(ma, from(f)); }; };\n    };\n}\nexports.chainOptionK = chainOptionK;\nfunction fromEitherK(F) {\n    return function (f) { return (0, function_1.flow)(f, F.fromEither); };\n}\nexports.fromEitherK = fromEitherK;\nfunction chainEitherK(F, M) {\n    var fromEitherKF = fromEitherK(F);\n    return function (f) { return function (ma) { return M.chain(ma, fromEitherKF(f)); }; };\n}\nexports.chainEitherK = chainEitherK;\nfunction chainFirstEitherK(F, M) {\n    return (0, function_1.flow)(fromEitherK(F), (0, Chain_1.chainFirst)(M));\n}\nexports.chainFirstEitherK = chainFirstEitherK;\nfunction filterOrElse(F, M) {\n    return function (predicate, onFalse) {\n        return function (ma) {\n            return M.chain(ma, function (a) { return F.fromEither(predicate(a) ? _.right(a) : _.left(onFalse(a))); });\n        };\n    };\n}\nexports.filterOrElse = filterOrElse;\n", "\"use strict\";\n/**\n * ```ts\n * interface Separated<E, A> {\n *    readonly left: E\n *    readonly right: A\n * }\n * ```\n *\n * Represents a result of separating a whole into two parts.\n *\n * @since 2.10.0\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.right = exports.left = exports.flap = exports.Functor = exports.Bifunctor = exports.URI = exports.bimap = exports.mapLeft = exports.map = exports.separated = void 0;\nvar function_1 = require(\"./function\");\nvar Functor_1 = require(\"./Functor\");\n// -------------------------------------------------------------------------------------\n// constructors\n// -------------------------------------------------------------------------------------\n/**\n * @category constructors\n * @since 2.10.0\n */\nvar separated = function (left, right) { return ({ left: left, right: right }); };\nexports.separated = separated;\nvar _map = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.map)(f)); };\nvar _mapLeft = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.mapLeft)(f)); };\nvar _bimap = function (fa, g, f) { return (0, function_1.pipe)(fa, (0, exports.bimap)(g, f)); };\n/**\n * `map` can be used to turn functions `(a: A) => B` into functions `(fa: F<A>) => F<B>` whose argument and return types\n * use the type constructor `F` to represent some computational context.\n *\n * @category mapping\n * @since 2.10.0\n */\nvar map = function (f) {\n    return function (fa) {\n        return (0, exports.separated)((0, exports.left)(fa), f((0, exports.right)(fa)));\n    };\n};\nexports.map = map;\n/**\n * Map a function over the first type argument of a bifunctor.\n *\n * @category error handling\n * @since 2.10.0\n */\nvar mapLeft = function (f) {\n    return function (fa) {\n        return (0, exports.separated)(f((0, exports.left)(fa)), (0, exports.right)(fa));\n    };\n};\nexports.mapLeft = mapLeft;\n/**\n * Map a pair of functions over the two type arguments of the bifunctor.\n *\n * @category mapping\n * @since 2.10.0\n */\nvar bimap = function (f, g) {\n    return function (fa) {\n        return (0, exports.separated)(f((0, exports.left)(fa)), g((0, exports.right)(fa)));\n    };\n};\nexports.bimap = bimap;\n/**\n * @category type lambdas\n * @since 2.10.0\n */\nexports.URI = 'Separated';\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Bifunctor = {\n    URI: exports.URI,\n    mapLeft: _mapLeft,\n    bimap: _bimap\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Functor = {\n    URI: exports.URI,\n    map: _map\n};\n/**\n * @category mapping\n * @since 2.10.0\n */\nexports.flap = (0, Functor_1.flap)(exports.Functor);\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.10.0\n */\nvar left = function (s) { return s.left; };\nexports.left = left;\n/**\n * @since 2.10.0\n */\nvar right = function (s) { return s.right; };\nexports.right = right;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.filterE = exports.witherDefault = exports.wiltDefault = void 0;\nvar _ = __importStar(require(\"./internal\"));\nfunction wiltDefault(T, C) {\n    return function (F) {\n        var traverseF = T.traverse(F);\n        return function (wa, f) { return F.map(traverseF(wa, f), C.separate); };\n    };\n}\nexports.wiltDefault = wiltDefault;\nfunction witherDefault(T, C) {\n    return function (F) {\n        var traverseF = T.traverse(F);\n        return function (wa, f) { return F.map(traverseF(wa, f), C.compact); };\n    };\n}\nexports.witherDefault = witherDefault;\nfunction filterE(W) {\n    return function (F) {\n        var witherF = W.wither(F);\n        return function (predicate) { return function (ga) { return witherF(ga, function (a) { return F.map(predicate(a), function (b) { return (b ? _.some(a) : _.none); }); }); }; };\n    };\n}\nexports.filterE = filterE;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.fold = exports.match = exports.foldW = exports.matchW = exports.isRight = exports.isLeft = exports.fromOption = exports.fromPredicate = exports.FromEither = exports.MonadThrow = exports.throwError = exports.ChainRec = exports.Extend = exports.extend = exports.Alt = exports.alt = exports.altW = exports.Bifunctor = exports.mapLeft = exports.bimap = exports.Traversable = exports.sequence = exports.traverse = exports.Foldable = exports.reduceRight = exports.foldMap = exports.reduce = exports.Monad = exports.Chain = exports.chain = exports.chainW = exports.Applicative = exports.Apply = exports.ap = exports.apW = exports.Pointed = exports.of = exports.Functor = exports.map = exports.getAltValidation = exports.getApplicativeValidation = exports.getWitherable = exports.getFilterable = exports.getCompactable = exports.getSemigroup = exports.getEq = exports.getShow = exports.URI = exports.right = exports.left = void 0;\nexports.getValidation = exports.getValidationMonoid = exports.getValidationSemigroup = exports.getApplyMonoid = exports.getApplySemigroup = exports.either = exports.stringifyJSON = exports.parseJSON = exports.sequenceArray = exports.traverseArray = exports.traverseArrayWithIndex = exports.traverseReadonlyArrayWithIndex = exports.traverseReadonlyNonEmptyArrayWithIndex = exports.ApT = exports.apSW = exports.apS = exports.bindW = exports.bind = exports.let = exports.bindTo = exports.Do = exports.exists = exports.elem = exports.toError = exports.toUnion = exports.chainNullableK = exports.fromNullableK = exports.tryCatchK = exports.tryCatch = exports.fromNullable = exports.orElse = exports.orElseW = exports.swap = exports.filterOrElseW = exports.filterOrElse = exports.chainOptionK = exports.fromOptionK = exports.duplicate = exports.flatten = exports.flattenW = exports.chainFirstW = exports.chainFirst = exports.apSecondW = exports.apSecond = exports.apFirstW = exports.apFirst = exports.flap = exports.getOrElse = exports.getOrElseW = void 0;\nvar Applicative_1 = require(\"./Applicative\");\nvar Apply_1 = require(\"./Apply\");\nvar Chain_1 = require(\"./Chain\");\nvar ChainRec_1 = require(\"./ChainRec\");\nvar FromEither_1 = require(\"./FromEither\");\nvar function_1 = require(\"./function\");\nvar Functor_1 = require(\"./Functor\");\nvar _ = __importStar(require(\"./internal\"));\nvar Separated_1 = require(\"./Separated\");\nvar Witherable_1 = require(\"./Witherable\");\n// -------------------------------------------------------------------------------------\n// constructors\n// -------------------------------------------------------------------------------------\n/**\n * Constructs a new `Either` holding a `Left` value. This usually represents a failure, due to the right-bias of this\n * structure.\n *\n * @category constructors\n * @since 2.0.0\n */\nexports.left = _.left;\n/**\n * Constructs a new `Either` holding a `Right` value. This usually represents a successful value due to the right bias\n * of this structure.\n *\n * @category constructors\n * @since 2.0.0\n */\nexports.right = _.right;\nvar _map = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.map)(f)); };\nvar _ap = function (fab, fa) { return (0, function_1.pipe)(fab, (0, exports.ap)(fa)); };\n/* istanbul ignore next */\nvar _chain = function (ma, f) { return (0, function_1.pipe)(ma, (0, exports.chain)(f)); };\n/* istanbul ignore next */\nvar _reduce = function (fa, b, f) { return (0, function_1.pipe)(fa, (0, exports.reduce)(b, f)); };\n/* istanbul ignore next */\nvar _foldMap = function (M) { return function (fa, f) {\n    var foldMapM = (0, exports.foldMap)(M);\n    return (0, function_1.pipe)(fa, foldMapM(f));\n}; };\n/* istanbul ignore next */\nvar _reduceRight = function (fa, b, f) { return (0, function_1.pipe)(fa, (0, exports.reduceRight)(b, f)); };\nvar _traverse = function (F) {\n    var traverseF = (0, exports.traverse)(F);\n    return function (ta, f) { return (0, function_1.pipe)(ta, traverseF(f)); };\n};\nvar _bimap = function (fa, f, g) { return (0, function_1.pipe)(fa, (0, exports.bimap)(f, g)); };\nvar _mapLeft = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.mapLeft)(f)); };\n/* istanbul ignore next */\nvar _alt = function (fa, that) { return (0, function_1.pipe)(fa, (0, exports.alt)(that)); };\n/* istanbul ignore next */\nvar _extend = function (wa, f) { return (0, function_1.pipe)(wa, (0, exports.extend)(f)); };\nvar _chainRec = function (a, f) {\n    return (0, ChainRec_1.tailRec)(f(a), function (e) {\n        return (0, exports.isLeft)(e) ? (0, exports.right)((0, exports.left)(e.left)) : (0, exports.isLeft)(e.right) ? (0, exports.left)(f(e.right.left)) : (0, exports.right)((0, exports.right)(e.right.right));\n    });\n};\n/**\n * @category type lambdas\n * @since 2.0.0\n */\nexports.URI = 'Either';\n/**\n * @category instances\n * @since 2.0.0\n */\nvar getShow = function (SE, SA) { return ({\n    show: function (ma) { return ((0, exports.isLeft)(ma) ? \"left(\".concat(SE.show(ma.left), \")\") : \"right(\".concat(SA.show(ma.right), \")\")); }\n}); };\nexports.getShow = getShow;\n/**\n * @category instances\n * @since 2.0.0\n */\nvar getEq = function (EL, EA) { return ({\n    equals: function (x, y) {\n        return x === y || ((0, exports.isLeft)(x) ? (0, exports.isLeft)(y) && EL.equals(x.left, y.left) : (0, exports.isRight)(y) && EA.equals(x.right, y.right));\n    }\n}); };\nexports.getEq = getEq;\n/**\n * Semigroup returning the left-most non-`Left` value. If both operands are `Right`s then the inner values are\n * concatenated using the provided `Semigroup`\n *\n * @example\n * import { getSemigroup, left, right } from 'fp-ts/Either'\n * import { SemigroupSum } from 'fp-ts/number'\n *\n * const S = getSemigroup<string, number>(SemigroupSum)\n * assert.deepStrictEqual(S.concat(left('a'), left('b')), left('a'))\n * assert.deepStrictEqual(S.concat(left('a'), right(2)), right(2))\n * assert.deepStrictEqual(S.concat(right(1), left('b')), right(1))\n * assert.deepStrictEqual(S.concat(right(1), right(2)), right(3))\n *\n * @category instances\n * @since 2.0.0\n */\nvar getSemigroup = function (S) { return ({\n    concat: function (x, y) { return ((0, exports.isLeft)(y) ? x : (0, exports.isLeft)(x) ? y : (0, exports.right)(S.concat(x.right, y.right))); }\n}); };\nexports.getSemigroup = getSemigroup;\n/**\n * Builds a `Compactable` instance for `Either` given `Monoid` for the left side.\n *\n * @category filtering\n * @since 2.10.0\n */\nvar getCompactable = function (M) {\n    var empty = (0, exports.left)(M.empty);\n    return {\n        URI: exports.URI,\n        _E: undefined,\n        compact: function (ma) { return ((0, exports.isLeft)(ma) ? ma : ma.right._tag === 'None' ? empty : (0, exports.right)(ma.right.value)); },\n        separate: function (ma) {\n            return (0, exports.isLeft)(ma)\n                ? (0, Separated_1.separated)(ma, ma)\n                : (0, exports.isLeft)(ma.right)\n                    ? (0, Separated_1.separated)((0, exports.right)(ma.right.left), empty)\n                    : (0, Separated_1.separated)(empty, (0, exports.right)(ma.right.right));\n        }\n    };\n};\nexports.getCompactable = getCompactable;\n/**\n * Builds a `Filterable` instance for `Either` given `Monoid` for the left side\n *\n * @category filtering\n * @since 2.10.0\n */\nvar getFilterable = function (M) {\n    var empty = (0, exports.left)(M.empty);\n    var _a = (0, exports.getCompactable)(M), compact = _a.compact, separate = _a.separate;\n    var filter = function (ma, predicate) {\n        return (0, exports.isLeft)(ma) ? ma : predicate(ma.right) ? ma : empty;\n    };\n    var partition = function (ma, p) {\n        return (0, exports.isLeft)(ma)\n            ? (0, Separated_1.separated)(ma, ma)\n            : p(ma.right)\n                ? (0, Separated_1.separated)(empty, (0, exports.right)(ma.right))\n                : (0, Separated_1.separated)((0, exports.right)(ma.right), empty);\n    };\n    return {\n        URI: exports.URI,\n        _E: undefined,\n        map: _map,\n        compact: compact,\n        separate: separate,\n        filter: filter,\n        filterMap: function (ma, f) {\n            if ((0, exports.isLeft)(ma)) {\n                return ma;\n            }\n            var ob = f(ma.right);\n            return ob._tag === 'None' ? empty : (0, exports.right)(ob.value);\n        },\n        partition: partition,\n        partitionMap: function (ma, f) {\n            if ((0, exports.isLeft)(ma)) {\n                return (0, Separated_1.separated)(ma, ma);\n            }\n            var e = f(ma.right);\n            return (0, exports.isLeft)(e) ? (0, Separated_1.separated)((0, exports.right)(e.left), empty) : (0, Separated_1.separated)(empty, (0, exports.right)(e.right));\n        }\n    };\n};\nexports.getFilterable = getFilterable;\n/**\n * Builds `Witherable` instance for `Either` given `Monoid` for the left side\n *\n * @category filtering\n * @since 2.0.0\n */\nvar getWitherable = function (M) {\n    var F_ = (0, exports.getFilterable)(M);\n    var C = (0, exports.getCompactable)(M);\n    return {\n        URI: exports.URI,\n        _E: undefined,\n        map: _map,\n        compact: F_.compact,\n        separate: F_.separate,\n        filter: F_.filter,\n        filterMap: F_.filterMap,\n        partition: F_.partition,\n        partitionMap: F_.partitionMap,\n        traverse: _traverse,\n        sequence: exports.sequence,\n        reduce: _reduce,\n        foldMap: _foldMap,\n        reduceRight: _reduceRight,\n        wither: (0, Witherable_1.witherDefault)(exports.Traversable, C),\n        wilt: (0, Witherable_1.wiltDefault)(exports.Traversable, C)\n    };\n};\nexports.getWitherable = getWitherable;\n/**\n * The default [`Applicative`](#applicative) instance returns the first error, if you want to\n * get all errors you need to provide a way to concatenate them via a `Semigroup`.\n *\n * @example\n * import * as A from 'fp-ts/Apply'\n * import * as E from 'fp-ts/Either'\n * import { pipe } from 'fp-ts/function'\n * import * as S from 'fp-ts/Semigroup'\n * import * as string from 'fp-ts/string'\n *\n * const parseString = (u: unknown): E.Either<string, string> =>\n *   typeof u === 'string' ? E.right(u) : E.left('not a string')\n *\n * const parseNumber = (u: unknown): E.Either<string, number> =>\n *   typeof u === 'number' ? E.right(u) : E.left('not a number')\n *\n * interface Person {\n *   readonly name: string\n *   readonly age: number\n * }\n *\n * const parsePerson = (\n *   input: Record<string, unknown>\n * ): E.Either<string, Person> =>\n *   pipe(\n *     E.Do,\n *     E.apS('name', parseString(input.name)),\n *     E.apS('age', parseNumber(input.age))\n *   )\n *\n * assert.deepStrictEqual(parsePerson({}), E.left('not a string')) // <= first error\n *\n * const Applicative = E.getApplicativeValidation(\n *   pipe(string.Semigroup, S.intercalate(', '))\n * )\n *\n * const apS = A.apS(Applicative)\n *\n * const parsePersonAll = (\n *   input: Record<string, unknown>\n * ): E.Either<string, Person> =>\n *   pipe(\n *     E.Do,\n *     apS('name', parseString(input.name)),\n *     apS('age', parseNumber(input.age))\n *   )\n *\n * assert.deepStrictEqual(parsePersonAll({}), E.left('not a string, not a number')) // <= all errors\n *\n * @category error handling\n * @since 2.7.0\n */\nvar getApplicativeValidation = function (SE) { return ({\n    URI: exports.URI,\n    _E: undefined,\n    map: _map,\n    ap: function (fab, fa) {\n        return (0, exports.isLeft)(fab)\n            ? (0, exports.isLeft)(fa)\n                ? (0, exports.left)(SE.concat(fab.left, fa.left))\n                : fab\n            : (0, exports.isLeft)(fa)\n                ? fa\n                : (0, exports.right)(fab.right(fa.right));\n    },\n    of: exports.of\n}); };\nexports.getApplicativeValidation = getApplicativeValidation;\n/**\n * The default [`Alt`](#alt) instance returns the last error, if you want to\n * get all errors you need to provide a way to concatenate them via a `Semigroup`.\n *\n * @example\n * import * as E from 'fp-ts/Either'\n * import { pipe } from 'fp-ts/function'\n * import * as S from 'fp-ts/Semigroup'\n * import * as string from 'fp-ts/string'\n *\n * const parseString = (u: unknown): E.Either<string, string> =>\n *   typeof u === 'string' ? E.right(u) : E.left('not a string')\n *\n * const parseNumber = (u: unknown): E.Either<string, number> =>\n *   typeof u === 'number' ? E.right(u) : E.left('not a number')\n *\n * const parse = (u: unknown): E.Either<string, string | number> =>\n *   pipe(\n *     parseString(u),\n *     E.alt<string, string | number>(() => parseNumber(u))\n *   )\n *\n * assert.deepStrictEqual(parse(true), E.left('not a number')) // <= last error\n *\n * const Alt = E.getAltValidation(pipe(string.Semigroup, S.intercalate(', ')))\n *\n * const parseAll = (u: unknown): E.Either<string, string | number> =>\n *   Alt.alt<string | number>(parseString(u), () => parseNumber(u))\n *\n * assert.deepStrictEqual(parseAll(true), E.left('not a string, not a number')) // <= all errors\n *\n * @category error handling\n * @since 2.7.0\n */\nvar getAltValidation = function (SE) { return ({\n    URI: exports.URI,\n    _E: undefined,\n    map: _map,\n    alt: function (me, that) {\n        if ((0, exports.isRight)(me)) {\n            return me;\n        }\n        var ea = that();\n        return (0, exports.isLeft)(ea) ? (0, exports.left)(SE.concat(me.left, ea.left)) : ea;\n    }\n}); };\nexports.getAltValidation = getAltValidation;\n/**\n * @category mapping\n * @since 2.0.0\n */\nvar map = function (f) { return function (fa) {\n    return (0, exports.isLeft)(fa) ? fa : (0, exports.right)(f(fa.right));\n}; };\nexports.map = map;\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Functor = {\n    URI: exports.URI,\n    map: _map\n};\n/**\n * @category constructors\n * @since 2.7.0\n */\nexports.of = exports.right;\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Pointed = {\n    URI: exports.URI,\n    of: exports.of\n};\n/**\n * Less strict version of [`ap`](#ap).\n *\n * The `W` suffix (short for **W**idening) means that the error types will be merged.\n *\n * @since 2.8.0\n */\nvar apW = function (fa) { return function (fab) {\n    return (0, exports.isLeft)(fab) ? fab : (0, exports.isLeft)(fa) ? fa : (0, exports.right)(fab.right(fa.right));\n}; };\nexports.apW = apW;\n/**\n * @since 2.0.0\n */\nexports.ap = exports.apW;\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Apply = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Applicative = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    of: exports.of\n};\n/**\n * Less strict version of [`chain`](#chain).\n *\n * The `W` suffix (short for **W**idening) means that the error types will be merged.\n *\n * @example\n * import * as E from 'fp-ts/Either'\n * import { pipe } from 'fp-ts/function'\n *\n * const e1: E.Either<string, number> = E.right(1)\n * const e2: E.Either<number, number> = E.right(2)\n *\n * export const result1 = pipe(\n *   // @ts-expect-error\n *   e1,\n *   E.chain(() => e2)\n * )\n *\n * // merged error types -----v-------------v\n * // const result2: E.Either<string | number, number>\n * export const result2 = pipe(\n *   e1, // no error\n *   E.chainW(() => e2)\n * )\n *\n * @category sequencing\n * @since 2.6.0\n */\nvar chainW = function (f) {\n    return function (ma) {\n        return (0, exports.isLeft)(ma) ? ma : f(ma.right);\n    };\n};\nexports.chainW = chainW;\n/**\n * Composes computations in sequence, using the return value of one computation to determine the next computation.\n *\n * @category sequencing\n * @since 2.0.0\n */\nexports.chain = exports.chainW;\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Chain = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    chain: _chain\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Monad = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    of: exports.of,\n    chain: _chain\n};\n/**\n * Left-associative fold of a structure.\n *\n * @example\n * import { pipe } from 'fp-ts/function'\n * import * as E from 'fp-ts/Either'\n *\n * const startWith = 'prefix'\n * const concat = (a: string, b: string) => `${a}:${b}`\n *\n * assert.deepStrictEqual(\n *   pipe(E.right('a'), E.reduce(startWith, concat)),\n *   'prefix:a'\n * )\n *\n * assert.deepStrictEqual(\n *   pipe(E.left('e'), E.reduce(startWith, concat)),\n *   'prefix'\n * )\n *\n * @category folding\n * @since 2.0.0\n */\nvar reduce = function (b, f) { return function (fa) {\n    return (0, exports.isLeft)(fa) ? b : f(b, fa.right);\n}; };\nexports.reduce = reduce;\n/**\n * Map each element of the structure to a monoid, and combine the results.\n *\n * @example\n * import { pipe } from 'fp-ts/function'\n * import * as E from 'fp-ts/Either'\n * import * as S from 'fp-ts/string'\n *\n * const yell = (a: string) => `${a}!`\n *\n * assert.deepStrictEqual(\n *   pipe(E.right('a'), E.foldMap(S.Monoid)(yell)),\n *   'a!'\n * )\n *\n * assert.deepStrictEqual(\n *   pipe(E.left('e'), E.foldMap(S.Monoid)(yell)),\n *   S.Monoid.empty\n * )\n *\n * @category folding\n * @since 2.0.0\n */\nvar foldMap = function (M) { return function (f) { return function (fa) {\n    return (0, exports.isLeft)(fa) ? M.empty : f(fa.right);\n}; }; };\nexports.foldMap = foldMap;\n/**\n * Right-associative fold of a structure.\n *\n * @example\n * import { pipe } from 'fp-ts/function'\n * import * as E from 'fp-ts/Either'\n *\n * const startWith = 'postfix'\n * const concat = (a: string, b: string) => `${a}:${b}`\n *\n * assert.deepStrictEqual(\n *   pipe(E.right('a'), E.reduceRight(startWith, concat)),\n *   'a:postfix'\n * )\n *\n * assert.deepStrictEqual(\n *   pipe(E.left('e'), E.reduceRight(startWith, concat)),\n *   'postfix'\n * )\n *\n * @category folding\n * @since 2.0.0\n */\nvar reduceRight = function (b, f) { return function (fa) {\n    return (0, exports.isLeft)(fa) ? b : f(fa.right, b);\n}; };\nexports.reduceRight = reduceRight;\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Foldable = {\n    URI: exports.URI,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight\n};\n/**\n * Map each element of a structure to an action, evaluate these actions from left to right, and collect the results.\n *\n * @example\n * import { pipe } from 'fp-ts/function'\n * import * as RA from 'fp-ts/ReadonlyArray'\n * import * as E from 'fp-ts/Either'\n * import * as O from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(\n *   pipe(E.right(['a']), E.traverse(O.Applicative)(RA.head)),\n *   O.some(E.right('a'))\n *  )\n *\n * assert.deepStrictEqual(\n *   pipe(E.right([]), E.traverse(O.Applicative)(RA.head)),\n *   O.none\n * )\n *\n * @category traversing\n * @since 2.6.3\n */\nvar traverse = function (F) {\n    return function (f) {\n        return function (ta) {\n            return (0, exports.isLeft)(ta) ? F.of((0, exports.left)(ta.left)) : F.map(f(ta.right), exports.right);\n        };\n    };\n};\nexports.traverse = traverse;\n/**\n * Evaluate each monadic action in the structure from left to right, and collect the results.\n *\n * @example\n * import { pipe } from 'fp-ts/function'\n * import * as E from 'fp-ts/Either'\n * import * as O from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(\n *   pipe(E.right(O.some('a')), E.sequence(O.Applicative)),\n *   O.some(E.right('a'))\n *  )\n *\n * assert.deepStrictEqual(\n *   pipe(E.right(O.none), E.sequence(O.Applicative)),\n *   O.none\n * )\n *\n * @category traversing\n * @since 2.6.3\n */\nvar sequence = function (F) {\n    return function (ma) {\n        return (0, exports.isLeft)(ma) ? F.of((0, exports.left)(ma.left)) : F.map(ma.right, exports.right);\n    };\n};\nexports.sequence = sequence;\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Traversable = {\n    URI: exports.URI,\n    map: _map,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence\n};\n/**\n * Map a pair of functions over the two type arguments of the bifunctor.\n *\n * @category mapping\n * @since 2.0.0\n */\nvar bimap = function (f, g) { return function (fa) {\n    return (0, exports.isLeft)(fa) ? (0, exports.left)(f(fa.left)) : (0, exports.right)(g(fa.right));\n}; };\nexports.bimap = bimap;\n/**\n * Map a function over the first type argument of a bifunctor.\n *\n * @category error handling\n * @since 2.0.0\n */\nvar mapLeft = function (f) { return function (fa) {\n    return (0, exports.isLeft)(fa) ? (0, exports.left)(f(fa.left)) : fa;\n}; };\nexports.mapLeft = mapLeft;\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Bifunctor = {\n    URI: exports.URI,\n    bimap: _bimap,\n    mapLeft: _mapLeft\n};\n/**\n * Less strict version of [`alt`](#alt).\n *\n * The `W` suffix (short for **W**idening) means that the error and the return types will be merged.\n *\n * @category error handling\n * @since 2.9.0\n */\nvar altW = function (that) { return function (fa) {\n    return (0, exports.isLeft)(fa) ? that() : fa;\n}; };\nexports.altW = altW;\n/**\n * Identifies an associative operation on a type constructor. It is similar to `Semigroup`, except that it applies to\n * types of kind `* -> *`.\n *\n * In case of `Either` returns the left-most non-`Left` value (or the right-most `Left` value if both values are `Left`).\n *\n * | x        | y        | pipe(x, alt(() => y) |\n * | -------- | -------- | -------------------- |\n * | left(a)  | left(b)  | left(b)              |\n * | left(a)  | right(2) | right(2)             |\n * | right(1) | left(b)  | right(1)             |\n * | right(1) | right(2) | right(1)             |\n *\n * @example\n * import * as E from 'fp-ts/Either'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(\n *   pipe(\n *     E.left('a'),\n *     E.alt(() => E.left('b'))\n *   ),\n *   E.left('b')\n * )\n * assert.deepStrictEqual(\n *   pipe(\n *     E.left('a'),\n *     E.alt(() => E.right(2))\n *   ),\n *   E.right(2)\n * )\n * assert.deepStrictEqual(\n *   pipe(\n *     E.right(1),\n *     E.alt(() => E.left('b'))\n *   ),\n *   E.right(1)\n * )\n * assert.deepStrictEqual(\n *   pipe(\n *     E.right(1),\n *     E.alt(() => E.right(2))\n *   ),\n *   E.right(1)\n * )\n *\n * @category error handling\n * @since 2.0.0\n */\nexports.alt = exports.altW;\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Alt = {\n    URI: exports.URI,\n    map: _map,\n    alt: _alt\n};\n/**\n * @since 2.0.0\n */\nvar extend = function (f) { return function (wa) {\n    return (0, exports.isLeft)(wa) ? wa : (0, exports.right)(f(wa));\n}; };\nexports.extend = extend;\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Extend = {\n    URI: exports.URI,\n    map: _map,\n    extend: _extend\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.ChainRec = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    chain: _chain,\n    chainRec: _chainRec\n};\n/**\n * @since 2.6.3\n */\nexports.throwError = exports.left;\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.MonadThrow = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    of: exports.of,\n    chain: _chain,\n    throwError: exports.throwError\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.FromEither = {\n    URI: exports.URI,\n    fromEither: function_1.identity\n};\n/**\n * @example\n * import { fromPredicate, left, right } from 'fp-ts/Either'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(\n *   pipe(\n *     1,\n *     fromPredicate(\n *       (n) => n > 0,\n *       () => 'error'\n *     )\n *   ),\n *   right(1)\n * )\n * assert.deepStrictEqual(\n *   pipe(\n *     -1,\n *     fromPredicate(\n *       (n) => n > 0,\n *       () => 'error'\n *     )\n *   ),\n *   left('error')\n * )\n *\n * @category lifting\n * @since 2.0.0\n */\nexports.fromPredicate = (0, FromEither_1.fromPredicate)(exports.FromEither);\n// -------------------------------------------------------------------------------------\n// conversions\n// -------------------------------------------------------------------------------------\n/**\n * @example\n * import * as E from 'fp-ts/Either'\n * import { pipe } from 'fp-ts/function'\n * import * as O from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(\n *   pipe(\n *     O.some(1),\n *     E.fromOption(() => 'error')\n *   ),\n *   E.right(1)\n * )\n * assert.deepStrictEqual(\n *   pipe(\n *     O.none,\n *     E.fromOption(() => 'error')\n *   ),\n *   E.left('error')\n * )\n *\n * @category conversions\n * @since 2.0.0\n */\nexports.fromOption = \n/*#__PURE__*/ (0, FromEither_1.fromOption)(exports.FromEither);\n// -------------------------------------------------------------------------------------\n// refinements\n// -------------------------------------------------------------------------------------\n/**\n * Returns `true` if the either is an instance of `Left`, `false` otherwise.\n *\n * @category refinements\n * @since 2.0.0\n */\nexports.isLeft = _.isLeft;\n/**\n * Returns `true` if the either is an instance of `Right`, `false` otherwise.\n *\n * @category refinements\n * @since 2.0.0\n */\nexports.isRight = _.isRight;\n/**\n * Less strict version of [`match`](#match).\n *\n * The `W` suffix (short for **W**idening) means that the handler return types will be merged.\n *\n * @category pattern matching\n * @since 2.10.0\n */\nvar matchW = function (onLeft, onRight) {\n    return function (ma) {\n        return (0, exports.isLeft)(ma) ? onLeft(ma.left) : onRight(ma.right);\n    };\n};\nexports.matchW = matchW;\n/**\n * Alias of [`matchW`](#matchw).\n *\n * @category pattern matching\n * @since 2.10.0\n */\nexports.foldW = exports.matchW;\n/**\n * Takes two functions and an `Either` value, if the value is a `Left` the inner value is applied to the first function,\n * if the value is a `Right` the inner value is applied to the second function.\n *\n * @example\n * import { match, left, right } from 'fp-ts/Either'\n * import { pipe } from 'fp-ts/function'\n *\n * function onLeft(errors: Array<string>): string {\n *   return `Errors: ${errors.join(', ')}`\n * }\n *\n * function onRight(value: number): string {\n *   return `Ok: ${value}`\n * }\n *\n * assert.strictEqual(\n *   pipe(\n *     right(1),\n *     match(onLeft, onRight)\n *   ),\n *   'Ok: 1'\n * )\n * assert.strictEqual(\n *   pipe(\n *     left(['error 1', 'error 2']),\n *     match(onLeft, onRight)\n *   ),\n *   'Errors: error 1, error 2'\n * )\n *\n * @category pattern matching\n * @since 2.10.0\n */\nexports.match = exports.matchW;\n/**\n * Alias of [`match`](#match).\n *\n * @category pattern matching\n * @since 2.0.0\n */\nexports.fold = exports.match;\n/**\n * Less strict version of [`getOrElse`](#getorelse).\n *\n * The `W` suffix (short for **W**idening) means that the handler return type will be merged.\n *\n * @category error handling\n * @since 2.6.0\n */\nvar getOrElseW = function (onLeft) {\n    return function (ma) {\n        return (0, exports.isLeft)(ma) ? onLeft(ma.left) : ma.right;\n    };\n};\nexports.getOrElseW = getOrElseW;\n/**\n * Returns the wrapped value if it's a `Right` or a default value if is a `Left`.\n *\n * @example\n * import { getOrElse, left, right } from 'fp-ts/Either'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(\n *   pipe(\n *     right(1),\n *     getOrElse(() => 0)\n *   ),\n *   1\n * )\n * assert.deepStrictEqual(\n *   pipe(\n *     left('error'),\n *     getOrElse(() => 0)\n *   ),\n *   0\n * )\n *\n * @category error handling\n * @since 2.0.0\n */\nexports.getOrElse = exports.getOrElseW;\n// -------------------------------------------------------------------------------------\n// combinators\n// -------------------------------------------------------------------------------------\n/**\n * @category mapping\n * @since 2.10.0\n */\nexports.flap = (0, Functor_1.flap)(exports.Functor);\n/**\n * Combine two effectful actions, keeping only the result of the first.\n *\n * @since 2.0.0\n */\nexports.apFirst = (0, Apply_1.apFirst)(exports.Apply);\n/**\n * Less strict version of [`apFirst`](#apfirst)\n *\n * The `W` suffix (short for **W**idening) means that the error types will be merged.\n *\n * @since 2.12.0\n */\nexports.apFirstW = exports.apFirst;\n/**\n * Combine two effectful actions, keeping only the result of the second.\n *\n * @since 2.0.0\n */\nexports.apSecond = (0, Apply_1.apSecond)(exports.Apply);\n/**\n * Less strict version of [`apSecond`](#apsecond)\n *\n * The `W` suffix (short for **W**idening) means that the error types will be merged.\n *\n * @since 2.12.0\n */\nexports.apSecondW = exports.apSecond;\n/**\n * Composes computations in sequence, using the return value of one computation to determine the next computation and\n * keeping only the result of the first.\n *\n * @category sequencing\n * @since 2.0.0\n */\nexports.chainFirst = \n/*#__PURE__*/ (0, Chain_1.chainFirst)(exports.Chain);\n/**\n * Less strict version of [`chainFirst`](#chainfirst)\n *\n * The `W` suffix (short for **W**idening) means that the error types will be merged.\n *\n * @category sequencing\n * @since 2.8.0\n */\nexports.chainFirstW = exports.chainFirst;\n/**\n * Less strict version of [`flatten`](#flatten).\n *\n * The `W` suffix (short for **W**idening) means that the error types will be merged.\n *\n * @category sequencing\n * @since 2.11.0\n */\nexports.flattenW = \n/*#__PURE__*/ (0, exports.chainW)(function_1.identity);\n/**\n * The `flatten` function is the conventional monad join operator. It is used to remove one level of monadic structure, projecting its bound argument into the outer level.\n *\n * @example\n * import * as E from 'fp-ts/Either'\n *\n * assert.deepStrictEqual(E.flatten(E.right(E.right('a'))), E.right('a'))\n * assert.deepStrictEqual(E.flatten(E.right(E.left('e'))), E.left('e'))\n * assert.deepStrictEqual(E.flatten(E.left('e')), E.left('e'))\n *\n * @category sequencing\n * @since 2.0.0\n */\nexports.flatten = exports.flattenW;\n/**\n * @since 2.0.0\n */\nexports.duplicate = (0, exports.extend)(function_1.identity);\n/**\n * @category lifting\n * @since 2.10.0\n */\nexports.fromOptionK = \n/*#__PURE__*/ (0, FromEither_1.fromOptionK)(exports.FromEither);\n/**\n * @category sequencing\n * @since 2.11.0\n */\nexports.chainOptionK = (0, FromEither_1.chainOptionK)(exports.FromEither, exports.Chain);\n/**\n * @example\n * import * as E from 'fp-ts/Either'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(\n *   pipe(\n *     E.right(1),\n *     E.filterOrElse(\n *       (n) => n > 0,\n *       () => 'error'\n *     )\n *   ),\n *   E.right(1)\n * )\n * assert.deepStrictEqual(\n *   pipe(\n *     E.right(-1),\n *     E.filterOrElse(\n *       (n) => n > 0,\n *       () => 'error'\n *     )\n *   ),\n *   E.left('error')\n * )\n * assert.deepStrictEqual(\n *   pipe(\n *     E.left('a'),\n *     E.filterOrElse(\n *       (n) => n > 0,\n *       () => 'error'\n *     )\n *   ),\n *   E.left('a')\n * )\n *\n * @category filtering\n * @since 2.0.0\n */\nexports.filterOrElse = (0, FromEither_1.filterOrElse)(exports.FromEither, exports.Chain);\n/**\n * Less strict version of [`filterOrElse`](#filterorelse).\n *\n * The `W` suffix (short for **W**idening) means that the error types will be merged.\n *\n * @category filtering\n * @since 2.9.0\n */\nexports.filterOrElseW = exports.filterOrElse;\n/**\n * Returns a `Right` if is a `Left` (and vice versa).\n *\n * @since 2.0.0\n */\nvar swap = function (ma) { return ((0, exports.isLeft)(ma) ? (0, exports.right)(ma.left) : (0, exports.left)(ma.right)); };\nexports.swap = swap;\n/**\n * Less strict version of [`orElse`](#orelse).\n *\n * The `W` suffix (short for **W**idening) means that the return types will be merged.\n *\n * @category error handling\n * @since 2.10.0\n */\nvar orElseW = function (onLeft) {\n    return function (ma) {\n        return (0, exports.isLeft)(ma) ? onLeft(ma.left) : ma;\n    };\n};\nexports.orElseW = orElseW;\n/**\n * Useful for recovering from errors.\n *\n * @category error handling\n * @since 2.0.0\n */\nexports.orElse = exports.orElseW;\n/**\n * Takes a default and a nullable value, if the value is not nully, turn it into a `Right`, if the value is nully use\n * the provided default as a `Left`.\n *\n * @example\n * import { fromNullable, left, right } from 'fp-ts/Either'\n *\n * const parse = fromNullable('nully')\n *\n * assert.deepStrictEqual(parse(1), right(1))\n * assert.deepStrictEqual(parse(null), left('nully'))\n *\n * @category conversions\n * @since 2.0.0\n */\nvar fromNullable = function (e) {\n    return function (a) {\n        return a == null ? (0, exports.left)(e) : (0, exports.right)(a);\n    };\n};\nexports.fromNullable = fromNullable;\n/**\n * Constructs a new `Either` from a function that might throw.\n *\n * See also [`tryCatchK`](#trycatchk).\n *\n * @example\n * import * as E from 'fp-ts/Either'\n *\n * const unsafeHead = <A>(as: ReadonlyArray<A>): A => {\n *   if (as.length > 0) {\n *     return as[0]\n *   } else {\n *     throw new Error('empty array')\n *   }\n * }\n *\n * const head = <A>(as: ReadonlyArray<A>): E.Either<Error, A> =>\n *   E.tryCatch(() => unsafeHead(as), e => (e instanceof Error ? e : new Error('unknown error')))\n *\n * assert.deepStrictEqual(head([]), E.left(new Error('empty array')))\n * assert.deepStrictEqual(head([1, 2, 3]), E.right(1))\n *\n * @category interop\n * @since 2.0.0\n */\nvar tryCatch = function (f, onThrow) {\n    try {\n        return (0, exports.right)(f());\n    }\n    catch (e) {\n        return (0, exports.left)(onThrow(e));\n    }\n};\nexports.tryCatch = tryCatch;\n/**\n * Converts a function that may throw to one returning a `Either`.\n *\n * @category interop\n * @since 2.10.0\n */\nvar tryCatchK = function (f, onThrow) {\n    return function () {\n        var a = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            a[_i] = arguments[_i];\n        }\n        return (0, exports.tryCatch)(function () { return f.apply(void 0, a); }, onThrow);\n    };\n};\nexports.tryCatchK = tryCatchK;\n/**\n * @category lifting\n * @since 2.9.0\n */\nvar fromNullableK = function (e) {\n    var from = (0, exports.fromNullable)(e);\n    return function (f) { return (0, function_1.flow)(f, from); };\n};\nexports.fromNullableK = fromNullableK;\n/**\n * @category sequencing\n * @since 2.9.0\n */\nvar chainNullableK = function (e) {\n    var from = (0, exports.fromNullableK)(e);\n    return function (f) { return (0, exports.chain)(from(f)); };\n};\nexports.chainNullableK = chainNullableK;\n/**\n * @category conversions\n * @since 2.10.0\n */\nexports.toUnion = (0, exports.foldW)(function_1.identity, function_1.identity);\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * Default value for the `onError` argument of `tryCatch`\n *\n * @since 2.0.0\n */\nfunction toError(e) {\n    return e instanceof Error ? e : new Error(String(e));\n}\nexports.toError = toError;\nfunction elem(E) {\n    return function (a, ma) {\n        if (ma === undefined) {\n            var elemE_1 = elem(E);\n            return function (ma) { return elemE_1(a, ma); };\n        }\n        return (0, exports.isLeft)(ma) ? false : E.equals(a, ma.right);\n    };\n}\nexports.elem = elem;\n/**\n * Returns `false` if `Left` or returns the result of the application of the given predicate to the `Right` value.\n *\n * @example\n * import { exists, left, right } from 'fp-ts/Either'\n *\n * const gt2 = exists((n: number) => n > 2)\n *\n * assert.strictEqual(gt2(left('a')), false)\n * assert.strictEqual(gt2(right(1)), false)\n * assert.strictEqual(gt2(right(3)), true)\n *\n * @since 2.0.0\n */\nvar exists = function (predicate) {\n    return function (ma) {\n        return (0, exports.isLeft)(ma) ? false : predicate(ma.right);\n    };\n};\nexports.exists = exists;\n// -------------------------------------------------------------------------------------\n// do notation\n// -------------------------------------------------------------------------------------\n/**\n * @category do notation\n * @since 2.9.0\n */\nexports.Do = (0, exports.of)(_.emptyRecord);\n/**\n * @category do notation\n * @since 2.8.0\n */\nexports.bindTo = (0, Functor_1.bindTo)(exports.Functor);\nvar let_ = /*#__PURE__*/ (0, Functor_1.let)(exports.Functor);\nexports.let = let_;\n/**\n * @category do notation\n * @since 2.8.0\n */\nexports.bind = (0, Chain_1.bind)(exports.Chain);\n/**\n * The `W` suffix (short for **W**idening) means that the error types will be merged.\n *\n * @category do notation\n * @since 2.8.0\n */\nexports.bindW = exports.bind;\n/**\n * @category do notation\n * @since 2.8.0\n */\nexports.apS = (0, Apply_1.apS)(exports.Apply);\n/**\n * Less strict version of [`apS`](#aps).\n *\n * The `W` suffix (short for **W**idening) means that the error types will be merged.\n *\n * @category do notation\n * @since 2.8.0\n */\nexports.apSW = exports.apS;\n/**\n * @since 2.11.0\n */\nexports.ApT = (0, exports.of)(_.emptyReadonlyArray);\n// -------------------------------------------------------------------------------------\n// array utils\n// -------------------------------------------------------------------------------------\n/**\n * Equivalent to `ReadonlyNonEmptyArray#traverseWithIndex(Applicative)`.\n *\n * @category traversing\n * @since 2.11.0\n */\nvar traverseReadonlyNonEmptyArrayWithIndex = function (f) {\n    return function (as) {\n        var e = f(0, _.head(as));\n        if ((0, exports.isLeft)(e)) {\n            return e;\n        }\n        var out = [e.right];\n        for (var i = 1; i < as.length; i++) {\n            var e_1 = f(i, as[i]);\n            if ((0, exports.isLeft)(e_1)) {\n                return e_1;\n            }\n            out.push(e_1.right);\n        }\n        return (0, exports.right)(out);\n    };\n};\nexports.traverseReadonlyNonEmptyArrayWithIndex = traverseReadonlyNonEmptyArrayWithIndex;\n/**\n * Equivalent to `ReadonlyArray#traverseWithIndex(Applicative)`.\n *\n * @category traversing\n * @since 2.11.0\n */\nvar traverseReadonlyArrayWithIndex = function (f) {\n    var g = (0, exports.traverseReadonlyNonEmptyArrayWithIndex)(f);\n    return function (as) { return (_.isNonEmpty(as) ? g(as) : exports.ApT); };\n};\nexports.traverseReadonlyArrayWithIndex = traverseReadonlyArrayWithIndex;\n/**\n * Equivalent to `ReadonlyArray#traverseWithIndex(Applicative)`.\n *\n * @category traversing\n * @since 2.9.0\n */\nexports.traverseArrayWithIndex = exports.traverseReadonlyArrayWithIndex;\n/**\n * Equivalent to `ReadonlyArray#traverse(Applicative)`.\n *\n * @category traversing\n * @since 2.9.0\n */\nvar traverseArray = function (f) { return (0, exports.traverseReadonlyArrayWithIndex)(function (_, a) { return f(a); }); };\nexports.traverseArray = traverseArray;\n/**\n * Equivalent to `ReadonlyArray#sequence(Applicative)`.\n *\n * @category traversing\n * @since 2.9.0\n */\nexports.sequenceArray = \n/*#__PURE__*/ (0, exports.traverseArray)(function_1.identity);\n/**\n * Use [`parse`](./Json.ts.html#parse) instead.\n *\n * @category zone of death\n * @since 2.0.0\n * @deprecated\n */\nfunction parseJSON(s, onError) {\n    return (0, exports.tryCatch)(function () { return JSON.parse(s); }, onError);\n}\nexports.parseJSON = parseJSON;\n/**\n * Use [`stringify`](./Json.ts.html#stringify) instead.\n *\n * @category zone of death\n * @since 2.0.0\n * @deprecated\n */\nvar stringifyJSON = function (u, onError) {\n    return (0, exports.tryCatch)(function () {\n        var s = JSON.stringify(u);\n        if (typeof s !== 'string') {\n            throw new Error('Converting unsupported structure to JSON');\n        }\n        return s;\n    }, onError);\n};\nexports.stringifyJSON = stringifyJSON;\n/**\n * This instance is deprecated, use small, specific instances instead.\n * For example if a function needs a `Functor` instance, pass `E.Functor` instead of `E.either`\n * (where `E` is from `import E from 'fp-ts/Either'`)\n *\n * @category zone of death\n * @since 2.0.0\n * @deprecated\n */\nexports.either = {\n    URI: exports.URI,\n    map: _map,\n    of: exports.of,\n    ap: _ap,\n    chain: _chain,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence,\n    bimap: _bimap,\n    mapLeft: _mapLeft,\n    alt: _alt,\n    extend: _extend,\n    chainRec: _chainRec,\n    throwError: exports.throwError\n};\n/**\n * Use [`getApplySemigroup`](./Apply.ts.html#getapplysemigroup) instead.\n *\n * Semigroup returning the left-most `Left` value. If both operands are `Right`s then the inner values\n * are concatenated using the provided `Semigroup`\n *\n * @category zone of death\n * @since 2.0.0\n * @deprecated\n */\nexports.getApplySemigroup = \n/*#__PURE__*/ (0, Apply_1.getApplySemigroup)(exports.Apply);\n/**\n * Use [`getApplicativeMonoid`](./Applicative.ts.html#getapplicativemonoid) instead.\n *\n * @category zone of death\n * @since 2.0.0\n * @deprecated\n */\nexports.getApplyMonoid = \n/*#__PURE__*/ (0, Applicative_1.getApplicativeMonoid)(exports.Applicative);\n/**\n * Use [`getApplySemigroup`](./Apply.ts.html#getapplysemigroup) instead.\n *\n * @category zone of death\n * @since 2.0.0\n * @deprecated\n */\nvar getValidationSemigroup = function (SE, SA) {\n    return (0, Apply_1.getApplySemigroup)((0, exports.getApplicativeValidation)(SE))(SA);\n};\nexports.getValidationSemigroup = getValidationSemigroup;\n/**\n * Use [`getApplicativeMonoid`](./Applicative.ts.html#getapplicativemonoid) instead.\n *\n * @category zone of death\n * @since 2.0.0\n * @deprecated\n */\nvar getValidationMonoid = function (SE, MA) {\n    return (0, Applicative_1.getApplicativeMonoid)((0, exports.getApplicativeValidation)(SE))(MA);\n};\nexports.getValidationMonoid = getValidationMonoid;\n/**\n * Use [`getApplicativeValidation`](#getapplicativevalidation) and [`getAltValidation`](#getaltvalidation) instead.\n *\n * @category zone of death\n * @since 2.0.0\n * @deprecated\n */\nfunction getValidation(SE) {\n    var ap = (0, exports.getApplicativeValidation)(SE).ap;\n    var alt = (0, exports.getAltValidation)(SE).alt;\n    return {\n        URI: exports.URI,\n        _E: undefined,\n        map: _map,\n        of: exports.of,\n        chain: _chain,\n        bimap: _bimap,\n        mapLeft: _mapLeft,\n        reduce: _reduce,\n        foldMap: _foldMap,\n        reduceRight: _reduceRight,\n        extend: _extend,\n        traverse: _traverse,\n        sequence: exports.sequence,\n        chainRec: _chainRec,\n        throwError: exports.throwError,\n        ap: ap,\n        alt: alt\n    };\n}\nexports.getValidation = getValidation;\n", "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.partial = exports.PartialType = exports.type = exports.InterfaceType = exports.array = exports.ArrayType = exports.recursion = exports.RecursiveType = exports.Int = exports.brand = exports.RefinementType = exports.keyof = exports.KeyofType = exports.literal = exports.LiteralType = exports.void = exports.undefined = exports.null = exports.UnknownRecord = exports.AnyDictionaryType = exports.UnknownArray = exports.AnyArrayType = exports.boolean = exports.BooleanType = exports.bigint = exports.BigIntType = exports.number = exports.NumberType = exports.string = exports.StringType = exports.unknown = exports.UnknownType = exports.voidType = exports.VoidType = exports.UndefinedType = exports.nullType = exports.NullType = exports.getIndex = exports.getTags = exports.emptyTags = exports.mergeAll = exports.getDomainKeys = exports.appendContext = exports.getContextEntry = exports.getFunctionName = exports.identity = exports.Type = exports.success = exports.failure = exports.failures = void 0;\nexports.alias = exports.clean = exports.StrictType = exports.dictionary = exports.Integer = exports.refinement = exports.object = exports.ObjectType = exports.Dictionary = exports.any = exports.AnyType = exports.never = exports.NeverType = exports.getDefaultContext = exports.getValidationError = exports.interface = exports.Array = exports.taggedUnion = exports.TaggedUnionType = exports.Function = exports.FunctionType = exports.exact = exports.ExactType = exports.strict = exports.readonlyArray = exports.ReadonlyArrayType = exports.readonly = exports.ReadonlyType = exports.tuple = exports.TupleType = exports.intersection = exports.IntersectionType = exports.union = exports.UnionType = exports.record = exports.DictionaryType = void 0;\n/**\n * @since 1.0.0\n */\nvar Either_1 = require(\"fp-ts/lib/Either\");\n/**\n * @category Decode error\n * @since 1.0.0\n */\nexports.failures = Either_1.left;\n/**\n * @category Decode error\n * @since 1.0.0\n */\nvar failure = function (value, context, message) {\n    return exports.failures([{ value: value, context: context, message: message }]);\n};\nexports.failure = failure;\n/**\n * @category Decode error\n * @since 1.0.0\n */\nexports.success = Either_1.right;\n/**\n * @category Codec\n * @since 1.0.0\n */\nvar Type = /** @class */ (function () {\n    function Type(\n    /** a unique name for this codec */\n    name, \n    /** a custom type guard */\n    is, \n    /** succeeds if a value of type I can be decoded to a value of type A */\n    validate, \n    /** converts a value of type A to a value of type O */\n    encode) {\n        this.name = name;\n        this.is = is;\n        this.validate = validate;\n        this.encode = encode;\n        this.decode = this.decode.bind(this);\n    }\n    /**\n     * @since 1.0.0\n     */\n    Type.prototype.pipe = function (ab, name) {\n        var _this = this;\n        if (name === void 0) { name = \"pipe(\" + this.name + \", \" + ab.name + \")\"; }\n        return new Type(name, ab.is, function (i, c) {\n            var e = _this.validate(i, c);\n            if (Either_1.isLeft(e)) {\n                return e;\n            }\n            return ab.validate(e.right, c);\n        }, this.encode === exports.identity && ab.encode === exports.identity ? exports.identity : function (b) { return _this.encode(ab.encode(b)); });\n    };\n    /**\n     * @since 1.0.0\n     */\n    Type.prototype.asDecoder = function () {\n        return this;\n    };\n    /**\n     * @since 1.0.0\n     */\n    Type.prototype.asEncoder = function () {\n        return this;\n    };\n    /**\n     * a version of `validate` with a default context\n     * @since 1.0.0\n     */\n    Type.prototype.decode = function (i) {\n        return this.validate(i, [{ key: '', type: this, actual: i }]);\n    };\n    return Type;\n}());\nexports.Type = Type;\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * @since 1.0.0\n */\nvar identity = function (a) { return a; };\nexports.identity = identity;\n/**\n * @since 1.0.0\n */\nfunction getFunctionName(f) {\n    return f.displayName || f.name || \"<function\" + f.length + \">\";\n}\nexports.getFunctionName = getFunctionName;\n/**\n * @since 1.0.0\n */\nfunction getContextEntry(key, decoder) {\n    return { key: key, type: decoder };\n}\nexports.getContextEntry = getContextEntry;\n/**\n * @since 1.0.0\n */\nfunction appendContext(c, key, decoder, actual) {\n    var len = c.length;\n    var r = Array(len + 1);\n    for (var i = 0; i < len; i++) {\n        r[i] = c[i];\n    }\n    r[len] = { key: key, type: decoder, actual: actual };\n    return r;\n}\nexports.appendContext = appendContext;\nfunction pushAll(xs, ys) {\n    var l = ys.length;\n    for (var i = 0; i < l; i++) {\n        xs.push(ys[i]);\n    }\n}\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nfunction getNameFromProps(props) {\n    return Object.keys(props)\n        .map(function (k) { return k + \": \" + props[k].name; })\n        .join(', ');\n}\nfunction useIdentity(codecs) {\n    for (var i = 0; i < codecs.length; i++) {\n        if (codecs[i].encode !== exports.identity) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction getInterfaceTypeName(props) {\n    return \"{ \" + getNameFromProps(props) + \" }\";\n}\nfunction getPartialTypeName(inner) {\n    return \"Partial<\" + inner + \">\";\n}\nfunction enumerableRecord(keys, domain, codomain, name) {\n    if (name === void 0) { name = \"{ [K in \" + domain.name + \"]: \" + codomain.name + \" }\"; }\n    var len = keys.length;\n    return new DictionaryType(name, function (u) { return exports.UnknownRecord.is(u) && keys.every(function (k) { return codomain.is(u[k]); }); }, function (u, c) {\n        var e = exports.UnknownRecord.validate(u, c);\n        if (Either_1.isLeft(e)) {\n            return e;\n        }\n        var o = e.right;\n        var a = {};\n        var errors = [];\n        var changed = false;\n        for (var i = 0; i < len; i++) {\n            var k = keys[i];\n            var ok = o[k];\n            var codomainResult = codomain.validate(ok, appendContext(c, k, codomain, ok));\n            if (Either_1.isLeft(codomainResult)) {\n                pushAll(errors, codomainResult.left);\n            }\n            else {\n                var vok = codomainResult.right;\n                changed = changed || vok !== ok;\n                a[k] = vok;\n            }\n        }\n        return errors.length > 0 ? exports.failures(errors) : exports.success((changed || Object.keys(o).length !== len ? a : o));\n    }, codomain.encode === exports.identity\n        ? exports.identity\n        : function (a) {\n            var s = {};\n            for (var i = 0; i < len; i++) {\n                var k = keys[i];\n                s[k] = codomain.encode(a[k]);\n            }\n            return s;\n        }, domain, codomain);\n}\n/**\n * @internal\n */\nfunction getDomainKeys(domain) {\n    var _a;\n    if (isLiteralC(domain)) {\n        var literal_1 = domain.value;\n        if (exports.string.is(literal_1)) {\n            return _a = {}, _a[literal_1] = null, _a;\n        }\n    }\n    else if (isKeyofC(domain)) {\n        return domain.keys;\n    }\n    else if (isUnionC(domain)) {\n        var keys = domain.types.map(function (type) { return getDomainKeys(type); });\n        return keys.some(undefinedType.is) ? undefined : Object.assign.apply(Object, __spreadArrays([{}], keys));\n    }\n    return undefined;\n}\nexports.getDomainKeys = getDomainKeys;\nfunction nonEnumerableRecord(domain, codomain, name) {\n    if (name === void 0) { name = \"{ [K in \" + domain.name + \"]: \" + codomain.name + \" }\"; }\n    return new DictionaryType(name, function (u) {\n        if (exports.UnknownRecord.is(u)) {\n            return Object.keys(u).every(function (k) { return domain.is(k) && codomain.is(u[k]); });\n        }\n        return isAnyC(codomain) && Array.isArray(u);\n    }, function (u, c) {\n        if (exports.UnknownRecord.is(u)) {\n            var a = {};\n            var errors = [];\n            var keys = Object.keys(u);\n            var len = keys.length;\n            var changed = false;\n            for (var i = 0; i < len; i++) {\n                var k = keys[i];\n                var ok = u[k];\n                var domainResult = domain.validate(k, appendContext(c, k, domain, k));\n                if (Either_1.isLeft(domainResult)) {\n                    pushAll(errors, domainResult.left);\n                }\n                else {\n                    var vk = domainResult.right;\n                    changed = changed || vk !== k;\n                    k = vk;\n                    var codomainResult = codomain.validate(ok, appendContext(c, k, codomain, ok));\n                    if (Either_1.isLeft(codomainResult)) {\n                        pushAll(errors, codomainResult.left);\n                    }\n                    else {\n                        var vok = codomainResult.right;\n                        changed = changed || vok !== ok;\n                        a[k] = vok;\n                    }\n                }\n            }\n            return errors.length > 0 ? exports.failures(errors) : exports.success((changed ? a : u));\n        }\n        if (isAnyC(codomain) && Array.isArray(u)) {\n            return exports.success(u);\n        }\n        return exports.failure(u, c);\n    }, domain.encode === exports.identity && codomain.encode === exports.identity\n        ? exports.identity\n        : function (a) {\n            var s = {};\n            var keys = Object.keys(a);\n            var len = keys.length;\n            for (var i = 0; i < len; i++) {\n                var k = keys[i];\n                s[String(domain.encode(k))] = codomain.encode(a[k]);\n            }\n            return s;\n        }, domain, codomain);\n}\nfunction getUnionName(codecs) {\n    return '(' + codecs.map(function (type) { return type.name; }).join(' | ') + ')';\n}\n/**\n * @internal\n */\nfunction mergeAll(base, us) {\n    var equal = true;\n    var primitive = true;\n    var baseIsNotADictionary = !exports.UnknownRecord.is(base);\n    for (var _i = 0, us_1 = us; _i < us_1.length; _i++) {\n        var u = us_1[_i];\n        if (u !== base) {\n            equal = false;\n        }\n        if (exports.UnknownRecord.is(u)) {\n            primitive = false;\n        }\n    }\n    if (equal) {\n        return base;\n    }\n    else if (primitive) {\n        return us[us.length - 1];\n    }\n    var r = {};\n    for (var _a = 0, us_2 = us; _a < us_2.length; _a++) {\n        var u = us_2[_a];\n        for (var k in u) {\n            if (!r.hasOwnProperty(k) || baseIsNotADictionary || u[k] !== base[k]) {\n                r[k] = u[k];\n            }\n        }\n    }\n    return r;\n}\nexports.mergeAll = mergeAll;\nfunction getProps(codec) {\n    switch (codec._tag) {\n        case 'RefinementType':\n        case 'ReadonlyType':\n            return getProps(codec.type);\n        case 'InterfaceType':\n        case 'StrictType':\n        case 'PartialType':\n            return codec.props;\n        case 'IntersectionType':\n            return codec.types.reduce(function (props, type) { return Object.assign(props, getProps(type)); }, {});\n    }\n}\nfunction stripKeys(o, props) {\n    var keys = Object.getOwnPropertyNames(o);\n    var shouldStrip = false;\n    var r = {};\n    for (var i = 0; i < keys.length; i++) {\n        var key = keys[i];\n        if (!hasOwnProperty.call(props, key)) {\n            shouldStrip = true;\n        }\n        else {\n            r[key] = o[key];\n        }\n    }\n    return shouldStrip ? r : o;\n}\nfunction getExactTypeName(codec) {\n    if (isTypeC(codec)) {\n        return \"{| \" + getNameFromProps(codec.props) + \" |}\";\n    }\n    else if (isPartialC(codec)) {\n        return getPartialTypeName(\"{| \" + getNameFromProps(codec.props) + \" |}\");\n    }\n    return \"Exact<\" + codec.name + \">\";\n}\nfunction isNonEmpty(as) {\n    return as.length > 0;\n}\n/**\n * @internal\n */\nexports.emptyTags = {};\nfunction intersect(a, b) {\n    var r = [];\n    for (var _i = 0, a_1 = a; _i < a_1.length; _i++) {\n        var v = a_1[_i];\n        if (b.indexOf(v) !== -1) {\n            r.push(v);\n        }\n    }\n    return r;\n}\nfunction mergeTags(a, b) {\n    if (a === exports.emptyTags) {\n        return b;\n    }\n    if (b === exports.emptyTags) {\n        return a;\n    }\n    var r = Object.assign({}, a);\n    for (var k in b) {\n        if (a.hasOwnProperty(k)) {\n            var intersection_1 = intersect(a[k], b[k]);\n            if (isNonEmpty(intersection_1)) {\n                r[k] = intersection_1;\n            }\n            else {\n                r = exports.emptyTags;\n                break;\n            }\n        }\n        else {\n            r[k] = b[k];\n        }\n    }\n    return r;\n}\nfunction intersectTags(a, b) {\n    if (a === exports.emptyTags || b === exports.emptyTags) {\n        return exports.emptyTags;\n    }\n    var r = exports.emptyTags;\n    for (var k in a) {\n        if (b.hasOwnProperty(k)) {\n            var intersection_2 = intersect(a[k], b[k]);\n            if (intersection_2.length === 0) {\n                if (r === exports.emptyTags) {\n                    r = {};\n                }\n                r[k] = a[k].concat(b[k]);\n            }\n        }\n    }\n    return r;\n}\n// tslint:disable-next-line: deprecation\nfunction isAnyC(codec) {\n    return codec._tag === 'AnyType';\n}\nfunction isLiteralC(codec) {\n    return codec._tag === 'LiteralType';\n}\nfunction isKeyofC(codec) {\n    return codec._tag === 'KeyofType';\n}\nfunction isTypeC(codec) {\n    return codec._tag === 'InterfaceType';\n}\nfunction isPartialC(codec) {\n    return codec._tag === 'PartialType';\n}\n// tslint:disable-next-line: deprecation\nfunction isStrictC(codec) {\n    return codec._tag === 'StrictType';\n}\nfunction isExactC(codec) {\n    return codec._tag === 'ExactType';\n}\n// tslint:disable-next-line: deprecation\nfunction isRefinementC(codec) {\n    return codec._tag === 'RefinementType';\n}\nfunction isIntersectionC(codec) {\n    return codec._tag === 'IntersectionType';\n}\nfunction isUnionC(codec) {\n    return codec._tag === 'UnionType';\n}\nfunction isRecursiveC(codec) {\n    return codec._tag === 'RecursiveType';\n}\nvar lazyCodecs = [];\n/**\n * @internal\n */\nfunction getTags(codec) {\n    if (lazyCodecs.indexOf(codec) !== -1) {\n        return exports.emptyTags;\n    }\n    if (isTypeC(codec) || isStrictC(codec)) {\n        var index = exports.emptyTags;\n        // tslint:disable-next-line: forin\n        for (var k in codec.props) {\n            var prop = codec.props[k];\n            if (isLiteralC(prop)) {\n                if (index === exports.emptyTags) {\n                    index = {};\n                }\n                index[k] = [prop.value];\n            }\n        }\n        return index;\n    }\n    else if (isExactC(codec) || isRefinementC(codec)) {\n        return getTags(codec.type);\n    }\n    else if (isIntersectionC(codec)) {\n        return codec.types.reduce(function (tags, codec) { return mergeTags(tags, getTags(codec)); }, exports.emptyTags);\n    }\n    else if (isUnionC(codec)) {\n        return codec.types.slice(1).reduce(function (tags, codec) { return intersectTags(tags, getTags(codec)); }, getTags(codec.types[0]));\n    }\n    else if (isRecursiveC(codec)) {\n        lazyCodecs.push(codec);\n        var tags = getTags(codec.type);\n        lazyCodecs.pop();\n        return tags;\n    }\n    return exports.emptyTags;\n}\nexports.getTags = getTags;\n/**\n * @internal\n */\nfunction getIndex(codecs) {\n    var tags = getTags(codecs[0]);\n    var keys = Object.keys(tags);\n    var len = codecs.length;\n    var _loop_1 = function (k) {\n        var all = tags[k].slice();\n        var index = [tags[k]];\n        for (var i = 1; i < len; i++) {\n            var codec = codecs[i];\n            var ctags = getTags(codec);\n            var values = ctags[k];\n            // tslint:disable-next-line: strict-type-predicates\n            if (values === undefined) {\n                return \"continue-keys\";\n            }\n            else {\n                if (values.some(function (v) { return all.indexOf(v) !== -1; })) {\n                    return \"continue-keys\";\n                }\n                else {\n                    all.push.apply(all, values);\n                    index.push(values);\n                }\n            }\n        }\n        return { value: [k, index] };\n    };\n    keys: for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n        var k = keys_1[_i];\n        var state_1 = _loop_1(k);\n        if (typeof state_1 === \"object\")\n            return state_1.value;\n        switch (state_1) {\n            case \"continue-keys\": continue keys;\n        }\n    }\n    return undefined;\n}\nexports.getIndex = getIndex;\n// -------------------------------------------------------------------------------------\n// primitives\n// -------------------------------------------------------------------------------------\n/**\n * @since 1.0.0\n */\nvar NullType = /** @class */ (function (_super) {\n    __extends(NullType, _super);\n    function NullType() {\n        var _this = _super.call(this, 'null', function (u) { return u === null; }, function (u, c) { return (_this.is(u) ? exports.success(u) : exports.failure(u, c)); }, exports.identity) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'NullType';\n        return _this;\n    }\n    return NullType;\n}(Type));\nexports.NullType = NullType;\n/**\n * @category primitives\n * @since 1.0.0\n */\nexports.nullType = new NullType();\nexports.null = exports.nullType;\n/**\n * @since 1.0.0\n */\nvar UndefinedType = /** @class */ (function (_super) {\n    __extends(UndefinedType, _super);\n    function UndefinedType() {\n        var _this = _super.call(this, 'undefined', function (u) { return u === void 0; }, function (u, c) { return (_this.is(u) ? exports.success(u) : exports.failure(u, c)); }, exports.identity) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'UndefinedType';\n        return _this;\n    }\n    return UndefinedType;\n}(Type));\nexports.UndefinedType = UndefinedType;\nvar undefinedType = new UndefinedType();\nexports.undefined = undefinedType;\n/**\n * @since 1.2.0\n */\nvar VoidType = /** @class */ (function (_super) {\n    __extends(VoidType, _super);\n    function VoidType() {\n        var _this = _super.call(this, 'void', undefinedType.is, undefinedType.validate, exports.identity) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'VoidType';\n        return _this;\n    }\n    return VoidType;\n}(Type));\nexports.VoidType = VoidType;\n/**\n * @category primitives\n * @since 1.2.0\n */\nexports.voidType = new VoidType();\nexports.void = exports.voidType;\n/**\n * @since 1.5.0\n */\nvar UnknownType = /** @class */ (function (_super) {\n    __extends(UnknownType, _super);\n    function UnknownType() {\n        var _this = _super.call(this, 'unknown', function (_) { return true; }, exports.success, exports.identity) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'UnknownType';\n        return _this;\n    }\n    return UnknownType;\n}(Type));\nexports.UnknownType = UnknownType;\n/**\n * @category primitives\n * @since 1.5.0\n */\nexports.unknown = new UnknownType();\n/**\n * @since 1.0.0\n */\nvar StringType = /** @class */ (function (_super) {\n    __extends(StringType, _super);\n    function StringType() {\n        var _this = _super.call(this, 'string', function (u) { return typeof u === 'string'; }, function (u, c) { return (_this.is(u) ? exports.success(u) : exports.failure(u, c)); }, exports.identity) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'StringType';\n        return _this;\n    }\n    return StringType;\n}(Type));\nexports.StringType = StringType;\n/**\n * @category primitives\n * @since 1.0.0\n */\nexports.string = new StringType();\n/**\n * @since 1.0.0\n */\nvar NumberType = /** @class */ (function (_super) {\n    __extends(NumberType, _super);\n    function NumberType() {\n        var _this = _super.call(this, 'number', function (u) { return typeof u === 'number'; }, function (u, c) { return (_this.is(u) ? exports.success(u) : exports.failure(u, c)); }, exports.identity) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'NumberType';\n        return _this;\n    }\n    return NumberType;\n}(Type));\nexports.NumberType = NumberType;\n/**\n * @category primitives\n * @since 1.0.0\n */\nexports.number = new NumberType();\n/**\n * @since 2.1.0\n */\nvar BigIntType = /** @class */ (function (_super) {\n    __extends(BigIntType, _super);\n    function BigIntType() {\n        var _this = _super.call(this, 'bigint', \n        // tslint:disable-next-line: valid-typeof\n        function (u) { return typeof u === 'bigint'; }, function (u, c) { return (_this.is(u) ? exports.success(u) : exports.failure(u, c)); }, exports.identity) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'BigIntType';\n        return _this;\n    }\n    return BigIntType;\n}(Type));\nexports.BigIntType = BigIntType;\n/**\n * @category primitives\n * @since 2.1.0\n */\nexports.bigint = new BigIntType();\n/**\n * @since 1.0.0\n */\nvar BooleanType = /** @class */ (function (_super) {\n    __extends(BooleanType, _super);\n    function BooleanType() {\n        var _this = _super.call(this, 'boolean', function (u) { return typeof u === 'boolean'; }, function (u, c) { return (_this.is(u) ? exports.success(u) : exports.failure(u, c)); }, exports.identity) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'BooleanType';\n        return _this;\n    }\n    return BooleanType;\n}(Type));\nexports.BooleanType = BooleanType;\n/**\n * @category primitives\n * @since 1.0.0\n */\nexports.boolean = new BooleanType();\n/**\n * @since 1.0.0\n */\nvar AnyArrayType = /** @class */ (function (_super) {\n    __extends(AnyArrayType, _super);\n    function AnyArrayType() {\n        var _this = _super.call(this, 'UnknownArray', Array.isArray, function (u, c) { return (_this.is(u) ? exports.success(u) : exports.failure(u, c)); }, exports.identity) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'AnyArrayType';\n        return _this;\n    }\n    return AnyArrayType;\n}(Type));\nexports.AnyArrayType = AnyArrayType;\n/**\n * @category primitives\n * @since 1.7.1\n */\nexports.UnknownArray = new AnyArrayType();\nexports.Array = exports.UnknownArray;\n/**\n * @since 1.0.0\n */\nvar AnyDictionaryType = /** @class */ (function (_super) {\n    __extends(AnyDictionaryType, _super);\n    function AnyDictionaryType() {\n        var _this = _super.call(this, 'UnknownRecord', function (u) {\n            var s = Object.prototype.toString.call(u);\n            return s === '[object Object]' || s === '[object Window]';\n        }, function (u, c) { return (_this.is(u) ? exports.success(u) : exports.failure(u, c)); }, exports.identity) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'AnyDictionaryType';\n        return _this;\n    }\n    return AnyDictionaryType;\n}(Type));\nexports.AnyDictionaryType = AnyDictionaryType;\n/**\n * @category primitives\n * @since 1.7.1\n */\nexports.UnknownRecord = new AnyDictionaryType();\n/**\n * @since 1.0.0\n */\nvar LiteralType = /** @class */ (function (_super) {\n    __extends(LiteralType, _super);\n    function LiteralType(name, is, validate, encode, value) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.value = value;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'LiteralType';\n        return _this;\n    }\n    return LiteralType;\n}(Type));\nexports.LiteralType = LiteralType;\n/**\n * @category constructors\n * @since 1.0.0\n */\nfunction literal(value, name) {\n    if (name === void 0) { name = JSON.stringify(value); }\n    var is = function (u) { return u === value; };\n    return new LiteralType(name, is, function (u, c) { return (is(u) ? exports.success(value) : exports.failure(u, c)); }, exports.identity, value);\n}\nexports.literal = literal;\n/**\n * @since 1.0.0\n */\nvar KeyofType = /** @class */ (function (_super) {\n    __extends(KeyofType, _super);\n    function KeyofType(name, is, validate, encode, keys) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.keys = keys;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'KeyofType';\n        return _this;\n    }\n    return KeyofType;\n}(Type));\nexports.KeyofType = KeyofType;\n/**\n * @category constructors\n * @since 1.0.0\n */\nfunction keyof(keys, name) {\n    if (name === void 0) { name = Object.keys(keys)\n        .map(function (k) { return JSON.stringify(k); })\n        .join(' | '); }\n    var is = function (u) { return exports.string.is(u) && hasOwnProperty.call(keys, u); };\n    return new KeyofType(name, is, function (u, c) { return (is(u) ? exports.success(u) : exports.failure(u, c)); }, exports.identity, keys);\n}\nexports.keyof = keyof;\n// -------------------------------------------------------------------------------------\n// combinators\n// -------------------------------------------------------------------------------------\n/**\n * @since 1.0.0\n */\nvar RefinementType = /** @class */ (function (_super) {\n    __extends(RefinementType, _super);\n    function RefinementType(name, is, validate, encode, type, predicate) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.type = type;\n        _this.predicate = predicate;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'RefinementType';\n        return _this;\n    }\n    return RefinementType;\n}(Type));\nexports.RefinementType = RefinementType;\n/**\n * @category combinators\n * @since 1.8.1\n */\nfunction brand(codec, predicate, name) {\n    // tslint:disable-next-line: deprecation\n    return refinement(codec, predicate, name);\n}\nexports.brand = brand;\n/**\n * A branded codec representing an integer\n *\n * @category primitives\n * @since 1.8.1\n */\nexports.Int = brand(exports.number, function (n) { return Number.isInteger(n); }, 'Int');\n/**\n * @since 1.0.0\n */\nvar RecursiveType = /** @class */ (function (_super) {\n    __extends(RecursiveType, _super);\n    function RecursiveType(name, is, validate, encode, runDefinition) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.runDefinition = runDefinition;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'RecursiveType';\n        return _this;\n    }\n    return RecursiveType;\n}(Type));\nexports.RecursiveType = RecursiveType;\nObject.defineProperty(RecursiveType.prototype, 'type', {\n    get: function () {\n        return this.runDefinition();\n    },\n    enumerable: true,\n    configurable: true\n});\n/**\n * @category combinators\n * @since 1.0.0\n */\nfunction recursion(name, definition) {\n    var cache;\n    var runDefinition = function () {\n        if (!cache) {\n            cache = definition(Self);\n            cache.name = name;\n        }\n        return cache;\n    };\n    var Self = new RecursiveType(name, function (u) { return runDefinition().is(u); }, function (u, c) { return runDefinition().validate(u, c); }, function (a) { return runDefinition().encode(a); }, runDefinition);\n    return Self;\n}\nexports.recursion = recursion;\n/**\n * @since 1.0.0\n */\nvar ArrayType = /** @class */ (function (_super) {\n    __extends(ArrayType, _super);\n    function ArrayType(name, is, validate, encode, type) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.type = type;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'ArrayType';\n        return _this;\n    }\n    return ArrayType;\n}(Type));\nexports.ArrayType = ArrayType;\n/**\n * @category combinators\n * @since 1.0.0\n */\nfunction array(item, name) {\n    if (name === void 0) { name = \"Array<\" + item.name + \">\"; }\n    return new ArrayType(name, function (u) { return exports.UnknownArray.is(u) && u.every(item.is); }, function (u, c) {\n        var e = exports.UnknownArray.validate(u, c);\n        if (Either_1.isLeft(e)) {\n            return e;\n        }\n        var us = e.right;\n        var len = us.length;\n        var as = us;\n        var errors = [];\n        for (var i = 0; i < len; i++) {\n            var ui = us[i];\n            var result = item.validate(ui, appendContext(c, String(i), item, ui));\n            if (Either_1.isLeft(result)) {\n                pushAll(errors, result.left);\n            }\n            else {\n                var ai = result.right;\n                if (ai !== ui) {\n                    if (as === us) {\n                        as = us.slice();\n                    }\n                    as[i] = ai;\n                }\n            }\n        }\n        return errors.length > 0 ? exports.failures(errors) : exports.success(as);\n    }, item.encode === exports.identity ? exports.identity : function (a) { return a.map(item.encode); }, item);\n}\nexports.array = array;\n/**\n * @since 1.0.0\n */\nvar InterfaceType = /** @class */ (function (_super) {\n    __extends(InterfaceType, _super);\n    function InterfaceType(name, is, validate, encode, props) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.props = props;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'InterfaceType';\n        return _this;\n    }\n    return InterfaceType;\n}(Type));\nexports.InterfaceType = InterfaceType;\n/**\n * @category combinators\n * @since 1.0.0\n */\nfunction type(props, name) {\n    if (name === void 0) { name = getInterfaceTypeName(props); }\n    var keys = Object.keys(props);\n    var types = keys.map(function (key) { return props[key]; });\n    var len = keys.length;\n    return new InterfaceType(name, function (u) {\n        if (exports.UnknownRecord.is(u)) {\n            for (var i = 0; i < len; i++) {\n                var k = keys[i];\n                var uk = u[k];\n                if ((uk === undefined && !hasOwnProperty.call(u, k)) || !types[i].is(uk)) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        return false;\n    }, function (u, c) {\n        var e = exports.UnknownRecord.validate(u, c);\n        if (Either_1.isLeft(e)) {\n            return e;\n        }\n        var o = e.right;\n        var a = o;\n        var errors = [];\n        for (var i = 0; i < len; i++) {\n            var k = keys[i];\n            var ak = a[k];\n            var type_1 = types[i];\n            var result = type_1.validate(ak, appendContext(c, k, type_1, ak));\n            if (Either_1.isLeft(result)) {\n                pushAll(errors, result.left);\n            }\n            else {\n                var vak = result.right;\n                if (vak !== ak || (vak === undefined && !hasOwnProperty.call(a, k))) {\n                    /* istanbul ignore next */\n                    if (a === o) {\n                        a = __assign({}, o);\n                    }\n                    a[k] = vak;\n                }\n            }\n        }\n        return errors.length > 0 ? exports.failures(errors) : exports.success(a);\n    }, useIdentity(types)\n        ? exports.identity\n        : function (a) {\n            var s = __assign({}, a);\n            for (var i = 0; i < len; i++) {\n                var k = keys[i];\n                var encode = types[i].encode;\n                if (encode !== exports.identity) {\n                    s[k] = encode(a[k]);\n                }\n            }\n            return s;\n        }, props);\n}\nexports.type = type;\nexports.interface = type;\n/**\n * @since 1.0.0\n */\nvar PartialType = /** @class */ (function (_super) {\n    __extends(PartialType, _super);\n    function PartialType(name, is, validate, encode, props) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.props = props;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'PartialType';\n        return _this;\n    }\n    return PartialType;\n}(Type));\nexports.PartialType = PartialType;\n/**\n * @category combinators\n * @since 1.0.0\n */\nfunction partial(props, name) {\n    if (name === void 0) { name = getPartialTypeName(getInterfaceTypeName(props)); }\n    var keys = Object.keys(props);\n    var types = keys.map(function (key) { return props[key]; });\n    var len = keys.length;\n    return new PartialType(name, function (u) {\n        if (exports.UnknownRecord.is(u)) {\n            for (var i = 0; i < len; i++) {\n                var k = keys[i];\n                var uk = u[k];\n                if (uk !== undefined && !props[k].is(uk)) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        return false;\n    }, function (u, c) {\n        var e = exports.UnknownRecord.validate(u, c);\n        if (Either_1.isLeft(e)) {\n            return e;\n        }\n        var o = e.right;\n        var a = o;\n        var errors = [];\n        for (var i = 0; i < len; i++) {\n            var k = keys[i];\n            var ak = a[k];\n            var type_2 = props[k];\n            var result = type_2.validate(ak, appendContext(c, k, type_2, ak));\n            if (Either_1.isLeft(result)) {\n                if (ak !== undefined) {\n                    pushAll(errors, result.left);\n                }\n            }\n            else {\n                var vak = result.right;\n                if (vak !== ak) {\n                    /* istanbul ignore next */\n                    if (a === o) {\n                        a = __assign({}, o);\n                    }\n                    a[k] = vak;\n                }\n            }\n        }\n        return errors.length > 0 ? exports.failures(errors) : exports.success(a);\n    }, useIdentity(types)\n        ? exports.identity\n        : function (a) {\n            var s = __assign({}, a);\n            for (var i = 0; i < len; i++) {\n                var k = keys[i];\n                var ak = a[k];\n                if (ak !== undefined) {\n                    s[k] = types[i].encode(ak);\n                }\n            }\n            return s;\n        }, props);\n}\nexports.partial = partial;\n/**\n * @since 1.0.0\n */\nvar DictionaryType = /** @class */ (function (_super) {\n    __extends(DictionaryType, _super);\n    function DictionaryType(name, is, validate, encode, domain, codomain) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.domain = domain;\n        _this.codomain = codomain;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'DictionaryType';\n        return _this;\n    }\n    return DictionaryType;\n}(Type));\nexports.DictionaryType = DictionaryType;\n/**\n * @category combinators\n * @since 1.7.1\n */\nfunction record(domain, codomain, name) {\n    var keys = getDomainKeys(domain);\n    return keys\n        ? enumerableRecord(Object.keys(keys), domain, codomain, name)\n        : nonEnumerableRecord(domain, codomain, name);\n}\nexports.record = record;\n/**\n * @since 1.0.0\n */\nvar UnionType = /** @class */ (function (_super) {\n    __extends(UnionType, _super);\n    function UnionType(name, is, validate, encode, types) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.types = types;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'UnionType';\n        return _this;\n    }\n    return UnionType;\n}(Type));\nexports.UnionType = UnionType;\n/**\n * @category combinators\n * @since 1.0.0\n */\nfunction union(codecs, name) {\n    if (name === void 0) { name = getUnionName(codecs); }\n    var index = getIndex(codecs);\n    if (index !== undefined && codecs.length > 0) {\n        var tag_1 = index[0], groups_1 = index[1];\n        var len_1 = groups_1.length;\n        var find_1 = function (value) {\n            for (var i = 0; i < len_1; i++) {\n                if (groups_1[i].indexOf(value) !== -1) {\n                    return i;\n                }\n            }\n            return undefined;\n        };\n        // tslint:disable-next-line: deprecation\n        return new TaggedUnionType(name, function (u) {\n            if (exports.UnknownRecord.is(u)) {\n                var i = find_1(u[tag_1]);\n                return i !== undefined ? codecs[i].is(u) : false;\n            }\n            return false;\n        }, function (u, c) {\n            var e = exports.UnknownRecord.validate(u, c);\n            if (Either_1.isLeft(e)) {\n                return e;\n            }\n            var r = e.right;\n            var i = find_1(r[tag_1]);\n            if (i === undefined) {\n                return exports.failure(u, c);\n            }\n            var codec = codecs[i];\n            return codec.validate(r, appendContext(c, String(i), codec, r));\n        }, useIdentity(codecs)\n            ? exports.identity\n            : function (a) {\n                var i = find_1(a[tag_1]);\n                if (i === undefined) {\n                    // https://github.com/gcanti/io-ts/pull/305\n                    throw new Error(\"no codec found to encode value in union codec \" + name);\n                }\n                else {\n                    return codecs[i].encode(a);\n                }\n            }, codecs, tag_1);\n    }\n    else {\n        return new UnionType(name, function (u) { return codecs.some(function (type) { return type.is(u); }); }, function (u, c) {\n            var errors = [];\n            for (var i = 0; i < codecs.length; i++) {\n                var codec = codecs[i];\n                var result = codec.validate(u, appendContext(c, String(i), codec, u));\n                if (Either_1.isLeft(result)) {\n                    pushAll(errors, result.left);\n                }\n                else {\n                    return exports.success(result.right);\n                }\n            }\n            return exports.failures(errors);\n        }, useIdentity(codecs)\n            ? exports.identity\n            : function (a) {\n                for (var _i = 0, codecs_1 = codecs; _i < codecs_1.length; _i++) {\n                    var codec = codecs_1[_i];\n                    if (codec.is(a)) {\n                        return codec.encode(a);\n                    }\n                }\n                // https://github.com/gcanti/io-ts/pull/305\n                throw new Error(\"no codec found to encode value in union type \" + name);\n            }, codecs);\n    }\n}\nexports.union = union;\n/**\n * @since 1.0.0\n */\nvar IntersectionType = /** @class */ (function (_super) {\n    __extends(IntersectionType, _super);\n    function IntersectionType(name, is, validate, encode, types) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.types = types;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'IntersectionType';\n        return _this;\n    }\n    return IntersectionType;\n}(Type));\nexports.IntersectionType = IntersectionType;\nfunction intersection(codecs, name) {\n    if (name === void 0) { name = \"(\" + codecs.map(function (type) { return type.name; }).join(' & ') + \")\"; }\n    var len = codecs.length;\n    return new IntersectionType(name, function (u) { return codecs.every(function (type) { return type.is(u); }); }, codecs.length === 0\n        ? exports.success\n        : function (u, c) {\n            var us = [];\n            var errors = [];\n            for (var i = 0; i < len; i++) {\n                var codec = codecs[i];\n                var result = codec.validate(u, appendContext(c, String(i), codec, u));\n                if (Either_1.isLeft(result)) {\n                    pushAll(errors, result.left);\n                }\n                else {\n                    us.push(result.right);\n                }\n            }\n            return errors.length > 0 ? exports.failures(errors) : exports.success(mergeAll(u, us));\n        }, codecs.length === 0\n        ? exports.identity\n        : function (a) {\n            return mergeAll(a, codecs.map(function (codec) { return codec.encode(a); }));\n        }, codecs);\n}\nexports.intersection = intersection;\n/**\n * @since 1.0.0\n */\nvar TupleType = /** @class */ (function (_super) {\n    __extends(TupleType, _super);\n    function TupleType(name, is, validate, encode, types) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.types = types;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'TupleType';\n        return _this;\n    }\n    return TupleType;\n}(Type));\nexports.TupleType = TupleType;\nfunction tuple(codecs, name) {\n    if (name === void 0) { name = \"[\" + codecs.map(function (type) { return type.name; }).join(', ') + \"]\"; }\n    var len = codecs.length;\n    return new TupleType(name, function (u) { return exports.UnknownArray.is(u) && u.length === len && codecs.every(function (type, i) { return type.is(u[i]); }); }, function (u, c) {\n        var e = exports.UnknownArray.validate(u, c);\n        if (Either_1.isLeft(e)) {\n            return e;\n        }\n        var us = e.right;\n        var as = us.length > len ? us.slice(0, len) : us; // strip additional components\n        var errors = [];\n        for (var i = 0; i < len; i++) {\n            var a = us[i];\n            var type_3 = codecs[i];\n            var result = type_3.validate(a, appendContext(c, String(i), type_3, a));\n            if (Either_1.isLeft(result)) {\n                pushAll(errors, result.left);\n            }\n            else {\n                var va = result.right;\n                if (va !== a) {\n                    /* istanbul ignore next */\n                    if (as === us) {\n                        as = us.slice();\n                    }\n                    as[i] = va;\n                }\n            }\n        }\n        return errors.length > 0 ? exports.failures(errors) : exports.success(as);\n    }, useIdentity(codecs) ? exports.identity : function (a) { return codecs.map(function (type, i) { return type.encode(a[i]); }); }, codecs);\n}\nexports.tuple = tuple;\n/**\n * @since 1.0.0\n */\nvar ReadonlyType = /** @class */ (function (_super) {\n    __extends(ReadonlyType, _super);\n    function ReadonlyType(name, is, validate, encode, type) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.type = type;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'ReadonlyType';\n        return _this;\n    }\n    return ReadonlyType;\n}(Type));\nexports.ReadonlyType = ReadonlyType;\n/**\n * @category combinators\n * @since 1.0.0\n */\nfunction readonly(codec, name) {\n    if (name === void 0) { name = \"Readonly<\" + codec.name + \">\"; }\n    return new ReadonlyType(name, codec.is, codec.validate, codec.encode, codec);\n}\nexports.readonly = readonly;\n/**\n * @since 1.0.0\n */\nvar ReadonlyArrayType = /** @class */ (function (_super) {\n    __extends(ReadonlyArrayType, _super);\n    function ReadonlyArrayType(name, is, validate, encode, type) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.type = type;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'ReadonlyArrayType';\n        return _this;\n    }\n    return ReadonlyArrayType;\n}(Type));\nexports.ReadonlyArrayType = ReadonlyArrayType;\n/**\n * @category combinators\n * @since 1.0.0\n */\nfunction readonlyArray(item, name) {\n    if (name === void 0) { name = \"ReadonlyArray<\" + item.name + \">\"; }\n    var codec = array(item);\n    return new ReadonlyArrayType(name, codec.is, codec.validate, codec.encode, item);\n}\nexports.readonlyArray = readonlyArray;\n/**\n * Strips additional properties, equivalent to `exact(type(props))`.\n *\n * @category combinators\n * @since 1.0.0\n */\nvar strict = function (props, name) { return exact(type(props), name); };\nexports.strict = strict;\n/**\n * @since 1.1.0\n */\nvar ExactType = /** @class */ (function (_super) {\n    __extends(ExactType, _super);\n    function ExactType(name, is, validate, encode, type) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.type = type;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'ExactType';\n        return _this;\n    }\n    return ExactType;\n}(Type));\nexports.ExactType = ExactType;\n/**\n * Strips additional properties.\n *\n * @category combinators\n * @since 1.1.0\n */\nfunction exact(codec, name) {\n    if (name === void 0) { name = getExactTypeName(codec); }\n    var props = getProps(codec);\n    return new ExactType(name, codec.is, function (u, c) {\n        var e = exports.UnknownRecord.validate(u, c);\n        if (Either_1.isLeft(e)) {\n            return e;\n        }\n        var ce = codec.validate(u, c);\n        if (Either_1.isLeft(ce)) {\n            return ce;\n        }\n        return Either_1.right(stripKeys(ce.right, props));\n    }, function (a) { return codec.encode(stripKeys(a, props)); }, codec);\n}\nexports.exact = exact;\n// -------------------------------------------------------------------------------------\n// deprecated\n// -------------------------------------------------------------------------------------\n/**\n * @since 1.0.0\n * @deprecated\n */\nvar FunctionType = /** @class */ (function (_super) {\n    __extends(FunctionType, _super);\n    function FunctionType() {\n        var _this = _super.call(this, 'Function', \n        // tslint:disable-next-line:strict-type-predicates\n        function (u) { return typeof u === 'function'; }, function (u, c) { return (_this.is(u) ? exports.success(u) : exports.failure(u, c)); }, exports.identity) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'FunctionType';\n        return _this;\n    }\n    return FunctionType;\n}(Type));\nexports.FunctionType = FunctionType;\n/**\n * @category primitives\n * @since 1.0.0\n * @deprecated\n */\n// tslint:disable-next-line: deprecation\nexports.Function = new FunctionType();\n/**\n * @since 1.3.0\n * @deprecated\n */\nvar TaggedUnionType = /** @class */ (function (_super) {\n    __extends(TaggedUnionType, _super);\n    function TaggedUnionType(name, \n    // tslint:disable-next-line: deprecation\n    is, \n    // tslint:disable-next-line: deprecation\n    validate, \n    // tslint:disable-next-line: deprecation\n    encode, codecs, tag) {\n        var _this = _super.call(this, name, is, validate, encode, codecs) /* istanbul ignore next */ // <= workaround for https://github.com/Microsoft/TypeScript/issues/13455\n         || this;\n        _this.tag = tag;\n        return _this;\n    }\n    return TaggedUnionType;\n}(UnionType));\nexports.TaggedUnionType = TaggedUnionType;\n/**\n * Use `union` instead.\n *\n * @category combinators\n * @since 1.3.0\n * @deprecated\n */\nvar taggedUnion = function (tag, codecs, name\n// tslint:disable-next-line: deprecation\n) {\n    if (name === void 0) { name = getUnionName(codecs); }\n    var U = union(codecs, name);\n    // tslint:disable-next-line: deprecation\n    if (U instanceof TaggedUnionType) {\n        return U;\n    }\n    else {\n        console.warn(\"[io-ts] Cannot build a tagged union for \" + name + \", returning a de-optimized union\");\n        // tslint:disable-next-line: deprecation\n        return new TaggedUnionType(name, U.is, U.validate, U.encode, codecs, tag);\n    }\n};\nexports.taggedUnion = taggedUnion;\n/**\n * @since 1.0.0\n * @deprecated\n */\nvar getValidationError /* istanbul ignore next */ = function (value, context) { return ({\n    value: value,\n    context: context\n}); };\nexports.getValidationError /* istanbul ignore next */ = getValidationError;\n/**\n * @since 1.0.0\n * @deprecated\n */\nvar getDefaultContext /* istanbul ignore next */ = function (decoder) { return [\n    { key: '', type: decoder }\n]; };\nexports.getDefaultContext /* istanbul ignore next */ = getDefaultContext;\n/**\n * @since 1.0.0\n * @deprecated\n */\nvar NeverType = /** @class */ (function (_super) {\n    __extends(NeverType, _super);\n    function NeverType() {\n        var _this = _super.call(this, 'never', function (_) { return false; }, function (u, c) { return exports.failure(u, c); }, \n        /* istanbul ignore next */\n        function () {\n            throw new Error('cannot encode never');\n        }) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'NeverType';\n        return _this;\n    }\n    return NeverType;\n}(Type));\nexports.NeverType = NeverType;\n/**\n * @category primitives\n * @since 1.0.0\n * @deprecated\n */\n// tslint:disable-next-line: deprecation\nexports.never = new NeverType();\n/**\n * @since 1.0.0\n * @deprecated\n */\nvar AnyType = /** @class */ (function (_super) {\n    __extends(AnyType, _super);\n    function AnyType() {\n        var _this = _super.call(this, 'any', function (_) { return true; }, exports.success, exports.identity) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'AnyType';\n        return _this;\n    }\n    return AnyType;\n}(Type));\nexports.AnyType = AnyType;\n/**\n * Use `unknown` instead.\n *\n * @category primitives\n * @since 1.0.0\n * @deprecated\n */\n// tslint:disable-next-line: deprecation\nexports.any = new AnyType();\n/**\n * Use `UnknownRecord` instead.\n *\n * @category primitives\n * @since 1.0.0\n * @deprecated\n */\nexports.Dictionary = exports.UnknownRecord;\n/**\n * @since 1.0.0\n * @deprecated\n */\nvar ObjectType = /** @class */ (function (_super) {\n    __extends(ObjectType, _super);\n    function ObjectType() {\n        var _this = _super.call(this, 'object', function (u) { return u !== null && typeof u === 'object'; }, function (u, c) { return (_this.is(u) ? exports.success(u) : exports.failure(u, c)); }, exports.identity) || this;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'ObjectType';\n        return _this;\n    }\n    return ObjectType;\n}(Type));\nexports.ObjectType = ObjectType;\n/**\n * Use `UnknownRecord` instead.\n *\n * @category primitives\n * @since 1.0.0\n * @deprecated\n */\n// tslint:disable-next-line: deprecation\nexports.object = new ObjectType();\n/**\n * Use `brand` instead.\n *\n * @category combinators\n * @since 1.0.0\n * @deprecated\n */\nfunction refinement(codec, predicate, name) {\n    if (name === void 0) { name = \"(\" + codec.name + \" | \" + getFunctionName(predicate) + \")\"; }\n    return new RefinementType(name, function (u) { return codec.is(u) && predicate(u); }, function (i, c) {\n        var e = codec.validate(i, c);\n        if (Either_1.isLeft(e)) {\n            return e;\n        }\n        var a = e.right;\n        return predicate(a) ? exports.success(a) : exports.failure(a, c);\n    }, codec.encode, codec, predicate);\n}\nexports.refinement = refinement;\n/**\n * Use `Int` instead.\n *\n * @category primitives\n * @since 1.0.0\n * @deprecated\n */\n// tslint:disable-next-line: deprecation\nexports.Integer = refinement(exports.number, Number.isInteger, 'Integer');\n/**\n * Use `record` instead.\n *\n * @category combinators\n * @since 1.0.0\n * @deprecated\n */\nexports.dictionary = record;\n/**\n * @since 1.0.0\n * @deprecated\n */\nvar StrictType = /** @class */ (function (_super) {\n    __extends(StrictType, _super);\n    function StrictType(name, \n    // tslint:disable-next-line: deprecation\n    is, \n    // tslint:disable-next-line: deprecation\n    validate, \n    // tslint:disable-next-line: deprecation\n    encode, props) {\n        var _this = _super.call(this, name, is, validate, encode) || this;\n        _this.props = props;\n        /**\n         * @since 1.0.0\n         */\n        _this._tag = 'StrictType';\n        return _this;\n    }\n    return StrictType;\n}(Type));\nexports.StrictType = StrictType;\n/**\n * Drops the codec \"kind\".\n *\n * @category combinators\n * @since 1.1.0\n * @deprecated\n */\nfunction clean(codec) {\n    return codec;\n}\nexports.clean = clean;\nfunction alias(codec) {\n    return function () { return codec; };\n}\nexports.alias = alias;\n", "// This is a generated file. Do not edit.\nmodule.exports.Space_Separator = /[\\u1680\\u2000-\\u200A\\u202F\\u205F\\u3000]/\nmodule.exports.ID_Start = /[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u0860-\\u086A\\u08A0-\\u08B4\\u08B6-\\u08BD\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u09FC\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0AF9\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58-\\u0C5A\\u0C60\\u0C61\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D54-\\u0D56\\u0D5F-\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1C80-\\u1C88\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312E\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FEA\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7AE\\uA7B0-\\uA7B7\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA8FD\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB65\\uAB70-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]|\\uD800[\\uDC00-\\uDC0B\\uDC0D-\\uDC26\\uDC28-\\uDC3A\\uDC3C\\uDC3D\\uDC3F-\\uDC4D\\uDC50-\\uDC5D\\uDC80-\\uDCFA\\uDD40-\\uDD74\\uDE80-\\uDE9C\\uDEA0-\\uDED0\\uDF00-\\uDF1F\\uDF2D-\\uDF4A\\uDF50-\\uDF75\\uDF80-\\uDF9D\\uDFA0-\\uDFC3\\uDFC8-\\uDFCF\\uDFD1-\\uDFD5]|\\uD801[\\uDC00-\\uDC9D\\uDCB0-\\uDCD3\\uDCD8-\\uDCFB\\uDD00-\\uDD27\\uDD30-\\uDD63\\uDE00-\\uDF36\\uDF40-\\uDF55\\uDF60-\\uDF67]|\\uD802[\\uDC00-\\uDC05\\uDC08\\uDC0A-\\uDC35\\uDC37\\uDC38\\uDC3C\\uDC3F-\\uDC55\\uDC60-\\uDC76\\uDC80-\\uDC9E\\uDCE0-\\uDCF2\\uDCF4\\uDCF5\\uDD00-\\uDD15\\uDD20-\\uDD39\\uDD80-\\uDDB7\\uDDBE\\uDDBF\\uDE00\\uDE10-\\uDE13\\uDE15-\\uDE17\\uDE19-\\uDE33\\uDE60-\\uDE7C\\uDE80-\\uDE9C\\uDEC0-\\uDEC7\\uDEC9-\\uDEE4\\uDF00-\\uDF35\\uDF40-\\uDF55\\uDF60-\\uDF72\\uDF80-\\uDF91]|\\uD803[\\uDC00-\\uDC48\\uDC80-\\uDCB2\\uDCC0-\\uDCF2]|\\uD804[\\uDC03-\\uDC37\\uDC83-\\uDCAF\\uDCD0-\\uDCE8\\uDD03-\\uDD26\\uDD50-\\uDD72\\uDD76\\uDD83-\\uDDB2\\uDDC1-\\uDDC4\\uDDDA\\uDDDC\\uDE00-\\uDE11\\uDE13-\\uDE2B\\uDE80-\\uDE86\\uDE88\\uDE8A-\\uDE8D\\uDE8F-\\uDE9D\\uDE9F-\\uDEA8\\uDEB0-\\uDEDE\\uDF05-\\uDF0C\\uDF0F\\uDF10\\uDF13-\\uDF28\\uDF2A-\\uDF30\\uDF32\\uDF33\\uDF35-\\uDF39\\uDF3D\\uDF50\\uDF5D-\\uDF61]|\\uD805[\\uDC00-\\uDC34\\uDC47-\\uDC4A\\uDC80-\\uDCAF\\uDCC4\\uDCC5\\uDCC7\\uDD80-\\uDDAE\\uDDD8-\\uDDDB\\uDE00-\\uDE2F\\uDE44\\uDE80-\\uDEAA\\uDF00-\\uDF19]|\\uD806[\\uDCA0-\\uDCDF\\uDCFF\\uDE00\\uDE0B-\\uDE32\\uDE3A\\uDE50\\uDE5C-\\uDE83\\uDE86-\\uDE89\\uDEC0-\\uDEF8]|\\uD807[\\uDC00-\\uDC08\\uDC0A-\\uDC2E\\uDC40\\uDC72-\\uDC8F\\uDD00-\\uDD06\\uDD08\\uDD09\\uDD0B-\\uDD30\\uDD46]|\\uD808[\\uDC00-\\uDF99]|\\uD809[\\uDC00-\\uDC6E\\uDC80-\\uDD43]|[\\uD80C\\uD81C-\\uD820\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879][\\uDC00-\\uDFFF]|\\uD80D[\\uDC00-\\uDC2E]|\\uD811[\\uDC00-\\uDE46]|\\uD81A[\\uDC00-\\uDE38\\uDE40-\\uDE5E\\uDED0-\\uDEED\\uDF00-\\uDF2F\\uDF40-\\uDF43\\uDF63-\\uDF77\\uDF7D-\\uDF8F]|\\uD81B[\\uDF00-\\uDF44\\uDF50\\uDF93-\\uDF9F\\uDFE0\\uDFE1]|\\uD821[\\uDC00-\\uDFEC]|\\uD822[\\uDC00-\\uDEF2]|\\uD82C[\\uDC00-\\uDD1E\\uDD70-\\uDEFB]|\\uD82F[\\uDC00-\\uDC6A\\uDC70-\\uDC7C\\uDC80-\\uDC88\\uDC90-\\uDC99]|\\uD835[\\uDC00-\\uDC54\\uDC56-\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDEA5\\uDEA8-\\uDEC0\\uDEC2-\\uDEDA\\uDEDC-\\uDEFA\\uDEFC-\\uDF14\\uDF16-\\uDF34\\uDF36-\\uDF4E\\uDF50-\\uDF6E\\uDF70-\\uDF88\\uDF8A-\\uDFA8\\uDFAA-\\uDFC2\\uDFC4-\\uDFCB]|\\uD83A[\\uDC00-\\uDCC4\\uDD00-\\uDD43]|\\uD83B[\\uDE00-\\uDE03\\uDE05-\\uDE1F\\uDE21\\uDE22\\uDE24\\uDE27\\uDE29-\\uDE32\\uDE34-\\uDE37\\uDE39\\uDE3B\\uDE42\\uDE47\\uDE49\\uDE4B\\uDE4D-\\uDE4F\\uDE51\\uDE52\\uDE54\\uDE57\\uDE59\\uDE5B\\uDE5D\\uDE5F\\uDE61\\uDE62\\uDE64\\uDE67-\\uDE6A\\uDE6C-\\uDE72\\uDE74-\\uDE77\\uDE79-\\uDE7C\\uDE7E\\uDE80-\\uDE89\\uDE8B-\\uDE9B\\uDEA1-\\uDEA3\\uDEA5-\\uDEA9\\uDEAB-\\uDEBB]|\\uD869[\\uDC00-\\uDED6\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF34\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]/\nmodule.exports.ID_Continue = /[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u0860-\\u086A\\u08A0-\\u08B4\\u08B6-\\u08BD\\u08D4-\\u08E1\\u08E3-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u09FC\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0AF9-\\u0AFF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58-\\u0C5A\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C80-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D00-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D54-\\u0D57\\u0D5F-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1C80-\\u1C88\\u1CD0-\\u1CD2\\u1CD4-\\u1CF9\\u1D00-\\u1DF9\\u1DFB-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312E\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FEA\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7AE\\uA7B0-\\uA7B7\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C5\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA8FD\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB65\\uAB70-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2F\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]|\\uD800[\\uDC00-\\uDC0B\\uDC0D-\\uDC26\\uDC28-\\uDC3A\\uDC3C\\uDC3D\\uDC3F-\\uDC4D\\uDC50-\\uDC5D\\uDC80-\\uDCFA\\uDD40-\\uDD74\\uDDFD\\uDE80-\\uDE9C\\uDEA0-\\uDED0\\uDEE0\\uDF00-\\uDF1F\\uDF2D-\\uDF4A\\uDF50-\\uDF7A\\uDF80-\\uDF9D\\uDFA0-\\uDFC3\\uDFC8-\\uDFCF\\uDFD1-\\uDFD5]|\\uD801[\\uDC00-\\uDC9D\\uDCA0-\\uDCA9\\uDCB0-\\uDCD3\\uDCD8-\\uDCFB\\uDD00-\\uDD27\\uDD30-\\uDD63\\uDE00-\\uDF36\\uDF40-\\uDF55\\uDF60-\\uDF67]|\\uD802[\\uDC00-\\uDC05\\uDC08\\uDC0A-\\uDC35\\uDC37\\uDC38\\uDC3C\\uDC3F-\\uDC55\\uDC60-\\uDC76\\uDC80-\\uDC9E\\uDCE0-\\uDCF2\\uDCF4\\uDCF5\\uDD00-\\uDD15\\uDD20-\\uDD39\\uDD80-\\uDDB7\\uDDBE\\uDDBF\\uDE00-\\uDE03\\uDE05\\uDE06\\uDE0C-\\uDE13\\uDE15-\\uDE17\\uDE19-\\uDE33\\uDE38-\\uDE3A\\uDE3F\\uDE60-\\uDE7C\\uDE80-\\uDE9C\\uDEC0-\\uDEC7\\uDEC9-\\uDEE6\\uDF00-\\uDF35\\uDF40-\\uDF55\\uDF60-\\uDF72\\uDF80-\\uDF91]|\\uD803[\\uDC00-\\uDC48\\uDC80-\\uDCB2\\uDCC0-\\uDCF2]|\\uD804[\\uDC00-\\uDC46\\uDC66-\\uDC6F\\uDC7F-\\uDCBA\\uDCD0-\\uDCE8\\uDCF0-\\uDCF9\\uDD00-\\uDD34\\uDD36-\\uDD3F\\uDD50-\\uDD73\\uDD76\\uDD80-\\uDDC4\\uDDCA-\\uDDCC\\uDDD0-\\uDDDA\\uDDDC\\uDE00-\\uDE11\\uDE13-\\uDE37\\uDE3E\\uDE80-\\uDE86\\uDE88\\uDE8A-\\uDE8D\\uDE8F-\\uDE9D\\uDE9F-\\uDEA8\\uDEB0-\\uDEEA\\uDEF0-\\uDEF9\\uDF00-\\uDF03\\uDF05-\\uDF0C\\uDF0F\\uDF10\\uDF13-\\uDF28\\uDF2A-\\uDF30\\uDF32\\uDF33\\uDF35-\\uDF39\\uDF3C-\\uDF44\\uDF47\\uDF48\\uDF4B-\\uDF4D\\uDF50\\uDF57\\uDF5D-\\uDF63\\uDF66-\\uDF6C\\uDF70-\\uDF74]|\\uD805[\\uDC00-\\uDC4A\\uDC50-\\uDC59\\uDC80-\\uDCC5\\uDCC7\\uDCD0-\\uDCD9\\uDD80-\\uDDB5\\uDDB8-\\uDDC0\\uDDD8-\\uDDDD\\uDE00-\\uDE40\\uDE44\\uDE50-\\uDE59\\uDE80-\\uDEB7\\uDEC0-\\uDEC9\\uDF00-\\uDF19\\uDF1D-\\uDF2B\\uDF30-\\uDF39]|\\uD806[\\uDCA0-\\uDCE9\\uDCFF\\uDE00-\\uDE3E\\uDE47\\uDE50-\\uDE83\\uDE86-\\uDE99\\uDEC0-\\uDEF8]|\\uD807[\\uDC00-\\uDC08\\uDC0A-\\uDC36\\uDC38-\\uDC40\\uDC50-\\uDC59\\uDC72-\\uDC8F\\uDC92-\\uDCA7\\uDCA9-\\uDCB6\\uDD00-\\uDD06\\uDD08\\uDD09\\uDD0B-\\uDD36\\uDD3A\\uDD3C\\uDD3D\\uDD3F-\\uDD47\\uDD50-\\uDD59]|\\uD808[\\uDC00-\\uDF99]|\\uD809[\\uDC00-\\uDC6E\\uDC80-\\uDD43]|[\\uD80C\\uD81C-\\uD820\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879][\\uDC00-\\uDFFF]|\\uD80D[\\uDC00-\\uDC2E]|\\uD811[\\uDC00-\\uDE46]|\\uD81A[\\uDC00-\\uDE38\\uDE40-\\uDE5E\\uDE60-\\uDE69\\uDED0-\\uDEED\\uDEF0-\\uDEF4\\uDF00-\\uDF36\\uDF40-\\uDF43\\uDF50-\\uDF59\\uDF63-\\uDF77\\uDF7D-\\uDF8F]|\\uD81B[\\uDF00-\\uDF44\\uDF50-\\uDF7E\\uDF8F-\\uDF9F\\uDFE0\\uDFE1]|\\uD821[\\uDC00-\\uDFEC]|\\uD822[\\uDC00-\\uDEF2]|\\uD82C[\\uDC00-\\uDD1E\\uDD70-\\uDEFB]|\\uD82F[\\uDC00-\\uDC6A\\uDC70-\\uDC7C\\uDC80-\\uDC88\\uDC90-\\uDC99\\uDC9D\\uDC9E]|\\uD834[\\uDD65-\\uDD69\\uDD6D-\\uDD72\\uDD7B-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD\\uDE42-\\uDE44]|\\uD835[\\uDC00-\\uDC54\\uDC56-\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDEA5\\uDEA8-\\uDEC0\\uDEC2-\\uDEDA\\uDEDC-\\uDEFA\\uDEFC-\\uDF14\\uDF16-\\uDF34\\uDF36-\\uDF4E\\uDF50-\\uDF6E\\uDF70-\\uDF88\\uDF8A-\\uDFA8\\uDFAA-\\uDFC2\\uDFC4-\\uDFCB\\uDFCE-\\uDFFF]|\\uD836[\\uDE00-\\uDE36\\uDE3B-\\uDE6C\\uDE75\\uDE84\\uDE9B-\\uDE9F\\uDEA1-\\uDEAF]|\\uD838[\\uDC00-\\uDC06\\uDC08-\\uDC18\\uDC1B-\\uDC21\\uDC23\\uDC24\\uDC26-\\uDC2A]|\\uD83A[\\uDC00-\\uDCC4\\uDCD0-\\uDCD6\\uDD00-\\uDD4A\\uDD50-\\uDD59]|\\uD83B[\\uDE00-\\uDE03\\uDE05-\\uDE1F\\uDE21\\uDE22\\uDE24\\uDE27\\uDE29-\\uDE32\\uDE34-\\uDE37\\uDE39\\uDE3B\\uDE42\\uDE47\\uDE49\\uDE4B\\uDE4D-\\uDE4F\\uDE51\\uDE52\\uDE54\\uDE57\\uDE59\\uDE5B\\uDE5D\\uDE5F\\uDE61\\uDE62\\uDE64\\uDE67-\\uDE6A\\uDE6C-\\uDE72\\uDE74-\\uDE77\\uDE79-\\uDE7C\\uDE7E\\uDE80-\\uDE89\\uDE8B-\\uDE9B\\uDEA1-\\uDEA3\\uDEA5-\\uDEA9\\uDEAB-\\uDEBB]|\\uD869[\\uDC00-\\uDED6\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF34\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]|\\uDB40[\\uDD00-\\uDDEF]/\n", "const unicode = require('../lib/unicode')\n\nmodule.exports = {\n    isSpaceSeparator (c) {\n        return typeof c === 'string' && unicode.Space_Separator.test(c)\n    },\n\n    isIdStartChar (c) {\n        return typeof c === 'string' && (\n            (c >= 'a' && c <= 'z') ||\n        (c >= 'A' && c <= 'Z') ||\n        (c === '$') || (c === '_') ||\n        unicode.ID_Start.test(c)\n        )\n    },\n\n    isIdContinueChar (c) {\n        return typeof c === 'string' && (\n            (c >= 'a' && c <= 'z') ||\n        (c >= 'A' && c <= 'Z') ||\n        (c >= '0' && c <= '9') ||\n        (c === '$') || (c === '_') ||\n        (c === '\\u200C') || (c === '\\u200D') ||\n        unicode.ID_Continue.test(c)\n        )\n    },\n\n    isDigit (c) {\n        return typeof c === 'string' && /[0-9]/.test(c)\n    },\n\n    isHexDigit (c) {\n        return typeof c === 'string' && /[0-9A-Fa-f]/.test(c)\n    },\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PathReporter = exports.success = exports.failure = void 0;\nvar _1 = require(\".\");\nvar Either_1 = require(\"fp-ts/lib/Either\");\nfunction stringify(v) {\n    if (typeof v === 'function') {\n        return _1.getFunctionName(v);\n    }\n    if (typeof v === 'number' && !isFinite(v)) {\n        if (isNaN(v)) {\n            return 'NaN';\n        }\n        return v > 0 ? 'Infinity' : '-Infinity';\n    }\n    return JSON.stringify(v);\n}\nfunction getContextPath(context) {\n    return context.map(function (_a) {\n        var key = _a.key, type = _a.type;\n        return key + \": \" + type.name;\n    }).join('/');\n}\nfunction getMessage(e) {\n    return e.message !== undefined\n        ? e.message\n        : \"Invalid value \" + stringify(e.value) + \" supplied to \" + getContextPath(e.context);\n}\n/**\n * @since 1.0.0\n */\nfunction failure(es) {\n    return es.map(getMessage);\n}\nexports.failure = failure;\n/**\n * @since 1.0.0\n */\nfunction success() {\n    return ['No errors!'];\n}\nexports.success = success;\n/**\n * @since 1.0.0\n */\nexports.PathReporter = {\n    report: Either_1.fold(failure, success)\n};\n", "// nb. This is for IE10 and lower _only_.\nvar supportCustomEvent = window.CustomEvent;\nif (!supportCustomEvent || typeof supportCustomEvent === 'object') {\n  supportCustomEvent = function CustomEvent(event, x) {\n    x = x || {};\n    var ev = document.createEvent('CustomEvent');\n    ev.initCustomEvent(event, !!x.bubbles, !!x.cancelable, x.detail || null);\n    return ev;\n  };\n  supportCustomEvent.prototype = window.Event.prototype;\n}\n\n/**\n * Dispatches the passed event to both an \"on<type>\" handler as well as via the\n * normal dispatch operation. Does not bubble.\n *\n * @param {!EventTarget} target\n * @param {!Event} event\n * @return {boolean}\n */\nfunction safeDispatchEvent(target, event) {\n  var check = 'on' + event.type.toLowerCase();\n  if (typeof target[check] === 'function') {\n    target[check](event);\n  }\n  return target.dispatchEvent(event);\n}\n\n/**\n * @param {Element} el to check for stacking context\n * @return {boolean} whether this el or its parents creates a stacking context\n */\nfunction createsStackingContext(el) {\n  while (el && el !== document.body) {\n    var s = window.getComputedStyle(el);\n    var invalid = function(k, ok) {\n      return !(s[k] === undefined || s[k] === ok);\n    };\n\n    if (s.opacity < 1 ||\n        invalid('zIndex', 'auto') ||\n        invalid('transform', 'none') ||\n        invalid('mixBlendMode', 'normal') ||\n        invalid('filter', 'none') ||\n        invalid('perspective', 'none') ||\n        s['isolation'] === 'isolate' ||\n        s.position === 'fixed' ||\n        s.webkitOverflowScrolling === 'touch') {\n      return true;\n    }\n    el = el.parentElement;\n  }\n  return false;\n}\n\n/**\n * Finds the nearest <dialog> from the passed element.\n *\n * @param {Element} el to search from\n * @return {HTMLDialogElement} dialog found\n */\nfunction findNearestDialog(el) {\n  while (el) {\n    if (el.localName === 'dialog') {\n      return /** @type {HTMLDialogElement} */ (el);\n    }\n    if (el.parentElement) {\n      el = el.parentElement;\n    } else if (el.parentNode) {\n      el = el.parentNode.host;\n    } else {\n      el = null;\n    }\n  }\n  return null;\n}\n\n/**\n * Blur the specified element, as long as it's not the HTML body element.\n * This works around an IE9/10 bug - blurring the body causes Windows to\n * blur the whole application.\n *\n * @param {Element} el to blur\n */\nfunction safeBlur(el) {\n  // Find the actual focused element when the active element is inside a shadow root\n  while (el && el.shadowRoot && el.shadowRoot.activeElement) {\n    el = el.shadowRoot.activeElement;\n  }\n\n  if (el && el.blur && el !== document.body) {\n    el.blur();\n  }\n}\n\n/**\n * @param {!NodeList} nodeList to search\n * @param {Node} node to find\n * @return {boolean} whether node is inside nodeList\n */\nfunction inNodeList(nodeList, node) {\n  for (var i = 0; i < nodeList.length; ++i) {\n    if (nodeList[i] === node) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * @param {HTMLFormElement} el to check\n * @return {boolean} whether this form has method=\"dialog\"\n */\nfunction isFormMethodDialog(el) {\n  if (!el || !el.hasAttribute('method')) {\n    return false;\n  }\n  return el.getAttribute('method').toLowerCase() === 'dialog';\n}\n\n/**\n * @param {!DocumentFragment|!Element} hostElement\n * @return {?Element}\n */\nfunction findFocusableElementWithin(hostElement) {\n  // Note that this is 'any focusable area'. This list is probably not exhaustive, but the\n  // alternative involves stepping through and trying to focus everything.\n  var opts = ['button', 'input', 'keygen', 'select', 'textarea'];\n  var query = opts.map(function(el) {\n    return el + ':not([disabled])';\n  });\n  // TODO(samthor): tabindex values that are not numeric are not focusable.\n  query.push('[tabindex]:not([disabled]):not([tabindex=\"\"])');  // tabindex != \"\", not disabled\n  var target = hostElement.querySelector(query.join(', '));\n\n  if (!target && 'attachShadow' in Element.prototype) {\n    // If we haven't found a focusable target, see if the host element contains an element\n    // which has a shadowRoot.\n    // Recursively search for the first focusable item in shadow roots.\n    var elems = hostElement.querySelectorAll('*');\n    for (var i = 0; i < elems.length; i++) {\n      if (elems[i].tagName && elems[i].shadowRoot) {\n        target = findFocusableElementWithin(elems[i].shadowRoot);\n        if (target) {\n          break;\n        }\n      }\n    }\n  }\n  return target;\n}\n\n/**\n * Determines if an element is attached to the DOM.\n * @param {Element} element to check\n * @return {boolean} whether the element is in DOM\n */\nfunction isConnected(element) {\n  return element.isConnected || document.body.contains(element);\n}\n\n/**\n * @param {!Event} event\n * @return {?Element}\n */\nfunction findFormSubmitter(event) {\n  if (event.submitter) {\n    return event.submitter;\n  }\n\n  var form = event.target;\n  if (!(form instanceof HTMLFormElement)) {\n    return null;\n  }\n\n  var submitter = dialogPolyfill.formSubmitter;\n  if (!submitter) {\n    var target = event.target;\n    var root = ('getRootNode' in target && target.getRootNode() || document);\n    submitter = root.activeElement;\n  }\n\n  if (!submitter || submitter.form !== form) {\n    return null;\n  }\n  return submitter;\n}\n\n/**\n * @param {!Event} event\n */\nfunction maybeHandleSubmit(event) {\n  if (event.defaultPrevented) {\n    return;\n  }\n  var form = /** @type {!HTMLFormElement} */ (event.target);\n\n  // We'd have a value if we clicked on an imagemap.\n  var value = dialogPolyfill.imagemapUseValue;\n  var submitter = findFormSubmitter(event);\n  if (value === null && submitter) {\n    value = submitter.value;\n  }\n\n  // There should always be a dialog as this handler is added specifically on them, but check just\n  // in case.\n  var dialog = findNearestDialog(form);\n  if (!dialog) {\n    return;\n  }\n\n  // Prefer formmethod on the button.\n  var formmethod = submitter && submitter.getAttribute('formmethod') || form.getAttribute('method');\n  if (formmethod !== 'dialog') {\n    return;\n  }\n  event.preventDefault();\n\n  if (value != null) {\n    // nb. we explicitly check against null/undefined\n    dialog.close(value);\n  } else {\n    dialog.close();\n  }\n}\n\n/**\n * @param {!HTMLDialogElement} dialog to upgrade\n * @constructor\n */\nfunction dialogPolyfillInfo(dialog) {\n  this.dialog_ = dialog;\n  this.replacedStyleTop_ = false;\n  this.openAsModal_ = false;\n\n  // Set a11y role. Browsers that support dialog implicitly know this already.\n  if (!dialog.hasAttribute('role')) {\n    dialog.setAttribute('role', 'dialog');\n  }\n\n  dialog.show = this.show.bind(this);\n  dialog.showModal = this.showModal.bind(this);\n  dialog.close = this.close.bind(this);\n\n  dialog.addEventListener('submit', maybeHandleSubmit, false);\n\n  if (!('returnValue' in dialog)) {\n    dialog.returnValue = '';\n  }\n\n  if ('MutationObserver' in window) {\n    var mo = new MutationObserver(this.maybeHideModal.bind(this));\n    mo.observe(dialog, {attributes: true, attributeFilter: ['open']});\n  } else {\n    // IE10 and below support. Note that DOMNodeRemoved etc fire _before_ removal. They also\n    // seem to fire even if the element was removed as part of a parent removal. Use the removed\n    // events to force downgrade (useful if removed/immediately added).\n    var removed = false;\n    var cb = function() {\n      removed ? this.downgradeModal() : this.maybeHideModal();\n      removed = false;\n    }.bind(this);\n    var timeout;\n    var delayModel = function(ev) {\n      if (ev.target !== dialog) { return; }  // not for a child element\n      var cand = 'DOMNodeRemoved';\n      removed |= (ev.type.substr(0, cand.length) === cand);\n      window.clearTimeout(timeout);\n      timeout = window.setTimeout(cb, 0);\n    };\n    ['DOMAttrModified', 'DOMNodeRemoved', 'DOMNodeRemovedFromDocument'].forEach(function(name) {\n      dialog.addEventListener(name, delayModel);\n    });\n  }\n  // Note that the DOM is observed inside DialogManager while any dialog\n  // is being displayed as a modal, to catch modal removal from the DOM.\n\n  Object.defineProperty(dialog, 'open', {\n    set: this.setOpen.bind(this),\n    get: dialog.hasAttribute.bind(dialog, 'open')\n  });\n\n  this.backdrop_ = document.createElement('div');\n  this.backdrop_.className = 'backdrop';\n  this.backdrop_.addEventListener('mouseup'  , this.backdropMouseEvent_.bind(this));\n  this.backdrop_.addEventListener('mousedown', this.backdropMouseEvent_.bind(this));\n  this.backdrop_.addEventListener('click'    , this.backdropMouseEvent_.bind(this));\n}\n\ndialogPolyfillInfo.prototype = /** @type {HTMLDialogElement.prototype} */ ({\n\n  get dialog() {\n    return this.dialog_;\n  },\n\n  /**\n   * Maybe remove this dialog from the modal top layer. This is called when\n   * a modal dialog may no longer be tenable, e.g., when the dialog is no\n   * longer open or is no longer part of the DOM.\n   */\n  maybeHideModal: function() {\n    if (this.dialog_.hasAttribute('open') && isConnected(this.dialog_)) { return; }\n    this.downgradeModal();\n  },\n\n  /**\n   * Remove this dialog from the modal top layer, leaving it as a non-modal.\n   */\n  downgradeModal: function() {\n    if (!this.openAsModal_) { return; }\n    this.openAsModal_ = false;\n    this.dialog_.style.zIndex = '';\n\n    // This won't match the native <dialog> exactly because if the user set top on a centered\n    // polyfill dialog, that top gets thrown away when the dialog is closed. Not sure it's\n    // possible to polyfill this perfectly.\n    if (this.replacedStyleTop_) {\n      this.dialog_.style.top = '';\n      this.replacedStyleTop_ = false;\n    }\n\n    // Clear the backdrop and remove from the manager.\n    this.backdrop_.parentNode && this.backdrop_.parentNode.removeChild(this.backdrop_);\n    dialogPolyfill.dm.removeDialog(this);\n  },\n\n  /**\n   * @param {boolean} value whether to open or close this dialog\n   */\n  setOpen: function(value) {\n    if (value) {\n      this.dialog_.hasAttribute('open') || this.dialog_.setAttribute('open', '');\n    } else {\n      this.dialog_.removeAttribute('open');\n      this.maybeHideModal();  // nb. redundant with MutationObserver\n    }\n  },\n\n  /**\n   * Handles mouse events ('mouseup', 'mousedown', 'click') on the fake .backdrop element, redirecting them as if\n   * they were on the dialog itself.\n   *\n   * @param {!Event} e to redirect\n   */\n  backdropMouseEvent_: function(e) {\n    if (!this.dialog_.hasAttribute('tabindex')) {\n      // Clicking on the backdrop should move the implicit cursor, even if dialog cannot be\n      // focused. Create a fake thing to focus on. If the backdrop was _before_ the dialog, this\n      // would not be needed - clicks would move the implicit cursor there.\n      var fake = document.createElement('div');\n      this.dialog_.insertBefore(fake, this.dialog_.firstChild);\n      fake.tabIndex = -1;\n      fake.focus();\n      this.dialog_.removeChild(fake);\n    } else {\n      this.dialog_.focus();\n    }\n\n    var redirectedEvent = document.createEvent('MouseEvents');\n    redirectedEvent.initMouseEvent(e.type, e.bubbles, e.cancelable, window,\n        e.detail, e.screenX, e.screenY, e.clientX, e.clientY, e.ctrlKey,\n        e.altKey, e.shiftKey, e.metaKey, e.button, e.relatedTarget);\n    this.dialog_.dispatchEvent(redirectedEvent);\n    e.stopPropagation();\n  },\n\n  /**\n   * Focuses on the first focusable element within the dialog. This will always blur the current\n   * focus, even if nothing within the dialog is found.\n   */\n  focus_: function() {\n    // Find element with `autofocus` attribute, or fall back to the first form/tabindex control.\n    var target = this.dialog_.querySelector('[autofocus]:not([disabled])');\n    if (!target && this.dialog_.tabIndex >= 0) {\n      target = this.dialog_;\n    }\n    if (!target) {\n      target = findFocusableElementWithin(this.dialog_);\n    }\n    safeBlur(document.activeElement);\n    target && target.focus();\n  },\n\n  /**\n   * Sets the zIndex for the backdrop and dialog.\n   *\n   * @param {number} dialogZ\n   * @param {number} backdropZ\n   */\n  updateZIndex: function(dialogZ, backdropZ) {\n    if (dialogZ < backdropZ) {\n      throw new Error('dialogZ should never be < backdropZ');\n    }\n    this.dialog_.style.zIndex = dialogZ;\n    this.backdrop_.style.zIndex = backdropZ;\n  },\n\n  /**\n   * Shows the dialog. If the dialog is already open, this does nothing.\n   */\n  show: function() {\n    if (!this.dialog_.open) {\n      this.setOpen(true);\n      this.focus_();\n    }\n  },\n\n  /**\n   * Show this dialog modally.\n   */\n  showModal: function() {\n    if (this.dialog_.hasAttribute('open')) {\n      throw new Error('Failed to execute \\'showModal\\' on dialog: The element is already open, and therefore cannot be opened modally.');\n    }\n    if (!isConnected(this.dialog_)) {\n      throw new Error('Failed to execute \\'showModal\\' on dialog: The element is not in a Document.');\n    }\n    if (!dialogPolyfill.dm.pushDialog(this)) {\n      throw new Error('Failed to execute \\'showModal\\' on dialog: There are too many open modal dialogs.');\n    }\n\n    if (createsStackingContext(this.dialog_.parentElement)) {\n      console.warn('A dialog is being shown inside a stacking context. ' +\n          'This may cause it to be unusable. For more information, see this link: ' +\n          'https://github.com/GoogleChrome/dialog-polyfill/#stacking-context');\n    }\n\n    this.setOpen(true);\n    this.openAsModal_ = true;\n\n    // Optionally center vertically, relative to the current viewport.\n    if (dialogPolyfill.needsCentering(this.dialog_)) {\n      dialogPolyfill.reposition(this.dialog_);\n      this.replacedStyleTop_ = true;\n    } else {\n      this.replacedStyleTop_ = false;\n    }\n\n    // Insert backdrop.\n    this.dialog_.parentNode.insertBefore(this.backdrop_, this.dialog_.nextSibling);\n\n    // Focus on whatever inside the dialog.\n    this.focus_();\n  },\n\n  /**\n   * Closes this HTMLDialogElement. This is optional vs clearing the open\n   * attribute, however this fires a 'close' event.\n   *\n   * @param {string=} opt_returnValue to use as the returnValue\n   */\n  close: function(opt_returnValue) {\n    if (!this.dialog_.hasAttribute('open')) {\n      throw new Error('Failed to execute \\'close\\' on dialog: The element does not have an \\'open\\' attribute, and therefore cannot be closed.');\n    }\n    this.setOpen(false);\n\n    // Leave returnValue untouched in case it was set directly on the element\n    if (opt_returnValue !== undefined) {\n      this.dialog_.returnValue = opt_returnValue;\n    }\n\n    // Triggering \"close\" event for any attached listeners on the <dialog>.\n    var closeEvent = new supportCustomEvent('close', {\n      bubbles: false,\n      cancelable: false\n    });\n    safeDispatchEvent(this.dialog_, closeEvent);\n  }\n\n});\n\nvar dialogPolyfill = {};\n\ndialogPolyfill.reposition = function(element) {\n  var scrollTop = document.body.scrollTop || document.documentElement.scrollTop;\n  var topValue = scrollTop + (window.innerHeight - element.offsetHeight) / 2;\n  element.style.top = Math.max(scrollTop, topValue) + 'px';\n};\n\ndialogPolyfill.isInlinePositionSetByStylesheet = function(element) {\n  for (var i = 0; i < document.styleSheets.length; ++i) {\n    var styleSheet = document.styleSheets[i];\n    var cssRules = null;\n    // Some browsers throw on cssRules.\n    try {\n      cssRules = styleSheet.cssRules;\n    } catch (e) {}\n    if (!cssRules) { continue; }\n    for (var j = 0; j < cssRules.length; ++j) {\n      var rule = cssRules[j];\n      var selectedNodes = null;\n      // Ignore errors on invalid selector texts.\n      try {\n        selectedNodes = document.querySelectorAll(rule.selectorText);\n      } catch(e) {}\n      if (!selectedNodes || !inNodeList(selectedNodes, element)) {\n        continue;\n      }\n      var cssTop = rule.style.getPropertyValue('top');\n      var cssBottom = rule.style.getPropertyValue('bottom');\n      if ((cssTop && cssTop !== 'auto') || (cssBottom && cssBottom !== 'auto')) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\ndialogPolyfill.needsCentering = function(dialog) {\n  var computedStyle = window.getComputedStyle(dialog);\n  if (computedStyle.position !== 'absolute') {\n    return false;\n  }\n\n  // We must determine whether the top/bottom specified value is non-auto.  In\n  // WebKit/Blink, checking computedStyle.top == 'auto' is sufficient, but\n  // Firefox returns the used value. So we do this crazy thing instead: check\n  // the inline style and then go through CSS rules.\n  if ((dialog.style.top !== 'auto' && dialog.style.top !== '') ||\n      (dialog.style.bottom !== 'auto' && dialog.style.bottom !== '')) {\n    return false;\n  }\n  return !dialogPolyfill.isInlinePositionSetByStylesheet(dialog);\n};\n\n/**\n * @param {!Element} element to force upgrade\n */\ndialogPolyfill.forceRegisterDialog = function(element) {\n  if (window.HTMLDialogElement || element.showModal) {\n    console.warn('This browser already supports <dialog>, the polyfill ' +\n        'may not work correctly', element);\n  }\n  if (element.localName !== 'dialog') {\n    throw new Error('Failed to register dialog: The element is not a dialog.');\n  }\n  new dialogPolyfillInfo(/** @type {!HTMLDialogElement} */ (element));\n};\n\n/**\n * @param {!Element} element to upgrade, if necessary\n */\ndialogPolyfill.registerDialog = function(element) {\n  if (!element.showModal) {\n    dialogPolyfill.forceRegisterDialog(element);\n  }\n};\n\n/**\n * @constructor\n */\ndialogPolyfill.DialogManager = function() {\n  /** @type {!Array<!dialogPolyfillInfo>} */\n  this.pendingDialogStack = [];\n\n  var checkDOM = this.checkDOM_.bind(this);\n\n  // The overlay is used to simulate how a modal dialog blocks the document.\n  // The blocking dialog is positioned on top of the overlay, and the rest of\n  // the dialogs on the pending dialog stack are positioned below it. In the\n  // actual implementation, the modal dialog stacking is controlled by the\n  // top layer, where z-index has no effect.\n  this.overlay = document.createElement('div');\n  this.overlay.className = '_dialog_overlay';\n  this.overlay.addEventListener('click', function(e) {\n    this.forwardTab_ = undefined;\n    e.stopPropagation();\n    checkDOM([]);  // sanity-check DOM\n  }.bind(this));\n\n  this.handleKey_ = this.handleKey_.bind(this);\n  this.handleFocus_ = this.handleFocus_.bind(this);\n\n  this.zIndexLow_ = 100000;\n  this.zIndexHigh_ = 100000 + 150;\n\n  this.forwardTab_ = undefined;\n\n  if ('MutationObserver' in window) {\n    this.mo_ = new MutationObserver(function(records) {\n      var removed = [];\n      records.forEach(function(rec) {\n        for (var i = 0, c; c = rec.removedNodes[i]; ++i) {\n          if (!(c instanceof Element)) {\n            continue;\n          } else if (c.localName === 'dialog') {\n            removed.push(c);\n          }\n          removed = removed.concat(c.querySelectorAll('dialog'));\n        }\n      });\n      removed.length && checkDOM(removed);\n    });\n  }\n};\n\n/**\n * Called on the first modal dialog being shown. Adds the overlay and related\n * handlers.\n */\ndialogPolyfill.DialogManager.prototype.blockDocument = function() {\n  document.documentElement.addEventListener('focus', this.handleFocus_, true);\n  document.addEventListener('keydown', this.handleKey_);\n  this.mo_ && this.mo_.observe(document, {childList: true, subtree: true});\n};\n\n/**\n * Called on the first modal dialog being removed, i.e., when no more modal\n * dialogs are visible.\n */\ndialogPolyfill.DialogManager.prototype.unblockDocument = function() {\n  document.documentElement.removeEventListener('focus', this.handleFocus_, true);\n  document.removeEventListener('keydown', this.handleKey_);\n  this.mo_ && this.mo_.disconnect();\n};\n\n/**\n * Updates the stacking of all known dialogs.\n */\ndialogPolyfill.DialogManager.prototype.updateStacking = function() {\n  var zIndex = this.zIndexHigh_;\n\n  for (var i = 0, dpi; dpi = this.pendingDialogStack[i]; ++i) {\n    dpi.updateZIndex(--zIndex, --zIndex);\n    if (i === 0) {\n      this.overlay.style.zIndex = --zIndex;\n    }\n  }\n\n  // Make the overlay a sibling of the dialog itself.\n  var last = this.pendingDialogStack[0];\n  if (last) {\n    var p = last.dialog.parentNode || document.body;\n    p.appendChild(this.overlay);\n  } else if (this.overlay.parentNode) {\n    this.overlay.parentNode.removeChild(this.overlay);\n  }\n};\n\n/**\n * @param {Element} candidate to check if contained or is the top-most modal dialog\n * @return {boolean} whether candidate is contained in top dialog\n */\ndialogPolyfill.DialogManager.prototype.containedByTopDialog_ = function(candidate) {\n  while (candidate = findNearestDialog(candidate)) {\n    for (var i = 0, dpi; dpi = this.pendingDialogStack[i]; ++i) {\n      if (dpi.dialog === candidate) {\n        return i === 0;  // only valid if top-most\n      }\n    }\n    candidate = candidate.parentElement;\n  }\n  return false;\n};\n\ndialogPolyfill.DialogManager.prototype.handleFocus_ = function(event) {\n  var target = event.composedPath ? event.composedPath()[0] : event.target;\n\n  if (this.containedByTopDialog_(target)) { return; }\n\n  if (document.activeElement === document.documentElement) { return; }\n\n  event.preventDefault();\n  event.stopPropagation();\n  safeBlur(/** @type {Element} */ (target));\n\n  if (this.forwardTab_ === undefined) { return; }  // move focus only from a tab key\n\n  var dpi = this.pendingDialogStack[0];\n  var dialog = dpi.dialog;\n  var position = dialog.compareDocumentPosition(target);\n  if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n    if (this.forwardTab_) {\n      // forward\n      dpi.focus_();\n    } else if (target !== document.documentElement) {\n      // backwards if we're not already focused on <html>\n      document.documentElement.focus();\n    }\n  }\n\n  return false;\n};\n\ndialogPolyfill.DialogManager.prototype.handleKey_ = function(event) {\n  this.forwardTab_ = undefined;\n  if (event.keyCode === 27) {\n    event.preventDefault();\n    event.stopPropagation();\n    var cancelEvent = new supportCustomEvent('cancel', {\n      bubbles: false,\n      cancelable: true\n    });\n    var dpi = this.pendingDialogStack[0];\n    if (dpi && safeDispatchEvent(dpi.dialog, cancelEvent)) {\n      dpi.dialog.close();\n    }\n  } else if (event.keyCode === 9) {\n    this.forwardTab_ = !event.shiftKey;\n  }\n};\n\n/**\n * Finds and downgrades any known modal dialogs that are no longer displayed. Dialogs that are\n * removed and immediately readded don't stay modal, they become normal.\n *\n * @param {!Array<!HTMLDialogElement>} removed that have definitely been removed\n */\ndialogPolyfill.DialogManager.prototype.checkDOM_ = function(removed) {\n  // This operates on a clone because it may cause it to change. Each change also calls\n  // updateStacking, which only actually needs to happen once. But who removes many modal dialogs\n  // at a time?!\n  var clone = this.pendingDialogStack.slice();\n  clone.forEach(function(dpi) {\n    if (removed.indexOf(dpi.dialog) !== -1) {\n      dpi.downgradeModal();\n    } else {\n      dpi.maybeHideModal();\n    }\n  });\n};\n\n/**\n * @param {!dialogPolyfillInfo} dpi\n * @return {boolean} whether the dialog was allowed\n */\ndialogPolyfill.DialogManager.prototype.pushDialog = function(dpi) {\n  var allowed = (this.zIndexHigh_ - this.zIndexLow_) / 2 - 1;\n  if (this.pendingDialogStack.length >= allowed) {\n    return false;\n  }\n  if (this.pendingDialogStack.unshift(dpi) === 1) {\n    this.blockDocument();\n  }\n  this.updateStacking();\n  return true;\n};\n\n/**\n * @param {!dialogPolyfillInfo} dpi\n */\ndialogPolyfill.DialogManager.prototype.removeDialog = function(dpi) {\n  var index = this.pendingDialogStack.indexOf(dpi);\n  if (index === -1) { return; }\n\n  this.pendingDialogStack.splice(index, 1);\n  if (this.pendingDialogStack.length === 0) {\n    this.unblockDocument();\n  }\n  this.updateStacking();\n};\n\ndialogPolyfill.dm = new dialogPolyfill.DialogManager();\ndialogPolyfill.formSubmitter = null;\ndialogPolyfill.imagemapUseValue = null;\n\n/**\n * Installs global handlers, such as click listers and native method overrides. These are needed\n * even if a no dialog is registered, as they deal with <form method=\"dialog\">.\n */\nif (window.HTMLDialogElement === undefined) {\n\n  /**\n   * If HTMLFormElement translates method=\"DIALOG\" into 'get', then replace the descriptor with\n   * one that returns the correct value.\n   */\n  var testForm = document.createElement('form');\n  testForm.setAttribute('method', 'dialog');\n  if (testForm.method !== 'dialog') {\n    var methodDescriptor = Object.getOwnPropertyDescriptor(HTMLFormElement.prototype, 'method');\n    if (methodDescriptor) {\n      // nb. Some older iOS and older PhantomJS fail to return the descriptor. Don't do anything\n      // and don't bother to update the element.\n      var realGet = methodDescriptor.get;\n      methodDescriptor.get = function() {\n        if (isFormMethodDialog(this)) {\n          return 'dialog';\n        }\n        return realGet.call(this);\n      };\n      var realSet = methodDescriptor.set;\n      /** @this {HTMLElement} */\n      methodDescriptor.set = function(v) {\n        if (typeof v === 'string' && v.toLowerCase() === 'dialog') {\n          return this.setAttribute('method', v);\n        }\n        return realSet.call(this, v);\n      };\n      Object.defineProperty(HTMLFormElement.prototype, 'method', methodDescriptor);\n    }\n  }\n\n  /**\n   * Global 'click' handler, to capture the <input type=\"submit\"> or <button> element which has\n   * submitted a <form method=\"dialog\">. Needed as Safari and others don't report this inside\n   * document.activeElement.\n   */\n  document.addEventListener('click', function(ev) {\n    dialogPolyfill.formSubmitter = null;\n    dialogPolyfill.imagemapUseValue = null;\n    if (ev.defaultPrevented) { return; }  // e.g. a submit which prevents default submission\n\n    var target = /** @type {Element} */ (ev.target);\n    if ('composedPath' in ev) {\n      var path = ev.composedPath();\n      target = path.shift() || target;\n    }\n    if (!target || !isFormMethodDialog(target.form)) { return; }\n\n    var valid = (target.type === 'submit' && ['button', 'input'].indexOf(target.localName) > -1);\n    if (!valid) {\n      if (!(target.localName === 'input' && target.type === 'image')) { return; }\n      // this is a <input type=\"image\">, which can submit forms\n      dialogPolyfill.imagemapUseValue = ev.offsetX + ',' + ev.offsetY;\n    }\n\n    var dialog = findNearestDialog(target);\n    if (!dialog) { return; }\n\n    dialogPolyfill.formSubmitter = target;\n\n  }, false);\n\n  /**\n   * Global 'submit' handler. This handles submits of `method=\"dialog\"` which are invalid, i.e.,\n   * outside a dialog. They get prevented.\n   */\n  document.addEventListener('submit', function(ev) {\n    var form = ev.target;\n    var dialog = findNearestDialog(form);\n    if (dialog) {\n      return;  // ignore, handle there\n    }\n\n    var submitter = findFormSubmitter(ev);\n    var formmethod = submitter && submitter.getAttribute('formmethod') || form.getAttribute('method');\n    if (formmethod === 'dialog') {\n      ev.preventDefault();\n    }\n  });\n\n  /**\n   * Replace the native HTMLFormElement.submit() method, as it won't fire the\n   * submit event and give us a chance to respond.\n   */\n  var nativeFormSubmit = HTMLFormElement.prototype.submit;\n  var replacementFormSubmit = function () {\n    if (!isFormMethodDialog(this)) {\n      return nativeFormSubmit.call(this);\n    }\n    var dialog = findNearestDialog(this);\n    dialog && dialog.close();\n  };\n  HTMLFormElement.prototype.submit = replacementFormSubmit;\n}\n\nexport default dialogPolyfill;\n", "// @ts-ignore\nimport LogicEditorTemplate from \"../html/LogicEditorTemplate.html\"\n// @ts-ignore\nimport LogicEditorCSS from \"../css/LogicEditor.css\"\n// @ts-ignore\nimport DialogPolyfillCSS from \"../../node_modules/dialog-polyfill/dist/dialog-polyfill.css\"\n\nimport dialogPolyfill from 'dialog-polyfill'\nimport { saveAs } from 'file-saver'\nimport JSON5 from \"json5\"\nimport * as LZString from \"lz-string\"\nimport * as pngMeta from 'png-metadata-writer'\nimport { ComponentFactory } from \"./ComponentFactory\"\nimport { ComponentList } from \"./ComponentList\"\nimport { ComponentMenu } from \"./ComponentMenu\"\nimport { MessageBar } from \"./MessageBar\"\nimport { MoveManager } from \"./MoveManager\"\nimport { NodeManager } from \"./NodeManager\"\nimport { RecalcManager, RedrawManager } from \"./RedrawRecalcManager\"\nimport { SVGRenderingContext } from \"./SVGRenderingContext\"\nimport { Circuit, PostLoadActions, PostLoadActions_None, PostLoadActions_SnapshotNoStorage, PostLoadActions_SnapshotStorage, Serialization } from \"./Serialization\"\nimport { TestCaseCombinational, TestCaseResult, TestCaseResultMismatch, TestCaseValueMap, TestSuite, TestSuiteResults, TestSuites } from \"./TestSuite\"\nimport { Tests } from \"./Tests\"\nimport { TestsPalette } from \"./TestsPalette\"\nimport { Timeline } from \"./Timeline\"\nimport { TopBar } from \"./TopBar\"\nimport { EditorSelection, PointerDragEvent, UIEventManager } from \"./UIEventManager\"\nimport { UndoManager } from './UndoManager'\nimport { Component, ComponentBase } from \"./components/Component\"\nimport { CustomComponent } from \"./components/CustomComponent\"\nimport { Drawable, DrawableParent, DrawableWithDraggablePosition, DrawableWithPosition, EditTools, GraphicsRendering, Orientation } from \"./components/Drawable\"\nimport { type Input } from \"./components/Input\"\nimport { Rectangle, RectangleDef } from \"./components/Rectangle\"\nimport { LinkManager, Wire, WireStyle, WireStyles } from \"./components/Wire\"\nimport { COLOR_BACKGROUND, COLOR_BACKGROUND_UNUSED_REGION, COLOR_BORDER, COLOR_COMPONENT_BORDER, COLOR_COMPONENT_ID, COLOR_GRID_LINES, COLOR_GRID_LINES_GUIDES, DrawZIndex, GRID_STEP, TextVAlign, USER_COLORS, drawAnchorsAroundComponent as drawAnchorsForComponent, fillTextVAlign, isDarkMode, parseColorToRGBA, setDarkMode, strokeSingleLine, strokeTextVAlign } from \"./drawutils\"\nimport { gallery } from './gallery'\nimport { Modifier, a, attr, attrBuilder, cls, div, emptyMod, href, input, label, mods, option, select, setupSvgIcon, span, style, target, title, type } from \"./htmlgen\"\nimport { makeIcon } from \"./images\"\nimport { DefaultLang, S, getLang, isLang, setLang } from \"./strings\"\nimport { Any, InBrowser, KeysOfByType, LogicValue, UIDisplay, copyToClipboard, deepArrayEquals, formatString, getURLParameter, isArray, isEmbeddedInIframe, isFalsyString, isRecord, isString, isTruthyString, onVisible, pasteFromClipboard, randomString, setDisplay, setVisible, showModal, toggleVisible, validateJson, valuesFromReprForInput } from \"./utils\"\n\n\n\nenum Mode {\n    STATIC,  // cannot interact in any way\n    TRYOUT,  // can change inputs on predefined circuit\n    CONNECT, // can additionnally move preexisting components around and connect them\n    DESIGN,  // can additionally add components from left menu\n    FULL,    // can additionally force output nodes to 'unset' state and draw undetermined dates\n}\n\nconst MIN_MODE_INDEX: number = Mode.STATIC\nconst MAX_MODE_INDEX: number = Mode.FULL\nconst MAX_MODE_WHEN_SINGLETON = Mode.FULL\nconst MAX_MODE_WHEN_EMBEDDED = Mode.DESIGN\nconst DEFAULT_MODE = Mode.DESIGN\n\nconst SINGLETON_INSTANCE_ID = \"_main\"\n\nconst ATTRIBUTE_NAMES = {\n    lang: \"lang\",\n    singleton: \"singleton\", // whether this is the only editor in the page\n    mode: \"mode\",\n    id: \"id\",\n    autosave: \"autosave\", // whether to use localStorage to persist the circuit across page visits\n    norestore: \"norestore\", // to skip restoring from any browser storage\n    hidereset: \"hidereset\",\n    exportformat: \"exportformat\", // differences between MyST and pymarkdown\n    linkedto: \"linkedto\", // query of an element whose text content should be updated with the circuit state\n\n    // these are mirrored in the display options\n    name: \"name\",\n    showonly: \"showonly\",\n    showgatetypes: \"showgatetypes\",\n    showdisconnectedpins: \"showdisconnectedpins\",\n    showtooltips: \"tooltips\",\n\n    src: \"src\",\n    data: \"data\",\n\n    // set on the root div and not the custom element\n    modes: \"modes\", // the space-separated list of cumulative modes whose UI elements should be shown\n    nomodes: \"nomodes\",\n} as const\n\nexport type InitParams = {\n    orient: Orientation\n}\n\nconst DEFAULT_EDITOR_OPTIONS = {\n    name: undefined as string | undefined,\n    showOnly: undefined as undefined | Array<string>,\n    initParams: undefined as undefined | Record<string, Partial<InitParams>>,\n    showGateTypes: false,\n    showDisconnectedPins: false,\n    wireStyle: WireStyles.auto as WireStyle,\n    animateWires: false,\n    hideWireColors: false,\n    hideInputColors: false,\n    hideOutputColors: false,\n    hideMemoryContent: false,\n    hideTooltips: false,\n    groupParallelWires: false,\n    showHiddenWires: false,\n    showAnchors: false,\n    showIDs: false,\n    propagationDelay: 100,\n    allowPausePropagation: false,\n    zoom: 100,\n    origin: [0, 0] as [number, number],\n}\n\nexport type EditorOptions = typeof DEFAULT_EDITOR_OPTIONS\n\nexport const PointerActions = {\n    edit: {\n        cursor: null,\n        paramTypes: [],\n    },\n    move: {\n        cursor: \"move\",\n        paramTypes: [],\n    },\n    delete: {\n        cursor: \"not-allowed\",\n        paramTypes: [],\n    },\n    setanchor: {\n        cursor: \"alias\",\n        paramTypes: Any as [DrawableWithPosition],\n    },\n} as const satisfies Record<string, {\n    cursor: string | null,\n    paramTypes: any[]\n}>\n\nexport type PoionterActionParams<M extends keyof typeof PointerActions> = typeof PointerActions[M][\"paramTypes\"]\n\nexport type PointerAction = keyof typeof PointerActions\n\ntype InitialData = { _type: \"url\", url: string } | { _type: \"json\", json: string } | { _type: \"compressed\", str: string }\n\ntype HighlightedItems = { comps: Component[], wires: Wire[], start: number }\n\nexport type DrawParams = {\n    drawTime: number,\n    drawTimeAnimationFraction: number | undefined,\n    currentCompUnderPointer: Drawable | null,\n    currentSelection: EditorSelection | undefined,\n    highlightedItems: HighlightedItems | undefined,\n    highlightColor: string | undefined,\n    anythingMoving: boolean,\n}\n\nexport type TestSuiteRunOptions = {\n    doLog?: boolean,\n    fast?: boolean,\n    noUI?: boolean,\n}\n\nexport class LogicEditor extends HTMLElement implements DrawableParent {\n\n    public static _globalListenersInstalled = false\n    private static _spaceDown = false\n    public static get spaceDown() { return LogicEditor._spaceDown }\n\n    public static _allConnectedEditors: Array<LogicEditor> = []\n    public static get allConnectedEditors(): ReadonlyArray<LogicEditor> {\n        return LogicEditor._allConnectedEditors\n    }\n\n    /// Accessible service singletons, defined once per editor ///\n\n    public readonly factory = new ComponentFactory(this)\n    public readonly eventMgr = new UIEventManager(this)\n    public readonly timeline = new Timeline(this)\n\n    /** EditTools are singleton-meant elements that help the general edition process, independently of\n     * whether the editor is showing the main circuit or a CustomComponent. They are thus instantiated\n     * only once by the main LogicEditor and can be accessed statically with `editor.editTools.xyz`\n     * when needed. If, however, certain actions are done inside a circuit currently not being edited\n     * (e.g., a CustomComponent that is closed, or the main circuit when a CustomComponent is open),\n     * then use the `ifEditing?.xyz` to avoid having unwanted effects. */\n    public readonly editTools: EditTools = {\n        moveMgr: new MoveManager(this),\n        undoMgr: new UndoManager(this),\n        redrawMgr: new RedrawManager(),\n        testsPalette: new TestsPalette(this),\n        setDirty: this.setDirty.bind(this),\n        setToolCursor: this.setToolCursor.bind(this),\n    }\n\n\n    /// DrawableParent implementation ///\n\n    public isMainEditor(): this is LogicEditor { return true }\n    public get editor(): LogicEditor { return this }\n\n    public readonly components = new ComponentList()\n    public readonly nodeMgr = new NodeManager()\n    public readonly testSuites: TestSuites = new TestSuites(this)\n    public readonly linkMgr: LinkManager = new LinkManager(this)\n    public readonly recalcMgr = new RecalcManager()\n\n    private _ifEditing: EditTools | undefined = this.editTools\n    /** See #editTools */\n    public get ifEditing() { return this._ifEditing }\n    public stopEditingThis() { this._ifEditing = undefined }\n    public startEditingThis(tools: EditTools) { this._ifEditing = tools }\n\n\n    /// Other internal state ///\n\n    private _isEmbedded = false\n    private _isSingleton = false\n    public get isSingleton() { return this._isSingleton }\n    /** Mirrors the id HTML attribute, is used to preserve the state across a simple reload with sessionStorage */\n    private _instanceId: string | undefined = undefined\n    public get instanceId() { return this._instanceId }\n    private get persistenceKey() { return this._instanceId === undefined ? undefined : \"logic/\" + this._instanceId }\n    /** Stores the id used for exporting. This is generated once if we are in the standalone editor, or reused if we are in a populated instance */\n    private _idWhenExporting: string | undefined = undefined\n    public get idWhenExporting() { if (this._idWhenExporting === undefined) { this._idWhenExporting = randomString(6) } return this._idWhenExporting }\n    /** Whether localStorage should be used in addition to sessionStorage, saving the state across page visits */\n    private _autosave: boolean = false\n    public get autosave() { return this._autosave }\n    private _norestore: boolean = false\n    private _linkedField: HTMLInputElement | HTMLTextAreaElement | undefined = undefined\n    private _maxInstanceMode: Mode = MAX_MODE_WHEN_EMBEDDED // can be set later\n    private _isDirty = false\n    private _isRunningOrCreatingTests = false // when inputs are being set programmatically over a longer period\n    private _dontHogFocus = false\n    private _mode: Mode = DEFAULT_MODE\n    public get mode() { return this._mode }\n    private _loadedFromStorage: boolean = false\n    private _initialData: InitialData | undefined = undefined\n    private _options: EditorOptions = { ...DEFAULT_EDITOR_OPTIONS }\n    private _hideResetButton = false\n    private _exportformat: string | undefined = undefined\n\n    private _menu: ComponentMenu | undefined = undefined\n    private _topBar: TopBar | undefined = undefined\n    private _messageBar: MessageBar | undefined = undefined\n    private _toolCursor: string | null = null\n    private _highlightedItems: HighlightedItems | undefined = undefined\n    private _nextAnimationFrameHandle: number | null = null\n\n    private _propagationPromise: Promise<void> = Promise.resolve()\n    private _propagationResolve: (() => void) | undefined = undefined\n\n    private _editorRoot: DrawableParent = this\n    /** Either the LogicEditor itself, or a CustomComponent, whichever is being edited right now. */\n    public get editorRoot() { return this._editorRoot }\n\n    public root: ShadowRoot\n    public readonly html: {\n        rootDiv: HTMLDivElement,\n        centerCol: HTMLDivElement,\n        canvasContainer: HTMLElement,\n        mainCanvas: HTMLCanvasElement,\n        leftToolbar: HTMLElement,\n        rightToolbarContainer: HTMLElement,\n        rightResetButton: HTMLButtonElement,\n        tooltipElem: HTMLElement,\n        tooltipContents: HTMLElement,\n        mainContextMenu: HTMLElement,\n        fileChooser: HTMLInputElement,\n        settingsPalette: HTMLElement,\n        embedDialog: HTMLDialogElement,\n        embedUrl: HTMLTextAreaElement,\n        // embedUrlQRCode: HTMLImageElement,\n        embedIframe: HTMLTextAreaElement,\n        embedWebcomp: HTMLTextAreaElement,\n        embedMarkdown: HTMLTextAreaElement,\n    }\n    public optionsHtml: {\n        showGateTypesCheckbox: HTMLInputElement,\n        showDisconnectedPinsCheckbox: HTMLInputElement,\n        wireStylePopup: HTMLSelectElement,\n        animateWiresCheckbox: HTMLInputElement,\n        hideWireColorsCheckbox: HTMLInputElement,\n        hideInputColorsCheckbox: HTMLInputElement,\n        hideOutputColorsCheckbox: HTMLInputElement,\n        hideMemoryContentCheckbox: HTMLInputElement,\n        hideTooltipsCheckbox: HTMLInputElement,\n        groupParallelWiresCheckbox: HTMLInputElement,\n        showHiddenWiresCheckbox: HTMLInputElement,\n        showAnchorsCheckbox: HTMLInputElement,\n        showIdsCheckbox: HTMLInputElement,\n        propagationDelayField: HTMLInputElement,\n        showUserDataLinkContainer: HTMLDivElement,\n    } | undefined = undefined\n    public userdata: string | Record<string, unknown> | undefined = undefined\n\n    private _baseUIDrawingScale = 1\n    private _userDrawingScale = 1\n    public get userDrawingScale() { return this._userDrawingScale }\n    private _translationX = 0\n    public get translationX() { return this._translationX }\n    private _translationY = 0\n    public get translationY() { return this._translationY }\n    public pointerX = -1000 // offscreen at start\n    public pointerY = -1000\n\n    public constructor() {\n        super()\n\n        this.root = this.attachShadow({ mode: 'open' })\n        this.root.appendChild(window.Logic.template.content.cloneNode(true) as HTMLElement)\n\n        const html: typeof this.html = {\n            rootDiv: this.elemWithId(\"logicEditorRoot\"),\n            centerCol: this.elemWithId(\"centerCol\"),\n            canvasContainer: this.elemWithId(\"canvas-sim\"),\n            mainCanvas: this.elemWithId(\"mainCanvas\"),\n            leftToolbar: this.elemWithId(\"leftToolbar\"),\n            rightToolbarContainer: this.elemWithId(\"rightToolbarContainer\"),\n            rightResetButton: this.elemWithId(\"rightResetButton\"),\n            tooltipElem: this.elemWithId(\"tooltip\"),\n            tooltipContents: this.elemWithId(\"tooltipContents\"),\n            mainContextMenu: this.elemWithId(\"mainContextMenu\"),\n            settingsPalette: this.elemWithId(\"settingsPalette\"),\n            fileChooser: this.elemWithId(\"fileChooser\"),\n            embedDialog: this.elemWithId(\"embedDialog\"),\n            embedUrl: this.elemWithId(\"embedUrl\"),\n            // embedUrlQRCode: this.elemWithId(\"embedUrlQRCode\"),\n            embedIframe: this.elemWithId(\"embedIframe\"),\n            embedWebcomp: this.elemWithId(\"embedWebcomp\"),\n            embedMarkdown: this.elemWithId(\"embedMarkdown\"),\n        }\n        this.html = html\n        dialogPolyfill.registerDialog(html.embedDialog)\n    }\n\n\n    private elemWithId<E extends Element>(id: string) {\n        let elem = this.root.querySelector(`#${id}`)\n        if (elem === null) {\n            elem = document.querySelector(`#${id}`)\n            if (elem !== null) {\n                console.log(`WARNING found elem with id ${id} in document rather than in shadow root`)\n            }\n        }\n        if (elem === null) {\n            console.log(\"root\", this.root)\n            throw new Error(`Could not find element with id '${id}'`)\n        }\n        return elem as E\n    }\n\n    public static get observedAttributes() {\n        return []\n    }\n\n    public get options(): Readonly<EditorOptions> {\n        return this._options\n    }\n\n    public get documentDisplayName(): string {\n        return this._options.name ?? S.Settings.DefaultFileName\n    }\n\n    public setPartialOptions(opts: Partial<EditorOptions>) {\n        const newOptions = { ...DEFAULT_EDITOR_OPTIONS, ...opts }\n        if (this._isSingleton) {\n            // restore showOnly\n            newOptions.showOnly = this._options.showOnly\n        }\n        this._options = newOptions\n        let optionsHtml\n\n        if ((optionsHtml = this.optionsHtml) !== undefined) {\n            optionsHtml.animateWiresCheckbox.checked = newOptions.animateWires\n            optionsHtml.hideWireColorsCheckbox.checked = newOptions.hideWireColors\n            optionsHtml.hideInputColorsCheckbox.checked = newOptions.hideInputColors\n            optionsHtml.hideOutputColorsCheckbox.checked = newOptions.hideOutputColors\n            optionsHtml.hideMemoryContentCheckbox.checked = newOptions.hideMemoryContent\n            optionsHtml.showGateTypesCheckbox.checked = newOptions.showGateTypes\n            optionsHtml.wireStylePopup.value = newOptions.wireStyle\n            optionsHtml.showDisconnectedPinsCheckbox.checked = newOptions.showDisconnectedPins\n            optionsHtml.hideTooltipsCheckbox.checked = newOptions.hideTooltips\n            optionsHtml.groupParallelWiresCheckbox.checked = newOptions.groupParallelWires\n            optionsHtml.showHiddenWiresCheckbox.checked = newOptions.showHiddenWires\n            optionsHtml.showAnchorsCheckbox.checked = newOptions.showAnchors\n            optionsHtml.showIdsCheckbox.checked = newOptions.showIDs\n            optionsHtml.propagationDelayField.valueAsNumber = newOptions.propagationDelay\n\n            this.setWindowTitleFrom(newOptions.name)\n            this._topBar?.setCircuitName(this.editor.options.name)\n            this._topBar?.setZoom(newOptions.zoom)\n\n            optionsHtml.showUserDataLinkContainer.style.display = this.userdata !== undefined ? \"initial\" : \"none\"\n        }\n\n        this._userDrawingScale = newOptions.zoom / 100\n        this._translationX = -newOptions.origin[0]\n        this._translationY = -newOptions.origin[1]\n\n        this.editTools.redrawMgr.requestRedraw({ why: \"options changed\", invalidateMask: true, invalidateTests: true })\n    }\n\n    private setWindowTitleFrom(docName: string | undefined) {\n        if (!this._isSingleton) {\n            return\n        }\n        const defaultTitle = \"Logic\"\n        if (docName === undefined) {\n            document.title = defaultTitle\n        } else {\n            document.title = `${docName} \u2013 ${defaultTitle}`\n        }\n    }\n\n    public nonDefaultOptions(): undefined | Partial<EditorOptions> {\n        const nonDefaultOpts: Partial<EditorOptions> = {}\n        let set = false\n        for (const [_k, v] of Object.entries(this._options)) {\n            const k = _k as keyof EditorOptions\n            if (!deepArrayEquals(v, DEFAULT_EDITOR_OPTIONS[k])) {\n                nonDefaultOpts[k] = v as any\n                set = true\n            }\n        }\n        return set ? nonDefaultOpts : undefined\n    }\n\n    public runFileChooser(accept: string, callback: (file: File) => void) {\n        const chooser = this.html.fileChooser\n        chooser.setAttribute(\"accept\", accept)\n        chooser.addEventListener(\"change\", () => {\n            const files = this.html.fileChooser.files\n            if (files !== null && files.length > 0) {\n                callback(files[0])\n            }\n        }, { once: true })\n        chooser.click()\n    }\n\n    public setToolCursor(cursor: string | null) {\n        this._toolCursor = cursor\n    }\n\n    private setCanvasSize() {\n        const { canvasContainer, mainCanvas } = this.html\n        mainCanvas.style.setProperty(\"width\", \"0\")\n        mainCanvas.style.setProperty(\"height\", \"0\")\n        const w = canvasContainer.clientWidth\n        const h = canvasContainer.clientHeight\n        const f = window.devicePixelRatio ?? 1\n        mainCanvas.setAttribute(\"width\", String(w * f))\n        mainCanvas.setAttribute(\"height\", String(h * f))\n        mainCanvas.style.setProperty(\"width\", w + \"px\")\n        mainCanvas.style.setProperty(\"height\", h + \"px\")\n        this._baseUIDrawingScale = f\n    }\n\n    public connectedCallback() {\n        if (LogicEditor._allConnectedEditors.length === 0) {\n            // set lang on first instance of editor on the page\n            this.setupLang()\n        }\n        LogicEditor._allConnectedEditors.push(this)\n        this.setup()\n    }\n\n    public disconnectedCallback() {\n        const insts = LogicEditor._allConnectedEditors\n        insts.splice(insts.indexOf(this), 1)\n\n        // TODO\n        // this.eventMgr.unregisterCanvasListenersOn(this.html.mainCanvas)\n    }\n\n    private setupLang() {\n\n        const getNavigatorLanguage = () => {\n            const lang = navigator.languages?.[0] ?? navigator.language\n            if (lang.length > 2) {\n                return lang.substring(0, 2)\n            }\n            if (lang.length === 2) {\n                return lang\n            }\n            return undefined\n        }\n\n        const getSavedLang = () => {\n            return localStorage.getItem(ATTRIBUTE_NAMES.lang)\n        }\n\n        const langStr = (getURLParameter(ATTRIBUTE_NAMES.lang)\n            ?? this.getAttribute(ATTRIBUTE_NAMES.lang)\n            ?? getSavedLang()\n            ?? getNavigatorLanguage()\n            ?? DefaultLang).toLowerCase()\n        const lang = isLang(langStr) ? langStr : DefaultLang\n        setLang(lang)\n    }\n\n    private setup() {\n        const rootDiv = this.html.rootDiv\n        const parentStyles = this.getAttribute(\"style\")\n        if (parentStyles !== null) {\n            rootDiv.setAttribute(\"style\", rootDiv.getAttribute(\"style\") + parentStyles)\n        }\n\n        this._isEmbedded = isEmbeddedInIframe()\n        const singletonAttr = this.getAttribute(ATTRIBUTE_NAMES.singleton)\n        this._isSingleton = !this._isEmbedded && singletonAttr !== null && !isFalsyString(singletonAttr)\n        this._maxInstanceMode = this._isSingleton && !this._isEmbedded ? MAX_MODE_WHEN_SINGLETON : MAX_MODE_WHEN_EMBEDDED\n        this._exportformat = this.getAttribute(ATTRIBUTE_NAMES.exportformat) ?? undefined\n\n        // Transfer from URL param to attributes if we are in singleton mode or embedded with data transferred in the URL\n        if (this._isSingleton || this._isEmbedded) {\n            const transferUrlParamToAttribute = (name: string) => {\n                const value = getURLParameter(name)\n                if (value !== undefined) {\n                    this.setAttribute(name, value)\n                }\n            }\n\n            for (const attr of [\n                ATTRIBUTE_NAMES.mode,\n                ATTRIBUTE_NAMES.id,\n                ATTRIBUTE_NAMES.showonly,\n                ATTRIBUTE_NAMES.showgatetypes,\n                ATTRIBUTE_NAMES.showdisconnectedpins,\n                ATTRIBUTE_NAMES.showtooltips,\n                ATTRIBUTE_NAMES.data,\n                ATTRIBUTE_NAMES.src,\n                ATTRIBUTE_NAMES.hidereset,\n            ]) {\n                transferUrlParamToAttribute(attr)\n            }\n\n            const userParamPrefix = \"user\"\n            const url = new URL(window.location.href)\n            url.searchParams.forEach((value: string, key: string) => {\n                if (key.startsWith(userParamPrefix)) {\n                    key = key.substring(userParamPrefix.length)\n                    if (key.startsWith(\".\")) {\n                        key = key.substring(1)\n                    }\n                    if (key.length === 0) {\n                        this.userdata = value\n                    } else {\n                        key = key[0].toLowerCase() + key.substring(1)\n                        if (typeof this.userdata !== \"object\") {\n                            this.userdata = {}\n                        }\n                        if (key in this.userdata) {\n                            const oldValue = this.userdata[key]\n                            if (isArray(oldValue)) {\n                                oldValue.push(value)\n                            } else {\n                                this.userdata[key] = [oldValue, value]\n                            }\n                        } else {\n                            this.userdata[key] = value\n                        }\n                    }\n                }\n            })\n            if (this.userdata !== undefined) {\n                console.log(\"Custom user data: \", this.userdata)\n            }\n        }\n\n        if (this._isSingleton) {\n            // console.log(\"LogicEditor is in singleton mode\")\n\n            // singletons manage their dark mode according to system settings\n            const darkModeQuery = window.matchMedia(\"(prefers-color-scheme: dark)\")\n            darkModeQuery.onchange = () => {\n                setDarkMode(darkModeQuery.matches, false)\n            }\n            setDarkMode(darkModeQuery.matches, true)\n\n            // reexport some libs\n            window.JSON5 = JSON5\n\n            // make load function available globally\n            window.Logic.singleton = this\n            window.load = this.loadCircuitOrLibrary.bind(this)\n            window.save = this.save.bind(this)\n            window.highlight = this.highlight.bind(this)\n\n            window.logicalTime = () => {\n                const time = this.timeline.logicalTime()\n                // console.log(time)\n                return time\n            }\n\n            const madeBy =\n                div(cls(\"noselect\"), style(\"position: absolute; bottom: 0; right: 0; padding: 5px 3px 2px 5px; color: rgba(128,128,128,0.2); border-radius: 10px 0 0 0; font-size: 69%; font-style: italic;\"),\n                    S.Messages.DevelopedBy + \" \",\n                    a(style(\"color: inherit\"),\n                        href(\"https://github.com/jppellet/Logic-Circuit-Simulator\"), target(\"_blank\"),\n                        \"Jean-Philippe Pellet\"\n                    ),\n                    \", \",\n                    a(style(\"color: inherit\"),\n                        href(\"https://www.hepl.ch/accueil/formation/unites-enseignement-et-recherche/medias-usages-numeriques-et-didactique-de-linformatique.html\"), target(\"_blank\"),\n                        \"HEP Vaud\"\n                    ),\n                ).render()\n\n            // insert as first child\n            this.html.canvasContainer.insertAdjacentElement(\"afterbegin\", madeBy)\n\n            window.onbeforeunload = e => {\n                if (this._isSingleton && this._isDirty && this.mode >= Mode.CONNECT) {\n                    e.preventDefault() // ask to save changes\n                    e.returnValue = S.Messages.ReallyCloseWindow\n                }\n            }\n\n            // if we lose the focus, we grab it back (if we're in singleton mode),\n            // otherwise key events won't be caught\n            this.addEventListener(\"focusout\", () => {\n                if (!this._dontHogFocus) {\n                    this.focus()\n                }\n            })\n\n            this.focus()\n        }\n\n        // Load parameters from attributes\n        let modeAttr = this.getAttribute(ATTRIBUTE_NAMES.mode)\n        if (modeAttr !== null && (modeAttr = modeAttr.toUpperCase()) in Mode) {\n            this._maxInstanceMode = (Mode as any)[modeAttr]\n        }\n\n        const autosaveAttr = this.getAttribute(ATTRIBUTE_NAMES.autosave)\n        this._autosave = autosaveAttr !== null && !isFalsyString(autosaveAttr)\n        const idAttr = this.getAttribute(ATTRIBUTE_NAMES.id)\n        const norestoreAttr = this.getAttribute(ATTRIBUTE_NAMES.norestore)\n        this._norestore = norestoreAttr !== null && !isFalsyString(norestoreAttr)\n\n        if (idAttr !== null || this._isSingleton) {\n            if (idAttr !== null) {\n                this._instanceId = idAttr\n                if (idAttr !== SINGLETON_INSTANCE_ID) {\n                    this._idWhenExporting = idAttr\n                }\n            } else {\n                this._instanceId = SINGLETON_INSTANCE_ID // default id for singleton\n            }\n        } else if (!this._norestore) {\n            const fct = this._autosave ? \"error\" : \"warn\"\n            console[fct](\"No id attribute set on logic-editor, undownloaded state will be lost\", this)\n            this._autosave = false\n        }\n\n        if (this._norestore && this._autosave) {\n            console.warn(\"norestore is set, but autosave is also set; disabling autosave\")\n            this._autosave = false\n        }\n\n        const linkedtoAttr = this.getAttribute(ATTRIBUTE_NAMES.linkedto)\n        if (linkedtoAttr !== null) {\n            this._norestore = false\n            const elem = document.querySelector(linkedtoAttr)\n            if (elem === null || !(elem instanceof HTMLInputElement || elem instanceof HTMLTextAreaElement)) {\n                console.error(`Could not find element matching selector '${linkedtoAttr}' to link to`)\n            } else {\n                console.log(`Linked logic-editor to element '${linkedtoAttr}'`, elem)\n                this._linkedField = elem\n\n                let throttleTimer: NodeJS.Timeout | undefined = undefined\n                elem.addEventListener('input', () => {\n                    if (throttleTimer !== undefined) {\n                        clearTimeout(throttleTimer)\n                    }\n                    throttleTimer = setTimeout(() => {\n                        const json = elem.value\n                        if (json !== null) {\n                            // console.log(\"Loading linkedto content into logic-editor\", json)\n                            this._linkedField = undefined // prevent feedback loop\n                            try {\n                                this.loadCircuitOrLibrary(json)\n                            } finally {\n                                this._linkedField = elem\n                            }\n                        }\n                    }, 1000)\n                })\n\n                if (this._autosave) {\n                    console.warn(\"  Ignoring autosave because linkedto is set\")\n                    this._autosave = false\n                }\n            }\n        }\n\n        const showonlyAttr = this.getAttribute(ATTRIBUTE_NAMES.showonly)\n        if (showonlyAttr !== null) {\n            this._options.showOnly = showonlyAttr.toLowerCase().split(/[, +]+/).filter(x => x.trim())\n        }\n\n        const showgatetypesAttr = this.getAttribute(ATTRIBUTE_NAMES.showgatetypes)\n        if (showgatetypesAttr !== null) {\n            this._options.showGateTypes = isTruthyString(showgatetypesAttr)\n        }\n\n        const showdisconnectedpinsAttr = this.getAttribute(ATTRIBUTE_NAMES.showdisconnectedpins)\n        if (showdisconnectedpinsAttr !== null) {\n            this._options.showDisconnectedPins = isTruthyString(showdisconnectedpinsAttr)\n        }\n\n        const showtooltipsAttr = this.getAttribute(ATTRIBUTE_NAMES.showtooltips)\n        if (showtooltipsAttr !== null) {\n            this._options.hideTooltips = !isFalsyString(showtooltipsAttr)\n        }\n\n        // TODO move this to options so that it is correctly persisted, too\n        this._hideResetButton = this.getAttribute(ATTRIBUTE_NAMES.hidereset) !== null && !isFalsyString(this.getAttribute(ATTRIBUTE_NAMES.hidereset))\n\n        let dataOrSrcRef\n        if ((dataOrSrcRef = this.getAttribute(ATTRIBUTE_NAMES.data)) !== null) {\n            this._initialData = { _type: \"compressed\", str: dataOrSrcRef }\n        } else if ((dataOrSrcRef = this.getAttribute(ATTRIBUTE_NAMES.src)) !== null) {\n            this._initialData = { _type: \"url\", url: dataOrSrcRef }\n        } else {\n\n            const tryLoadFromLightDOM = () => {\n                const innerScriptElem = this.findLightDOMChild(\"script\")\n                if (innerScriptElem !== null) {\n                    this._initialData = { _type: \"json\", json: innerScriptElem.innerHTML }\n                    innerScriptElem.remove() // remove the data element to hide the raw data\n                    // do this manually\n                    const tryLoadStorage = !this._norestore\n                    if (!this._loadedFromStorage) {\n                        this.tryLoadCircuitFromData(tryLoadStorage, PostLoadActions_SnapshotNoStorage)\n                        this.doRedraw(true)\n                    }\n                    return true\n                } else {\n                    return false\n                }\n            }\n\n            // try to load from the children of the light DOM,\n            // but this has to be done later as it hasn't been parsed yet\n            setTimeout(() => {\n                const loaded = tryLoadFromLightDOM()\n\n                // sometimes the light DOM is not parsed yet, so try again a bit later\n                if (!loaded) {\n                    setTimeout(() => {\n                        tryLoadFromLightDOM()\n                    }, 100)\n                }\n            })\n        }\n\n        const setCaption = (buttonId: string, strings: string | [string, string]) => {\n            const elem = this.elemWithId(buttonId)\n            const [name, tooltip] = isString(strings) ? [strings, undefined] : strings\n            elem.insertAdjacentText(\"beforeend\", name)\n            if (tooltip !== undefined) {\n                elem.setAttribute(\"title\", tooltip)\n            }\n        }\n\n        // set strings in the UI\n        const s = S.Dialogs.Share\n        setCaption(\"shareDialogTitle\", s.title)\n        setCaption(\"shareDialogUrl\", s.URL)\n        setCaption(\"shareDialogIframe\", s.EmbedInIframe)\n        setCaption(\"shareDialogWebComp\", s.EmbedWithWebComp)\n        setCaption(\"shareDialogMarkdown\", s.EmbedInMarkdown)\n        setCaption(\"shareDialogClose\", S.Dialogs.Generic.Close)\n\n        this._topBar = new TopBar(this)\n        this._menu = new ComponentMenu(this, this.html.leftToolbar)\n        this._messageBar = new MessageBar(this)\n        const testResultsPalette = this.elemWithId(\"testResultsPalette\")\n        testResultsPalette.parentElement!.replaceChild(this.editTools.testsPalette.rootElem, testResultsPalette)\n\n        // TODO move this to the Def of LabelRect to be cleaner\n        const groupButton = this.html.leftToolbar.querySelector(\"button.sim-component-button[data-type=rect]\")\n        if (groupButton === null) {\n            if (this._options.showOnly === undefined) {\n                // else, it was probably hidden on purpose\n                console.log(\"ERROR: Could not find group button\")\n            }\n        } else {\n            groupButton.addEventListener(\"pointerdown\", this.wrapHandler(e => {\n                const success = this.makeGroupWithSelection()\n                if (success) {\n                    e.preventDefault()\n                    e.stopImmediatePropagation()\n                }\n            }))\n        }\n\n        this.eventMgr.registerCanvasListenersOn(this.html.mainCanvas)\n\n        this.eventMgr.registerButtonListenersOn(this._menu.allFixedButtons(), false)\n\n        this.html.rightResetButton.addEventListener(\"click\", this.wrapHandler(this.resetCircuit.bind(this)))\n\n        const showModeChange = this._maxInstanceMode >= Mode.FULL\n        if (showModeChange) {\n            const modeChangeMenu: HTMLElement = this.elemWithId(\"modeChangeMenu\")!\n            const titleElem = div(cls(\"toolbar-title\"),\n                \"Mode\",\n            ).render()\n            this.eventMgr.registerTitleDragListenersOn(titleElem)\n            mods(\n                titleElem,\n                div(cls(\"btn-group-vertical\"),\n                    ...[Mode.FULL, Mode.DESIGN, Mode.CONNECT, Mode.TRYOUT, Mode.STATIC].map((buttonMode) => {\n                        const [[modeTitle, expl], addElem] = (() => {\n                            switch (buttonMode) {\n                                case Mode.FULL: {\n                                    const optionsDiv =\n                                        div(cls(\"sim-mode-link\"),\n                                            title(S.Settings.Settings),\n                                            makeIcon(\"settings\")\n                                        ).render()\n\n                                    optionsDiv.addEventListener(\"click\", () => {\n                                        toggleVisible(this.html.settingsPalette)\n                                    })\n\n                                    return [S.Modes.FULL, optionsDiv]\n                                }\n                                case Mode.DESIGN: return [S.Modes.DESIGN, emptyMod]\n                                case Mode.CONNECT: return [S.Modes.CONNECT, emptyMod]\n                                case Mode.TRYOUT: return [S.Modes.TRYOUT, emptyMod]\n                                case Mode.STATIC: return [S.Modes.STATIC, emptyMod]\n                            }\n                        })()\n\n                        const copyLinkDiv =\n                            div(cls(\"sim-mode-link\"),\n                                title(\"Copie un lien vers ce contenu dans ce mode\"),\n                                makeIcon(\"link\"),\n                            ).render()\n\n                        copyLinkDiv.addEventListener(\"click\", __ => {\n                            this.shareSheetForMode(buttonMode)\n                        })\n\n                        const switchToModeDiv =\n                            div(cls(\"btn btn-sm btn-outline-light sim-toolbar-button-right sim-mode-tool\"),\n                                style(\"display: flex; justify-content: space-between; align-items: center\"),\n                                attrBuilder(\"mode\")(Mode[buttonMode].toLowerCase()),\n                                title(expl),\n                                modeTitle,\n                                addElem,\n                                copyLinkDiv\n                            ).render()\n\n                        switchToModeDiv.addEventListener(\"click\", () => this.setMode(buttonMode, true))\n\n                        return switchToModeDiv\n                    })\n                )\n            ).applyTo(modeChangeMenu)\n            setVisible(modeChangeMenu, true)\n        }\n\n        // this.html.embedUrlQRCode.addEventListener(\"click\", __ => {\n        //     // download\n        //     const dataUrl = this.html.embedUrlQRCode.src\n        //     const filename = this.documentDisplayName + \"_qrcode.png\"\n        //     downloadDataUrl(dataUrl, filename)\n        // })\n\n        const selectAllListener = (e: Event) => {\n            const textArea = e.target as HTMLTextAreaElement\n            textArea.focus()\n            textArea.select()\n            e.preventDefault()\n        }\n        for (const textArea of [this.html.embedUrl, this.html.embedIframe, this.html.embedWebcomp, this.html.embedMarkdown]) {\n            textArea.addEventListener(\"pointerdown\", selectAllListener)\n            textArea.addEventListener(\"focus\", selectAllListener)\n        }\n\n        this.setCurrentPointerAction(\"edit\", true)\n        this.timeline.reset()\n\n        // Options\n        const settingsPalette = this.html.settingsPalette\n        const settingsTitleElem = div(cls(\"toolbar-title with-border\"), S.Settings.Settings).render()\n        this.eventMgr.registerTitleDragListenersOn(settingsTitleElem, () => {\n            setVisible(settingsPalette, false)\n        })\n        settingsPalette.insertAdjacentElement(\"afterbegin\", settingsTitleElem)\n\n        const makeCheckbox = <K extends KeysOfByType<EditorOptions, boolean>>(optionName: K, [title, mouseover]: [string, string], hide = false) => {\n            const checkbox = input(type(\"checkbox\")).render()\n            if (this.options[optionName] === true) {\n                checkbox.checked = true\n            }\n            checkbox.addEventListener(\"change\", this.wrapHandler(() => {\n                this._options[optionName] = checkbox.checked\n                this.editTools.redrawMgr.requestRedraw({ why: \"option changed: \" + optionName, invalidateMask: true, invalidateTests: true })\n                this.focus()\n            }))\n            const section = div(\n                style(\"height: 20px\"),\n                label(checkbox, span(style(\"margin-left: 4px\"), attr(\"title\", mouseover), title))\n            ).render()\n            settingsPalette.appendChild(section)\n            if (hide) {\n                setVisible(section, false)\n            }\n            return checkbox\n        }\n\n        const animateWiresCheckbox = makeCheckbox(\"animateWires\", S.Settings.animateWires)\n        const hideWireColorsCheckbox = makeCheckbox(\"hideWireColors\", S.Settings.hideWireColors)\n        const hideInputColorsCheckbox = makeCheckbox(\"hideInputColors\", S.Settings.hideInputColors)\n        const hideOutputColorsCheckbox = makeCheckbox(\"hideOutputColors\", S.Settings.hideOutputColors)\n        const hideMemoryContentCheckbox = makeCheckbox(\"hideMemoryContent\", S.Settings.hideMemoryContent)\n        const showGateTypesCheckbox = makeCheckbox(\"showGateTypes\", S.Settings.showGateTypes)\n        const showDisconnectedPinsCheckbox = makeCheckbox(\"showDisconnectedPins\", S.Settings.showDisconnectedPins)\n        const hideTooltipsCheckbox = makeCheckbox(\"hideTooltips\", S.Settings.hideTooltips)\n        const groupParallelWiresCheckbox = makeCheckbox(\"groupParallelWires\", S.Settings.groupParallelWires, true)\n        const showHiddenWiresCheckbox = makeCheckbox(\"showHiddenWires\", S.Settings.showHiddenWires)\n        const showAnchorsCheckbox = makeCheckbox(\"showAnchors\", S.Settings.showAnchors)\n        const showIdsCheckbox = makeCheckbox(\"showIDs\", S.Settings.showIds)\n        // \n        const sw = S.Components.Wire.contextMenu\n        const wireStylePopup = select(\n            option(attr(\"value\", WireStyles.auto), sw.WireStyleAuto),\n            option(attr(\"value\", WireStyles.straight), sw.WireStyleStraight),\n            option(attr(\"value\", WireStyles.hv), sw.WireStyleSquareHV),\n            option(attr(\"value\", WireStyles.vh), sw.WireStyleSquareVH),\n            option(attr(\"value\", WireStyles.bezier), sw.WireStyleCurved),\n        ).render()\n        wireStylePopup.addEventListener(\"change\", this.wrapHandler(() => {\n            this._options.wireStyle = wireStylePopup.value as WireStyle\n            this.linkMgr.invalidateAllWirePaths()\n            this.editTools.redrawMgr.requestRedraw({ why: \"wire style changed\", invalidateMask: true })\n        }))\n        settingsPalette.appendChild(\n            div(\n                style(\"height: 20px\"),\n                S.Settings.wireStyle + \" \", wireStylePopup\n            ).render()\n        )\n\n        const propagationDelayField = input(type(\"number\"),\n            style(\"margin: 0 4px; width: 4em\"),\n            attr(\"min\", \"0\"), attr(\"step\", \"50\"),\n            attr(\"value\", String(this.options.propagationDelay)),\n            attr(\"title\", S.Settings.propagationDelay),\n        ).render()\n        propagationDelayField.addEventListener(\"change\", () => {\n            this._options.propagationDelay = propagationDelayField.valueAsNumber\n        })\n        settingsPalette.appendChild(\n            div(\n                style(\"height: 20px\"),\n                S.Settings.propagationDelayField[0], propagationDelayField, S.Settings.propagationDelayField[1]\n            ).render()\n        )\n\n        const showUserdataLink = a(S.Settings.showUserDataLink[1], style(\"text-decoration: underline; cursor: pointer\")).render()\n        showUserdataLink.addEventListener(\"click\", () => {\n            alert(S.Settings.userDataHeader + \"\\n\\n\" + JSON5.stringify(this.userdata, undefined, 4))\n        })\n        const showUserDataLinkContainer = div(\n            style(\"margin-top: 5px; display: none\"),\n            S.Settings.showUserDataLink[0], showUserdataLink,\n        ).render()\n        settingsPalette.appendChild(showUserDataLinkContainer)\n\n        this.optionsHtml = {\n            animateWiresCheckbox,\n            hideWireColorsCheckbox,\n            hideInputColorsCheckbox,\n            hideOutputColorsCheckbox,\n            hideMemoryContentCheckbox,\n            wireStylePopup,\n            showGateTypesCheckbox,\n            showDisconnectedPinsCheckbox,\n            hideTooltipsCheckbox,\n            groupParallelWiresCheckbox,\n            showHiddenWiresCheckbox,\n            showAnchorsCheckbox,\n            showIdsCheckbox,\n            propagationDelayField,\n            showUserDataLinkContainer,\n        }\n\n        // this is called once here to set the initial transform and size before the first draw, and again later\n        this.setCanvasSize()\n\n        // force redraw the first time the canvas is visible; this also sets the size\n        onVisible(this.html.canvasContainer, () => {\n            this.redraw()\n        })\n\n        this.tryLoadCircuitFromData(!this._norestore, PostLoadActions_SnapshotNoStorage)\n        // also triggers redraw, should be last thing called here\n\n        this.setModeFromString(this.getAttribute(ATTRIBUTE_NAMES.mode))\n\n        // this is called a second time here because the canvas width may have changed following the mode change\n        this.setCanvasSize()\n        LogicEditor.installGlobalListeners()\n\n        this.doRedraw(true)\n    }\n\n    private findLightDOMChild<K extends keyof HTMLElementTagNameMap>(tagName: K): HTMLElementTagNameMap[K] | null {\n        const TAGNAME = tagName.toUpperCase()\n        for (const child of this.children) {\n            if (child.tagName === TAGNAME) {\n                return child as HTMLElementTagNameMap[K]\n            }\n        }\n        return null\n    }\n\n    public static installGlobalListeners() {\n        if (LogicEditor._globalListenersInstalled) {\n            return\n        }\n\n        window.decompress = LZString.decompressFromEncodedURIComponent\n        window.decodeOld = LogicEditor.decodeFromURLOld\n\n        window.formatString = formatString\n\n        // make gallery available globally\n        window.gallery = gallery\n\n        const makeUpdatePointerPositionHandler = (closingContextMenus: boolean) => (e: PointerEvent) => {\n            for (const editor of LogicEditor._allConnectedEditors) {\n\n                // Update X and Y coordinates of the pointer\n                const canvasContainer = editor.html.canvasContainer\n                if (canvasContainer !== undefined) {\n                    const canvasPos = canvasContainer.getBoundingClientRect()\n                    // first, compute the coordinates ignoring the zoom and translation\n                    const x = e.clientX - canvasPos.left\n                    const y = e.clientY - canvasPos.top\n                    // then, apply the zoom and translation\n                    editor.pointerX = x / editor._userDrawingScale - editor._translationX\n                    editor.pointerY = y / editor._userDrawingScale - editor._translationY\n                    // console.log(`Pointer position: ${editor.pointerX}, ${editor.pointerY}`)\n                }\n\n                // If needed, hide the context menu\n                if (closingContextMenus) {\n                    editor.eventMgr.hideContextMenuIfNeeded(e)\n                }\n            }\n        }\n\n        window.addEventListener(\"pointerdown\", makeUpdatePointerPositionHandler(true), true)\n        window.addEventListener(\"pointermove\", makeUpdatePointerPositionHandler(false), true)\n\n        const updateCursors = () => {\n            for (const editor of LogicEditor._allConnectedEditors) {\n                editor.updateCursor()\n            }\n        }\n        window.addEventListener(\"keydown\", e => {\n            if (e.key === \" \") {\n                LogicEditor._spaceDown = true\n                updateCursors()\n            }\n        })\n        window.addEventListener(\"keyup\", e => {\n            if (e.key === \" \") {\n                LogicEditor._spaceDown = false\n                updateCursors()\n            }\n        })\n\n        window.addEventListener(\"resize\", () => {\n            for (const editor of LogicEditor._allConnectedEditors) {\n                const canvasContainer = editor.html.canvasContainer\n                if (canvasContainer !== undefined) {\n                    editor.wrapHandler(() => {\n                        editor.setCanvasSize()\n                        editor.editTools.redrawMgr.requestRedraw({ why: \"window resized\", invalidateMask: true })\n                    })()\n                }\n                editor._topBar?.updateCompactMode()\n            }\n            registerPixelRatioListener()\n        })\n\n        let pixelRatioMediaQuery: undefined | MediaQueryList\n        const registerPixelRatioListener = () => {\n            if (pixelRatioMediaQuery !== undefined) {\n                pixelRatioMediaQuery.onchange = null\n            }\n\n            const queryString = `(resolution: ${window.devicePixelRatio}dppx)`\n            pixelRatioMediaQuery = window.matchMedia(queryString)\n            pixelRatioMediaQuery.onchange = () => {\n                for (const editor of LogicEditor._allConnectedEditors) {\n                    editor.wrapHandler(() => {\n                        editor.setCanvasSize()\n                        editor.editTools.redrawMgr.requestRedraw({ why: \"devicePixelRatio changed\", invalidateMask: true })\n                    })()\n                }\n                registerPixelRatioListener()\n            }\n        }\n        registerPixelRatioListener()\n\n        document.body.addEventListener(\"themechanged\", (e) => {\n            const isDark = Boolean((e as any).detail?.is_dark_theme)\n            setDarkMode(isDark, false)\n        })\n\n        const mkdocsThemeObserver = new MutationObserver(function (mutations) {\n            mutations.forEach(function (mutation) {\n                if (mutation.type === \"attributes\" && mutation.attributeName === \"data-md-color-switching\" && document.body.getAttribute(\"data-md-color-switching\") === null) {\n                    const newBackgroundColor = getComputedStyle(document.body).backgroundColor\n                    console.log(\"Logic: looks like new background color is \" + newBackgroundColor)\n                    window.Logic.setDarkMode(newBackgroundColor)\n                }\n            })\n        })\n\n        mkdocsThemeObserver.observe(document.body, { attributes: true })\n\n        LogicEditor._globalListenersInstalled = true\n    }\n\n    public setMode(mode: Mode, doSetFocus: boolean) {\n        this.wrapHandler(() => {\n            let modeStr = Mode[mode].toLowerCase()\n            if (mode > this._maxInstanceMode) {\n                mode = this._maxInstanceMode\n                console.log(`Cannot switch to mode ${modeStr} because we are capped by ${Mode[this._maxInstanceMode]}`)\n                modeStr = Mode[mode].toLowerCase()\n            }\n            this._mode = mode\n\n            const modes: string[] = []\n            for (let i = MIN_MODE_INDEX; i <= mode; i++) {\n                modes.push(Mode[i].toLowerCase())\n            }\n            this.html.rootDiv.setAttribute(ATTRIBUTE_NAMES.modes, modes.join(\" \"))\n            const nomodes: string[] = []\n            for (let i = mode + 1; i <= MAX_MODE_INDEX; i++) {\n                nomodes.push(Mode[i].toLowerCase())\n            }\n            this.html.rootDiv.setAttribute(ATTRIBUTE_NAMES.nomodes, nomodes.join(\" \"))\n\n            // console.log(`Current mode is ${modeStr} - ${mode}`)\n\n            this.editTools.redrawMgr.requestRedraw({ why: \"mode changed\", invalidateMask: true })\n\n            // update mode active button\n            this.root.querySelectorAll(\".sim-mode-tool\").forEach((elem) => {\n                if (elem.getAttribute(\"mode\") === modeStr) {\n                    elem.classList.add(\"active\")\n                } else {\n                    elem.classList.remove(\"active\")\n                }\n            })\n\n            if (mode < Mode.CONNECT) {\n                this.setCurrentPointerAction(\"edit\")\n            }\n\n            const showComponentsAndEditControls: UIDisplay =\n                mode >= Mode.DESIGN ? \"show\" :\n                    (this._maxInstanceMode >= Mode.DESIGN ? \"inactive\" : \"hide\")\n\n            const showEditControls = showComponentsAndEditControls === \"show\"\n            const showReset = mode >= Mode.TRYOUT && !this._hideResetButton\n            const showOnlyReset = showReset && !showEditControls\n            const hideSettings = mode < Mode.FULL\n\n            this._topBar?.setButtonStateFromMode({ showComponentsAndEditControls, showReset }, mode)\n\n            setVisible(this.html.rightToolbarContainer, showOnlyReset)\n\n            if (hideSettings) {\n                setVisible(this.html.settingsPalette, false)\n            }\n\n            setDisplay(this.html.leftToolbar, showComponentsAndEditControls)\n\n            if (mode < Mode.CONNECT) {\n                this.setTestsPaletteVisible(false)\n            } else {\n                this.didLoadTests(this.testSuites)\n            }\n            // const showTxGates = mode >= Mode.FULL && (showOnly === undefined || showOnly.includes(\"TX\") || showOnly.includes(\"TXA\"))\n            // const txGateButton = this.root.querySelector(\"button[data-type=TXA]\") as HTMLElement\n            // setVisible(txGateButton, showTxGates)\n\n            if (doSetFocus) {\n                this.focus()\n            }\n\n        })()\n    }\n\n    public setModeFromString(modeStr: string | null) {\n        let mode: Mode = this._maxInstanceMode\n        if (modeStr !== null && (modeStr = modeStr.toUpperCase()) in Mode) {\n            mode = (Mode as any)[modeStr]\n        }\n        this.setMode(mode, false)\n    }\n\n    public setCircuitName(name: string | undefined) {\n        this._options.name = (name === undefined || name.length === 0) ? undefined : name\n        this._topBar?.setCircuitName(name)\n        this.setWindowTitleFrom(this._options.name)\n    }\n\n    public setZoom(zoom: number, updateTopBar: boolean): number {\n        zoom = Math.max(10, Math.min(1000, zoom))\n        const roundedZoomForUI = Math.round(zoom)\n        this._options.zoom = roundedZoomForUI\n        this._userDrawingScale = zoom / 100\n        if (updateTopBar) {\n            this._topBar?.setZoom(roundedZoomForUI)\n        }\n        this.editTools.redrawMgr.requestRedraw({ why: \"zoom level changed\", invalidateMask: true })\n        return zoom\n    }\n\n    public setTranslation(tX: number, tY: number) {\n        this._translationX = tX\n        this._translationY = tY\n        this._options.origin = [-Math.round(tX), -Math.round(tY)]\n        this.editTools.redrawMgr.requestRedraw({ why: \"translation changed\", invalidateMask: true })\n    }\n\n    public finishAutoZoomTranslationIfActive() {\n        this.setDirty(\"zoom/translation changed\")\n        this.editTools.undoMgr.takeSnapshot()\n    }\n\n    public updateCustomComponentButtons() {\n        if (this._menu !== undefined) {\n            this._menu.updateCustomComponentButtons(this.factory.customDefs())\n            this.eventMgr.registerButtonListenersOn(this._menu.allCustomButtons(), true)\n        }\n        this._topBar?.updateCustomComponentCaption()\n    }\n\n    public allowGateType(type: string) {\n        return this._menu?.allowGateType(type) ?? true\n    }\n\n    public override focus() {\n        this.html.mainCanvas.focus()\n    }\n\n    /**\n     * This saves the passed circuit to both sessionStorage and localStorage.\n     * The idea is that sessionStorage is always restored (page reload),\n     * and localStorage items can be proposed in the UI for reloading.\n     */\n    public trySaveInBrowserStorage(circuit: Circuit) {\n        if (this._linkedField !== undefined) {\n            const selectionStart = this._linkedField.selectionStart\n            const selectionEnd = this._linkedField.selectionEnd\n            this._linkedField.value = Serialization.stringifyObject(circuit, false)\n            // Restore cursor position after value change\n            if (selectionStart !== null && selectionEnd !== null) {\n                this._linkedField.setSelectionRange(selectionStart, selectionEnd)\n            }\n        }\n\n        if (this._norestore) {\n            return\n        }\n\n        const key = this.persistenceKey\n        if (key === undefined) {\n            // console.log(\"No persistence ID set, not saving circuit\")\n            return\n        }\n\n        const now = Date.now()\n        const saveStr = now + \";\" + Serialization.stringifyObject(circuit, true)\n        // console.log(\"Saving circuit to browser storage with key '\" + key + \"' at \" + new Date(now).toISOString())\n        try {\n            sessionStorage.setItem(key, saveStr)\n            if (this._autosave) {\n                localStorage.setItem(key, saveStr)\n                // console.log(`Saved circuit to session and local storage with key '${key}'`)\n            } else {\n                // console.log(`Saved circuit to session (not local) storage with key '${key}'`)\n            }\n        } catch (e) {\n            console.error(\"Failed to save circuit to browser storage\", e)\n        }\n    }\n\n    /**\n     * Automatically called upon load after the initial data has been loaded.\n     * Allows to restore the circuit from the session storage only (local storage is\n     * only upon user request).\n     */\n    public tryLoadFromSessionStorage(): boolean {\n        const savedTime = this.tryLoadFromStorage(sessionStorage, PostLoadActions_None)\n        if (savedTime === undefined) {\n            return false\n        }\n        if (isString(savedTime)) {\n            console.error(\"Failed to load circuit from session storage\", savedTime)\n            return false\n        }\n        this.showLoadedMessage(savedTime, false)\n        // console.log(\"Loaded circuit from session storage\")\n        this._loadedFromStorage = true\n        return true\n    }\n\n    /**\n     * This does something similar as `tryLoadFromSessionStorage` but it is initiated\n     * by the user and should show errors\n     */\n    public tryLoadFromLocalStorage(): boolean {\n        const savedTime = this.tryLoadFromStorage(localStorage, PostLoadActions_SnapshotNoStorage)\n        if (savedTime === undefined) {\n            window.alert(S.Messages.NoSavedData)\n            return false\n        }\n\n        if (isString(savedTime)) {\n            window.alert(S.Messages.FailedToLoadCircuitFromStorage.expand({ error: savedTime }))\n            console.error(\"Failed to load circuit from session storage\", savedTime)\n            return false\n        }\n        this.showLoadedMessage(savedTime, false)\n        return true\n    }\n\n    private showLoadedMessage(savedTime: Date, keepOpen: boolean) {\n        const day = savedTime.toLocaleDateString(undefined, {\n            year: '2-digit',\n            month: '2-digit',\n            day: '2-digit',\n        })\n        const time = savedTime.toLocaleTimeString(undefined, {\n            hour: '2-digit',\n            minute: '2-digit',\n            second: undefined,\n        })\n\n        this.showMessage(S.Messages.LoadedCircuitFromSessionStorage.expand({ day, time }), keepOpen ? 0 : 2000, keepOpen)\n    }\n\n    /**\n     * @returns undefined if no persistence id is set or nothing is saved; a string in case of an error to report; a Date if loaded successfully\n     */\n    private tryLoadFromStorage(storage: Storage, postLoadActions: PostLoadActions): undefined | Date | string {\n        const key = this.persistenceKey\n        if (key === undefined) {\n            return undefined\n        }\n\n        const savedStr = storage.getItem(key)\n        if (savedStr === null || savedStr.length === 0) {\n            // console.log(`Nothing to load from ${storage === localStorage ? \"local\" : \"session\"} storage with key '${key}'`)\n            return undefined\n        }\n        // console.log(`Loading circuit from ${storage === localStorage ? \"local\" : \"session\"} storage with key '${key}'`)\n\n        let semicolIndex = -1\n        if ((semicolIndex = savedStr.indexOf(\";\")) === -1) {\n            return \"unparseable saved string\"\n        }\n\n        const circuitStr = savedStr.substring(semicolIndex + 1)\n        const error = Serialization.loadCircuitOrLibrary(this, circuitStr, postLoadActions)\n        if (error !== undefined) {\n            return error\n        }\n\n        try {\n            return new Date(Number(savedStr.substring(0, semicolIndex)))\n        } catch (e) {\n            return new Date()\n        }\n    }\n\n    public tryClearBrowserStorage() {\n        const key = this.persistenceKey\n        if (key === undefined) {\n            return\n        }\n\n        try {\n            localStorage.removeItem(key)\n        } catch (e) {\n            // ignore\n        }\n\n        try {\n            sessionStorage.removeItem(key)\n        } catch (e) {\n            // ignore\n        }\n    }\n\n    public tryLoadFrom(file: File) {\n        if (file.type === \"application/json\" || file.type === \"application/json5\" || file.type === \"text/plain\") {\n            // JSON files can be circuits or libraries\n            const reader = new FileReader()\n            reader.onload = () => {\n                const content = reader.result?.toString()\n                if (content !== undefined) {\n                    this.loadCircuitOrLibrary(content)\n                }\n            }\n            reader.readAsText(file, \"utf-8\")\n\n        } else if (file.type === \"image/png\") {\n            // PNG files may contain a circuit in the metadata\n            const reader = new FileReader()\n            reader.onload = () => {\n                const content = reader.result\n                if (content instanceof ArrayBuffer) {\n                    const uintArray2 = new Uint8Array(content)\n                    const pngMetadata = pngMeta.readMetadata(uintArray2)\n                    const compressedJSON = pngMetadata.tEXt?.Description\n                    if (isString(compressedJSON)) {\n                        this._initialData = { _type: \"compressed\", str: compressedJSON }\n                        this.wrapHandler(() => {\n                            this.tryLoadCircuitFromData(false, PostLoadActions_SnapshotStorage)\n                        })()\n                    }\n                }\n            }\n            reader.readAsArrayBuffer(file)\n\n        } else if (file.type === \"image/svg+xml\") {\n            // SVG files may contain a circuit in the metadata\n            const reader = new FileReader()\n            reader.onload = e => {\n                const content = e.target?.result?.toString()\n                if (content !== undefined) {\n\n                    const temp = document.createElement(\"div\")\n                    temp.innerHTML = content\n                    const metadata = temp.querySelector(\"svg metadata\")\n                    const json = metadata?.textContent\n                    temp.remove()\n                    if (json !== undefined && json !== null) {\n                        this.loadCircuitOrLibrary(json)\n                    }\n                }\n            }\n            reader.readAsText(file, \"utf-8\")\n\n        } else {\n            this.showMessage(S.Messages.UnsupportedFileType.expand({ type: file.type }))\n        }\n    }\n\n    public tryLoadCircuitFromData(tryLoadStorage: boolean, postLoadActions: PostLoadActions) {\n        // console.log(`tryLoadCircuitFromData with tryLoadStorage=${tryLoadStorage}, takeSnapshot=${takeSnapshot}`)\n        if (this._initialData !== undefined) {\n\n            // if URL, load and call the function again\n            if (this._initialData._type === \"url\") {\n                // load from URL\n                const url = this._initialData.url\n                // will only work within the same domain for now\n                fetch(url, { mode: \"cors\" }).then(response => response.text()).then(json => {\n                    console.log(`Loaded initial data from URL '${url}'`)\n                    this._initialData = { _type: \"json\", json }\n                    this.tryLoadCircuitFromData(tryLoadStorage, postLoadActions)\n                })\n\n                // TODO try fetchJSONP if this fails?\n                return\n            }\n\n            let error: undefined | string = undefined\n\n            if (this._initialData._type === \"json\") {\n                // already decompressed\n                try {\n                    error = Serialization.loadCircuitOrLibrary(this, this._initialData.json, postLoadActions)\n                } catch (e) {\n                    error = String(e) + \" (JSON)\"\n                }\n\n            } else {\n                let decodedData\n                try {\n                    decodedData = LZString.decompressFromEncodedURIComponent(this._initialData.str)\n                    if (this._initialData.str.length !== 0 && (decodedData?.length ?? 0) === 0) {\n                        throw new Error(\"zero decoded length\")\n                    }\n                } catch (err) {\n                    error = String(err) + \" (LZString)\"\n\n                    // try the old, uncompressed way of storing the data in the URL\n                    try {\n                        decodedData = LogicEditor.decodeFromURLOld(this._initialData.str)\n                        error = undefined\n                    } catch (e) {\n                        // swallow error from old format\n                    }\n                }\n\n                if (error === undefined && isString(decodedData)) {\n                    // remember the decompressed/decoded value\n                    error = Serialization.loadCircuitOrLibrary(this, decodedData, postLoadActions)\n                    if (error === undefined) {\n                        this._initialData = { _type: \"json\", json: decodedData }\n                    }\n                }\n            }\n\n\n            if (error !== undefined) {\n                console.log(\"ERROR could not not load initial data: \" + error)\n            }\n        }\n\n        let contentFromLinkedField\n        if (this._linkedField !== undefined &&\n            (contentFromLinkedField = this._linkedField.value) !== null &&\n            (contentFromLinkedField = contentFromLinkedField.trim()).length > 0) {\n            const error = Serialization.loadCircuitOrLibrary(this, contentFromLinkedField, postLoadActions)\n            if (error === undefined) {\n                this._initialData = { _type: \"json\", json: contentFromLinkedField }\n            }\n        }\n\n        let isConsideredDirty = false\n        if (tryLoadStorage) {\n            // try restore from session storage\n            if (this.tryLoadFromSessionStorage()) {\n                isConsideredDirty = true\n            }\n        }\n\n        if (!isConsideredDirty) {\n            this.clearDirty()\n        }\n    }\n\n    public resetCircuit() {\n        this.tryClearBrowserStorage()\n        this.editor.tryLoadCircuitFromData(false, PostLoadActions_None)\n    }\n\n    public tryCloseCustomComponentEditor() {\n        const editorRoot = this.editor.editorRoot\n        if (!(editorRoot instanceof CustomComponent)) {\n            return false\n        }\n        const def = editorRoot.customDef\n        const error = this.editor.factory.tryModifyCustomComponent(def, editorRoot)\n        if (error !== undefined) {\n            if (error.length !== 0) {\n                window.alert(error)\n            }\n            return true // handled, even if with error\n        }\n        for (const type of this.factory.getCustomComponentTypesWhichUse(def.type)) {\n            // console.log(`Updating custom component type '${type}'`)\n            this.components.updateCustomComponents(type)\n        }\n        this.setEditorRoot(this.editor)\n        this.editTools.undoMgr.takeSnapshot()\n        return true\n    }\n\n    public loadCircuitOrLibrary(jsonStringOrObject: string | Record<string, unknown>) {\n        this.wrapHandler(\n            (jsonStringOrObject: string | Record<string, unknown>) =>\n                Serialization.loadCircuitOrLibrary(this, jsonStringOrObject, PostLoadActions_SnapshotStorage)\n        )(jsonStringOrObject)\n    }\n\n    public makeGroupWithSelection(): boolean {\n        const selectedComps = this.eventMgr.currentSelection?.previouslySelectedElements || new Set()\n        if (selectedComps.size === 0) {\n            return false\n        }\n\n        const newGroup = RectangleDef.make<Rectangle>(this)\n        newGroup.setSpawned()\n\n        if (newGroup instanceof Rectangle) {\n            newGroup.wrapContents(selectedComps)\n            for (const comp of selectedComps) {\n                if (comp instanceof DrawableWithDraggablePosition && comp.anchor === undefined) {\n                    comp.anchor = newGroup\n                }\n            }\n        } else {\n            console.log(\"ERROR: created component is not a Rectangle\")\n        }\n\n        return true\n    }\n\n    public setDirty(__reason: string) {\n        if (this.mode >= Mode.CONNECT) {\n            // other modes can't be dirty\n            this._isDirty = true\n            this._topBar?.setDirty(true)\n        }\n    }\n\n    public clearDirty() {\n        this._isDirty = false\n        this._topBar?.setDirty(false)\n    }\n\n    public setDark(dark: boolean) {\n        this.html.rootDiv.classList.toggle(\"dark\", dark)\n    }\n\n    public setEditorRoot(newRoot: DrawableParent) {\n        if (newRoot === this._editorRoot) {\n            return\n        }\n\n        if (this._editorRoot !== undefined) {\n            this._editorRoot.stopEditingThis()\n        }\n\n        this._editorRoot = newRoot\n        newRoot.startEditingThis(this.editTools)\n\n        const [customComp, typesToHide] = !(newRoot instanceof CustomComponent)\n            // case LogicEditor\n            ? [undefined, []]\n            // case CustomComponent\n            : [newRoot, this.factory.getCustomComponentTypesWhichUse(newRoot.customDef.type)]\n\n        this._menu?.setCustomComponentsHidden(typesToHide)\n        this._topBar?.setEditingCustomComponent(customComp?.customDef)\n\n        this._highlightedItems = undefined\n        this.eventMgr.currentSelection = undefined\n        this.eventMgr.clearTooltipIfNeeded()\n        this.eventMgr.updateComponentUnderPointer([this.pointerX, this.pointerY], false, false, false)\n        this.editTools.testsPalette.update()\n        this.editTools.moveMgr.clear()\n        this.editTools.redrawMgr.requestRedraw({ why: \"editor root changed\", invalidateMask: true, invalidateTests: true })\n\n        this.focus()\n    }\n\n    public setCurrentPointerAction<M extends PointerAction>(action: M, forceUpdate: boolean = false, ...params: PoionterActionParams<M>): boolean {\n        const changed = this.eventMgr.setHandlersFor(action, ...params)\n        if (forceUpdate || changed) {\n            this.setToolCursor(PointerActions[action].cursor)\n            this._topBar?.updateActiveTool(action)\n            this.editTools.redrawMgr.requestRedraw({ why: \"mouse action changed\" })\n            this.editor.focus()\n        }\n        return changed\n    }\n\n    public updateCursor(e?: PointerEvent) {\n        const cursor =\n            this.editTools.moveMgr.areDrawablesMoving()\n                ? \"grabbing\"\n                : this._toolCursor\n                ?? this.eventMgr.currentComponentUnderPointer?.cursorWhenMouseover(e)\n                ?? (LogicEditor._spaceDown && this._mode >= Mode.CONNECT\n                    ? \"grab\"\n                    : \"default\")\n        this.html.canvasContainer.style.cursor = cursor\n    }\n\n    public showMessage(msg: Modifier, duration: number = 2000, withCloseButton: boolean = false): () => void {\n        return this._messageBar?.showMessage(msg, duration, withCloseButton) ?? (() => undefined)\n    }\n\n    public offsetXYForContextMenu(e: MouseEvent | PointerDragEvent, snapToGrid = false): [number, number] {\n        const mainCanvas = this.html.mainCanvas\n        let x, y\n\n        if (\"offsetX\" in e && e.offsetX === 0 && e.offsetY === 0 && e.target === mainCanvas) {\n            const canvasRect = mainCanvas.getBoundingClientRect()\n            x = e.clientX - canvasRect.x\n            y = e.clientY - canvasRect.y\n        } else if (\"dragStartX\" in e) {\n            return [e.dragStartX, e.dragStartY]\n        } else {\n            [x, y] = this.offsetXY(e)\n        }\n\n        if (snapToGrid) {\n            x = Math.round(x / GRID_STEP) * GRID_STEP\n            y = Math.round(y / GRID_STEP) * GRID_STEP\n        }\n        return [x, y]\n    }\n\n    public offsetXY(e: MouseEvent, skipTransform: boolean = false): [number, number] {\n        const [unscaledX, unscaledY] = (() => {\n            const mainCanvas = this.html.mainCanvas\n            let target = e.target\n            if (\"offsetX\" in e) {\n                // MouseEvent\n                const canvasRect = mainCanvas.getBoundingClientRect()\n                let offsetX = e.offsetX\n                let offsetY = e.offsetY\n\n                // fix for firefox having always 0 offsetX,Y\n                if (offsetX === 0 && offsetY === 0) {\n                    const _e = e as any\n                    if (\"_savedOffsetX\" in _e) {\n                        offsetX = _e._savedOffsetX\n                        offsetY = _e._savedOffsetY\n                        target = _e._savedTarget\n                    } else if (\"layerX\" in e) {\n                        // This should never happen and is actually wrong, because we assume \n                        offsetX = _e.layerX + canvasRect.x\n                        offsetY = _e.layerY + canvasRect.y\n                    }\n                }\n\n                if (target === mainCanvas) {\n                    return [offsetX, offsetY]\n                } else {\n                    const elemRect = (target as HTMLElement).getBoundingClientRect()\n                    return [\n                        Math.max(GRID_STEP * 2, offsetX + elemRect.x - canvasRect.x),\n                        Math.max(GRID_STEP * 2, offsetY + elemRect.y - canvasRect.y),\n                    ]\n                }\n            } else {\n                console.error(\"calling offsetXY with TouchEvent\")\n                throw new Error(\"not implemented\")\n                // const elemRect = (target as HTMLElement).getBoundingClientRect()\n                // const bodyRect = document.body.getBoundingClientRect()\n                // const touch = e.changedTouches[0]\n                // const offsetX = touch.pageX - (elemRect.left - bodyRect.left)\n                // const offsetY = touch.pageY - (elemRect.top - bodyRect.top)\n\n                // if (target === mainCanvas) {\n                //     return [offsetX, offsetY]\n                // } else {\n                //     const canvasRect = mainCanvas.getBoundingClientRect()\n                //     return [\n                //         Math.max(GRID_STEP * 2, offsetX + elemRect.x - canvasRect.x),\n                //         Math.max(GRID_STEP * 2, offsetY + elemRect.y - canvasRect.y),\n                //     ]\n                // }\n            }\n        })()\n        const [f, tX, tY] = skipTransform ? [1, 0, 0] : [this._userDrawingScale, this._translationX, this._translationY]\n        return [unscaledX / f - tX, unscaledY / f - tY]\n    }\n\n    public offsetXYForComponent(e: PointerEvent, comp: Component): [number, number] {\n        const offset = this.offsetXY(e)\n        if (comp.orient === Orientation.default) {\n            return offset\n        }\n        const [x, y] = offset\n        const dx = x - comp.posX\n        const dy = y - comp.posY\n        switch (comp.orient) {\n            case \"e\": return offset // done before anyway\n            case \"w\": return [comp.posX - dx, comp.posY - dy]\n            case \"s\": return [comp.posX - dy, comp.posY - dx]\n            case \"n\": return [comp.posX + dy, comp.posY + dx]\n        }\n    }\n\n    private guessAdequateCanvasSize(applyZoom: boolean): [number, number] {\n        let rightmostX = Number.NEGATIVE_INFINITY, leftmostX = Number.POSITIVE_INFINITY\n        let lowestY = Number.NEGATIVE_INFINITY, highestY = Number.POSITIVE_INFINITY\n        const drawables: DrawableWithPosition[] = [...this.editorRoot.components.all()]\n        for (const wire of this.linkMgr.wires) {\n            drawables.push(...wire.waypoints)\n        }\n        for (const comp of drawables) {\n            const cx = comp.posX\n            const width = comp.width\n            const left = cx - width / 2\n            const right = left + width\n            if (right > rightmostX) {\n                rightmostX = right\n            }\n            if (left < leftmostX) {\n                leftmostX = left\n            }\n\n            const cy = comp.posY\n            const height = comp.height\n            const top = cy - height / 2\n            const bottom = top + height\n            if (bottom > lowestY) {\n                lowestY = bottom\n            }\n            if (top < highestY) {\n                highestY = top\n            }\n        }\n        leftmostX = Math.max(0, leftmostX)\n        let w = rightmostX + leftmostX // add right margin equal to left margin\n        if (isNaN(w)) {\n            w = 300\n        }\n        highestY = Math.max(0, highestY)\n        let h = highestY + lowestY // add lower margin equal to top margin\n        if (isNaN(h)) {\n            h = 150\n        }\n        const f = applyZoom ? this._userDrawingScale : 1\n        return [f * w, f * h]\n    }\n\n    public async shareSheetForMode(mode: Mode) {\n        if (this._mode > MAX_MODE_WHEN_EMBEDDED) {\n            this._mode = MAX_MODE_WHEN_EMBEDDED\n        }\n        const modeStr = Mode[mode].toLowerCase()\n        const idWhenExporting = this.idWhenExporting\n        const { fullJson, compressedJsonForUri, showOnlyArr } = this.fullJsonStateAndCompressedForUri(true)\n\n        console.log(\"JSON:\\n\" + fullJson)\n\n        const fullUrl = this.fullUrlForMode(mode, compressedJsonForUri, showOnlyArr, idWhenExporting)\n        this.html.embedUrl.value = fullUrl\n\n        const modeParam = mode === MAX_MODE_WHEN_EMBEDDED ? \"\" : `:mode: ${modeStr}`\n        const embedHeight = this.guessAdequateCanvasSize(true)[1]\n\n        const showOnlySpaceDelim = showOnlyArr === undefined ? undefined : showOnlyArr.join(\" \")\n        const markdownBlock =\n            this._exportformat === \"superfence\"\n                // superfence\n                ? `\\`\\`\\`{.logic id=${idWhenExporting} height=${embedHeight} mode=${modeStr}${showOnlySpaceDelim === undefined ? '' : `showonly=${showOnlySpaceDelim}`}}\\n${fullJson}\\n\\`\\`\\``\n                // default, myst-style\n                : `\\`\\`\\`{logic}\\n:id: ${idWhenExporting}\\n:height: ${embedHeight}\\n${modeParam}\\n${showOnlySpaceDelim === undefined ? '' : `:showonly: ${showOnlySpaceDelim}\\n`}\\n${fullJson}\\n\\`\\`\\``\n        this.html.embedMarkdown.value = markdownBlock\n\n        const showOnlyHtmlAttr = showOnlySpaceDelim === undefined ? \"\" : ` showonly=\"${showOnlySpaceDelim}\"`\n\n        const iframeEmbed = `<iframe style=\"width: 100%; height: ${embedHeight}px; border: 0\"${showOnlyHtmlAttr} src=\"${fullUrl}\"></iframe>`\n        this.html.embedIframe.value = iframeEmbed\n\n        const webcompEmbed = `<div style=\"width: 100%; height: ${embedHeight}px\">\\n  <logic-editor id=\"${idWhenExporting}\" mode=\"${Mode[mode].toLowerCase()}\"${showOnlyHtmlAttr}>\\n    <script type=\"application/json5\">\\n      ${fullJson.replace(/\\n/g, \"\\n      \")}\\n    </script>\\n  </logic-editor>\\n</div>`\n        this.html.embedWebcomp.value = webcompEmbed\n\n        // const dataUrl = await QRCode.toDataURL(fullUrl, { margin: 0, errorCorrectionLevel: 'L' })\n        // const qrcodeImg = this.html.embedUrlQRCode\n        // qrcodeImg.src = dataUrl\n\n        this.saveToUrl(compressedJsonForUri, showOnlyArr)\n\n        if (!showModal(this.html.embedDialog)) {\n            // alert(\"The <dialog> API is not supported by this browser\")\n\n            // TODO show the info some other way\n\n            if (await copyToClipboard(fullUrl)) {\n                console.log(\"  -> Copied!\")\n            } else {\n                console.log(\"  -> Could not copy!\")\n            }\n        }\n    }\n\n    public saveCurrentStateToUrl() {\n        const { fullJson, compressedJsonForUri, showOnlyArr } = this.fullJsonStateAndCompressedForUri(true)\n        console.log(\"Saved to URL compressed version of:\\n\" + fullJson)\n        this.saveToUrl(compressedJsonForUri, showOnlyArr)\n    }\n\n    public save() {\n        return Serialization.buildCircuitObject(this)\n    }\n\n    public saveToUrl(compressedUriSafeJson: string, showOnly: string[] | undefined) {\n        if (this._isSingleton) {\n            history.pushState(null, \"\", this.fullUrlForMode(MAX_MODE_WHEN_SINGLETON, compressedUriSafeJson, showOnly, this.instanceId))\n            this.clearDirty()\n            this.showMessage(S.Messages.SavedToUrl)\n        }\n    }\n\n    /**\n     * @param removeShowOnly if showOnly should be removed from the JSON (first returned value.). It is always removed from the compressed version for the URL, since it is an explicit URL parameter.\n     */\n    private fullJsonStateAndCompressedForUri(removeShowOnly: boolean): { fullJson: string, compressedJsonForUri: string, showOnlyArr: string[] | undefined } {\n        let showOnlyArr: string[] | undefined = undefined\n        const jsonObj = Serialization.buildCircuitObject(this)\n        if (removeShowOnly) {\n            showOnlyArr = Serialization.removeShowOnlyFrom(jsonObj)\n        }\n        const fullJson = Serialization.stringifyObject(jsonObj, false)\n        if (!removeShowOnly) {\n            showOnlyArr = Serialization.removeShowOnlyFrom(jsonObj)\n        }\n        const jsonForUri = Serialization.stringifyObject(jsonObj, true)\n\n        // console.log(\"Full JSON:\\n\" + jsonFull)\n        // console.log(\"JSON for URL:\\n\" + jsonForUri)\n\n        // this can compress to like 40-50% of the original size\n        const compressedJsonForUri = LZString.compressToEncodedURIComponent(jsonForUri)\n        return { fullJson, compressedJsonForUri, showOnlyArr }\n    }\n\n    private fullUrlForMode(mode: Mode, compressedUriSafeJson: string, showOnlyArr: string[] | undefined, id: string | undefined): string {\n        const loc = window.location\n        const showOnlyParam = showOnlyArr === undefined ? \"\" : `&${ATTRIBUTE_NAMES.showonly}=${showOnlyArr.join(\",\")}`\n        const currentLang = getLang()\n        const hasCorrectLangParam = new URL(loc.href).searchParams.get(ATTRIBUTE_NAMES.lang) === currentLang\n        const langParam = !hasCorrectLangParam ? \"\" // no param, keep default lang\n            : `&${ATTRIBUTE_NAMES.lang}=${currentLang}` // keep currently set lang\n        if (id === SINGLETON_INSTANCE_ID) {\n            id = undefined\n        }\n        const idParam = id === undefined ? \"\" : `id=${id}&`\n        return `${loc.protocol}//${loc.host}${loc.pathname}?${idParam}${ATTRIBUTE_NAMES.mode}=${Mode[mode].toLowerCase()}${langParam}${showOnlyParam}&${ATTRIBUTE_NAMES.data}=${compressedUriSafeJson}`\n    }\n\n    public toBase64(blob: Blob | null | undefined): Promise<string | undefined> {\n        return new Promise((resolve, __) => {\n            if (blob === null || blob === undefined) {\n                resolve(undefined)\n                return\n            }\n            const reader = new FileReader()\n            reader.onloadend = () => {\n                const dataURL = reader.result as string\n                const asBase64 = dataURL.substring(dataURL.indexOf(\",\") + 1)\n                resolve(asBase64)\n            }\n            reader.readAsDataURL(blob)\n        })\n    }\n\n    public async toPNG(withMetadata: boolean, heightHint?: number): Promise<Blob | undefined> {\n        const pngBareBlob = await new Promise<Blob | null>((resolve) => {\n            const drawingScale = 3 // super retina\n            let [width, height] = this.guessAdequateCanvasSize(false)\n            if (heightHint !== undefined) {\n                height = heightHint\n            }\n            width *= drawingScale\n            height *= drawingScale\n\n            const transform = new DOMMatrix().scale(drawingScale)\n\n            const tmpCanvas = document.createElement('canvas')\n            tmpCanvas.width = width\n            tmpCanvas.height = height\n\n            const g = LogicEditor.getGraphics(tmpCanvas)\n            const wasDark = isDarkMode()\n            if (wasDark) {\n                setDarkMode(false, false)\n            }\n            this.doDrawWithContext(g, width, height, transform, transform, true, true, false)\n            if (wasDark) {\n                setDarkMode(true, false)\n            }\n            tmpCanvas.toBlob(resolve, 'image/png')\n            tmpCanvas.remove()\n        })\n\n        if (pngBareBlob === null) {\n            return undefined\n        }\n\n        if (!withMetadata) {\n            return pngBareBlob\n        }\n\n        // else, add metadata\n        const { compressedJsonForUri } = this.fullJsonStateAndCompressedForUri(false)\n        const pngBareData = new Uint8Array(await pngBareBlob.arrayBuffer())\n        const pngChunks = pngMeta.extractChunks(pngBareData)\n        pngMeta.insertMetadata(pngChunks, { \"tEXt\": { \"Description\": compressedJsonForUri } })\n        return new Blob([pngMeta.encodeChunks(pngChunks)], { type: \"image/png\" })\n    }\n\n    public async toSVG(withMetadata: boolean): Promise<Blob> {\n        const metadata = !withMetadata ? undefined\n            : Serialization.stringifyObject(Serialization.buildCircuitObject(this), false)\n\n        const [width, height] = this.guessAdequateCanvasSize(false)\n        const id = new DOMMatrix()\n        const svgCtx = new SVGRenderingContext({ width, height, metadata })\n        this.doDrawWithContext(svgCtx, width, height, id, id, true, true, false)\n        const serializedSVG = svgCtx.getSerializedSvg()\n        return Promise.resolve(new Blob([serializedSVG], { type: \"image/svg+xml\" }))\n    }\n\n    public async download(data: Promise<Blob | undefined>, extension: string) {\n        const blob = await data\n        if (blob === undefined) {\n            return\n        }\n        const filename = this.documentDisplayName + extension\n        saveAs(blob, filename)\n    }\n\n    public setTestsPaletteVisible(visible: boolean) {\n        this.editTools.testsPalette.setVisible(visible)\n        this._topBar?.updateTestPaletteVisible(visible)\n    }\n\n    public didLoadTests(testSuites: TestSuites) {\n        const numTests = testSuites.totalCases()\n        this._topBar?.setTestPaletteButtonVisible(numTests)\n        this.setTestsPaletteVisible(numTests > 0)\n    }\n\n    public addTestCases(result: TestCaseCombinational | TestCaseCombinational[]) {\n        let testSuite: TestSuite\n        if (this.testSuites.suites.length > 0) {\n            testSuite = this.testSuites.suites[0]\n        } else {\n            testSuite = new TestSuite()\n            this.testSuites.push(testSuite)\n        }\n        if (!isArray(result)) {\n            testSuite.testCases.push(result)\n        } else {\n            testSuite.testCases.push(...result)\n        }\n        this.ifEditing?.setDirty(\"added test case\")\n        this.ifEditing?.undoMgr.takeSnapshot()\n        this.ifEditing?.testsPalette.update()\n    }\n\n    public removeTestCase(testCase: TestCaseCombinational) {\n        for (const testSuite of this.testSuites.suites) {\n            const idx = testSuite.testCases.indexOf(testCase)\n            if (idx >= 0) {\n                testSuite.testCases.splice(idx, 1)\n                this.ifEditing?.setDirty(\"removed test case\")\n                this.ifEditing?.undoMgr.takeSnapshot()\n                this.ifEditing?.testsPalette.update()\n                return\n            }\n        }\n    }\n\n    public async disableUIWhile<T>(message: string, action: (restoreAfter: Map<Input, LogicValue[]>) => Promise<T>): Promise<T | undefined> {\n        if (this._isRunningOrCreatingTests) {\n            // cannot run tests while already running\n            return undefined\n        }\n\n        this._isRunningOrCreatingTests = true\n        const oldMode = this.mode\n        const restoreAfter = new Map<Input, LogicValue[]>()\n        const hideMsg = this.showMessage(message, 0)\n\n        try {\n            this.setMode(Mode.STATIC, false)\n            const result = await action(restoreAfter)\n            return result\n        } finally {\n            hideMsg()\n            this.setMode(oldMode, true)\n            for (const [input, value] of restoreAfter) {\n                input.setValue(value)\n            }\n            this.recalcPropagateAndDrawIfNeeded()\n            await this.waitForPropagation()\n            this._isRunningOrCreatingTests = false\n        }\n\n    }\n\n    public async runAllCircuitTestSuites(options?: TestSuiteRunOptions): Promise<TestSuiteResults[] | undefined> {\n        const palette = this.editTools.testsPalette\n        if (palette === undefined) {\n            return undefined\n        }\n\n        return await palette.runAllTestSuites(options)\n    }\n\n\n    public async runTestSuite(testSuite: TestSuite | Record<string, unknown>, options?: TestSuiteRunOptions): Promise<TestSuiteResults | undefined> {\n\n        const palette = this.editTools.testsPalette\n        if (palette === undefined) {\n            return undefined\n        }\n\n        const noUI = options?.noUI ?? false\n        const fast = noUI || (options?.fast ?? false)\n        const doLog = options?.doLog ?? false\n\n        // do we need to load it from JSON?\n        if (!(testSuite instanceof TestSuite)) {\n            const testSuiteRepr = validateJson(testSuite, TestSuite.Repr, \"test suite\")\n            if (testSuiteRepr === undefined) {\n                return undefined\n            }\n            testSuite = new TestSuite([testSuiteRepr, this.editor.components])\n        }\n\n        return this.disableUIWhile(S.Messages.RunningTests, async restoreAfter => {\n\n            this.setTestsPaletteVisible(true) // after setMode, which may hide it\n\n            const results = new TestSuiteResults(testSuite)\n            const ui = noUI ? undefined : palette.getOrMakeUIFor(testSuite)\n\n            let isFirst = true\n            let skip = false\n            for (let i = 0; i < testSuite.testCases.length; i++) {\n                const testCase = testSuite.testCases[i]\n                ui?.setRunning(i)\n\n                if (isFirst) {\n                    isFirst = false\n                } else if (!skip && !fast) {\n                    // pause for 2 seconds\n                    await new Promise(resolve => setTimeout(resolve, 2000))\n                }\n                let testCaseResult\n                if (skip) {\n                    testCaseResult = TestCaseResult.Skip\n                } else {\n                    const [oldInValues, result] = await this.runTestCase(testCase, testSuite, doLog)\n                    testCaseResult = result\n                    for (const [input, value] of oldInValues) {\n                        if (!restoreAfter.has(input)) {\n                            restoreAfter.set(input, value)\n                        }\n                    }\n                }\n                results.addTestCaseResult(testCase, testCaseResult)\n                ui?.setResult(i, testCaseResult)\n                if (testCase.stopOnFail && testCaseResult._tag === \"fail\") {\n                    skip = true\n                }\n            }\n            return results\n        })\n    }\n\n    public trySetInputsAndRecalc(inputs: TestCaseValueMap<Input>) {\n        for (const [input, valueRepr] of inputs) {\n            if (!isString(input)) {\n                input.setValue(valuesFromReprForInput(valueRepr, input.numBits))\n            } else {\n                console.error(`Input component ${input} not found`)\n            }\n        }\n        this.recalcPropagateAndDrawIfNeeded(false)\n    }\n\n    private async runTestCase(\n        testCase: TestCaseCombinational,\n        sourceSuite: TestSuite,\n        doLog: boolean\n    ): Promise<[Map<Input, LogicValue[]>, TestCaseResult]> {\n\n        if (doLog) {\n            const fullTestNameParts = [sourceSuite.name, testCase.name].filter(Boolean)\n            const fullTestName = fullTestNameParts.length === 0 ? S.Tests.DefaultTestCaseName : fullTestNameParts.join(\"/\")\n            console.group(\"Running test case \" + fullTestName)\n        }\n\n        testCase.tryFixReferences(this.editorRoot.components)\n        const oldInValues = new Map<Input, LogicValue[]>()\n        try {\n            for (const [input, valueRepr] of testCase.in) {\n                if (isString(input)) {\n                    return [oldInValues, TestCaseResult.Error(`Input component ${input} not found`)]\n                }\n                oldInValues.set(input, input.value)\n                input.setValue(valuesFromReprForInput(valueRepr, input.numBits))\n            }\n            // console.log(`Propagation starting at ${this.timeline.logicalTime()}...`)\n            this.recalcPropagateAndDrawIfNeeded(true)\n            await this.waitForPropagation()\n            // console.log(`Propagation done at ${this.timeline.logicalTime()}`)\n            const mismatches: TestCaseResultMismatch[] = []\n            for (const [output, expectedRepr] of testCase.out) {\n                if (isString(output)) {\n                    return [oldInValues, TestCaseResult.Error(`Output component ${output} not found`)]\n                }\n                const actual = output.value\n                const expected = valuesFromReprForInput(expectedRepr, output.numBits)\n                // console.log(`  ${outputName}: ${actual} (expected ${expected})`)\n                if (!deepArrayEquals(actual, expected)) {\n                    mismatches.push({ output, expected, actual })\n                    if (doLog) {\n                        const failMsg = `${output.ref} is ${actual} instead of ${expected}`\n                        console.log(`%cFAIL:%c ${failMsg}`, 'color: red; font-weight: bold;', '')\n                    }\n                } else {\n                    if (doLog) {\n                        const passMsg = `${output.ref} is ${expected}`\n                        console.log(`%cPASS:%c ${passMsg}`, 'color: green; font-weight: bold;', '')\n                    }\n                }\n            }\n            return [oldInValues, mismatches.length === 0 ? TestCaseResult.Pass : TestCaseResult.Fail(mismatches)]\n\n        } finally {\n            if (doLog) {\n                console.groupEnd()\n            }\n        }\n    }\n\n    /**\n     * Make sure that `recalcPropagateAndDrawIfNeeded` has been called after the change\n     * with an argument of `true` to force the redraw and reset the promise if needed.\n     */\n    public waitForPropagation() {\n        return this._propagationPromise\n    }\n\n    /**\n     * @param forceNow This must be `true` only if we have just changed values manually\n     * and we need to bypass and cancel the possible next animation frame to make sure we\n     * renew the propagation promise right now. Otherwise, the next animation frame\n     * will take care of the redraw.\n     */\n    public recalcPropagateAndDrawIfNeeded(forceNow: boolean = false) {\n        if (this._nextAnimationFrameHandle !== null) {\n            if (!forceNow) {\n                // an animation frame will be played soon anyway\n                return\n            } else {\n                cancelAnimationFrame(this._nextAnimationFrameHandle)\n                this._nextAnimationFrameHandle = null\n            }\n        }\n\n        const __recalculated = this.recalcMgr.recalcAndPropagateIfNeeded()\n\n        const redrawMgr = this.editTools.redrawMgr\n        const linkMgr = this._editorRoot.linkMgr\n        if (linkMgr.isAddingWire || linkMgr.isSettingAnchor) {\n            redrawMgr.requestRedraw({ why: \"adding a wire/setting anchor\" })\n        }\n\n        const animateWires = this._options.animateWires\n        const redrawInfo = redrawMgr.getReasonsAndClear()\n        if (redrawInfo === undefined && !animateWires) {\n            return\n        }\n\n        // By now, we know that we have to redraw\n\n        // we need to reset the promise if we have real redraw reasons, not only\n        // a wire animate to run\n        if (redrawInfo !== undefined && this._propagationResolve === undefined) {\n            // console.log(\"new propagation promise\")\n            // means that the promise has been resolved already and we are\n            // starting a new cycle, so we reset the promise\n            this._propagationPromise = new Promise(resolve => {\n                this._propagationResolve = resolve\n            })\n        }\n\n        const redrawMask = redrawInfo?.redrawMask ?? false\n        // console.log(\"Drawing \" + (__recalculated ? \"with\" : \"without\") + \" recalc, \" + (redrawMask ? \"with\" : \"without\") + \" redrawing mask, reasons:\\n    \" + (redrawInfo?.getReasons() ?? \"??\"))\n        this.doRedraw(redrawMask)\n\n        const invalidateTests = redrawInfo?.invalidateTests ?? false\n        if (invalidateTests && !this._isRunningOrCreatingTests) {\n            this.editTools.testsPalette.clearDisplayedResults()\n            this.dispatchEvent(new CustomEvent(\"testsinvalidated\"))\n            console.log(\"Dispatched testsinvalidated event\")\n        }\n\n        if (!redrawMgr.isAnyValuePropagating()) {\n            // console.log(\"No value is propagating\")\n            // if no value is propagating, we can resolve the promise, but after the\n            // next timeline updates\n\n            if (this._propagationResolve !== undefined) {\n                // console.log(\"will maybe call _propagationResolve\")\n                // we cannot finish this now if there are pending callbacks\n                // as they may change the state and we need to let them run\n\n                if (!this.timeline.hasPendingCallbacksNow()) {\n                    // console.log(\"-> yes\")\n                    // setTimeout(() => {\n                    this._propagationResolve()\n                    this._propagationResolve = undefined\n                    // }, 0)\n                } else {\n                    // console.log(\"-> no, there are pending callbacks\")\n                }\n            }\n        }\n\n        if (animateWires || redrawMgr.hasReasons()) {\n            // an animation is running\n            this._nextAnimationFrameHandle = requestAnimationFrame(() => {\n                this._nextAnimationFrameHandle = null\n                this.recalcPropagateAndDrawIfNeeded()\n            })\n        }\n    }\n\n    public highlight(refs: string | string[] | Component | undefined) {\n        if (refs === undefined) {\n            this._highlightedItems = undefined\n            return\n        }\n\n        if (isString(refs)) {\n            refs = [refs]\n        }\n\n        const highlightComps: Component[] = []\n        const highlightWires: Wire[] = []\n\n        if (!isArray(refs)) {\n            // a single component\n            highlightComps.push(refs)\n        } else {\n            for (const comp of this.components.all()) {\n                if (comp.ref !== undefined && refs.includes(comp.ref)) {\n                    highlightComps.push(comp)\n                }\n            }\n\n            for (const wire of this.linkMgr.wires) {\n                if (wire.ref !== undefined && refs.includes(wire.ref)) {\n                    highlightWires.push(wire)\n                }\n            }\n\n            if (highlightComps.length === 0 && highlightWires.length === 0) {\n                console.log(`Nothing to highlight for ref '${refs}'`)\n                this._highlightedItems = undefined\n                return\n            }\n        }\n\n        const start = this.timeline.unadjustedTime()\n        this._highlightedItems = { comps: highlightComps, wires: highlightWires, start }\n        this.editTools.redrawMgr.requestRedraw({ why: \"highlighting component\" })\n        this.recalcPropagateAndDrawIfNeeded()\n    }\n\n    public redraw() {\n        this.setCanvasSize()\n        this.editTools.redrawMgr.requestRedraw({ why: \"explicit redraw call\", invalidateMask: true })\n        this.recalcPropagateAndDrawIfNeeded()\n    }\n\n    private doRedraw(redrawMask: boolean) {\n        // const timeBefore = performance.now()\n        this._topBar?.updateTimeLabelIfNeeded()\n        const g = LogicEditor.getGraphics(this.html.mainCanvas)\n        const mainCanvas = this.html.mainCanvas\n        const baseDrawingScale = this._baseUIDrawingScale\n\n        const width = mainCanvas.width / baseDrawingScale\n        const height = mainCanvas.height / baseDrawingScale\n        // Recall that the matrices premultiply the coordinates, which means\n        // that the first transform is applied last and the last one first\n        const baseTransform = new DOMMatrix().scale(this._baseUIDrawingScale)\n        const contentTransform = baseTransform.scale(this._userDrawingScale).translate(this._translationX, this._translationY)\n        // console.log(`Drawing with zoom factor ${this._actualZoomFactor} and translation (${this._translationX}, ${this._translationY})`)\n        this.doDrawWithContext(g, width, height, baseTransform, contentTransform, false, false, redrawMask)\n        // const timeAfter = performance.now()\n        // console.log(`Drawing took ${timeAfter - timeBefore}ms`)\n    }\n\n    private doDrawWithContext(g: GraphicsRendering, width: number, height: number, baseTransform: DOMMatrixReadOnly, contentTransform: DOMMatrixReadOnly, skipBorder: boolean, transparentBackground: boolean, __redrawMask: boolean) {\n\n        // Draw order:\n        // * Clear\n        // * Highlight rectangles\n        // * Grid\n        // * Guidelines\n        // * Border\n        // * Components - background\n        // * Wires\n        // * Components - normal\n        // * Anchors\n        // * Components - overlays\n        // * Refs\n        // * Selection rect\n\n        // if (redrawMask) {\n        //     console.log(\"would redraw mask\")\n        // } else {\n        //     console.log(\"would not redraw mask\")\n        // }\n\n        g.setTransform(baseTransform)\n        g.lineCap = \"square\"\n        // eslint-disable-next-line no-restricted-syntax\n        g.textBaseline = \"alphabetic\"\n\n        // clear background\n        g.fillStyle = COLOR_BACKGROUND\n        if (transparentBackground) {\n            g.clearRect(0, 0, width, height)\n        } else {\n            g.fillRect(0, 0, width, height)\n        }\n        g.setTransform(contentTransform)\n\n        // draw highlight\n        const highlightRectFor = (comp: Component) => {\n            const margin = 15\n            let w = comp.unrotatedWidth + margin + margin\n            let h = comp.unrotatedHeight + margin + margin\n            if (Orientation.isVertical(comp.orient)) {\n                const t = w\n                w = h\n                h = t\n            }\n            return new DOMRect(comp.posX - w / 2, comp.posY - h / 2, w, h)\n        }\n\n        const highlightedItems = this._highlightedItems\n        let highlightColor: string | undefined = undefined\n        if (highlightedItems !== undefined) {\n            const HOLD_TIME = 2000\n            const FADE_OUT_TIME = 200\n            const START_ALPHA = 0.4\n            const elapsed = this.timeline.unadjustedTime() - highlightedItems.start\n            const highlightAlpha = (elapsed < HOLD_TIME) ? START_ALPHA : START_ALPHA * (1 - (elapsed - HOLD_TIME) / FADE_OUT_TIME)\n            if (highlightAlpha <= 0) {\n                this._highlightedItems = undefined\n            } else {\n\n                g.beginPath()\n                for (const comp of highlightedItems.comps) {\n                    const highlightRect = highlightRectFor(comp)\n                    g.moveTo(highlightRect.x, highlightRect.y)\n                    g.lineTo(highlightRect.right, highlightRect.y)\n                    g.lineTo(highlightRect.right, highlightRect.bottom)\n                    g.lineTo(highlightRect.x, highlightRect.bottom)\n                    g.closePath()\n                }\n\n                highlightColor = `rgba(238,241,0,${highlightAlpha})`\n                g.shadowColor = highlightColor\n                g.shadowBlur = 20\n                g.shadowOffsetX = 0\n                g.shadowOffsetY = 0\n                g.fillStyle = highlightColor\n                g.fill()\n\n                g.shadowBlur = 0 // reset\n\n                // will make it run until alpha is 0\n                this.editTools.redrawMgr.requestRedraw({ why: \"highlight animation\" })\n            }\n        }\n\n        // draw grid if moving comps\n        const moveMgr = this.editTools.moveMgr\n        // moveMgr.dump()\n        const isMovingComponent = moveMgr.areDrawablesMoving()\n        if (isMovingComponent) {\n            // set the transform to the base one but still apply the zoom factor\n            g.setTransform(baseTransform)\n            g.scale(this._userDrawingScale, this._userDrawingScale)\n            g.beginGroup(\"grid\")\n            const widthAdjusted = width / this._userDrawingScale\n            const heightAdjusted = height / this._userDrawingScale\n            const step = GRID_STEP //* 2\n            g.strokeStyle = COLOR_GRID_LINES\n            g.lineWidth = 1\n            g.beginPath()\n            for (let x = step; x < widthAdjusted; x += step) {\n                g.moveTo(x, 0)\n                g.lineTo(x, heightAdjusted)\n            }\n            for (let y = step; y < heightAdjusted; y += step) {\n                g.moveTo(0, y)\n                g.lineTo(widthAdjusted, y)\n            }\n            g.stroke()\n            g.endGroup()\n            g.setTransform(contentTransform)\n        }\n        if (!skipBorder && this.translationX !== 0 || this.translationY !== 0) {\n            // draw axes when translated\n            g.beginGroup(\"axes\")\n            g.strokeStyle = COLOR_GRID_LINES\n            g.fillStyle = COLOR_GRID_LINES\n            g.lineWidth = 1\n            g.beginPath()\n            g.moveTo(0, -10)\n            g.lineTo(0, 20)\n            g.moveTo(-10, 0)\n            g.lineTo(20, 0)\n            g.stroke()\n\n            // draw arrow head right\n            g.beginPath()\n            g.moveTo(22, 0)\n            g.lineTo(15, -3)\n            g.lineTo(15, 3)\n            g.closePath()\n            g.fill()\n\n            // draw arrow head down\n            g.beginPath()\n            g.moveTo(0, 22)\n            g.lineTo(-3, 15)\n            g.lineTo(3, 15)\n            g.closePath()\n            g.fill()\n\n            // draw \"0\" near origin\n            g.font = '10px sans-serif'\n            g.textAlign = 'right'\n            fillTextVAlign(g, TextVAlign.bottom, \"0\", -3, -3)\n\n            g.endGroup()\n        }\n\n        // draw guidelines when moving waypoint\n        const singleMovingWaypoint = moveMgr.getSingleMovingWaypoint()\n        if (singleMovingWaypoint !== undefined) {\n            g.beginGroup(\"guides\")\n            const guides = singleMovingWaypoint.getPrevAndNextAnchors()\n            g.strokeStyle = COLOR_GRID_LINES_GUIDES\n            g.lineWidth = 1.5\n            g.beginPath()\n            for (const guide of guides) {\n                g.moveTo(guide.posX, 0)\n                g.lineTo(guide.posX, height)\n                g.moveTo(0, guide.posY)\n                g.lineTo(width, guide.posY)\n            }\n            g.stroke()\n            g.endGroup()\n        }\n\n        // draw border according to mode\n        if (!skipBorder && (this._mode >= Mode.CONNECT || this._maxInstanceMode === MAX_MODE_WHEN_SINGLETON)) {\n            g.beginGroup(\"border\")\n            g.setTransform(baseTransform)\n            g.strokeStyle = COLOR_BORDER\n            g.lineWidth = 2\n            if (this._maxInstanceMode === MAX_MODE_WHEN_SINGLETON && this._mode < this._maxInstanceMode) {\n                g.strokeRect(0, 0, width, height)\n                const h = this.guessAdequateCanvasSize(true)[1]\n                strokeSingleLine(g, 0, h, width, h)\n\n                g.fillStyle = COLOR_BACKGROUND_UNUSED_REGION\n                g.fillRect(0, h, width, height - h)\n            } else {\n                // skip border where the top tab is\n                const myX = this.html.mainCanvas.getBoundingClientRect().x\n                const [x1, x2] = this._topBar?.getActiveTabCoords() ?? [0, 0]\n                g.beginPath()\n                g.moveTo(x1 - myX, 0)\n                g.lineTo(0, 0)\n                g.lineTo(0, height)\n                g.lineTo(width, height)\n                g.lineTo(width, 0)\n                g.lineTo(x2 - myX, 0)\n                g.stroke()\n            }\n            g.setTransform(contentTransform)\n            g.endGroup()\n        }\n\n        // const currentScale = this._currentScale\n        // g.scale(currentScale, currentScale)\n\n        const drawTime = this.timeline.logicalTime()\n        const drawTimeAnimationFraction = !this._options.animateWires ? undefined : (drawTime / 1000) % 1\n        g.strokeStyle = COLOR_COMPONENT_BORDER\n        const currentCompUnderPointer = this.eventMgr.currentComponentUnderPointer\n        const drawParams: DrawParams = {\n            drawTime,\n            drawTimeAnimationFraction,\n            currentCompUnderPointer,\n            highlightedItems,\n            highlightColor,\n            currentSelection: undefined,\n            anythingMoving: moveMgr.areDrawablesMoving(),\n        }\n        const currentSelection = this.eventMgr.currentSelection\n        drawParams.currentSelection = currentSelection\n        const drawComp = (comp: Component) => {\n            g.beginGroup(comp.constructor.name)\n            try {\n                comp.draw(g, drawParams)\n                for (const node of comp.allNodes()) {\n                    node.draw(g, drawParams) // never show nodes as selected\n                }\n            } finally {\n                g.endGroup()\n            }\n        }\n\n        const root = this._editorRoot\n\n        // draw background components\n        g.beginGroup(\"background\")\n        for (const comp of root.components.withZIndex(DrawZIndex.Background)) {\n            drawComp(comp)\n        }\n        g.endGroup()\n\n        // draw wires\n        g.beginGroup(\"wires\")\n        root.linkMgr.draw(g, drawParams) // never show wires as selected\n        g.endGroup()\n\n        // draw normal components\n        g.beginGroup(\"components\")\n        for (const comp of root.components.withZIndex(DrawZIndex.Normal)) {\n            drawComp(comp)\n        }\n        g.endGroup()\n\n        // draw anchor of moving component, if any\n        const movingCompWithAnchor = moveMgr.getSingleMovingComponentWithAnchors()\n        if (movingCompWithAnchor !== undefined) {\n            g.beginGroup(\"anchors\")\n            drawAnchorsForComponent(g, movingCompWithAnchor, true)\n            g.endGroup()\n        } else if (this._options.showAnchors) {\n            g.beginGroup(\"anchors\")\n            for (const comp of root.components.all()) {\n                drawAnchorsForComponent(g, comp, false)\n            }\n            g.endGroup()\n        }\n\n        // draw overlays\n        g.beginGroup(\"overlays\")\n        for (const comp of root.components.withZIndex(DrawZIndex.Overlay)) {\n            drawComp(comp)\n        }\n        g.endGroup()\n\n        // draw refs\n        if (this._options.showIDs) {\n            g.beginGroup(\"refs\")\n            g.font = 'bold 14px sans-serif'\n            g.strokeStyle = \"white\"\n            g.lineWidth = 3\n            g.fillStyle = COLOR_COMPONENT_ID\n            g.textAlign = 'center'\n            for (const comp of root.components.all()) {\n                if (comp.ref !== undefined) {\n                    strokeTextVAlign(g, TextVAlign.middle, comp.ref, comp.posX, comp.posY)\n                    fillTextVAlign(g, TextVAlign.middle, comp.ref, comp.posX, comp.posY)\n                }\n            }\n            g.endGroup()\n        }\n\n        // draw selection\n        let selRect\n        if (currentSelection !== undefined && (selRect = currentSelection.currentlyDrawnRect) !== undefined) {\n            g.beginGroup(\"selection\")\n            g.lineWidth = 1.5\n            g.strokeStyle = \"rgb(100,100,255)\"\n            g.fillStyle = \"rgba(100,100,255,0.2)\"\n            g.beginPath()\n            g.rect(selRect.x, selRect.y, selRect.width, selRect.height)\n            g.stroke()\n            g.fill()\n            g.endGroup()\n        }\n\n        // this.drawDebugInfo(g)\n    }\n\n    private drawDebugInfo(g: GraphicsRendering) {\n        // debug draw origin\n        drawPoint(0, 0)\n        for (const d of [100, 200]) {\n            for (const [x, y] of [[-d, -d], [-d, 0], [-d, d], [0, -d], [0, d], [d, d], [d, 0], [d, -d]]) {\n                drawPoint(x, y)\n            }\n        }\n\n        function drawPoint(x: number, y: number) {\n            g.lineWidth = 2\n            g.strokeStyle = \"red\"\n            g.beginPath()\n            g.moveTo(x - 10, y)\n            g.lineTo(x + 10, y)\n            g.moveTo(x, y - 10)\n            g.lineTo(x, y + 10)\n            g.stroke()\n            g.fillStyle = \"black\"\n            g.font = 'bold 10px sans-serif'\n            g.textAlign = 'left'\n            fillTextVAlign(g, TextVAlign.top, `${x},${y}`, x + 4, y + 4)\n        }\n    }\n\n    public deleteSelection() {\n        if (this.eventMgr.currentSelectionEmpty()) {\n            return false\n        }\n        let anyDeleted = false\n        for (const elem of this.eventMgr.currentSelection?.previouslySelectedElements ?? []) {\n            anyDeleted = this.eventMgr.tryDeleteDrawable(elem).isChange || anyDeleted\n        }\n\n        if (!anyDeleted) {\n            return false\n        }\n\n        this.editTools.undoMgr.takeSnapshot()\n        return true\n    }\n\n    public async cut() {\n        const copied = await this.copy()\n        if (!copied) {\n            return\n        }\n        await this.deleteSelection()\n    }\n\n    public async copy(): Promise<boolean> {\n        if (this.eventMgr.currentSelectionEmpty()) {\n            return false\n        }\n        const componentsToInclude: Component[] = []\n        for (const elem of this.eventMgr.currentSelection?.previouslySelectedElements ?? []) {\n            if (elem instanceof ComponentBase) {\n                componentsToInclude.push(elem)\n            }\n        }\n\n        // TODO check if we're copying custom components to include their def?\n        // ... but then, beware of duplicated custom components if pasting into the same circuit,\n        // or find some compatibility criterion for component defs (e.g., number of in/out nodes\n        // and names) that would seem enough to determine they are the same (beyond their id/name)\n        const reprs = Serialization.buildComponentsAndWireObject(componentsToInclude, [], [this.pointerX, this.pointerY])\n        if (reprs.components === undefined && reprs.wires === undefined) {\n            return false\n        }\n\n        const jsonStr = Serialization.stringifyObject(reprs, false)\n        const copied = await copyToClipboard(jsonStr)\n        if (copied) {\n            console.log(\"Copied:\\n\" + jsonStr)\n        } else {\n            console.log(\"Could not copy\")\n        }\n        this.focus()\n        return copied\n    }\n\n    public async paste() {\n        const oldDontHogFocus = this._dontHogFocus\n        this._dontHogFocus = true\n        let jsonStr: string | undefined = undefined\n        try {\n            jsonStr = await pasteFromClipboard()\n        } finally {\n            this._dontHogFocus = oldDontHogFocus\n        }\n        if (jsonStr === undefined || jsonStr === \"\") {\n            return\n        }\n        const errorOrComps = Serialization.pasteComponents(this, jsonStr)\n        if (isString(errorOrComps)) {\n            console.log(errorOrComps)\n        } else {\n            const selection = new EditorSelection(undefined)\n            for (const comp of errorOrComps) {\n                selection.toggle(comp)\n            }\n            this.eventMgr.currentSelection = selection\n        }\n        this.focus()\n    }\n\n    public wrapHandler<T extends unknown[], R>(f: (...params: T) => R extends Promise<any> ? never : R): (...params: T) => R {\n        return (...params: T) => {\n            const result = f(...params)\n            this.recalcPropagateAndDrawIfNeeded()\n            return result\n        }\n    }\n\n    public wrapAsyncHandler<T extends unknown[], R>(f: (...params: T) => Promise<R>): (...params: T) => Promise<R> {\n        return async (...params: T) => {\n            const result = await f(...params)\n            this.recalcPropagateAndDrawIfNeeded()\n            return result\n        }\n    }\n\n    public static decodeFromURLOld(str: string) {\n        return decodeURIComponent(atob(str.replace(/-/g, \"+\").replace(/_/g, \"/\").replace(/%3D/g, \"=\")))\n    }\n\n    public static getGraphics(canvas: HTMLCanvasElement): GraphicsRendering {\n        const g = canvas.getContext(\"2d\")! as GraphicsRendering\n        g.createPath = (path?: Path2D | string) => new Path2D(path)\n        g.beginGroup = () => undefined\n        g.endGroup = () => undefined\n        return g\n    }\n}\n\nexport class LogicStatic {\n\n    public constructor(\n        public readonly template: HTMLTemplateElement,\n    ) { }\n\n    public singleton: LogicEditor | undefined\n\n    public highlight(diagramRefs: string | string[], componentRefs: string | string[]) {\n        if (isString(diagramRefs)) {\n            diagramRefs = [diagramRefs]\n        }\n        for (const diagramRef of diagramRefs) {\n            const diagram = document.getElementById(\"logic_\" + diagramRef) ?? document.getElementById(diagramRef)\n            if (diagram === null) {\n                console.log(`Cannot find logic diagram with reference '${diagramRef}'`)\n                return\n            }\n            if (!(diagram instanceof LogicEditor)) {\n                console.log(`Element with id '${diagramRef}' is not a logic editor`)\n                return\n            }\n            diagram.highlight(componentRefs)\n        }\n    }\n\n    public runSampleTestSuite(options: unknown): void {\n        const f = async () => {\n            if (this.singleton) {\n                const testSuite = new TestSuite([{\n                    name: \"Simple XOR gate test suite\",\n                    cases: [{\n                        name: \"false false -> false\",\n                        in: { in0: 0, in1: 0 },\n                        out: { out0: 0 },\n                        stopOnFail: true,\n                    }, {\n                        name: \"false true -> true\",\n                        in: { in0: 1, in1: 0 },\n                        out: { out0: 1 },\n                    }, {\n                        name: \"true false -> true\",\n                        in: { in0: 0, in1: 1 },\n                        out: { out0: 1 },\n                    }, {\n                        name: \"true true -> false\",\n                        in: { in0: 1, in1: 1 },\n                        out: { out0: 0 },\n                    }],\n                }, this.singleton.editorRoot.components])\n                const _opts = isRecord(options) ? options : {}\n                const results = await this.singleton.runTestSuite(testSuite, _opts)\n                if (results === undefined) {\n                    console.error(\"Could not run test suite\")\n                } else {\n                    results.dump()\n                }\n            }\n        }\n        setTimeout(f, 0)\n    }\n\n    public printUndoStack() {\n        this.singleton?.editTools.undoMgr.dump()\n    }\n\n    public readonly tests = new Tests()\n\n    public readonly Serialization = Serialization\n\n    public setDarkMode(mode: boolean | string) {\n        if (mode === \"auto\") {\n            mode = window.matchMedia(\"(prefers-color-scheme: dark)\").matches\n        } else if (mode === \"false\") {\n            mode = false\n        } else if (isString(mode)) {\n            const col = parseColorToRGBA(mode)\n            if (col !== undefined) {\n                const rgbaString = col[3] === 255 ? `rgb(${col[0]}, ${col[1]}, ${col[2]})` : `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3] / 255})`\n                USER_COLORS.COLOR_BACKGROUND = rgbaString\n                const looksDark = col[0] + col[1] + col[2] < 3 * 128\n                console.log(`Will use '${rgbaString}' as background color, interpreted as a ${looksDark ? \"dark\" : \"light\"} theme`)\n                mode = looksDark\n            }\n        }\n        setDarkMode(Boolean(mode), true)\n    }\n\n}\n\n\nif (InBrowser) {\n    // cannot be in setup function because the 'template' var is not assigned until that func returns\n    // and promotion of elems occurs during this 'customElements.define' call\n    const template = (() => {\n        const template = document.createElement('template')\n        template.innerHTML = LogicEditorTemplate\n        const styles = [LogicEditorCSS, DialogPolyfillCSS]\n        template.content.querySelector(\"#inlineStyle\")!.innerHTML = styles.join(\"\\n\\n\\n\")\n        template.content.querySelectorAll(\"i.svgicon\").forEach(setupSvgIcon)\n        return template\n    })()\n    window.Logic = new LogicStatic(template)\n    window.customElements.define('logic-editor', LogicEditor)\n    document.addEventListener(\"toggle\", e => {\n        if (!(e.target instanceof HTMLDetailsElement)) {\n            return\n        }\n        if (e.target.open) {\n            e.target.querySelectorAll(\"logic-editor\").forEach(el => {\n                if (el instanceof LogicEditor) {\n                    el.redraw()\n                }\n            })\n        }\n    }, true)\n\n} else {\n    // TODO\n    console.log(\"cli\")\n}\n", "import * as t from \"io-ts\"\nimport JSON5 from \"json5\"\nimport { LogicEditor } from \"./LogicEditor\"\nimport { Serialization } from \"./Serialization\"\nimport { TestCaseCombinational, TestCaseCombinationalRepr } from \"./TestSuite\"\nimport { ALUDef } from \"./components/ALU\"\nimport { AdderDef } from \"./components/Adder\"\nimport { AdderArrayDef } from \"./components/AdderArray\"\nimport { Clock, ClockDef } from \"./components/Clock\"\nimport { ComparatorDef } from \"./components/Comparator\"\nimport { Component, ComponentBase, ComponentRepr } from \"./components/Component\"\nimport { ControlledInverterDef } from \"./components/ControlledInverter\"\nimport { CounterDef } from \"./components/Counter\"\nimport { CustomComponent, CustomComponentDef, CustomComponentDefRepr, CustomComponentPrefix } from \"./components/CustomComponent\"\nimport { DecoderDef } from \"./components/Decoder\"\nimport { Decoder16SegDef } from \"./components/Decoder16Seg\"\nimport { Decoder7SegDef } from \"./components/Decoder7Seg\"\nimport { DecoderBCD4Def } from \"./components/DecoderBCD4\"\nimport { DemuxDef } from \"./components/Demux\"\nimport { DisplayDef } from \"./components/Display\"\nimport { Display16SegDef } from \"./components/Display16Seg\"\nimport { Display7SegDef } from \"./components/Display7Seg\"\nimport { DisplayAsciiDef } from \"./components/DisplayAscii\"\nimport { DisplayBarDef } from \"./components/DisplayBar\"\nimport { DrawableParent, MenuData } from \"./components/Drawable\"\nimport { FlipflopDDef } from \"./components/FlipflopD\"\nimport { FlipflopJKDef } from \"./components/FlipflopJK\"\nimport { FlipflopTDef } from \"./components/FlipflopT\"\nimport { Gate1Def, GateNDef } from \"./components/Gate\"\nimport { GateArrayDef } from \"./components/GateArray\"\nimport { Gate1Types, GateNTypes } from \"./components/GateTypes\"\nimport { HalfAdderDef } from \"./components/HalfAdder\"\nimport { Input, InputDef } from \"./components/Input\"\nimport { Label, LabelDef } from \"./components/Label\"\nimport { LatchSRDef } from \"./components/LatchSR\"\nimport { MuxDef } from \"./components/Mux\"\nimport { Output, OutputDef } from \"./components/Output\"\nimport { PassthroughDef } from \"./components/Passthrough\"\nimport { PixelDef } from \"./components/Pixel\"\nimport { RAMDef } from \"./components/RAM\"\nimport { ROMDef } from \"./components/ROM\"\nimport { RandomDef } from \"./components/Random\"\nimport { RectangleDef } from \"./components/Rectangle\"\nimport { RegisterDef } from \"./components/Register\"\nimport { ShiftDisplayDef } from \"./components/ShiftDisplay\"\nimport { ShiftRegisterDef } from \"./components/ShiftRegister\"\nimport { TristateBufferDef } from \"./components/TristateBuffer\"\nimport { TristateBufferArrayDef } from \"./components/TristateBufferArray\"\nimport { S } from \"./strings\"\nimport { binaryStringRepr, isArray, isRecord, isString, validateJson, valuesReprForTest } from \"./utils\"\n\n// Generic interface to instantiate components from scratch (possibly with params) or from JSON\ntype ComponentMaker<TParams extends Record<string, unknown>> = {\n    isValid(): boolean,\n    type: string,\n    make(parent: DrawableParent, params?: TParams): Component,\n    makeFromJSON(parent: DrawableParent, data: Record<string, unknown>): Component | undefined,\n}\n\n// All predefined components except the ones which don't have\n// static type strings: Gate1, GateN, GateArray, CustomComponent\nconst AllComponentDefs: ComponentMaker<any>[] = [\n    // in\n    InputDef,\n    ClockDef,\n    RandomDef,\n\n    // out\n    OutputDef,\n    DisplayDef,\n    Display7SegDef,\n    Display16SegDef,\n    DisplayAsciiDef,\n    DisplayBarDef,\n    PixelDef,\n    ShiftDisplayDef,\n\n    // gates\n    Gate1Def,\n    GateNDef,\n    GateArrayDef,\n    TristateBufferDef,\n    TristateBufferArrayDef,\n    ControlledInverterDef,\n\n    // labels & layout\n    LabelDef,\n    RectangleDef,\n    PassthroughDef,\n\n    // ic\n    HalfAdderDef,\n    AdderDef,\n    ComparatorDef,\n    AdderArrayDef,\n    ALUDef,\n    MuxDef,\n    DemuxDef,\n    LatchSRDef,\n    FlipflopJKDef,\n    FlipflopTDef,\n    FlipflopDDef,\n    RegisterDef,\n    ShiftRegisterDef,\n    ROMDef,\n    RAMDef,\n    CounterDef,\n    DecoderDef,\n    Decoder7SegDef,\n    Decoder16SegDef,\n    DecoderBCD4Def,\n]\n\n// Data present in the HTMLElement of a component button\nexport type ButtonDataset = {\n    type: string,\n    componentId?: string,\n    params?: string,\n}\n\nexport class ComponentFactory {\n\n    public readonly editor: LogicEditor\n    private readonly _predefinedComponents = new Map<string, ComponentMaker<any>>()\n    private readonly _customComponents = new Map<string, CustomComponentDef>()\n\n    public constructor(editor: LogicEditor) {\n        this.editor = editor\n        for (const maker of AllComponentDefs) {\n            const key = maker.type\n            if (!maker.isValid()) {\n                throw new Error(`Implementation missing for components of type '${key}'`)\n            }\n            // console.log(`Registering component for '${key}'`)\n            if (this._predefinedComponents.has(key)) {\n                throw new Error(`Duplicate component for components of type '${key}'`)\n            }\n            this._predefinedComponents.set(key, maker)\n        }\n    }\n\n\n    // Component creation functions\n\n    public makeFromJSON(parent: DrawableParent, obj_: unknown, offsetPos?: [number, number]): Component | undefined {\n        if (!isRecord(obj_)) {\n            console.warn(`Skipping invalid non-object component: ${JSON5.stringify(obj_, null, 2)}`)\n            return undefined\n        }\n        const obj = obj_ as Partial<ComponentRepr<boolean, boolean>>\n        if (offsetPos !== undefined) {\n            if (isArray(obj.pos)) {\n                obj.pos = [obj.pos[0] + offsetPos[0], obj.pos[1] + offsetPos[1]]\n            }\n        }\n        const type = isString(obj.type) ? obj.type : \"<unknown>\"\n        const maker = this.getMaker(type)\n        return maker?.makeFromJSON(parent, obj)\n    }\n\n    public makeFromButton(parent: DrawableParent, elem: HTMLElement) {\n        const compDataset = elem.dataset as ButtonDataset\n        const paramsStr = compDataset.params\n        const maker = this.getMaker(compDataset.type)\n        const params = paramsStr === undefined ? undefined : JSON5.parse(paramsStr) as Record<string, unknown>\n        return maker?.make(parent, params)\n\n        // TODO further general component customisation based on editor options\n        // const classId = compDataset.componentId\n        // if (classId === undefined) {\n        //     console.warn(\"No class ID linked to elem \" + elem.outerHTML)\n        // } else {\n        //     const compConfig = editor.options.initParams?.[classId]\n        //     if (compConfig !== undefined) {\n        //         let val\n        //         if ((val = compConfig.orient) !== undefined) {\n        //             newComp.doSetOrient(val)\n        //         }\n        //     }\n\n    }\n\n    private getMaker(type: string): ComponentMaker<any> | undefined {\n        let maker\n        // normal cases\n        if ((maker = this._predefinedComponents.get(type)) !== undefined) {\n            return maker\n        }\n\n        // gates\n        if (Gate1Types.includes(type)) {\n            return Gate1Def\n        } else if (GateNTypes.includes(type)) {\n            return GateNDef\n        }\n\n        const hyphenPos = type.indexOf(\"-\")\n        if (hyphenPos !== -1) {\n\n            // gate arrays\n            const typeStart = type.substring(0, hyphenPos)\n            const typeEnd = type.substring(hyphenPos + 1)\n            if (typeEnd === \"array\" && GateNTypes.includes(typeStart)) {\n                return GateArrayDef\n            }\n\n            // custom components\n            if (type.startsWith(CustomComponentPrefix)) {\n                const customId = type.substring(CustomComponentPrefix.length)\n                if ((maker = this._customComponents.get(customId)) !== undefined) {\n                    return maker\n                }\n            }\n        }\n\n        console.warn(`Unknown component for '${type}'`)\n        return undefined\n    }\n\n\n    // Custom components handling\n\n    public getCustomDef(customId: string): CustomComponentDef | undefined {\n        return this._customComponents.get(customId)\n    }\n\n    public customDefs(): CustomComponentDef[] | undefined {\n        if (this._customComponents.size === 0) {\n            return undefined\n        }\n        return [...this._customComponents.values()]\n    }\n\n    public customDefReprs(): CustomComponentDefRepr[] | undefined {\n        const defs = this.customDefs()\n        if (defs === undefined) {\n            return undefined\n        }\n        return defs.map(def => def.toJSON())\n    }\n\n    public clearCustomDefs() {\n        this._customComponents.clear()\n    }\n\n    public getCustomComponentTypesWhichUse(id: string) {\n        const compIds: string[] = [id]\n        for (const def of this._customComponents.values()) {\n            if (def.uses(id, [true, this])) {\n                compIds.push(def.type)\n            }\n        }\n        return compIds\n    }\n\n    public tryAddCustomDef(def: CustomComponentDef, overwrite: boolean): ComponentMaker<any> | undefined {\n        // Calling this may change the list of custom defs, we may need to update the UI\n        const customid = def.customId\n        if (!overwrite && this._customComponents.has(customid)) {\n            console.warn(`Could not add custom component with duplicate id '${customid}'`)\n            return undefined\n        }\n        this._customComponents.set(customid, def)\n        return def\n    }\n\n    public tryLoadCustomDefsFrom(defs: unknown): number {\n        // Calling this may change the list of custom defs, we may need to update the UI\n        if (defs === undefined) {\n            return 0\n        }\n        const validatedDefs = validateJson(defs, t.array(CustomComponentDefRepr), \"defs\")\n        if (validatedDefs === undefined) {\n            return 0\n        }\n        let numLoaded = 0\n        for (const validatedDef of validatedDefs) {\n            const maker = this.tryAddCustomDef(new CustomComponentDef(validatedDef), false)\n            if (maker !== undefined) {\n                numLoaded++\n            }\n        }\n        return numLoaded\n    }\n\n    public hasCustomComponents() {\n        return this._customComponents.size > 0\n    }\n\n    public makeContextMenu(id: string): MenuData | undefined {\n        const customId = id.substring(CustomComponentPrefix.length)\n        const def = this._customComponents.get(customId)\n        if (def === undefined) {\n            return undefined\n        }\n\n        const s = S.Components.Custom.contextMenu\n        return [\n            MenuData.item(\"pen\", s.ChangeName, () => this.runChangeCustomComponentCaptionDialog(def)),\n            MenuData.item(\"connect\", s.ChangeCircuit, () => {\n                window.alert(s.EditFromComponentMessage)\n            }),\n            MenuData.sep(),\n            MenuData.item(\"trash\", s.Delete, () => {\n                if (this.editor.components.contains(id)) {\n                    window.alert(s.CannotDeleteInUse)\n                    return\n                }\n                for (const compDef of this._customComponents.values()) {\n                    if (compDef.uses(def.type, false)) {\n                        window.alert(s.CannotDeleteInUseBy.expand({ caption: compDef.caption }))\n                        return\n                    }\n                }\n                if (window.confirm(s.ConfirmDelete)) {\n                    this._customComponents.delete(customId)\n                    this.editor.updateCustomComponentButtons()\n                }\n            }, undefined, true),\n        ]\n    }\n\n    public runChangeCustomComponentCaptionDialog(def: CustomComponentDef) {\n        const s = S.Components.Custom.contextMenu\n        const oldCaption = def.caption\n        const oldType = def.type\n        // eslint-disable-next-line no-constant-condition\n        while (true) {\n            const newCaption = window.prompt(s.ChangeNamePrompt, oldCaption)\n            if (newCaption === null || newCaption === oldCaption) {\n                return\n            }\n            if (newCaption.length === 0) {\n                window.alert(s.ChangeNameEmpty)\n                continue\n            }\n\n            def.doSetCaption(newCaption)\n            const oldDefaultCustomId = makeCustomIdFromCaption(oldCaption)\n            if (def.customId === oldDefaultCustomId) {\n                // The ID was automatically generated from the caption, so we'll try to update it as well\n                const newCustomId = makeCustomIdFromCaption(newCaption)\n                if (!this._customComponents.has(newCustomId)) {\n                    // we can actually change it without conflicts\n                    this._customComponents.delete(oldDefaultCustomId)\n                    def.customId = newCustomId\n                    const newType = def.type\n\n                    // update the type in all custom conponent definitions\n                    for (const compDef of this._customComponents.values()) {\n                        for (const compRepr of Object.values(compDef.circuit.components ?? {})) {\n                            if (compRepr.type === oldType) {\n                                compRepr.type = newType\n                            }\n                        }\n                    }\n                    this._customComponents.set(newCustomId, def)\n                }\n            }\n            break\n        }\n\n        this.editor.updateCustomComponentButtons()\n        this.editor.components.updateCustomComponents(oldType) // they still have the old type\n        this.editor.focus()\n    }\n\n    public tryMakeNewCustomComponent(editor: LogicEditor): CustomComponentDef | string {\n        const s = S.Components.Custom.messages\n\n        const selectionAll = editor.eventMgr.currentSelection?.previouslySelectedElements\n        if (selectionAll === undefined) {\n            return s.EmptySelection\n        }\n        const selectedComps = [...selectionAll].filter((e): e is Component => e instanceof ComponentBase)\n        if (selectedComps.length === 0) {\n            return s.EmptySelection\n        }\n\n        const checkResult = this.checkComponentsForCustomDef(selectedComps)\n        if (isString(checkResult)) {\n            return checkResult\n        }\n\n        const componentsToInclude = checkResult.components\n\n        let caption\n        const labels = componentsToInclude.filter((e): e is Label => e instanceof Label)\n        if (labels.length !== 1) {\n            caption = window.prompt(s.EnterCaptionPrompt)\n            if (caption === null) {\n                return \"\"\n            }\n        } else {\n            caption = labels[0].text\n        }\n\n        const id = makeCustomIdFromCaption(caption)\n        if (this._customComponents.has(id)) {\n            return s.ComponentAlreadyExists.expand({ id })\n        }\n\n        const { components, wires } = Serialization.buildComponentsAndWireObject(componentsToInclude, [], undefined)\n        if (components === undefined || wires === undefined) {\n            return s.NoWires\n        }\n\n        const customDef = new CustomComponentDef({\n            id, caption, circuit: { components, wires },\n        })\n        const maker = this.tryAddCustomDef(customDef, false)\n        if (maker === undefined) {\n            return \"\"\n        }\n\n        const customComp = maker.make(editor)\n        customComp.setSpawned()\n        customComp.setPosition(editor.pointerX + customComp.unrotatedWidth / 2 - 5, editor.pointerY, true)\n        editor.eventMgr.currentSelection = undefined\n        editor.eventMgr.setCurrentComponentUnderPointer(customComp)\n\n        for (const comp of componentsToInclude) {\n            editor.components.tryDelete(comp)\n        }\n\n        return customDef\n    }\n\n    public tryMakeNewTestCase(editor: LogicEditor): TestCaseCombinational | string {\n\n        const checkResult = this.checkSelectionForTestCase(editor)\n        if (isString(checkResult)) {\n            return checkResult\n        }\n\n        const { inputs, outputs } = checkResult\n\n        return this.makeTestCaseWithCurrentValues(editor, inputs, outputs, true) ?? \"\"\n    }\n\n    private makeTestCaseWithCurrentValues<B extends boolean>(editor: LogicEditor, inputs: Input[], outputs: Output[], askName: B): TestCaseCombinational | (B extends true ? undefined : never) {\n\n        const joiner = \"\\n \u2022 \"\n        const inReprBuf: string[] = []\n        const outReprBuf: string[] = []\n\n        const mkDesc = (reprBuf: string[]) => (inOut: Input | Output) => {\n            const repr = binaryStringRepr(inOut.value)\n            reprBuf.push(repr)\n            return `${inOut.ref ?? \"?\"}${isString(inOut.name) ? ` (\u201C${inOut.name}\u201D)` : \"\"}: ${repr}`\n        }\n\n        const s = S.Messages\n        const inputsStr = s.TestCaseInputToSet.expand({ n: inputs.length }) + joiner + inputs.map(mkDesc(inReprBuf)).join(joiner)\n        const outputsStr = s.TestCaseOuputToCheck.expand({ n: outputs.length }) + joiner + outputs.map(mkDesc(outReprBuf)).join(joiner)\n\n\n        const prompt = s.NewTestCaseTitle + `\\n\\n${inputsStr}\\n\\n${outputsStr}\\n\\n` + s.NewTestCaseSetName\n        let testCaseName: string | null = inReprBuf.join(\" \") + \" \u2192 \" + outReprBuf.join(\" \")\n\n        if (askName) {\n            testCaseName = window.prompt(prompt, testCaseName)\n            if (testCaseName === null) {\n                return undefined as any\n            }\n        }\n\n        const inMap: TestCaseCombinationalRepr[\"in\"] = Object.create(null)\n        for (const input of inputs) {\n            inMap[input.ref ?? \"?\"] = valuesReprForTest(input.value)\n        }\n\n        const outMap: TestCaseCombinationalRepr[\"out\"] = Object.create(null)\n        for (const output of outputs) {\n            outMap[output.ref ?? \"?\"] = valuesReprForTest(output.value)\n        }\n\n        return new TestCaseCombinational({\n            in: inMap, out: outMap,\n            name: testCaseName.length === 0 ? undefined : testCaseName,\n        }, editor.components)\n    }\n\n    public async tryMakeAllTestCases(editor: LogicEditor): Promise<TestCaseCombinational[] | string> {\n        const checkResult = this.checkSelectionForTestCase(editor)\n        if (isString(checkResult)) {\n            return checkResult\n        }\n\n        const { inputs, outputs } = checkResult\n\n        const s = S.Messages\n        const max = 10\n\n        const inputsByBit: Array<[Input, number]> = []\n        let numInputs = 0\n        for (const input of inputs) {\n            for (let i = 0; i < input.numBits; i++) {\n                inputsByBit.push([input, i])\n            }\n            numInputs += input.numBits\n        }\n\n        const setBit = (i: number, value: boolean) => {\n            const [input, bit] = inputsByBit[i]\n            const newValues = input.value.slice()\n            newValues[bit] = value\n            input.setValue(newValues)\n        }\n\n        if (numInputs > max) {\n            return s.TooManyInputsForAutoTestCases.expand({ max })\n        }\n\n        const numCases = Math.pow(2, numInputs)\n        if (!confirm(s.AutoTestCasesWarning.expand({ numInputs, numCases }))) {\n            return \"\"\n        }\n\n        const result = await editor.disableUIWhile(s.ComputingTestCases, async restoreAfter => {\n            for (const input of inputs) {\n                restoreAfter.set(input, input.value)\n            }\n\n            const testCases: TestCaseCombinational[] = []\n            for (let i = 0; i < numCases; i++) {\n                for (let j = 0; j < numInputs; j++) {\n                    const value = (i & (1 << j)) !== 0\n                    setBit(j, value)\n                }\n                editor.recalcPropagateAndDrawIfNeeded(true)\n                await editor.waitForPropagation()\n                testCases.push(this.makeTestCaseWithCurrentValues(editor, inputs, outputs, false))\n            }\n\n            return testCases\n        })\n\n        return result ?? \"\"\n    }\n\n    public tryModifyCustomComponent(def: CustomComponentDef, defRoot: CustomComponent): undefined | string {\n        const s = S.Components.Custom.messages\n        const components = [...defRoot.components.all()]\n\n        const checkResult = this.checkComponentsForCustomDef(components)\n        if (isString(checkResult)) {\n            return checkResult\n        }\n\n        const newComponents = checkResult.components\n\n        const circuit = Serialization.buildComponentsAndWireObject(newComponents, [], undefined)\n        if (circuit.components === undefined || circuit.wires === undefined) {\n            return \"\"\n        }\n\n        const newDef = new CustomComponentDef({\n            id: def.customId,\n            caption: def.caption,\n            circuit: { components: circuit.components, wires: circuit.wires },\n        })\n\n        if (newDef.numInputs !== def.numInputs || newDef.numOutputs !== def.numOutputs) {\n            if (!window.confirm(s.InputsOutputsChanged)) {\n                return \"\" // cancelled\n            }\n        }\n\n        this.tryAddCustomDef(newDef, true)\n        return undefined // success\n    }\n\n    private checkComponentsForCustomDef(components: Component[]): { components: Component[], inputs: Input[], outputs: Output[] } | string {\n        const s = S.Components.Custom.messages\n\n        const inputs = components.filter((e): e is Input => e instanceof Input)\n        if (inputs.length === 0) {\n            return s.NoInput\n        }\n\n        const outputs = components.filter((e): e is Output => e instanceof Output)\n        if (outputs.length === 0) {\n            return s.NoOutput\n        }\n\n\n        // Check that all inputs and outputs have names\n        function checkNames(inOuts: Array<Input | Output>): boolean {\n            const names = new Set<string>()\n            const missingNames: Array<Input | Output> = []\n            for (const inOut of inOuts) {\n                const name = inOut.name\n                if (name === undefined) {\n                    missingNames.push(inOut)\n                } else {\n                    if (!isString(name) || names.has(name)) {\n                        return false\n                    }\n                    names.add(name)\n                }\n            }\n            for (const inOut of missingNames) {\n                const prefix = inOut instanceof Input ? \"In\" : \"Out\"\n                let i = 0, name\n                do {\n                    name = `${prefix}${i++}`\n                } while (names.has(name))\n                inOut.doSetName(name)\n                names.add(name)\n            }\n            return true\n        }\n\n        const namesValid = checkNames(inputs) && checkNames(outputs)\n        if (!namesValid) {\n            return s.InputsOutputsMustHaveNames\n        }\n\n\n        const componentsToInclude: Component[] = [...inputs, ...outputs]\n        const queue: Component[] = []\n        let comp\n\n        // Go forward from inputs to keep all linked components.\n        // We don't complain about linked components that are not in the selection\n        // as we allow inputs to connect to other stuff as well.\n        queue.push(...inputs)\n        while ((comp = queue.shift()) !== undefined) {\n            for (const node of comp.outputs._all) {\n                for (const wire of node.outgoingWires) {\n                    const otherComp = wire.endNode.component\n                    if (components.includes(otherComp)\n                        && !componentsToInclude.includes(otherComp)) {\n                        componentsToInclude.push(otherComp)\n                        queue.push(otherComp)\n                    }\n                }\n            }\n        }\n\n        // Go backward from outputs to include all linked components\n        // and make sure all necessary components are in the selection.\n        queue.push(...outputs)\n        const missingComponents: Component[] = []\n        while ((comp = queue.shift()) !== undefined) {\n            for (const node of comp.inputs._all) {\n                const wire = node.incomingWire\n                if (wire !== null) {\n                    const otherComp = wire.startNode.component\n\n                    if (!components.includes(otherComp)) {\n                        // this component is missing from the selection\n                        if (!missingComponents.includes(otherComp)) {\n                            missingComponents.push(otherComp)\n                        }\n                    } else {\n                        if (!componentsToInclude.includes(otherComp)) {\n                            componentsToInclude.push(otherComp)\n                            queue.push(otherComp)\n                        }\n                    }\n                }\n            }\n        }\n\n        if (missingComponents.length > 0) {\n            const missingCompsStr = missingComponents.map(c => c.toString()).join(\", \")\n            return s.MissingComponents.expand({ list: missingCompsStr })\n        }\n\n        const uselessComponents = components.filter(c =>\n            !componentsToInclude.includes(c)\n            // allow disconnected comps that have no inputs or outputs, e.g. labels\n            && (c.inputs._all.length !== 0 || c.outputs._all.length !== 0)\n        )\n        if (uselessComponents.length > 0) {\n            const uselessCompsStr = uselessComponents.map(c => c.toString()).join(\", \")\n            return s.UselessComponents.expand({ list: uselessCompsStr })\n        }\n\n        if (componentsToInclude.some(c => c instanceof Clock)) {\n            return s.CannotIncludeClock\n        }\n\n        return { components: componentsToInclude, inputs, outputs }\n    }\n\n    private checkSelectionForTestCase(editor: LogicEditor): { inputs: Input[], outputs: Output[] } | string {\n        const s = S.Components.Custom.messages\n\n        const selectionAll = editor.eventMgr.currentSelection?.previouslySelectedElements\n        if (selectionAll === undefined) {\n            return s.EmptySelection\n        }\n        const components = [...selectionAll].filter((e): e is Component => e instanceof ComponentBase)\n        if (components.length === 0) {\n            return s.EmptySelection\n        }\n\n        const inputs = components.filter((e): e is Input => e instanceof Input)\n        if (inputs.length === 0) {\n            return s.NoInput\n        }\n\n        const outputs = components.filter((e): e is Output => e instanceof Output)\n        if (outputs.length === 0) {\n            return s.NoOutput\n        }\n\n        return { inputs, outputs }\n    }\n\n}\n\n\nfunction makeCustomIdFromCaption(caption: string): string {\n    return caption\n        .trim()\n        .normalize(\"NFKD\")\n        .toLowerCase()\n        .replace(/[^a-z0-9]+/g, \"\")\n}", "import { saveAs } from 'file-saver'\nimport * as t from \"io-ts\"\nimport JSON5 from \"json5\"\nimport * as json5util from \"json5/lib/util\"\nimport { CurrentFormatVersion, migrateData } from './DataMigration'\nimport { LogicEditor } from \"./LogicEditor\"\nimport { NodeMapping } from './NodeManager'\nimport { TestSuite, TestSuiteRepr } from './TestSuite'\nimport { type Component } from \"./components/Component\"\nimport { type CustomComponent, type CustomComponentDefRepr } from './components/CustomComponent'\nimport { DrawableParent } from './components/Drawable'\nimport { Wire } from \"./components/Wire\"\nimport { S } from './strings'\nimport { JSONParseObject, isArray, isRecord, isString, keysOf, validateJson } from \"./utils\"\n\n\nexport type Circuit = CommonFields & {\n\n    /** Global circuit options */\n    opts?: Record<string, unknown>,\n\n    /** The current subcircuit being edited (but not valided yet) */\n    scratch?: Scratch,\n\n    /** Copy of what was passed through URL parameters */\n    userdata?: string | Record<string, unknown> | undefined\n\n} & ComponentAndWires\n\nexport type Library = CommonFields & {\n    type: \"lib\",\n}\n\ntype Scratch = {\n\n    /** The ID of the component whose scratch space it is */\n    id: string,\n\n} & ComponentAndWires\n\ntype CommonFields = {\n    v: typeof CurrentFormatVersion,\n    defs?: CustomComponentDefRepr[],\n}\n\ntype WireRepr = t.TypeOf<typeof Wire.Repr>\n\nexport type ComponentAndWires = {\n\n    /** The original reference position these components are from */\n    pos?: [number, number],\n\n    /** The components themselves, keyed by their ID */\n    components?: Record<string, Record<string, unknown>>,\n\n    /** The wires between the previously listed components */\n    wires?: WireRepr[],\n\n    /** The test suites linked to the circuit */\n    tests?: TestSuiteRepr[],\n}\n\nexport const PostLoadActions_None = \"none\"\nexport const PostLoadActions_SnapshotStorage = \"snapshot-storage\"\nexport const PostLoadActions_SnapshotNoStorage = \"snapshot\"\nexport type PostLoadActions =\n    | typeof PostLoadActions_None\n    | typeof PostLoadActions_SnapshotStorage\n    | typeof PostLoadActions_SnapshotNoStorage\n\ntype LoadOptions = {\n    immediateWirePropagation?: boolean,\n    skipMigration?: boolean\n}\n\nclass _Serialization {\n\n    // Top-level\n\n    public saveCircuitToFile(editor: LogicEditor) {\n        const jsonStr = this.stringifyObject(this.buildCircuitObject(editor), false)\n        const blob = new Blob([jsonStr], { type: 'application/json5' })\n        const filename = editor.documentDisplayName + \".json\"\n        saveAs(blob, filename)\n    }\n\n    public saveLibraryToFile(editor: LogicEditor) {\n        const jsonStr = this.stringifyObject(this.buildLibraryObject(editor), false)\n        const blob = new Blob([jsonStr], { type: 'application/json5' })\n        const filename = editor.documentDisplayName + \"-lib.json\"\n        saveAs(blob, filename)\n    }\n\n    public loadCircuitOrLibrary(editor: LogicEditor, content: string | Record<string, unknown>, postLoadActions: PostLoadActions, opts?: LoadOptions) {\n        let parsed: Record<string, unknown>\n        if (!isString(content)) {\n            parsed = content\n        } else {\n            try {\n                parsed = JSONParseObject(content)\n            } catch (err) {\n                console.error(err)\n                return \"can't load this JSON - error \u201C\" + err + `\u201D, length = ${content.length}, JSON:\\n` + content\n            }\n        }\n        const isLib = (parsed as Partial<Library>).type === \"lib\"\n        if (isLib) {\n            return this.doLoadLibrary(editor, parsed)\n        } else {\n            return this.loadCircuit(editor, parsed, postLoadActions, opts)\n        }\n    }\n\n    public pasteComponents(parent: DrawableParent, content: string): Component[] | string {\n        let parsed: Record<string, unknown>\n        try {\n            parsed = JSONParseObject(content)\n        } catch (err) {\n            console.error(err)\n            return \"can't load this JSON - error \u201C\" + err + `\u201D, length = ${content.length}, JSON:\\n` + content\n        }\n\n        // find difference of mouse position and honor it in the new components' positions\n        // to avoid pasting new components on top of the old ones\n        let offsetPos: [number, number] | undefined = undefined\n        if (isArray(parsed.pos)) {\n            const editor = parent.editor\n            const ceil10 = (x: number) => Math.ceil(x / 10) * 10\n            offsetPos = [ceil10(editor.pointerX - parsed.pos[0]), ceil10(editor.pointerY - parsed.pos[1])]\n            // console.log(`offsetPos = ${offsetPos}`)\n        }\n\n        const compReprs = parsed.components\n        if (!isArray(compReprs) && !isRecord(compReprs)) {\n            return \"invalid JSON: 'components' must be an array or an object\"\n        }\n\n        const { nodeMapping, components, componentsByRef } = this.makeComponents(parent, compReprs, offsetPos)\n        this.makeWires(parent, parsed.wires, nodeMapping, componentsByRef, false)\n        return components\n    }\n\n\n    // Private\n\n    private doLoadLibrary(editor: LogicEditor, parsed: Record<string, unknown>) {\n        migrateData(parsed, editor.instanceId)\n        const numLoaded = editor.factory.tryLoadCustomDefsFrom(parsed.defs)\n        editor.updateCustomComponentButtons()\n        editor.showMessage(S.Messages.LoadedDefinitions.expand({ n: numLoaded }))\n        return undefined // no error\n    }\n\n    public loadCircuit(\n        parent: DrawableParent,\n        parsed_: Record<string, unknown>,\n        postLoadActions: PostLoadActions,\n        opts?: LoadOptions,\n    ): undefined | string { // string is an error\n\n        const componentList = parent.components\n        const parsed = { ...parsed_ } // copy because we delete stuff from it\n\n        try {\n            if (!(opts?.skipMigration ?? false)) {\n                migrateData(parsed, parent.editor.instanceId)\n            }\n        } catch (err) {\n            console.error(err)\n            return \"can't migrate JSON - error \u201C\" + err + `\u201D, JSON:\\n` + stringifySmart(parsed, { maxLength: 120 })\n        }\n        delete parsed.v\n\n        if (parent.isMainEditor()) {\n            parent.factory.clearCustomDefs()\n            parent.factory.tryLoadCustomDefsFrom(parsed.defs)\n            delete parsed.defs\n        }\n\n        for (const elem of componentList.all()) {\n            elem.destroy()\n        }\n        componentList.clearAll()\n        parent.linkMgr.clearAll()\n        parent.nodeMgr.clearAll()\n        if (parent.isMainEditor()) {\n            parent.timeline.reset()\n        }\n\n        const compReprs = parsed.components\n        const { nodeMapping, componentsByRef } = this.makeComponents(parent, compReprs, undefined)\n        delete parsed.components\n\n        const immediateWirePropagation = opts?.immediateWirePropagation ?? false\n        this.makeWires(parent, parsed.wires, nodeMapping, componentsByRef, immediateWirePropagation)\n        delete parsed.wires\n\n        if (isArray(parsed.tests)) {\n            const testSuiteReprs = validateJson(parsed.tests, TestSuite.ReprArray, \"tests\")\n            if (testSuiteReprs !== undefined) {\n                const testSuites = testSuiteReprs.map(ts => new TestSuite([ts, componentList]))\n                parent.testSuites.set(testSuites)\n                parent.ifEditing?.testsPalette.update()\n            }\n        }\n        delete parsed.tests\n\n        if (parent.isMainEditor()) {\n            // load userdata, keeping already existing data\n            if (parsed.userdata !== undefined) {\n                if (typeof parent.userdata === \"object\" && typeof parsed.userdata === \"object\") {\n                    // merge\n                    parent.userdata = {\n                        ...parsed.userdata,\n                        ...parent.userdata,\n                    }\n                } else {\n                    // cannot merge, keep existing data\n                }\n                delete parsed.userdata\n            }\n\n            // also works with undefined\n            // must be done AFTER setting user data to ensure the UI is updated accordingly\n            parent.setPartialOptions(parsed.opts as any)\n            delete parsed.opts\n\n            const takeSnapshot = postLoadActions.startsWith(\"snapshot\")\n            if (takeSnapshot) {\n                const skipStorage = !postLoadActions.endsWith(\"storage\")\n                parent.editor.editTools.undoMgr.takeSnapshot(undefined, skipStorage)\n            }\n\n            parent.updateCustomComponentButtons()\n\n            // try to load scratch, if any\n            const scratch = parsed.scratch\n            let customComp_\n            if (scratch !== undefined && isRecord(scratch) && isString(scratch.id) && (customComp_ = parent.components.get(scratch.id)) !== undefined) {\n                delete scratch.id\n                const customComp = customComp_ as CustomComponent\n                const error = this.loadCircuitForCustomComponent(customComp, scratch)\n                if (error !== undefined) {\n                    console.error(\"Error loading scratch space: \" + error)\n                } else {\n                    // switch editor to the scratch\n                    parent.setEditorRoot(customComp)\n                }\n\n            }\n            delete parsed.scratch\n        }\n\n        const unhandledData = keysOf(parsed)\n        if (unhandledData.length !== 0) {\n            console.warn(\"Unloaded data fields: \" + unhandledData.join(\", \"))\n        }\n\n        return undefined // no error\n    }\n\n    public loadCircuitForCustomComponent(customComp: CustomComponent, parsed: Record<string, unknown>): string | undefined {\n        const error = this.loadCircuit(customComp, parsed, PostLoadActions_None, { immediateWirePropagation: true, skipMigration: true })\n        if (error !== undefined) {\n            return error\n        }\n        customComp.circuitDidLoad()\n        return undefined // no error\n    }\n\n    private makeComponents(parent: DrawableParent, compReprs: unknown, offsetPos: [number, number] | undefined): { nodeMapping: NodeMapping, components: Component[], componentsByRef: Record<string, Component> } {\n        // TODO also return a mapping for renamed component ids according to the same principle\n        const components: Component[] = []\n        const componentsByRef: Record<string, Component> = {}\n        const anchorsToSet: Array<[Component, string]> = []\n        const add = (c: Component | undefined, repr: unknown) => {\n            if (c !== undefined) {\n                components.push(c)\n                if (c.ref !== undefined) {\n                    componentsByRef[c.ref] = c\n                }\n                let anchor\n                if (isRecord(repr) && \"anchor\" in repr && isString(anchor = repr.anchor)) {\n                    anchorsToSet.push([c, anchor])\n                }\n            }\n        }\n\n        const nodeMapping = parent.nodeMgr.recordMappingWhile(() => {\n            const factory = parent.editor.factory\n            if (isArray(compReprs)) {\n                // parse using ids from attributes\n                for (const compRepr of compReprs as unknown[]) {\n                    add(factory.makeFromJSON(parent, compRepr, offsetPos), compRepr)\n                }\n            } else if (isRecord(compReprs)) {\n                // parse using ids from keys\n                for (const [id, compRepr] of Object.entries(compReprs)) {\n                    if (isRecord(compRepr)) {\n                        compRepr.ref = id\n                        add(factory.makeFromJSON(parent, compRepr, offsetPos), compRepr)\n                    } else {\n                        console.error(`Invalid non-object component repr: '${compRepr}'`)\n                    }\n                }\n            }\n        })\n\n        for (const [comp, anchorRef] of anchorsToSet) {\n            const anchor = componentsByRef[anchorRef]\n            if (anchor !== undefined) {\n                comp.anchor = anchor\n            } else {\n                console.warn(`Anchor '${anchorRef}' not found for component '${comp.ref}'`)\n            }\n        }\n\n        return { nodeMapping, components, componentsByRef }\n    }\n\n\n    private makeWires(parent: DrawableParent, wires: unknown, nodeMapping: NodeMapping, componentsByRef: Record<string, Component>, immediateWirePropagation: boolean) {\n        const linkMgr = parent.linkMgr\n        const nodeMgr = parent.nodeMgr\n\n        // recalculating all the unconnected gates here allows\n        // to avoid spurious circular dependency messages, as right\n        // now all components are marked as needing recalculating\n        const recalcMgr = parent.recalcMgr\n        recalcMgr.recalcAndPropagateIfNeeded()\n\n        for (const obj of (isArray(wires) ? wires as unknown[] : [])) {\n            const wireData = validateJson(obj, Wire.Repr, \"wire\")\n            if (wireData === undefined) {\n                return\n            }\n\n            const [nodeID1, nodeID2, wireOptions] = wireData\n            const node1 = nodeMgr.findNode(nodeID1, nodeMapping)\n            const node2 = nodeMgr.findNode(nodeID2, nodeMapping)\n            if (node1 !== undefined && node2 !== undefined && node1.isOutput() && !node2.isOutput()) {\n                const completedWire = linkMgr.addWire(node1, node2, false)\n                if (completedWire !== undefined) {\n                    if (wireOptions !== undefined) {\n                        completedWire.setOptions(wireOptions, componentsByRef)\n                    }\n                    if (immediateWirePropagation) {\n                        completedWire.customPropagationDelay = 0\n                    }\n                }\n                recalcMgr.recalcAndPropagateIfNeeded()\n            }\n        }\n    }\n\n    public buildCircuitObject(editor: LogicEditor): Circuit {\n        const dataObject: Circuit = {\n            v: CurrentFormatVersion,\n            opts: editor.nonDefaultOptions(),\n            defs: editor.factory.customDefReprs(),\n            scratch: undefined,\n            userdata: editor.userdata,\n        }\n\n        const editorRoot = editor.editorRoot\n        if (!(editorRoot instanceof LogicEditor)) {\n            const customComp = editorRoot as CustomComponent\n            // we save this scratch space, too\n            const scratch: Scratch = {\n                id: customComp.ref ?? \"n/a\",\n            }\n            this.buildReprsInto(scratch, editorRoot.components.all(), editorRoot.linkMgr.wires, editorRoot.testSuites.suites)\n            dataObject.scratch = scratch\n        }\n\n        this.buildReprsInto(dataObject, editor.components.all(), editor.linkMgr.wires, editor.testSuites.suites)\n        return dataObject\n    }\n\n    public buildLibraryObject(editor: LogicEditor): Library {\n        return {\n            v: CurrentFormatVersion,\n            defs: editor.factory.customDefReprs(),\n            type: 'lib',\n        }\n    }\n\n    public buildComponentsAndWireObject(components: readonly Component[], testSuites: readonly TestSuite[], sourcePos: [number, number] | undefined): ComponentAndWires {\n        const dataObject: ComponentAndWires = {}\n        if (sourcePos !== undefined) {\n            dataObject.pos = sourcePos\n        }\n\n        // collect all wires that connect to components within the list\n        const wires: Wire[] = []\n        for (const comp of components) {\n            for (const nodeIn of comp.inputs._all) {\n                const wire = nodeIn.incomingWire\n                if (wire !== null && components.includes(wire.startNode.component)) {\n                    wires.push(wire)\n                }\n            }\n        }\n        this.buildReprsInto(dataObject, components, wires, testSuites)\n        return dataObject\n    }\n\n    private buildReprsInto(dataObject: ComponentAndWires, components: Iterable<Component>, wires: readonly Wire[], testSuites: readonly TestSuite[]): void {\n        for (const comp of components) {\n            if (dataObject.components === undefined) {\n                dataObject.components = {}\n            }\n\n            const id = comp.ref\n            if (id === undefined) {\n                console.error(\"Skipping component with no id: \" + comp)\n                continue\n            }\n\n            if (dataObject.components[id] !== undefined) {\n                console.error(\"Skipping component with duplicate id: \" + comp)\n            }\n\n            const compRepr = comp.toJSON()\n            dataObject.components[id] = compRepr\n        }\n        if (wires.length !== 0) {\n            dataObject.wires = wires.map(w => w.toJSON())\n        }\n        if (testSuites.length !== 0) {\n            dataObject.tests = testSuites.map(ts => ts.toJSON())\n        }\n\n\n        // TODO: better way of representing the wires, along these lines:\n        // const nodeName = (node: Node) => {\n        //     const group = node.group\n        //     if (group === undefined) {\n        //         return node.shortName\n        //     }\n        //     const nodeIndex = group.nodes.indexOf(node as any)\n        //     return `${group.name}[${nodeIndex}]`\n        // }\n\n        // const wires: Record<string, Record<string, string>> = {}\n\n        // for (const comp of componentsToInclude) {\n        //     const ref = componentToRef.get(comp)!\n        //     for (const node of comp.inputs._all) {\n        //         const wire = node.incomingWire\n        //         if (wire !== null) {\n        //             const nodeInName = nodeName(node)\n        //             const nodeOut = wire.startNode\n        //             const otherComp = nodeOut.component\n        //             const sourceRef = `${componentToRef.get(otherComp)!}.${nodeName(nodeOut)}`;\n\n        //             (wires[ref] ?? (wires[ref] = {}))[nodeInName] = sourceRef\n        //         }\n        //     }\n        // }\n    }\n\n    public removeShowOnlyFrom(dataObject: Circuit): string[] | undefined {\n        if (dataObject.opts !== undefined) {\n            const showOnly = dataObject.opts.showOnly\n            delete dataObject.opts.showOnly\n            if (Object.keys(dataObject.opts).length === 0) {\n                delete dataObject.opts\n            }\n            if (isArray(showOnly) && showOnly.every(isString)) {\n                return showOnly\n            }\n        }\n        return undefined\n    }\n\n    public stringifyObject(_dataObject: Partial<Circuit>, compact: boolean): string {\n\n        // TODO: refactor this to not touch input object and not do this \"delete dataObject.key\" thing\n        if (compact) {\n            return JSON5.stringify(_dataObject)\n        }\n\n        // Custom stringifier to have always one component per line and\n        // spaces after commas\n\n        const dataObject = { ..._dataObject }\n\n        const parts: string[] = []\n\n        stringifyCompactReprTo(parts, dataObject, \"v\")\n        stringifyCompactReprTo(parts, dataObject, \"type\")\n        stringifyCompactReprTo(parts, dataObject, \"opts\")\n        stringifyCompactReprTo(parts, dataObject, \"userdata\")\n        stringifyCompactReprTo(parts, dataObject, \"pos\")\n\n        const defs = dataObject.defs\n        if (defs !== undefined && isArray(defs)) {\n            const defparts: string[] = []\n            for (const def of defs as Partial<CustomComponentDefRepr>[]) {\n                const circuit = def.circuit!\n                delete def.circuit\n                let subpart = stringifySmart(def, { maxLength: Infinity })\n                def.circuit = circuit\n                const compparts: string[] = []\n                stringifyComponentWiresTestsReprsTo(compparts, { ...circuit }, 3, true)\n                const circuitRepr = compparts.length === 0 ? \"{}\" : \"{\\n      \" + compparts.join(\",\\n      \") + \"\\n    }\"\n                subpart = subpart.slice(0, subpart.length - 1) + `, circuit: ` + circuitRepr + \"}\"\n                defparts.push(subpart)\n            }\n            parts.push(`defs: [\\n    ` + defparts.join(\",\\n    \") + \"\\n  ]\")\n        }\n        delete dataObject.defs\n\n        const scratch = dataObject.scratch\n        if (scratch !== undefined) {\n            const scratchparts: string[] = []\n            scratchparts.push(`id: ${stringifySmart(scratch.id)}`)\n            stringifyComponentWiresTestsReprsTo(scratchparts, { ...scratch }, 2, false)\n            parts.push(`scratch: {\\n    ` + scratchparts.join(\",\\n    \") + \"\\n  }\")\n        }\n        delete dataObject.scratch\n\n        stringifyComponentWiresTestsReprsTo(parts, dataObject, 1, false)\n\n        // loop though the remaining fields\n        const unprocessedFields = keysOf(dataObject)\n        if (unprocessedFields.length !== 0) {\n            console.error(\"ERROR: unprocessed fields in stringified JSON: \" + unprocessedFields.join(\", \"))\n        }\n\n        return \"{ // JSON5\\n  \" + parts.join(\",\\n  \") + \"\\n}\"\n    }\n\n}\n\nexport const Serialization = new _Serialization()\n\n\nfunction stringifyCompactReprTo(parts: string[], container: Record<string, unknown>, key: string) {\n    const value = container[key]\n    if (value !== undefined) {\n        parts.push(`${stringifyKey(key)}: ${stringifySmart(value, { maxLength: Infinity })}`)\n    }\n    delete container[key]\n}\n\nfunction stringifyComponentWiresTestsReprsTo(parts: string[], container: ComponentAndWires, outerLevel: number, noWireDelay: boolean) {\n    const outerIndent = \"  \".repeat(outerLevel)\n    const innerIndent = outerIndent + \"  \"\n    let entries\n\n    const comps = container.components\n    if (comps !== undefined) {\n        if (isArray(comps) && comps.length !== 0) {\n            // array style\n            const subparts: string[] = []\n            for (const compRepr of comps) {\n                subparts.push(stringifySmart(compRepr, { maxLength: Infinity }))\n            }\n            parts.push(`components: [\\n${innerIndent}` + subparts.join(`,\\n${innerIndent}`) + `,\\n${outerIndent}]`)\n\n        } else if ((entries = Object.entries(comps)).length !== 0) {\n            // object style\n            const subparts: string[] = []\n            for (const [id, compRepr] of entries) {\n                delete compRepr.ref\n                subparts.push(`${stringifyKey(id)}: ${stringifySmart(compRepr, { maxLength: Infinity })}`)\n            }\n            parts.push(`components: {\\n${innerIndent}` + subparts.join(`,\\n${innerIndent}`) + `,\\n${outerIndent}}`)\n        }\n    }\n    delete container.components\n\n    if (noWireDelay && container.wires !== undefined) {\n        for (const wire of container.wires) {\n            const wireOpts = wire[2]\n            if (wireOpts !== undefined) {\n                delete wireOpts.propagationDelay\n                if (allValuesUndefined(wireOpts)) {\n                    wire.splice(2, 1)\n                }\n            }\n        }\n    }\n    stringifyCompactReprTo(parts, container, \"wires\")\n\n    const tests = container.tests\n    if (tests !== undefined && tests.length !== 0) {\n        const innerIndent2 = innerIndent + \"  \"\n\n        const subparts: string[] = []\n        for (const testSuiteRepr of tests) {\n            const Cases = \"cases\"\n            const testCases = testSuiteRepr[Cases]\n            const testCasesReprStrs = testCases.map(testCase => stringifySmart(testCase, { maxLength: Infinity })).filter(s => s.length !== 0);\n\n            (testSuiteRepr as any).cases = undefined\n            const baseSuiteRepr = stringifySmart(testSuiteRepr, { maxLength: Infinity }).slice(1, -1)\n            const sep = baseSuiteRepr.length === 0 ? \"\" : \", \"\n            testSuiteRepr.cases = testCases\n            const casesRepr = testCasesReprStrs.length === 0 ? `${Cases}: []`\n                : `${Cases}: [\\n${innerIndent2}` + testCasesReprStrs.join(`,\\n${innerIndent2}`) + `,\\n${innerIndent}]`\n            subparts.push(`{${baseSuiteRepr}${sep}${casesRepr}}`)\n        }\n\n        parts.push(`tests: [\\n${innerIndent}` + subparts.join(`,\\n${innerIndent}`) + `,\\n${outerIndent}]`)\n    }\n    delete container.tests\n}\n\nfunction allValuesUndefined(obj: Record<string, unknown>): boolean {\n    for (const value of Object.values(obj)) {\n        if (value !== undefined) {\n            return false\n        }\n    }\n    return true\n}\n\n\n// Note: This regex matches even invalid JSON strings, but since we\u2019re\n// working on the output of `JSON.stringify` we know that only valid strings\n// are present (unless the user supplied a weird `options.indent` but in\n// that case we don\u2019t care since the output would be invalid anyway).\nconst stringOrChar = /(\"([^\\\\\"]|\\\\.)*\")|[:,]/g\n\nexport function stringifySmart(\n    passedObj: any,\n    options?: {\n        replacer?: (this: any, key: string, value: any) => any,\n        indent?: number | string,\n        maxLength?: number\n    }\n): string {\n\n    options ??= {}\n    const indent: string = JSON.stringify([1], undefined, options.indent ?? 2).slice(2, -3)\n    const maxLength: number =\n        indent === \"\"\n            ? Infinity\n            : options.maxLength ?? 80\n\n    let replacer = options.replacer\n\n    return (function _stringify(obj: any, currentIndent: string, reserved: number): string {\n        if (obj !== undefined && typeof obj.toJSON === \"function\") {\n            obj = obj.toJSON()\n        }\n\n        const string = JSON5.stringify(obj, replacer)\n\n        if (string === undefined) {\n            return string\n        }\n\n        let length = maxLength - currentIndent.length - reserved\n\n        if (string.length <= length) {\n            const prettified = string.replace(\n                stringOrChar,\n                function (match, stringLiteral) {\n                    return stringLiteral ?? match + \" \"\n                }\n            )\n            if (prettified.length <= length) {\n                return prettified\n            }\n        }\n\n        if (replacer !== null) {\n            obj = JSON5.parse(string)\n            replacer = undefined\n        }\n\n        if (typeof obj === \"object\" && obj !== null) {\n            const nextIndent = currentIndent + indent\n            const items: string[] = []\n            let index = 0\n\n            let start: string\n            let end: string\n            if (isArray(obj)) {\n                start = \"[\"\n                end = \"]\"\n                length = obj.length\n                for (; index < length; index++) {\n                    items.push(\n                        _stringify(obj[index], nextIndent, index === length - 1 ? 0 : 1) ||\n                        \"null\"\n                    )\n                }\n            } else {\n                start = \"{\"\n                end = \"}\"\n                const keys = Object.keys(obj)\n                length = keys.length\n                for (; index < length; index++) {\n                    const key = keys[index]\n                    const keyPart = stringifyKey(key) + \": \"\n                    const value = _stringify(\n                        obj[key],\n                        nextIndent,\n                        keyPart.length + (index === length - 1 ? 0 : 1)\n                    )\n                    if (value !== undefined) {\n                        items.push(keyPart + value)\n                    }\n                }\n            }\n\n            if (items.length > 0) {\n                return [start, indent + items.join(\",\\n\" + nextIndent), end].join(\n                    \"\\n\" + currentIndent\n                )\n            }\n        }\n\n        return string\n    })(passedObj, \"\", 0)\n}\n\n// Adapted from JSON5 (https://github.com/json5/json5), MIT license\nfunction stringifyKey(key: string): string {\n    if (key.length === 0) {\n        return quoteString(key)\n    }\n\n    const firstChar = String.fromCodePoint(key.codePointAt(0)!)\n    if (!json5util.isIdStartChar(firstChar)) {\n        return quoteString(key)\n    }\n\n    for (let i = firstChar.length; i < key.length; i++) {\n        if (!json5util.isIdContinueChar(String.fromCodePoint(key.codePointAt(i)!))) {\n            return quoteString(key)\n        }\n    }\n\n    return key\n}\n\nconst replacements: Record<string, string> = {\n    \"'\": \"\\\\'\",\n    '\"': '\\\\\"',\n    '\\\\': '\\\\\\\\',\n    '\\b': '\\\\b',\n    '\\f': '\\\\f',\n    '\\n': '\\\\n',\n    '\\r': '\\\\r',\n    '\\t': '\\\\t',\n    '\\v': '\\\\v',\n    '\\0': '\\\\0',\n    '\\u2028': '\\\\u2028',\n    '\\u2029': '\\\\u2029',\n}\n\nfunction quoteString(value: string): string {\n    const quotes = {\n        \"'\": 0.1,\n        '\"': 0.2,\n    }\n\n    let product = ''\n\n    for (let i = 0; i < value.length; i++) {\n        const c = value[i]\n        switch (c) {\n            case \"'\":\n            case '\"':\n                quotes[c]++\n                product += c\n                continue\n\n            case '\\0':\n                if (json5util.isDigit(value[i + 1])) {\n                    product += '\\\\x00'\n                    continue\n                }\n        }\n\n        if (replacements[c] !== undefined) {\n            product += replacements[c]\n            continue\n        }\n\n        if (c < ' ') {\n            const hexString = c.charCodeAt(0).toString(16)\n            product += '\\\\x' + ('00' + hexString).substring(hexString.length)\n            continue\n        }\n        product += c\n    }\n\n    const quoteChar = keysOf(quotes).reduce(function (a, b) { return (quotes[a] < quotes[b]) ? a : b })\n    product = product.replace(new RegExp(quoteChar, 'g'), replacements[quoteChar])\n    return quoteChar + product + quoteChar\n}", "import { isLeft } from \"fp-ts/lib/Either\"\nimport * as t from \"io-ts\"\nimport { PathReporter } from \"io-ts/lib/PathReporter\"\nimport JSON5 from \"json5\"\nimport { Add } from \"ts-arithmetic\"\n\nexport type Dict<T> = Record<string, T | undefined>\nexport type TimeoutHandle = NodeJS.Timeout\n\nexport const InBrowser = typeof window !== 'undefined'\n\nexport const Any = undefined as any\n\n// Better types for an Object.keys() replacement\nexport function keysOf<K extends keyof any>(d: Record<K, any>): K[]\nexport function keysOf<K extends {}>(o: K): (keyof K)[]\nexport function keysOf(o: any) {\n    return Object.keys(o)\n}\n\n// Allows nice definitions of enums with associated data\nexport class RichStringEnum<K extends keyof any, P> {\n\n    public static withProps<P0>() {\n        return function <K0 extends keyof any>(defs: Record<K0, P0>) {\n            return new RichStringEnum<K0, P0>(defs)\n        }\n    }\n\n    private _values: Array<K>\n\n    private constructor(public readonly props: Record<K, P>) {\n        this._values = keysOf(props)\n        for (let i = 0; i < this._values.length; i++) {\n            this[i] = this._values[i]\n        }\n    }\n\n    public get type(): K {\n        throw new Error()\n    }\n\n    public get values(): ReadonlyArray<K> {\n        return this._values\n    }\n\n    public get length(): number {\n        return this._values.length\n    }\n\n    public get definitions(): Array<[K, P]> {\n        const defs: Array<[K, P]> = []\n        for (const i of this._values) {\n            defs.push([i, this.props[i]])\n        }\n        return defs\n    }\n\n    public includes(val: unknown): val is K {\n        return this.values.includes(val as any)\n    }\n\n    public indexOf(val: K): number {\n        return this.values.indexOf(val)\n    }\n\n    [i: number]: K\n\n    public *[Symbol.iterator]() {\n        for (const i of this._values) {\n            yield i\n        }\n    }\n\n}\n\n// returns the passed parameter typed as a tuple\nexport function tuple<T extends readonly any[]>(...items: [...T]): [...T] {\n    return items\n}\n\nexport function mergeWhereDefined<A, B>(a: A, b: B): A & PickDefined<B> {\n    const obj: any = { ...a }\n    for (const [k, v] of Object.entries(b as any)) {\n        if (v !== undefined) {\n            obj[k] = v\n        }\n    }\n    return obj\n}\n\nexport function randomString(n: number) {\n    const chars = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\"\n    let str = \"\"\n    for (let i = 0; i < n; i++) {\n        str += chars[Math.floor(Math.random() * chars.length)]\n    }\n    return str\n}\n\nexport function brand<B>() {\n    return <A>(val: A): t.Branded<A, B> => {\n        return val as any\n    }\n}\n\n// Utility types to force the evaluation of computed types\n// See: https://stackoverflow.com/a/57683652/390581\n\n// expands object types one level deep\nexport type Expand<T> = T extends infer O ? { [K in keyof O]: O[K] } : never\n\n// expands object types recursively\nexport type ExpandRecursively<T> = T extends Record<string, unknown>\n    ? T extends infer O ? { [K in keyof O]: ExpandRecursively<O[K]> } : never\n    : T\n\n\nexport type OptionalKeysOf<T> = { [P in keyof T]-?: undefined extends T[P] ? P : never }[keyof T]\nexport type RequiredKeysOf<T> = Exclude<keyof T, OptionalKeysOf<T>>\n\nexport type KeysOfByType<T, U> = { [P in keyof T]: T[P] extends U ? P : never }[keyof T]\n\nexport type FilterProperties<T, U> = {\n    [P in KeysOfByType<T, U>]: T[P]\n}\n\nexport type PickDefined<T> = {\n    [P in keyof T as undefined extends T[P] ? never : P]: T[P]\n}\n\nexport type ValuesOf<T> = T[keyof T]\n\nexport type PromiseOrValue<T> = T | Promise<T>\n\nexport type HasField<T, K extends string> = K extends keyof T ? true : false\n\nexport type IsSameType<A, B> = A extends B ? (B extends A ? true : false) : false\nexport type PartialWhereUndefinedRecursively<T> = ExpandRecursively<_PartialWhereUndefinedRecursively<T>>\n\ntype _PartialWhereUndefinedRecursively<T> =\n    // is it an object?\n    T extends Record<string, unknown>\n    ? T extends infer O ? {\n        [P in RequiredKeysOf<O>]: _PartialWhereUndefinedRecursively<O[P]>\n    } & {\n        [P in OptionalKeysOf<O>]?: _PartialWhereUndefinedRecursively<O[P]>\n    }\n    : never // \"closing the infer block\"\n\n    // is it an array?\n    : T extends ReadonlyArray<infer E>\n    ? Array<_PartialWhereUndefinedRecursively<E>>\n\n    // other types\n    : T\n\n\n// Lightweight ADT facilities\n// Either go with:\n//    export const MyADT = { Case1: ..., Case2: () => ... }\n//    export type MyADT = ADTWith<typeof MyADT>\n// ... or, if you need statics:\n//    const MyADTCases = { Case1: ..., Case2: () => ... } // as before\n//    export type MyADT = ADTWith<typeof MyADTCases>\n//    export const MyADT = defineADTStatics(MyADTCases, { ...statics })\n// Then, as needed, you can alias type cases:\n//    export type MyADTCase = ADTCase<MyADT, \"Case1\">\nexport type ADTWith<TADTCases extends Record<string, unknown>>\n    = { [K in keyof TADTCases]:\n        TADTCases[K] extends (...args: infer TArgs) => infer TReturn ? TReturn : TADTCases[K]\n    }[keyof TADTCases]\n\nexport function defineADTStatics<\n    TADTCases extends Record<string, unknown>,\n    TStatics extends Record<string, unknown>\n>(cases: TADTCases, statics: TStatics) {\n    return { ...statics, ...cases }\n}\n\nexport type ADTCase<T extends { _tag: string }, Tag extends T[\"_tag\"]> = T extends { _tag: Tag } ? T : never\n\n\n// Series of type-assertion functions\n\n// We *don't* have isUndefined, etc. functions as they\n// do not improve readability or correctness (see for clarifications\n// https://stackoverflow.com/a/22053469/390581)\n\nexport function isString(v: unknown): v is string {\n    return typeof v === \"string\"\n}\n\nexport function isArray(arg: unknown): arg is any[] {\n    return Array.isArray(arg)\n}\n\n// NO: TypeScript is not smart enough to infer the type of the function,\n// so just use `typeof arg === \"function\"` instead\n// export function isFunction(arg: unknown): arg is ((...args: any[]) => any) {\n//     return typeof arg === \"function\"\n// }\n\nexport function isNumber(arg: unknown): arg is number {\n    return typeof arg === \"number\"\n}\n\nexport function isBoolean(arg: unknown): arg is boolean {\n    return typeof arg === \"boolean\"\n}\n\nexport function isRecord(arg: unknown): arg is Record<string, unknown> {\n    return typeof arg === \"object\" && arg !== null\n}\n\n\n// Array stuff\n\nexport type ArrayOrDirect<T> = T | Array<T>\n\nexport function ArrayFillWith<T>(val: T, n: number): Array<T> {\n    return Array(n).fill(val)\n}\n\nexport function ArrayFillUsing<T>(val: (i: number) => T, n: number): Array<T> {\n    const arr = Array(n)\n    for (let i = 0; i < n; i++) {\n        arr[i] = val(i)\n    }\n    return arr\n}\n\nexport function ArrayClampOrPad<T>(arr: T[], len: number, padValue: T): T[] {\n    const missing = len - arr.length\n    if (missing === 0) {\n        return arr\n    }\n    if (missing > 0) {\n        for (let i = 0; i < missing; i++) {\n            arr.push(padValue)\n        }\n    } else {\n        // missing < 0\n        arr.splice(len, -missing)\n    }\n    return arr\n}\n\n\n// Binary strings\n\nconst BinChars = [\"0\", \"1\", \"?\", \"Z\", \"*\"] as const\n\ntype BinChar = typeof BinChars[number]\n\ntype _CheckBinaryStringRec<FullStr extends string, S extends string> =\n    S extends `${BinChar}${infer Rest}` // First character must be '1' or '0'\n    ? (Rest extends \"\" ? FullStr : _CheckBinaryStringRec<FullStr, Rest>)\n    : never\n\ntype BinString = t.Branded<string, \"BinString\">\n\n/** Statically check that the passed string is a binary string */\nexport function b<S extends string>(s: _CheckBinaryStringRec<S, S>): BinString {\n    return s as BinString\n}\n\n/** Checks at runtime that the passed string is a binary string.\n * Don't pass string literals, which should be validated statically with the\n * other function above. */\nexport function BinaryStringAssert<S extends string>(s: string extends S ? S : never): BinString {\n    let valid = true\n    if (s.length === 0) {\n        valid = false\n    } else {\n        for (const c of s) {\n            if (!BinChars.includes(c)) {\n                valid = false\n                break\n            }\n        }\n    }\n    if (!valid) {\n        throw new Error(`BinaryStringAssert: invalid binary string '${s}'`)\n    }\n    return s as unknown as BinString\n}\n\n\n// Fixed-size array types\n\n// assuming N is a number literal; non-literals filtered by main type\ntype _FixedArray<TItem, TSize extends number, TRest extends number, Acc extends TItem[], TTrueIfMutable extends boolean>\n    = TRest extends 0 ? TTrueIfMutable extends true ? Acc : readonly [...Acc]\n    : _FixedArray<TItem, TSize, Add<TRest, -1>, [TItem, ...Acc], TTrueIfMutable>\n\nexport type FixedArray<T, N extends number> =\n    number extends N ? T[] : _FixedArray<T, N, N, [], true>\n\n//  boolean and not false as 4th type param to keep assignment compatibility\nexport type ReadonlyFixedArray<T, N extends number> =\n    number extends N ? readonly T[] : _FixedArray<T, N, N, [], boolean>\n\n// function testAssignment<NN extends number>(n: N) {\n//     type N = NN\n//     const arr: number[] = []\n//     const arrro: readonly number[] = []\n//     const b: readonly number[] = arr\n//     // const bb: number[] = arrro\n\n//     const farr: FixedArray<number, N> = [] as any\n//     const farrro: ReadonlyFixedArray<number, N> = [] as any\n//     const fb: ReadonlyFixedArray<number, N> = farr\n//     const fbb: FixedArray<number, N> = farrro // must fail\n// }\n\n// type _FixedArrayLength<T extends readonly any[], N extends number>\n//     = T extends [] ? N\n//     : T extends [any, ...infer U] ? _FixedArrayLength<U, Add<N, 1>>\n//     : never\n\n// export type FixedArrayLength<T extends readonly any[]> = _FixedArrayLength<T, 0>\n\n\nexport function FixedArrayFillWith<T, N extends number>(val: T, n: N): FixedArray<T, N> {\n    return ArrayFillWith(val, n) as any\n}\n\nexport function FixedArrayFillUsing<T, N extends number>(val: (i: number) => T, n: N): FixedArray<T, N> {\n    return ArrayFillUsing(val, n) as any\n}\n\nexport function FixedArrayMap<U, Arr extends readonly any[]>(items: Arr, fn: (item: Arr[number]) => U): FixedArray<U, Arr[\"length\"]> {\n    return items.map(fn) as any\n}\n\nexport function FixedArrayAssert<T, N extends number>(arr: readonly T[], n: N): FixedArray<T, N> {\n    if (arr.length !== n) {\n        throw new Error(`FixedArrayAssert: expected length ${n}, got ${arr.length}`)\n    }\n    return arr as FixedArray<T, N>\n}\n\n\n// JSON\n\nexport function JSONParseObject(str: string): Record<string, unknown> {\n    const parsed: unknown = JSON5.parse(str)\n    if (isRecord(parsed)) {\n        return parsed\n    }\n    throw new Error(\"JSONParseObject: not an object\")\n}\n\n\nexport function isTruthyString(str: string | null | undefined): boolean {\n    return str !== null && str !== undefined && (str === \"1\" || str.toLowerCase() === \"true\")\n}\n\nexport function isFalsyString(str: string | null | undefined): boolean {\n    return str !== null && str !== undefined && (str === \"0\" || str.toLowerCase() === \"false\")\n}\n\nexport function getURLParameter<T>(sParam: string, defaultValue: T): string | T\nexport function getURLParameter(sParam: string, defaultValue?: undefined): string | undefined\nexport function getURLParameter(sParam: string, defaultValue: any) {\n    const sPageURL = window.location.search.substring(1)\n    const sURLVariables = sPageURL.split('&')\n    for (const sURLVariable of sURLVariables) {\n        const sParameterName = sURLVariable.split('=')\n        if (sParameterName[0] === sParam) {\n            return sParameterName[1]\n        }\n    }\n    return defaultValue\n}\n\nexport function isEmbeddedInIframe(): boolean {\n    try {\n        return window.self !== window.top\n    } catch (e) {\n        return true\n    }\n}\n\nexport function onVisible(element: HTMLElement, callback: () => void) {\n    new IntersectionObserver((entries, observer) => {\n        entries.forEach(entry => {\n            if (entry.intersectionRatio > 0) {\n                callback()\n                observer.disconnect()\n                return\n            }\n        })\n    }).observe(element)\n}\n\nexport function setEnabled(elem: HTMLButtonElement, enabled: boolean) {\n    if (enabled) {\n        elem.removeAttribute(\"disabled\")\n    } else {\n        elem.setAttribute(\"disabled\", \"disabled\")\n    }\n}\n\nexport function setVisible(elem: HTMLElement, visible: boolean) {\n    if (visible) {\n        const prevDisplay = elem.getAttribute(\"data-prev-display\")\n        if (prevDisplay === null) {\n            if (elem.style.display === \"none\") {\n                elem.style.removeProperty(\"display\")\n            } else {\n                // not hidden\n            }\n        } else {\n            elem.removeAttribute(\"data-prev-display\")\n            elem.style.display = prevDisplay\n        }\n    } else {\n        const currentDisplay = elem.style.display\n        if (currentDisplay.length !== 0 && currentDisplay !== \"none\") {\n            elem.setAttribute(\"data-prev-display\", currentDisplay)\n        }\n        elem.style.display = \"none\"\n    }\n}\n\nexport function toggleVisible(elem: HTMLElement) {\n    setVisible(elem, elem.style.display === \"none\")\n}\n\nexport function setHidden(elem: HTMLElement, hidden: boolean) {\n    if (hidden) {\n        elem.style.visibility = \"hidden\"\n    } else {\n        elem.style.removeProperty(\"visibility\")\n    }\n}\n\nexport type UIDisplay = \"show\" | \"hide\" | \"inactive\"\n\nexport function setDisplay(elem: HTMLElement, display: UIDisplay) {\n    setVisible(elem, display !== \"hide\")\n    setHidden(elem, display === \"inactive\")\n}\n\nexport function setActive(elem: HTMLElement, active: boolean) {\n    elem.classList.toggle(\"active\", active)\n}\n\nexport function showModal(dlog: HTMLDialogElement): boolean {\n    if (typeof (dlog as any).showModal === \"function\") {\n        dlog.style.display = \"initial\";\n        (dlog as any).showModal()\n        const listener = () => {\n            dlog.style.display = \"none\"\n            dlog.removeEventListener(\"close\", listener)\n        }\n        dlog.addEventListener(\"close\", listener)\n        return true\n    }\n    return false\n}\n\n\n// An InteractionResult is used to indicate whether some interaction\n// had an effect, in which case a snapshot can be taken for undo/redo.\n// It can also be a RepeatableChange to allow to redos acting as\n// repetitions of the last change.\n\nexport type RepeatFunction = () => boolean | RepeatFunction\n\nconst InteractionResultCases = {\n    NoChange: { _tag: \"NoChange\" as const, isChange: false as const },\n    SimpleChange: { _tag: \"SimpleChange\" as const, isChange: true as const },\n    RepeatableChange: (repeat: RepeatFunction) => ({ _tag: \"RepeatableChange\" as const, isChange: true as const, repeat }),\n}\n\nexport const InteractionResult = defineADTStatics(InteractionResultCases, {\n    fromBoolean: (changed: boolean) =>\n        changed ? InteractionResult.SimpleChange : InteractionResult.NoChange,\n\n    merge: (r0: InteractionResult, r1: InteractionResult): InteractionResult => {\n        // keeps the most informative result\n        if (r0._tag === \"NoChange\") {\n            return r1\n        }\n        if (r0._tag === \"RepeatableChange\") {\n            return r0\n        }\n        // r0 is SimpleChange\n        if (r1._tag === \"RepeatableChange\") {\n            return r1\n        }\n        return r0\n    },\n})\n\nexport type InteractionResult = ADTWith<typeof InteractionResultCases>\n\n\n// Reused types across several components\n\nexport const EdgeTrigger = {\n    rising: \"rising\",\n    falling: \"falling\",\n} as const\n\nexport type EdgeTrigger = keyof typeof EdgeTrigger\n\nexport const ComponentTypeInput = \"in\" as const\n\nexport const ComponentTypeOutput = \"out\" as const\n\n\n// More general-purpose utility functions\n\nexport function any(bools: boolean[]): boolean {\n    for (const b of bools) {\n        if (b) {\n            return true\n        }\n    }\n    return false\n}\n\nexport function repeatString(c: string, n: number) {\n    return Array(n + 1).join(c)\n}\n\nexport function formatString(str: string, ...varargs: any[]) {\n    if (varargs.length) {\n        const t = typeof varargs[0]\n        const args = (\"string\" === t || \"number\" === t) ?\n            Array.prototype.slice.call(varargs)\n            : varargs[0]\n\n        for (const key in args) {\n            str = str.replace(new RegExp(\"\\\\{\" + key + \"\\\\}\", \"gi\"), args[key])\n        }\n    }\n    return str\n}\n\n\nexport function deepObjectEquals(v1: Record<string, unknown>, v2: Record<string, unknown>) {\n    const keys1 = Object.keys(v1)\n    const keys2 = Object.keys(v2)\n    if (keys1.length !== keys2.length) {\n        return false\n    }\n    for (const key of keys1) {\n        if (!deepArrayEquals(v1[key], v2[key])) {\n            return false\n        }\n    }\n    return true\n}\n\n\n\nexport function deepArrayEquals(v1: unknown, v2: unknown) {\n    if (isArray(v1) && isArray(v2)) {\n        if (v1.length !== v2.length) {\n            return false\n        }\n        for (let i = 0; i < v1.length; i++) {\n            if (v1[i] !== v2[i]) {\n                return false\n            }\n        }\n        return true\n    } else {\n        return v1 === v2\n    }\n}\n\n\n// io-ts utils\n\nexport const typeOrUndefined = <T extends t.Mixed>(tpe: T) => {\n    return t.union([tpe, t.undefined], tpe.name + \" | undefined\")\n}\n\nexport const typeOrNull = <T extends t.Mixed>(tpe: T) => {\n    return t.union([tpe, t.null], tpe.name + \" | null\")\n}\n\nexport function templateLiteral<L extends string>(regex: RegExp | string, name?: string) {\n    const regex_ = typeof regex === 'string' ? new RegExp(regex) : regex\n    const predicate = (s: string): s is L => regex_.test(s)\n    return new t.RefinementType(\n        name ?? `TemplateLiteral<${regex_.source}>`,\n        (u): u is L => t.string.is(u) && predicate(u),\n        (i, c) => {\n            const e = t.string.validate(i, c)\n            if (isLeft(e)) {\n                return e\n            }\n            const a = e.right\n            return predicate(a) ? t.success(a) : t.failure(a, c)\n        },\n        t.string.encode,\n        t.string,\n        predicate,\n    )\n}\n\nexport function validateJson<T, I>(obj: I, repr: t.Decoder<I, T>, what: string): T | undefined {\n    const validated = repr.decode(obj)\n    if (isLeft(validated)) {\n        console.warn(`ERROR while parsing ${what} from %o -> %s: `, obj, PathReporter.report(validated).join(\"; \"))\n        return undefined\n    }\n    return validated.right\n}\n\n\n// Unset; LogicValue\n\nexport const HighImpedance = \"Z\" as const\nexport type HighImpedance = typeof HighImpedance\nexport function isHighImpedance<T>(v: T | HighImpedance): v is HighImpedance {\n    return v === HighImpedance\n}\n\nexport const Unknown = \"?\" as const\nexport type Unknown = typeof Unknown\nexport function isUnknown<T>(v: T | Unknown): v is Unknown {\n    return v === Unknown\n}\nexport const TUnknown = new t.Type<Unknown>(\n    \"Unknown\",\n    isUnknown,\n    (input, context) => isUnknown(input) ? t.success(input) : t.failure(input, context),\n    t.identity,\n)\n\nexport type LogicValue = boolean | HighImpedance | Unknown\nexport const LogicValue = {\n    invert(v: LogicValue): LogicValue {\n        return isUnknown(v) || isHighImpedance(v) ? v : !v\n    },\n    filterHighZ(v: LogicValue): boolean | Unknown {\n        return isHighImpedance(v) ? Unknown : v\n    },\n}\n\nexport type LogicValueRepr = 0 | 1 | HighImpedance | Unknown\nexport const LogicValueRepr = new t.Type<LogicValueRepr>(\n    \"0|1|?|Z\",\n    (v: unknown): v is LogicValueRepr => isUnknown(v) || isHighImpedance(v) || v === 1 || v === 0,\n    (input, context) =>\n        isUnknown(input) ? t.success(input) :\n            isHighImpedance(input) ? t.success(input) :\n                input === 1 ? t.success(1) :\n                    input === 0 ? t.success(0) :\n                        t.failure(input, context),\n    t.identity,\n)\n\nexport function toLogicValueRepr(v: LogicValue): LogicValueRepr\nexport function toLogicValueRepr(v: LogicValue | undefined): LogicValueRepr | undefined\nexport function toLogicValueRepr(v: LogicValue | undefined): LogicValueRepr | undefined {\n    switch (v) {\n        case true: return 1\n        case false: return 0\n        case Unknown: return Unknown\n        case HighImpedance: return HighImpedance\n        case undefined: return undefined\n    }\n}\n\nexport function toLogicValue(v: LogicValueRepr): LogicValue\nexport function toLogicValue(v: LogicValueRepr | undefined): LogicValue | undefined\nexport function toLogicValue(v: LogicValueRepr | undefined): LogicValue | undefined {\n    switch (v) {\n        case 1: return true\n        case 0: return false\n        case Unknown: return Unknown\n        case HighImpedance: return HighImpedance\n        case undefined: return undefined\n    }\n}\n\nexport function toLogicValueFromChar(char: string): LogicValue {\n    switch (char) {\n        case \"1\": return true\n        case \"0\": return false\n        case Unknown: return Unknown\n        case HighImpedance: return HighImpedance\n        default: return Unknown\n    }\n}\n\nexport const InputOutputValueRepr = t.union([\n    LogicValueRepr,\n    t.string,\n    t.array(LogicValueRepr),\n])\nexport type InputOutputValueRepr = t.TypeOf<typeof InputOutputValueRepr>\n\nexport function allBooleans(values: LogicValue[]): values is boolean[] {\n    for (const v of values) {\n        if (v !== true && v !== false) {\n            return false\n        }\n    }\n    return true\n}\n\nexport function isAllZeros(s: string) {\n    for (const c of s) {\n        if (c !== \"0\") {\n            return false\n        }\n    }\n    return true\n}\n\nexport function binaryStringRepr(values: readonly LogicValue[]): string {\n    const binStr = values.map(toLogicValueRepr).reverse().join(\"\")\n    return binStr\n}\n\nexport function valuesReprForTest(values: readonly LogicValue[]): string | 0 | 1 {\n    return values.length === 1 ? toLogicValueRepr(values[0]) : binaryStringRepr(values)\n}\n\nexport function hexStringRepr(values: readonly boolean[], hexWidth: number): string {\n    const binStr = binaryStringRepr(values)\n    return parseInt(binStr, 2).toString(16).toUpperCase().padStart(hexWidth, \"0\")\n}\n\nexport function valuesFromBinaryOrHexRepr(wordRepr: string, numBits: number): LogicValue[] {\n    const len = wordRepr.length\n    const isBinary = len === numBits\n    const binaryRepr = isBinary ? wordRepr : parseInt(wordRepr, 16).toString(2).padStart(numBits, \"0\")\n    const row: LogicValue[] = Array(numBits)\n    for (let i = 0; i < numBits; i++) {\n        row[i] = toLogicValueFromChar(binaryRepr[numBits - i - 1])\n    }\n    return row\n}\n\nexport function valuesFromReprForInput(repr: string | LogicValueRepr | LogicValueRepr[] | undefined, numBits: number): LogicValue[] {\n    if (repr === undefined || isString(repr) && repr.length === 0) {\n        // empty string or undefined\n        return ArrayFillWith<LogicValue>(false, numBits)\n    }\n    if (isArray(repr)) {\n        // array of LogicValueRepr\n        return ArrayClampOrPad(repr.map(v => toLogicValue(v)), numBits, false)\n    }\n    if (isNumber(repr)) {\n        // use that number for all bits\n        return ArrayFillWith<LogicValue>(toLogicValue(repr), numBits)\n    }\n    // by now, we have a bit string\n    return ArrayClampOrPad(Array.from(repr).reverse().map(v => toLogicValueFromChar(v)), numBits, false)\n}\n\nexport function reprForLogicValues<AllowUndefined extends boolean>(values: LogicValue[], undefinedIfTrivial: AllowUndefined): LogicValueRepr | string | (AllowUndefined extends false ? never : undefined) {\n    const numBits = values.length\n    if (numBits === 1) {\n        const value = values[0]\n        return undefinedIfTrivial && value === false ? undefined as any : toLogicValueRepr(value)\n    }\n    if (undefinedIfTrivial) {\n        let nontrivial = false\n        for (let i = 0; i < numBits; i++) {\n            if (values[i] !== false) {\n                nontrivial = true\n                break\n            }\n        }\n        if (!nontrivial) {\n            return undefined as any\n        }\n    }\n\n    return values.map(toLogicValueRepr).reverse().join(\"\")\n}\n\n\n\n// Enums or RichEnums used in several files\n\nexport enum Mode {\n    STATIC,  // cannot interact in any way\n    TRYOUT,  // can change inputs on predefined circuit\n    CONNECT, // can additionnally move preexisting components around and connect them\n    DESIGN,  // can additionally add components from left menu\n    FULL,    // can additionally force output nodes to 'unset' state and draw undetermined dates\n}\n\nexport async function copyToClipboard(textToCopy: string): Promise<boolean> {\n\n    try {\n        await navigator.clipboard.writeText(textToCopy)\n        console.log(\"Text copied to clipboard with new API\")\n        return true\n    } catch (e) {\n        // fallback to old method\n    }\n\n    function isOS() {\n        //can use a better detection logic here\n        return navigator.userAgent.match(/ipad|iphone/i)\n    }\n\n    const textArea = document.createElement('textarea')\n    textArea.readOnly = true\n    textArea.contentEditable = \"true\"\n    textArea.value = textToCopy\n    document.body.appendChild(textArea)\n\n    if (isOS()) {\n        const range = document.createRange()\n        range.selectNodeContents(textArea)\n        const selection = window.getSelection()\n        if (selection !== null) {\n            selection.removeAllRanges()\n            selection.addRange(range)\n            textArea.setSelectionRange(0, 999999)\n        }\n    } else {\n        textArea.select()\n    }\n\n    const ok = document.execCommand('copy')\n    document.body.removeChild(textArea)\n    return ok\n}\n\nexport async function pasteFromClipboard(): Promise<string | undefined> {\n\n    try {\n        const text = await navigator.clipboard.readText()\n        console.log(\"Text pasted from clipboard with new API\")\n        return text\n    } catch (e) {\n        // fallback to old method\n    }\n\n    const textArea = document.createElement('textarea')\n    textArea.readOnly = false\n    textArea.contentEditable = \"true\"\n    document.body.appendChild(textArea)\n\n    let result: string | undefined = undefined\n    textArea.focus()\n    const ok = document.execCommand('paste')\n    if (ok && textArea.value.length > 0) {\n        result = textArea.value\n    }\n    document.body.removeChild(textArea)\n    return result\n}\n\nexport function targetIsFieldOrOtherInput(e: Event) {\n    const targets = e.composedPath()\n    let elem, tagName\n    return targets.length !== 0 &&\n        (elem = targets[0]) instanceof HTMLElement &&\n        ((tagName = elem.tagName) === \"INPUT\" || tagName === \"SELECT\")\n}\n\nexport function getScrollParent(element: HTMLElement): HTMLElement | Document {\n    let style = getComputedStyle(element)\n    const excludeStaticParent = style.position === \"absolute\"\n    const overflowRegex = /(auto|scroll)/\n\n    if (style.position === \"fixed\") {\n        return document\n    }\n    let parent\n    for (parent = element; (parent = parent.parentElement);) {\n        style = getComputedStyle(parent)\n        if (excludeStaticParent && style.position === \"static\") {\n            continue\n        }\n        if (overflowRegex.test(style.overflow + style.overflowY + style.overflowX)) {\n            return parent\n        }\n    }\n    return document\n}\n\n\nexport const fetchJSONP = ((unique: number) => (url: string) =>\n    new Promise<string>(resolve => {\n        const script = document.createElement('script')\n        const name = `_jsonp_${unique++}`\n\n        if (url.match(/\\?/)) {\n            url += `&callback=${name}`\n        } else {\n            url += `?callback=${name}`\n        }\n\n        script.src = url;\n        (window as any)[name] = (json: any) => {\n            script.remove()\n            delete (window as any)[name]\n            resolve(JSON5.stringify(json))\n        }\n\n        document.body.appendChild(script)\n    })\n)(0)\n", "import { Serialization } from \"./Serialization\"\nimport { binaryStringRepr, isAllZeros, isArray, isRecord, isString, toLogicValue } from \"./utils\"\n\nexport const CurrentFormatVersion = 6\n\nexport function migrateData(data: Record<string, unknown>, editorId: string | undefined) {\n\n    // const initialRepr = !LogBeforeAfter ? undefined : isString(data) ? data : stringifySmart(data, { maxLength: 140 })\n\n    let jsonVersion = Number(data.v ?? 0)\n    const savedVersion = jsonVersion\n    if (savedVersion > CurrentFormatVersion) {\n        throw new Error(`Data format v${savedVersion} is newer than what this editor can load (v \u2264 ${CurrentFormatVersion}`)\n    }\n    while (jsonVersion < CurrentFormatVersion) {\n        const migrationFunc = migrateTo[++jsonVersion]\n\n        // migrate the outer container\n        migrationFunc(data)\n\n        // try to migrate the inner circuit descriptions of the custom components\n        const defs = data.defs\n        if (isArray(defs)) {\n            for (const def of defs) {\n                const circuit = def.circuit\n                if (isRecord(circuit)) {\n                    migrationFunc(circuit)\n                }\n            }\n        }\n\n        data.v = jsonVersion\n    }\n    if (jsonVersion !== savedVersion) {\n        const newRepr = Serialization.stringifyObject(data, false)\n        const editorIdStr = editorId !== undefined ? ` for editor '${editorId}'` : \"\"\n        console.log(`LogicEditor${editorIdStr} migrated data format from v${savedVersion} to v${jsonVersion}, consider upgrading its source to this:\\n${newRepr}`)\n        // console.log(\"WAS:\\n\" + initialRepr)\n    }\n}\n\n// Migration functions\n\nconst migrateTo: Record<number, (container: Record<string, unknown>) => void> = {\n\n    6: (container) => {\n        // replace separate lists with a single list of components with better type fields\n        const compFieldsAndCategories = {\n            in: \"in\",\n            out: \"out\",\n            gates: \"gate\",\n            ic: \"ic\",\n            labels: \"label\",\n            layout: \"layout\",\n        } as const\n\n        const oldToNewId: Record<string, string> = {\n            \"in\": \"in\",\n            \"in.clock\": \"clock\",\n            \"in.random\": \"rand\",\n            \"out\": \"out\",\n            \"out.display\": \"display\",\n            \"out.7seg\": \"7seg\",\n            \"out.16seg\": \"16seg\",\n            \"out.ascii\": \"ascii\",\n            \"out.bar\": \"bar\",\n            \"out.shift-buffer\": \"shift-display\",\n            \"out.shift-register\": \"shift-reg\",\n            \"ic.switched-inverter\": \"cnot-array\",\n            \"ic.gate-array\": \"{gatetype}-array\",\n            \"ic.tristate-array\": \"tristate-array\",\n            \"label\": \"label\",\n            \"label.rect\": \"rect\",\n            \"layout.pass\": \"pass\",\n            \"ic.halfadder\": \"halfadder\",\n            \"ic.adder\": \"adder\",\n            \"ic.comparator\": \"comp\",\n            \"ic.adder-array\": \"adder-array\",\n            \"ic.alu\": \"alu\",\n            \"ic.mux\": \"mux\",\n            \"ic.demux\": \"demux\",\n            \"ic.latch-sr\": \"latch-sr\",\n            \"ic.flipflop-jk\": \"ff-jk\",\n            \"ic.flipflop-t\": \"ff-t\",\n            \"ic.flipflop-d\": \"ff-d\",\n            \"ic.register\": \"reg\",\n            \"ic.shift-register\": \"shift-reg\",\n            \"ic.counter\": \"counter\",\n            \"ic.ram\": \"ram\",\n            \"ic.rom\": \"rom\",\n            \"ic.decoder\": \"dec\",\n            \"ic.decoder-7seg\": \"dec-7seg\",\n            \"ic.decoder-16seg\": \"dec-16seg\",\n            \"ic.decoder-bcd4\": \"dec-bcd4\",\n        }\n\n        function newTypeFor(category: string, item: Record<string, unknown>): string {\n            if (category === \"gate\") {\n                if (!isString(item.type)) {\n                    console.warn(\"Gate with no type found, assuming AND\", item)\n                    return \"and\"\n                }\n                const gateType = item.type.toLowerCase()\n                return gateType === \"tri\" ? \"tristate\" : gateType\n            } else {\n                const id = isString(item.type) ? `${category}.${item.type}` : category\n                if (id === \"ic.gate-array\") {\n                    let gateType\n                    if (!isString(item.subtype)) {\n                        console.warn(\"Gate array with no subtype found, assuming AND\", item)\n                        gateType = \"and\"\n                    } else {\n                        gateType = item.subtype.toLowerCase()\n                    }\n                    delete item.subtype\n                    return `${gateType}-array`\n                } else if (id in oldToNewId) {\n                    return oldToNewId[id]\n                } else if (id.startsWith(\"ic.custom-\")) {\n                    return id.substring(3)\n                } else {\n                    console.error(`Unknown component type: ${id}`)\n                    return id\n                }\n            }\n        }\n\n        const components: Record<string, unknown>[] = []\n        for (const [field, category] of Object.entries(compFieldsAndCategories)) {\n            const list = container[field]\n            if (isArray(list)) {\n                for (const compRepr of list) {\n                    if (isRecord(compRepr)) {\n                        const newType = newTypeFor(category, compRepr)\n                        compRepr.type = newType\n                        if (category === \"gate\" && isString(compRepr.poseAs)) {\n                            compRepr.poseAs = compRepr.poseAs.toLowerCase()\n                        }\n                        components.push(compRepr)\n                    }\n                }\n            }\n            delete container[field]\n        }\n        container.components = components\n    },\n\n\n    5: (container) => {\n        let type\n        let match: RegExpExecArray | null\n\n        // replace all hard-coded length types with parameterized types\n        const ins = container.in\n        if (isArray(ins)) {\n            for (const in_ of ins) {\n                if (isString(type = in_.type)) {\n\n                    if (type === \"nibble\") {\n                        delete in_.type\n                        in_.bits = 4\n\n                    } else if (type === \"byte\") {\n                        delete in_.type\n                        in_.bits = 8\n                    }\n                }\n            }\n        }\n\n        const outs = container.out\n        if (isArray(outs)) {\n            for (const out of outs) {\n                if (isString(type = out.type)) {\n\n                    if (type === \"nibble\") {\n                        delete out.type\n                        out.bits = 4\n\n                    } else if (type === \"byte\") {\n                        delete out.type\n                        out.bits = 8\n\n                    } else if (type === \"nibble-display\") {\n                        out.type = \"display\"\n                        out.bits = 4\n\n                    } else if (type === \"byte-display\") {\n                        out.type = \"display\"\n                        out.bits = 8\n\n                    } else if (type === \"shiftbuffer\") {\n                        out.type = \"shift-buffer\"\n                    }\n                }\n            }\n        }\n\n        const gates = container.gates\n        if (isArray(gates)) {\n            for (const gate of gates) {\n                if (isString(type = gate.type)) {\n\n                    const lastChar = type[type.length - 1]\n                    const maybeBit = parseInt(lastChar)\n                    if (!isNaN(maybeBit)) {\n                        gate.bits = maybeBit\n                        gate.type = type.slice(0, -1)\n                    }\n                }\n            }\n        }\n\n        const components = container.components\n        if (isArray(components)) {\n\n            const ramRegex = /^ram-(?<lines>\\d+)x(?<bits>\\d+)$/\n            const muxRegex = /^mux-(?<from>\\d+)to(?<to>\\d+)$/\n            const demuxRegex = /^demux-(?<from>\\d+)to(?<to>\\d+)$/\n\n            for (const comp of components) {\n                if (isString(type = comp.type)) {\n\n                    if (type === \"register\") {\n                        // register.state -> register.content\n                        let state\n                        if (isArray(state = comp.state)) {\n                            const binStr = binaryStringRepr(state.map(toLogicValue) as any)\n                            if (!isAllZeros(binStr)) {\n                                comp.content = binStr\n                            }\n                            delete comp.state\n                        }\n\n                    } else if (type === \"quad-gate\") {\n                        comp.type = \"gate-array\"\n\n                    } else if (type === \"quad-tristate\") {\n                        comp.type = \"tristate-array\"\n\n                    } else if ((match = ramRegex.exec(type)) !== null) {\n                        comp.type = \"ram\"\n                        comp.bits = parseInt(match.groups?.bits ?? \"4\")\n                        comp.lines = parseInt(match.groups?.lines ?? \"16\")\n\n                    } else if ((match = muxRegex.exec(type)) !== null) {\n                        comp.type = \"mux\"\n                        comp.from = parseInt(match.groups?.from ?? \"8\")\n                        comp.to = parseInt(match.groups?.to ?? \"4\")\n\n                    } else if ((match = demuxRegex.exec(type)) !== null) {\n                        comp.type = \"demux\"\n                        comp.from = parseInt(match.groups?.from ?? \"4\")\n                        comp.to = parseInt(match.groups?.to ?? \"8\")\n\n                    }\n                }\n            }\n\n            container.ic = components\n            delete container.components\n        }\n\n        const layouts = container.layout\n        if (isArray(layouts)) {\n\n            const passthroughRegex = /^pass-(?<bits>\\d+)$/\n\n            for (const layout of layouts) {\n                if (isString(type = layout.type)) {\n\n                    if ((match = passthroughRegex.exec(type)) !== null) {\n                        layout.type = \"pass\"\n                        layout.bits = parseInt(match.groups?.bits ?? \"1\")\n                    }\n                }\n            }\n        }\n    },\n\n\n    4: (container) => {\n        let nextNewId = findFirstFreeId(container)\n\n        // correct type of 4-bit display\n        const outs = container.out\n        if (isArray(outs)) {\n            for (const out of outs) {\n                if (out.type === \"nibble\") {\n                    out.type = \"nibble-display\"\n                }\n            }\n        }\n\n        // alu has one more output\n        const components = container.components\n        if (isArray(components)) {\n            for (const comp of components) {\n                if (comp.type === \"alu\") {\n                    if (isArray(comp.out)) {\n                        comp.out.push(nextNewId++) // add a new oVerflow output\n                        // replace carry output with overflow output as it was wrongly used before\n                        const t = comp.out[4]\n                        comp.out[4] = comp.out[6]\n                        comp.out[6] = t\n                    }\n                }\n            }\n        }\n    },\n\n\n    3: (container) => {\n        // alu has one more input\n        let nextNewId = findFirstFreeId(container)\n        const components = container.components\n        if (isArray(components)) {\n            for (const comp of components) {\n                if (comp.type === \"alu\") {\n                    if (isArray(comp.in)) {\n                        comp.in.push(nextNewId++)\n                    }\n                }\n            }\n        }\n    },\n\n\n    2: (container) => {\n        // waypoints -> via\n        const wires = container.wires\n        if (isArray(wires)) {\n            for (const wire of wires) {\n                if (isArray(wire) && wire.length === 3) {\n                    const wireOptions = wire[2]\n                    if (\"waypoints\" in wireOptions) {\n                        wireOptions.via = wireOptions.waypoints\n                        delete wireOptions.waypoints\n                    }\n                }\n            }\n        }\n    },\n\n\n    1: (container) => {\n        // all displays are now out\n        if (\"displays\" in container) {\n            const displays = container.displays\n            delete container.displays\n            if (!(\"out\" in container)) {\n                container.out = []\n            }\n            if (isArray(displays) && isArray(container.out)) {\n                for (const display of displays) {\n                    container.out.push(display)\n                }\n            }\n        }\n\n        // all clocks are now in\n        if (\"clocks\" in container) {\n            const clocks = container.clocks\n            delete container.clocks\n            if (!(\"in\" in container)) {\n                container.in = []\n            }\n            if (isArray(clocks) && isArray(container.in)) {\n                for (const clock of clocks) {\n                    clock.type = \"clock\"\n                    container.in.push(clock)\n                }\n            }\n        }\n\n        // flipflops have a different input node order\n        const components = container.components\n        if (isArray(components)) {\n            for (const comp of components) {\n                let type\n                if (isString(type = comp.type) && type.startsWith(\"flipflop\")) {\n                    // extract last three inputs\n                    const inputs: Array<number> = comp.in\n                    const lastThree = inputs.splice(-3)\n                    comp.in = [...lastThree, ...inputs]\n                }\n            }\n        }\n    },\n\n}\n\n\n// Migration helpers\n\nfunction findFirstFreeId(parsedContents: Record<string, unknown>): number {\n    // this finds the maximum id of all components on raw (but parsed) JSON;\n    // it is useful for migration code that needs to generate new ids\n\n    let maxId = -1\n\n    function inspectComponentDef(compDef: Record<string, unknown>) {\n        for (const fieldName of [\"id\", \"in\", \"out\"]) {\n            inspectValue(compDef[fieldName])\n        }\n    }\n\n    function inspectValue(value: unknown) {\n        if (value === undefined) {\n            return\n        }\n        if (typeof value === \"number\") {\n            if (!isNaN(value) && isFinite(value)) {\n                maxId = Math.max(maxId, value)\n            }\n        } else if (typeof value === \"string\") {\n            for (const val of value.split(\"-\")) {\n                inspectValue(parseInt(val))\n            }\n        } else if (isArray(value)) {\n            for (const item of value) {\n                inspectValue(item)\n            }\n        } else if (typeof value === \"object\" && value !== null) {\n            inspectValue((value as Record<string, unknown>).id)\n        }\n    }\n\n    for (const jsonField of Object.keys(parsedContents)) {\n        const arr = parsedContents[jsonField]\n        if (arr !== undefined && isArray(arr)) {\n            for (const comp of arr) {\n                inspectComponentDef(comp)\n            }\n        }\n    }\n\n    return maxId + 1\n}\n", "import * as t from \"io-ts\"\nimport { type ComponentList } from \"./ComponentList\"\nimport { type Component } from \"./components/Component\"\nimport { DrawableParent } from \"./components/Drawable\"\nimport { type Input } from \"./components/Input\"\nimport { type Output } from \"./components/Output\"\nimport { S } from \"./strings\"\nimport { ADTCase, ADTWith, ComponentTypeInput, ComponentTypeOutput, InputOutputValueRepr, isString, LogicValue, reprForLogicValues } from \"./utils\"\n\n\nexport type TestCaseValueMap<IO extends Input | Output> = Map<IO | string, InputOutputValueRepr>\n\n\nfunction buildMap<IO extends Input | Output>(repr: Record<string, InputOutputValueRepr>, compList: ComponentList, isInputOutput: (comp: Component | undefined) => comp is IO): TestCaseValueMap<IO> {\n    const map: TestCaseValueMap<IO> = new Map()\n    for (const [ref, value] of Object.entries(repr)) {\n        const comp = compList.get(ref)\n        if (isInputOutput(comp)) {\n            map.set(comp, value)\n        } else {\n            // fall back to using the ref as a string\n            map.set(ref, value)\n        }\n    }\n    return map\n}\n\nfunction fixMap<IO extends Input | Output>(map: TestCaseValueMap<IO>, compList: ComponentList, isInputOutput: (comp: Component | undefined) => comp is IO) {\n    for (const [k, v] of map.entries()) {\n        if (isString(k)) {\n            const comp = compList.get(k)\n            if (isInputOutput(comp)) {\n                map.delete(k)\n                map.set(comp, v)\n            }\n        }\n    }\n}\n\nfunction isInput(comp: Component | undefined): comp is Input {\n    return comp?.def.type === ComponentTypeInput\n}\n\nfunction isOutput(comp: Component | undefined): comp is Output {\n    return comp?.def.type === ComponentTypeOutput\n}\n\nexport type TestCaseCombinationalRepr = t.TypeOf<typeof TestCaseCombinational.Repr>\n\nexport class TestCaseCombinational {\n\n    public static get Repr() {\n        return t.intersection([\n            t.type({\n                in: t.record(t.string, InputOutputValueRepr),\n                out: t.record(t.string, InputOutputValueRepr),\n            }),\n            t.partial({\n                name: t.string,\n                stopOnFail: t.boolean,\n            }),\n        ], \"TestCaseCombinational\")\n    }\n\n    public name: string | undefined\n    public in: TestCaseValueMap<Input>\n    public out: TestCaseValueMap<Output>\n    public stopOnFail: boolean\n\n    public constructor(repr: TestCaseCombinationalRepr, compList: ComponentList) {\n        if (repr !== undefined) {\n            this.name = repr.name\n            this.in = buildMap(repr.in, compList, isInput)\n            this.out = buildMap(repr.out, compList, isOutput)\n            this.stopOnFail = repr.stopOnFail ?? false\n        } else {\n            this.name = S.Tests.DefaultTestCaseName\n            this.in = new Map()\n            this.out = new Map()\n            this.stopOnFail = false\n        }\n    }\n\n    public tryFixReferences(compList: ComponentList) {\n        fixMap(this.in, compList, isInput)\n        fixMap(this.out, compList, isOutput)\n    }\n\n    public toJSON(): TestCaseCombinationalRepr {\n        const mapRepr = (map: TestCaseValueMap<Input | Output>) =>\n            Object.fromEntries([...map.entries()].map(\n                ([k, v]) => [(isString(k) ? k : k.ref ?? \"?\"), v])\n            )\n        return {\n            name: this.name,\n            in: mapRepr(this.in),\n            out: mapRepr(this.out),\n            stopOnFail: this.stopOnFail === true ? true : undefined,\n        }\n    }\n\n}\n\n\nexport type TestSuiteRepr = t.TypeOf<typeof TestSuite.Repr>\n\nexport class TestSuite {\n\n    public static get Repr() {\n        return t.intersection([\n            t.type({\n                cases: t.array(TestCaseCombinational.Repr),\n            }),\n            t.partial({\n                name: t.string,\n                hidden: t.boolean,\n                weight: t.number,\n            }),\n        ], \"TestSuite\")\n    }\n\n    public static get ReprArray() {\n        return t.array(TestSuite.Repr)\n    }\n\n    public name: string | undefined\n    public weight: number\n    public isHidden: boolean\n    public testCases: TestCaseCombinational[]\n\n    public constructor(reprAndComps?: [TestSuiteRepr, ComponentList]) {\n        if (reprAndComps !== undefined) {\n            const [repr, compList] = reprAndComps\n            this.name = repr.name\n            this.isHidden = repr.hidden ?? false\n            this.weight = repr.weight ?? 1\n            this.testCases = repr.cases.map(tc => new TestCaseCombinational(tc, compList))\n        } else {\n            this.name = undefined\n            this.isHidden = false\n            this.weight = 1\n            this.testCases = []\n        }\n    }\n\n    public toJSON(): TestSuiteRepr {\n        return {\n            name: this.name,\n            weight: this.weight !== 1 ? this.weight : undefined,\n            hidden: this.isHidden === true ? true : undefined,\n            cases: this.testCases.map(tc => tc.toJSON()),\n        }\n    }\n\n}\n\nexport type TestCaseResultMismatch = { output: Output, expected: LogicValue[], actual: LogicValue[] }\n\nexport const TestCaseResult = {\n    Pass: { _tag: \"pass\" as const },\n    Skip: { _tag: \"skip\" as const },\n    Fail: (mismatches: TestCaseResultMismatch[]) => ({ _tag: \"fail\" as const, mismatches }),\n    Error: (msg: string) => ({ _tag: \"error\" as const, msg }),\n}\nexport type TestCaseResult = ADTWith<typeof TestCaseResult>\n\nexport type TestCaseResultFail = ADTCase<TestCaseResult, \"fail\">\n\n\nexport class TestSuiteResults {\n\n    public readonly testCaseResults: Array<[TestCaseCombinational, TestCaseResult]> = []\n\n    public constructor(\n        public readonly testSuite: TestSuite\n    ) {\n    }\n\n    public addTestCaseResult(testCase: TestCaseCombinational, result: TestCaseResult) {\n        this.testCaseResults.push([testCase, result])\n    }\n\n    public isAllPass(): boolean {\n        return this.testCaseResults.every(([, result]) => result._tag === \"pass\")\n    }\n\n    public dump() {\n        console.group(`Test Suite Results for ${this.testSuite.name}`)\n        for (const [testCase, result] of this.testCaseResults) {\n            console.group(`Test Case ${testCase.name}`)\n            if (result._tag === \"pass\") {\n                console.log(\"PASS\")\n            } else if (result._tag === \"fail\") {\n                const mismatches = result.mismatches.map(m => `${m.output.ref}: ${reprForLogicValues(m.actual, false)} instead of ${reprForLogicValues(m.expected, false)}`)\n                console.log(\"FAIL - mismatches: \" + mismatches.join(\", \"))\n            } else if (result._tag === \"error\") {\n                console.log(`ERROR - ${result.msg}`)\n            }\n            console.groupEnd()\n        }\n        console.groupEnd()\n    }\n\n}\n\n\nexport class TestSuites {\n\n    private readonly _testSuites: TestSuite[]\n\n    public constructor(\n        public readonly parent: DrawableParent\n    ) {\n        this._testSuites = []\n    }\n\n    public get suites(): ReadonlyArray<TestSuite> {\n        return this._testSuites\n    }\n\n    public totalCases(): number {\n        return this._testSuites.reduce((acc, suite) => acc + suite.testCases.length, 0)\n    }\n\n    public set(testSuites: readonly TestSuite[]) {\n        this._testSuites.length = 0\n        this._testSuites.push(...testSuites)\n    }\n\n    public push(testSuite: TestSuite) {\n        this._testSuites.push(testSuite)\n    }\n\n    public hasReferenceTo(ref: string | undefined): ref is string {\n        if (ref === undefined) {\n            return false\n        }\n        const isRef = (s: string | Input | Output, ref: string) =>\n            isString(s) ? s === ref : s.ref === ref\n        for (const suite of this._testSuites) {\n            for (const testCase of suite.testCases) {\n                for (const input of testCase.in.keys()) {\n                    if (isRef(input, ref)) {\n                        return true\n                    }\n                }\n                for (const output of testCase.out.keys()) {\n                    if (isRef(output, ref)) {\n                        return true\n                    }\n                }\n            }\n        }\n        return false\n    }\n\n}", "/* eslint-disable @typescript-eslint/semi */\n\n// 'ts-ignore' works on the next line, so we need the next line\n// @ts-ignore\n\n\n\n// icons\nimport add from '../img/icons/add.icon.svg'; // @ts-ignore\nimport bordercolor from '../img/icons/bordercolor.icon.svg'; // @ts-ignore\nimport browserload from '../img/icons/browserload.icon.svg'; // @ts-ignore\nimport check from '../img/icons/check.icon.svg'; // @ts-ignore\nimport close from '../img/icons/close.icon.svg'; // @ts-ignore\nimport connect from '../img/icons/connect.icon.svg'; // @ts-ignore\nimport dimensions from '../img/icons/dimensions.icon.svg'; // @ts-ignore\nimport direction from '../img/icons/direction.icon.svg'; // @ts-ignore\nimport download from '../img/icons/download.icon.svg'; // @ts-ignore\nimport edit from '../img/icons/edit.icon.svg'; // @ts-ignore\nimport eye from '../img/icons/eye.icon.svg'; // @ts-ignore\nimport eyecrossed from '../img/icons/eyecrossed.icon.svg'; // @ts-ignore\nimport font from '../img/icons/font.icon.svg'; // @ts-ignore\nimport force from '../img/icons/force.icon.svg'; // @ts-ignore\nimport inputs from '../img/icons/inputs.icon.svg'; // @ts-ignore\nimport link from '../img/icons/link.icon.svg'; // @ts-ignore\nimport memcontent from '../img/icons/memcontent.icon.svg'; // @ts-ignore\nimport memlines from '../img/icons/memlines.icon.svg'; // @ts-ignore\nimport mouse from '../img/icons/mouse.icon.svg'; // @ts-ignore\nimport move from '../img/icons/move.icon.svg'; // @ts-ignore\nimport newcomponent from '../img/icons/newcomponent.icon.svg'; // @ts-ignore\nimport none from '../img/icons/none.icon.svg'; // @ts-ignore\nimport open from '../img/icons/open.icon.svg'; // @ts-ignore\nimport outputs from '../img/icons/outputs.icon.svg'; // @ts-ignore\nimport palette from '../img/icons/palette.icon.svg'; // @ts-ignore\nimport pause from '../img/icons/pause.icon.svg'; // @ts-ignore\nimport pen from '../img/icons/pen.icon.svg'; // @ts-ignore\nimport placement from '../img/icons/placement.icon.svg'; // @ts-ignore\nimport play from '../img/icons/play.icon.svg'; // @ts-ignore\nimport question from '../img/icons/question.icon.svg'; // @ts-ignore\nimport questioncircled from '../img/icons/questioncircled.icon.svg'; // @ts-ignore\nimport redo from '../img/icons/redo.icon.svg'; // @ts-ignore\nimport { default as ref, default as regroup } from '../img/icons/ref.icon.svg'; // @ts-ignore\nimport replace from '../img/icons/replace.icon.svg'; // @ts-ignore\nimport reset from '../img/icons/reset.icon.svg'; // @ts-ignore\nimport screenshot from '../img/icons/screenshot.icon.svg'; // @ts-ignore\nimport setinput from '../img/icons/setinput.icon.svg'; // @ts-ignore\nimport settings from '../img/icons/settings.icon.svg'; // @ts-ignore\nimport slanted from '../img/icons/slanted.icon.svg'; // @ts-ignore\nimport step from '../img/icons/step.icon.svg'; // @ts-ignore\nimport strokewidth from '../img/icons/strokewidth.icon.svg'; // @ts-ignore\nimport testcase from '../img/icons/testcase.icon.svg'; // @ts-ignore\nimport timer from '../img/icons/timer.icon.svg'; // @ts-ignore\nimport trash from '../img/icons/trash.icon.svg'; // @ts-ignore\nimport undo from '../img/icons/undo.icon.svg'; // @ts-ignore\nimport wirestyle from '../img/icons/wirestyle.icon.svg'; // @ts-ignore\n\n\n// images\nimport ALU from '../img/ALU.svg'; // @ts-ignore\nimport Adder from '../img/Adder.svg'; // @ts-ignore\nimport AdderArray from '../img/AdderArray.svg'; // @ts-ignore\nimport Clock from '../img/Clock.svg'; // @ts-ignore\nimport Comparator from '../img/Comparator.svg'; // @ts-ignore\nimport ControlledInverter from '../img/ControlledInverter.svg'; // @ts-ignore\nimport Counter from '../img/Counter.svg'; // @ts-ignore\nimport Decoder from '../img/Decoder.svg'; // @ts-ignore\nimport Decoder16Seg from '../img/Decoder16Seg.svg'; // @ts-ignore\nimport Decoder7Seg from '../img/Decoder7Seg.svg'; // @ts-ignore\nimport DecoderBCD4 from '../img/DecoderBCD4.svg'; // @ts-ignore\nimport Demux from '../img/Demux.svg'; // @ts-ignore\nimport Display16Seg from '../img/Display16Seg.svg'; // @ts-ignore\nimport Display4 from '../img/Display4.svg'; // @ts-ignore\nimport Display7Seg from '../img/Display7Seg.svg'; // @ts-ignore\nimport Display8 from '../img/Display8.svg'; // @ts-ignore\nimport DisplayAscii from '../img/DisplayAscii.svg'; // @ts-ignore\nimport DisplayBar from '../img/DisplayBar.svg'; // @ts-ignore\nimport FlipflopD from '../img/FlipflopD.svg'; // @ts-ignore\nimport FlipflopJK from '../img/FlipflopJK.svg'; // @ts-ignore\nimport FlipflopT from '../img/FlipflopT.svg'; // @ts-ignore\nimport GateArray from '../img/GateArray.svg'; // @ts-ignore\nimport HalfAdder from '../img/HalfAdder.svg'; // @ts-ignore\nimport Input1 from '../img/Input1.svg'; // @ts-ignore\nimport Input4 from '../img/Input4.svg'; // @ts-ignore\nimport Input8 from '../img/Input8.svg'; // @ts-ignore\nimport Label from '../img/Label.svg'; // @ts-ignore\nimport LatchSR from '../img/LatchSR.svg'; // @ts-ignore\nimport Mux from '../img/Mux.svg'; // @ts-ignore\nimport Output1 from '../img/Output1.svg'; // @ts-ignore\nimport Output4 from '../img/Output4.svg'; // @ts-ignore\nimport Output8 from '../img/Output8.svg'; // @ts-ignore\nimport Passthrough1 from '../img/Passthrough1.svg'; // @ts-ignore\nimport PassthroughN from '../img/PassthroughN.svg'; // @ts-ignore\nimport Pixel from '../img/Pixel.svg'; // @ts-ignore\nimport RAM from '../img/RAM.svg'; // @ts-ignore\nimport ROM from '../img/ROM.svg'; // @ts-ignore\nimport Random from '../img/Random.svg'; // @ts-ignore\nimport Rectangle from '../img/Rectangle.svg'; // @ts-ignore\nimport Register from '../img/Register.svg'; // @ts-ignore\nimport ShiftDisplay from '../img/ShiftDisplay.svg'; // @ts-ignore\nimport ShiftRegister from '../img/ShiftRegister.svg'; // @ts-ignore\nimport TristateBufferArray from '../img/TristateBufferArray.svg'; // @ts-ignore\nimport and from '../img/and.svg'; // @ts-ignore\nimport and3 from '../img/and3.svg'; // @ts-ignore\nimport and4 from '../img/and4.svg'; // @ts-ignore\nimport buf from '../img/buf.svg'; // @ts-ignore\nimport imply from '../img/imply.svg'; // @ts-ignore\nimport nand from '../img/nand.svg'; // @ts-ignore\nimport nand3 from '../img/nand3.svg'; // @ts-ignore\nimport nand4 from '../img/nand4.svg'; // @ts-ignore\nimport nimply from '../img/nimply.svg'; // @ts-ignore\nimport nor from '../img/nor.svg'; // @ts-ignore\nimport nor3 from '../img/nor3.svg'; // @ts-ignore\nimport nor4 from '../img/nor4.svg'; // @ts-ignore\nimport not from '../img/not.svg'; // @ts-ignore\nimport or from '../img/or.svg'; // @ts-ignore\nimport or3 from '../img/or3.svg'; // @ts-ignore\nimport or4 from '../img/or4.svg'; // @ts-ignore\nimport tri from '../img/tri.svg'; // @ts-ignore\nimport txa from '../img/txa.svg'; // @ts-ignore\nimport xnor from '../img/xnor.svg'; // @ts-ignore\nimport xnor3 from '../img/xnor3.svg'; // @ts-ignore\nimport xnor4 from '../img/xnor4.svg'; // @ts-ignore\nimport xor from '../img/xor.svg'; // @ts-ignore\nimport xor3 from '../img/xor3.svg'; // @ts-ignore\nimport xor4 from '../img/xor4.svg'; // @ts-ignore\nimport { Modifier, applyModifierTo, raw } from './htmlgen'\n\n\nvoid 0 // dummy line to consume the last 'ts-ignore'\n\n\nconst icons = {\n    add,\n    bordercolor,\n    browserload,\n    check,\n    close,\n    connect,\n    dimensions,\n    direction,\n    download,\n    edit,\n    eye,\n    eyecrossed,\n    font,\n    force,\n    inputs,\n    link,\n    memcontent,\n    memlines,\n    mouse,\n    move,\n    newcomponent,\n    none,\n    open,\n    outputs,\n    palette,\n    pause,\n    pen,\n    placement,\n    play,\n    question,\n    questioncircled,\n    redo,\n    ref,\n    regroup,\n    replace,\n    reset,\n    screenshot,\n    setinput,\n    settings,\n    slanted,\n    step,\n    strokewidth,\n    testcase,\n    timer,\n    trash,\n    undo,\n    wirestyle,\n}\n\nconst images = {\n    Adder,\n    AdderArray,\n    ALU,\n    and,\n    and3,\n    and4,\n    buf,\n    Clock,\n    Comparator,\n    Counter,\n    Decoder,\n    Decoder7Seg,\n    Decoder16Seg,\n    DecoderBCD4,\n    Demux,\n    FlipflopD,\n    FlipflopJK,\n    FlipflopT,\n    GateArray,\n    HalfAdder,\n    imply,\n    Input1,\n    Input4,\n    Input8,\n    Random,\n    Rectangle,\n    Label,\n    LatchSR,\n    Mux,\n    nand,\n    nand3,\n    nand4,\n    nimply,\n    nor,\n    nor3,\n    nor4,\n    not,\n    or,\n    or3,\n    or4,\n    Output1,\n    Output4,\n    Output8,\n    Display7Seg,\n    Display16Seg,\n    DisplayAscii,\n    DisplayBar,\n    Display4,\n    Display8,\n    ShiftDisplay,\n    Passthrough1,\n    PassthroughN,\n    Pixel,\n    RAM,\n    ROM,\n    Register,\n    ShiftRegister,\n    ControlledInverter,\n    tri,\n    TristateBufferArray,\n    txa,\n    xnor,\n    xnor3,\n    xnor4,\n    xor,\n    xor3,\n    xor4,\n}\n\nexport type IconName = keyof typeof icons\nexport function isIconName(name: string): name is IconName {\n    return name in icons\n}\n\nexport type ImageName = keyof typeof images\nexport function isImageName(name: string): name is ImageName {\n    return name in images\n}\n\nexport function makeImage(name: ImageName, width?: number, height?: number): HTMLElement {\n    return makeSvgHolder(\"svgimg\", name, raw(inlineSvgFor(images, name)), width, height)\n}\n\nexport function makeIcon(name: IconName, width?: number, height?: number): HTMLElement {\n    return makeSvgHolder(\"svgicon\", name, raw(inlineSvgFor(icons, name)), width, height)\n}\n\nexport function makeSvgHolder(className: string, iconName: string, content: Modifier, width?: number, height?: number): HTMLElement {\n    const elem = document.createElement('i')\n    elem.classList.add(className)\n    elem.setAttribute('data-icon', iconName)\n    if (width !== undefined) {\n        elem.style.width = `${width}px`\n    }\n    if (height !== undefined) {\n        elem.style.height = `${height}px`\n    }\n    applyModifierTo(elem, content)\n    return elem\n}\n\nfunction inlineSvgFor<TImages extends Record<string, string>>(svgData: TImages, name: keyof TImages): string {\n    return svgData[name]\n}\n\nexport function inlineIconSvgFor(name: IconName): string {\n    return inlineSvgFor(icons, name)\n}\n\n\n", "\n//\n// Helper export function s to build HTML more smartly in JavaScript\n//\n\nimport { inlineIconSvgFor, isIconName } from \"./images\"\nimport { isHighImpedance, isUnknown, LogicValue, Unknown } from \"./utils\"\n\nexport interface ModifierObject {\n    applyTo(parent: Element): void\n}\nexport type Modifier = ModifierObject | Node | string\nexport interface RenderObject<T extends HTMLElement> {\n    render(): T\n}\nexport type ElemRenderer<T extends HTMLElement> = ModifierObject & RenderObject<T>\nexport interface AttrBuilder {\n    (attrValue: any): ModifierObject\n    attrName: string\n}\nexport interface StyleBuilder {\n    (styleValue: any): ModifierObject\n    styleName: string\n}\n\nexport function isModifierObject(mod: any): mod is ModifierObject {\n    return typeof mod.applyTo === \"function\"\n}\nexport function isNode(obj: any): obj is Node {\n    return typeof obj === \"object\" && \"nodeType\" in obj\n}\n\nexport function applyModifierTo(parent: Element, modifier: Modifier): void {\n    if (isNode(modifier)) {\n        parent.appendChild(modifier)\n    } else if (isModifierObject(modifier)) {\n        modifier.applyTo(parent)\n    } else {\n        const text = \"\" + modifier\n        parent.appendChild(document.createTextNode(text))\n    }\n}\n\nexport function applyModifiersTo(parent: Element, modifiers: Modifier[]): void {\n    for (const mod of modifiers) {\n        applyModifierTo(parent, mod)\n    }\n}\n\nexport function elemBuilder<K extends keyof HTMLElementTagNameMap>(tagName: K): (...modifiers: Modifier[]) => ElemRenderer<HTMLElementTagNameMap[K]> {\n    return (...modifiers: Modifier[]) => {\n        return {\n            render: () => {\n                const el = document.createElement(tagName)\n                applyModifiersTo(el, modifiers)\n                return el\n            },\n            applyTo: function (parent) {\n                parent.appendChild(this.render())\n            },\n        }\n    }\n}\n\n\nexport function attrBuilder(attrName: string): AttrBuilder {\n    const builder = ((attrValue: any): ModifierObject => {\n        return {\n            applyTo: p => p.setAttribute(attrName, \"\" + attrValue),\n        }\n    }) as AttrBuilder\n    builder.attrName = attrName\n    return builder\n}\n\nexport function styleBuilder(styleName: string): StyleBuilder {\n    const builder = ((styleValue: any): ModifierObject => {\n        return {\n            applyTo: p => (p as HTMLElement).style.setProperty(styleName, styleValue),\n        }\n    }) as StyleBuilder\n    builder.styleName = styleName\n    return builder\n}\n\nexport function data(dataName: string): AttrBuilder {\n    return attrBuilder(\"data-\" + dataName)\n}\n\nexport function raw(rawHTML: string): Modifier {\n    return {\n        applyTo: p => p.insertAdjacentHTML('beforeend', rawHTML),\n    }\n}\n\nexport function addClass(className: string): Modifier {\n    return {\n        applyTo: p => p.classList.add(className),\n    }\n}\n\nexport function mods(...modifiers: Modifier[]): ModifierObject {\n    return {\n        applyTo: p => applyModifiersTo(p, modifiers),\n    }\n}\n\nexport const emptyMod: Modifier = {\n    applyTo: __ => undefined, // do nothing\n}\n\nexport function attr(attrName: string, attrValue: string): Modifier {\n    return attrBuilder(attrName)(attrValue)\n}\n\nexport const div = elemBuilder(\"div\")\nexport const span = elemBuilder(\"span\")\n\nexport const a = elemBuilder(\"a\")\n\nexport const b = elemBuilder(\"b\")\nexport const i = elemBuilder(\"i\")\n\nexport const ul = elemBuilder(\"ul\")\nexport const ol = elemBuilder(\"ol\")\nexport const li = elemBuilder(\"li\")\n\nexport const table = elemBuilder(\"table\")\nexport const thead = elemBuilder(\"thead\")\nexport const tbody = elemBuilder(\"tbody\")\nexport const tr = elemBuilder(\"tr\")\nexport const th = elemBuilder(\"th\")\nexport const td = elemBuilder(\"td\")\n\nexport const input = elemBuilder(\"input\")\nexport const select = elemBuilder(\"select\")\nexport const option = elemBuilder(\"option\")\nexport const button = elemBuilder(\"button\")\nexport const label = elemBuilder(\"label\")\nexport const img = elemBuilder(\"img\")\nexport const canvas = elemBuilder(\"canvas\")\n\nexport const style = attrBuilder(\"style\")\nexport const type = attrBuilder(\"type\")\nexport const cls = attrBuilder(\"class\")\nexport const href = attrBuilder(\"href\")\nexport const target = attrBuilder(\"target\")\nexport const title = attrBuilder(\"title\")\nexport const src = attrBuilder(\"src\")\nexport const draggable = attrBuilder(\"draggable\")(\"true\")\nexport const br = raw('<br>')\n\n\n// Common Modifier-generating helpers\n\nexport const asValue = (bool: LogicValue) => b(isUnknown(bool) || isHighImpedance(bool) ? Unknown : String(Number(bool)))\n\nexport function tooltipContent(title: Modifier | undefined, body: Modifier, maxWidth = 200): ModifierObject {\n    return div(style(`max-width: ${maxWidth}px`),\n        title === undefined ? emptyMod : div(style(\"padding-bottom: 3px; border-bottom: 1px solid grey;\"), title),\n        div(body)\n    )\n}\n\nexport const fixedWidthInContextMenu = style(\"font-family: monospace; font-weight: bolder; font-size: 90%\")\n\nexport function setupSvgIcon(_iconElem: Element) {\n    const iconElem = _iconElem as HTMLElement\n    const iconName = iconElem.dataset.icon ?? \"question\"\n    if (isIconName(iconName)) {\n        iconElem.innerHTML = inlineIconSvgFor(iconName)\n    } else {\n        console.log(`Unknown icon name '${iconName}'`)\n    }\n}", "import { Modifier, mods } from \"./htmlgen\"\nimport { RichStringEnum, tuple } from \"./utils\"\n\nexport type Strings = typeof Strings_fr\n\n// either just the title (mouseover), or the title and the caption\ntype ComponentStrings = string | [string, string]\n\nexport class Template<TPlaceholders extends string[]> {\n    public constructor(public readonly templateString: string) { }\n    public expand(values: { [K in TPlaceholders[number]]: unknown }) {\n        return this.templateString.replace(/\\$(s?)\\{(\\w+)(\\?(\\w*)(:(\\w*))?)?\\}/g, (match, s, key, plurDecl, plural, singDecl, singular) => {\n            const value = (values as any)[key] as unknown | undefined\n            if (s === \"s\") {\n                return S.plural(value === undefined ? 0 : Number(value), plural, singular)\n            }\n            return String(value ?? \"<<\" + key + \">>\")\n        })\n    }\n}\n\ntype _ExtractPlaceholders<TName extends string, TPlaceholders extends string[]>\n    = TName extends `${infer __TStart}\\${${infer TPlaceholder}}${infer TEnd}`\n    ? _ExtractPlaceholders<`${TEnd}`, [...TPlaceholders, TPlaceholder]>\n    : TName extends `${infer __TStart}$s{${infer TPlaceholder}}${infer TEnd}`\n    ? _ExtractPlaceholders<`${TEnd}`, [...TPlaceholders, TPlaceholder]>\n    : TPlaceholders\n\ntype ExtractPlaceholders<TName extends string> =\n    _ExtractPlaceholders<TName, []>\n\nexport function template<TText extends string>(templ: TText) {\n    return new Template<ExtractPlaceholders<TText>>(templ)\n}\n\n\nconst Strings_fr = {\n    plural: (n: number, plural?: string, singular?: string) => Math.abs(n) < 2 ? (singular ?? \"\") : (plural ?? \"s\"),\n    ComponentBar: {\n        Labels: {\n            More: \"Plus\",\n            Less: \"Moins\",\n        },\n        SectionNames: {\n            InputOutput: \"Entr\u00E9es/ sorties\",\n            Layout: \"Dispo- sition\",\n            Gates: \"Portes\",\n            Components: \"Compo- sants\",\n            Custom: \"Person- nalis\u00E9\",\n        },\n        Components: RichStringEnum.withProps<ComponentStrings>()({\n            Input1: [\"Entr\u00E9e\", \"IN\"],\n            InputN: [\"Entr\u00E9e multiple\", \"IN mult.\"],\n            Input8: [\"Entr\u00E9e octet (8 bits)\", \"IN 8 bits\"],\n            Clock: [\"G\u00E9n\u00E9rateur de signal d\u2019horloge\", \"Horloge\"],\n            Random: [\"Entr\u00E9e al\u00E9atoire\", \"Al\u00E9atoire\"],\n            Output1: [\"Sortie\", \"OUT\"],\n            OutputN: [\"Sortie multiple\", \"OUT mult.\"],\n            Output8: [\"Sortie octet (8 bits)\", \"OUT 8 bits\"],\n            DisplayN: [\"Afficheur d\u2019une valeur\", \"Afficheur\"],\n            Display8: [\"Affichage de 8 bits\", \"Aff. 8 bits\"],\n            Display7Seg: [\"Afficheur \u00E0 7 segments\", \"7 segments\"],\n            Display16Seg: [\"Afficheur \u00E0 16 segments\", \"16 segments\"],\n            DisplayAscii: [\"Affichage d\u2019un caract\u00E8re ASCII (sur 7 bits)\", \"Caract\u00E8re\"],\n            DisplayBar: [\"Affichage d\u2019un bit sous forme de segment lumineux\", \"Segment\"],\n            Pixel: [\"Affichage d\u2019un pixel avec couleur r\u00E9glable\", \"Pixel\"],\n            ShiftDisplay: [\"Affichage avec buffer \u00E0 d\u00E9calage\", \"Affichage \u00E0 d\u00E9calage\"],\n\n            Passthrough1: [\"Broche\", \"Broche\"],\n            PassthroughN: [\"Broche \u00E0 plusieurs entr\u00E9es-sortes\", \"Broche (n)\"],\n            Label: [\"\u00C9tiquette\", \"Label\"],\n            Rectangle: [\"Rectangle de regroupement\", \"Groupe\"],\n\n            not: [\"Porte NON\", \"NON\"],\n            buf: [\"Buffer (porte OUI)\", \"OUI\"],\n            tri: [\"Sortie \u00E0 3 \u00E9tats\", \"3 \u00E9tats\"],\n            and: [\"Porte ET\", \"ET\"],\n            or: [\"Porte OU\", \"OU\"],\n            xor: [\"Porte OU-X\", \"OU-X\"],\n            nand: [\"Porte NON-ET\", \"NON-ET\"],\n            nor: [\"Porte NON-OU\", \"NON-OU\"],\n            xnor: [\"Porte NON-OU-X\", \"NON-OU-X\"],\n            imply: [\"Porte IMPLIQUE\", \"IMPLIQUE\"],\n            nimply: [\"Porte NON-IMPLIQUE\", \"NON-IMPL.\"],\n            transfer: [\"Fausse porte TRANSFERT \u00E0 deux entr\u00E9es\", \"TRANSF.\"],\n\n            and3: [\"Porte ET \u00E0 3 entr\u00E9es\", \"ET (3)\"],\n            or3: [\"Porte OU \u00E0 3 entr\u00E9es\", \"OU (3)\"],\n            xor3: [\"Porte OU-X \u00E0 3 entr\u00E9es\", \"OU-X (3)\"],\n            nand3: [\"Porte NON-ET \u00E0 3 entr\u00E9es\", \"NON-ET (3)\"],\n            nor3: [\"Porte NON-OU \u00E0 3 entr\u00E9es\", \"NON-OU (3)\"],\n            xnor3: [\"Porte NON-OU-X \u00E0 3 entr\u00E9es\", \"NON-OU-X (3)\"],\n\n            and4: [\"Porte ET \u00E0 4 entr\u00E9es\", \"ET (4)\"],\n            or4: [\"Porte OU \u00E0 4 entr\u00E9es\", \"OU (4)\"],\n            xor4: [\"Porte OU-X \u00E0 4 entr\u00E9es\", \"OU-X (4)\"],\n            nand4: [\"Porte NON-ET \u00E0 4 entr\u00E9es\", \"NON-ET (4)\"],\n            nor4: [\"Porte NON-OU \u00E0 4 entr\u00E9es\", \"NON-OU (4)\"],\n            xnor4: [\"Porte NON-OU-X \u00E0 4 entr\u00E9es\", \"NON-OU-X (4)\"],\n\n            ControlledInverter: [\"Inverseur commut\u00E9\", \"Inv. comm.\"],\n            GateArray: [\"Porte multiple\", \"Porte mult.\"],\n            TristateBufferArray: [\"Sortie \u00E0 3 \u00E9tats multiple\", \"3 \u00E9tats mult.\"],\n\n            HalfAdder: [\"Demi-additionneur\", \"Demi-add.\"],\n            Adder: [\"Additionneur\", \"Addit.\"],\n            AdderArray: [\"Additionneur multiple\", \"Add. mult.\"],\n            ALU: [\"Unit\u00E9 arithm\u00E9tique et logique\", \"ALU\"],\n\n            Mux: [\"Multiplexer\", \"Mux\"],\n            Mux2to1: [\"Multiplexer 2-vers-1 (1 bit de contr\u00F4le)\", \"Mux 2-1\"],\n            Mux4to1: [\"Multiplexer 4-vers-1 (2 bits de contr\u00F4le)\", \"Mux 4-1\"],\n            Mux8to1: [\"Multiplexer 8-vers-1 (3 bits de contr\u00F4le)\", \"Mux 8-1\"],\n            Mux4to2: [\"Multiplexer 4-vers-2 (1 bit de contr\u00F4le)\", \"Mux 4-2\"],\n            Mux8to2: [\"Multiplexer 8-vers-2 (2 bits de contr\u00F4le)\", \"Mux 8-2\"],\n            Mux8to4: [\"Multiplexer 8-vers-4 (1 bit de contr\u00F4le)\", \"Mux 8-4\"],\n            Mux16to8: [\"Multiplexer 16-vers-8 (1 bit de contr\u00F4le)\", \"Mux 16-8\"],\n\n            Demux: [\"D\u00E9multiplexer\", \"Demux\"],\n            Demux1to2: [\"D\u00E9multiplexer 1-vers-2 (1 bit de contr\u00F4le)\", \"Demux 1-2\"],\n            Demux1to4: [\"D\u00E9multiplexer 1-vers-4 (2 bits de contr\u00F4le)\", \"Demux 1-4\"],\n            Demux1to8: [\"D\u00E9multiplexer 1-vers-8 (3 bits de contr\u00F4le)\", \"Demux 1-8\"],\n            Demux2to4: [\"D\u00E9multiplexer 2-vers-4 (1 bit de contr\u00F4le)\", \"Demux 2-4\"],\n            Demux2to8: [\"D\u00E9multiplexer 2-vers-8 (2 bits de contr\u00F4le)\", \"Demux 2-8\"],\n            Demux4to8: [\"D\u00E9multiplexer 4-vers-8 (1 bit de contr\u00F4le)\", \"Demux 4-8\"],\n            Demux8to16: [\"D\u00E9multiplexer 8-vers-16 (1 bit de contr\u00F4le)\", \"Demux 8-16\"],\n\n            LatchSR: [\"Verrou SR\", \"Verrou SR\"],\n            FlipflopJK: [\"Bascule JK\", \"Basc. JK\"],\n            FlipflopT: [\"Bascule T\", \"Basc. T\"],\n            FlipflopD: [\"Bascule D\", \"Basc. D\"],\n            Register: [\"Registre\", \"Registre\"],\n            ShiftRegister: [\"Registre \u00E0 d\u00E9calage\", \"Reg. d\u00E9c.\"],\n            RAM: [\"RAM (m\u00E9moire vive)\", \"RAM\"],\n            ROM: [\"ROM (m\u00E9moire morte)\", \"ROM\"],\n\n            Counter: [\"Compteur 4 bits\", \"Compteur\"],\n            Decoder: [\"D\u00E9codeur binaire vers 1-sur-n\", \"D\u00E9codeur\"],\n            Decoder7Seg: [\"D\u00E9codeur 7 segments\", \"D\u00E9c. 7 seg.\"],\n            Decoder16Seg: [\"D\u00E9codeur ASCII vers 16 segments\", \"D\u00E9c. 16 seg.\"],\n            DecoderBCD4: [\"D\u00E9codeur 4 bits vers BCD sur 5 bits\", \"D\u00E9c. BCD\"],\n\n            Comparator: [\"Comparateur\", \"Compar.\"],\n        }),\n    },\n    Modes: {\n        FULL: tuple(\"Admin\", \"En plus du mode complet, ce mode permet de rendre les entr\u00E9es, les sorties des portes, voire les portes elles-m\u00EAmes ind\u00E9termin\u00E9es\"),\n        DESIGN: tuple(\"Complet\", \"La totalit\u00E9 des actions de conception d\u2019un circuit sont possible\"),\n        CONNECT: tuple(\"Connexion\", \"Il est possible de d\u00E9placer et de connecter des \u00E9l\u00E9ments d\u00E9j\u00E0 sur le canevas, mais pas d\u2019en rajouter (le menu de gauche ne serait pas actif)\"),\n        TRYOUT: tuple(\"Test\", \"Il est seulement possible de changer les entr\u00E9es pour tester un circuit pr\u00E9\u00E9tabli\"),\n        STATIC: tuple(\"Statique\", \"Les \u00E9l\u00E9ments sont juste affich\u00E9s; aucune interaction n\u2019est possible\"),\n    },\n    Orientations: {\n        e: \"Vers la droite (par d\u00E9faut)\",\n        s: \"Vers le bas\",\n        w: \"Vers la gauche\",\n        n: \"Vers le haut\",\n    },\n    Settings: {\n        Settings: \"R\u00E9glages\",\n        CircuitName: \"Nom:\",\n        DefaultFileName: \"circuit\",\n        NameOfDownloadedFile: \"Ceci sera le nom du fichier t\u00E9l\u00E9charg\u00E9.\",\n        animateWires: tuple(\"Animer les fils\", \"Si coch\u00E9, les fils sont anim\u00E9s pour montrer dans quel sens logique le signal se propage.\"),\n        hideWireColors: tuple(\"Cacher l\u2019\u00E9tat des fils\", \"Si coch\u00E9, les fils sont affich\u00E9s avec une couleur neutre plut\u00F4t que de montrer s\u2019ils v\u00E9hiculent un 1 ou un 0.\"),\n        hideInputColors: tuple(\"Cacher l\u2019\u00E9tat des entr\u00E9es\", \"Si coch\u00E9, les entr\u00E9es sont affich\u00E9es avec une couleur neutre, m\u00EAme si elles livrent au circuit une valeur bien d\u00E9termin\u00E9e. S\u2019utilise volontiers en cachant aussi l\u2019\u00E9tat des fils.\"),\n        hideOutputColors: tuple(\"Cacher l\u2019\u00E9tat des sorties\", \"Si coch\u00E9, les sorties sont affich\u00E9es avec une couleur neutre. S\u2019utilise volontiers en cachant aussi l\u2019\u00E9tat des fils.\"),\n        hideMemoryContent: tuple(\"Cacher le contenu stock\u00E9\", \"Si coch\u00E9, les verrous, bascules, registres et autres m\u00E9moires ne montrent pas leur contenu.\"),\n        showGateTypes: tuple(\"Montrer type des portes\", \"Si coch\u00E9, affiche sur les portes logique le nom de la fonction r\u00E9alis\u00E9e.\"),\n        showDisconnectedPins: tuple(\"Toujours montrer les pattes\", \"Si non coch\u00E9, les pattes non connect\u00E9es des composants sont masqu\u00E9es dans les modes o\u00F9 les connexions du circuit ne peuvent pas \u00EAtre modifi\u00E9es (et restent visibles sinon).\"),\n        hideTooltips: tuple(\"D\u00E9sactiver tooltips\", \"Si coch\u00E9, les informations suppl\u00E9mentaires des tooltips (comme les tables de v\u00E9rit\u00E9) ne seront pas affich\u00E9es.\"),\n        groupParallelWires: tuple(\"Grouper les fils parall\u00E8les\", \"Si coch\u00E9, les fils parral\u00E8les allant d'un composant \u00E0 un autre seront regroup\u00E9s en un seul fil plus \u00E9pais.\"),\n        showHiddenWires: tuple(\"Montrer les fils cach\u00E9s\", \"Si coch\u00E9, les fils cach\u00E9s seront quand m\u00EAme affich\u00E9s.\"),\n        showAnchors: tuple(\"Montrer les ancrages\", \"Si coch\u00E9, des fl\u00E8ches indiqueront les composants auxquels sont ancr\u00E9s les composants lors de leur d\u00E9placement.\"),\n        showIds: tuple(\"Montrer les identifiants\", \"Si coch\u00E9, les identifiants des composants seront affich\u00E9s.\"),\n        propagationDelay: \"Un 1 ou un 0 impos\u00E9 sur une connexion sera r\u00E9percut\u00E9 \u00E0 l\u2019autre bout de la connexion apr\u00E8s ce d\u00E9lai de propagation.\",\n        propagationDelayField: tuple(\"Propagation en\", \"ms\"),\n        zoomLevel: \"Le niveau de zoom sur les composants du circuit.\",\n        zoomLevelField: tuple(\"Zoom:\", \"%\"),\n        showUserDataLink: tuple(\"Voir les\", \"donn\u00E9es li\u00E9es\"),\n        userDataHeader: \"Les donn\u00E9es suivantes sont export\u00E9es avec le circuit:\",\n        wireStyle: \"Style des fils:\",\n    },\n    Tests: {\n        Title: \"Tests\",\n        DefaultTestCaseName: \"Test\",\n        DefaultTestSuiteName: \"Tests\",\n        SetInputs: \"Entr\u00E9es\",\n        WantedOutputs: \"Sorties\",\n        SetTheseInputs: \"R\u00E9gler ces entr\u00E9es\",\n        Run: \"Tester\",\n        RunTestSuite: \"Ex\u00E9cuter les tests\",\n        DeleteTestCase: \"Supprimer ce test\",\n        EditTestCaseName: \"Renommer ce test\",\n        TestSuiteShownClickToHide: \"Tests visibles (cliquez pour cacher)\",\n        TestSuiteHiddenClickToShow: \"Tests cach\u00E9s (cliquez pour montrer)\",\n        EnterNewTestCaseName: \"Entrez le nouveau nom du test:\",\n        ComponentUsedInTestSuite: template(\"Ce composant est utilis\u00E9 dans des tests. Voulez-vous vraiment le supprimer? Les tests seront conserv\u00E9s, mais ne fonctionneront pas tant qu\u2019un autre composant avec cette r\u00E9f\u00E9rence (\u201C${ref}\u201D) ne sera pas ajout\u00E9 au circuit.\"),\n    },\n    TopBar: {\n        DirtyTooltip: \"Le circuit a \u00E9t\u00E9 modifi\u00E9 depuis la derni\u00E8re sauvegarde.\",\n        CircuitNameTooltip: \"Nom du circuit actuellement \u00E9dit\u00E9; cliquez pour modifier\",\n        SetCircuitName: \"Tapez le nom du circuit (ou laissez vide pour le nom par d\u00E9faut):\",\n        CustomComponentCaptionTooltip: \"Nom du sous-circuit actuellement \u00E9dit\u00E9; cliquez pour modifier\",\n        CloseCircuit: \"Retour au circuit complet\",\n\n        Undo: tuple(\"Annuler\", \"Annule la derni\u00E8re action\"),\n        Redo: tuple(\"R\u00E9tablir\", \"R\u00E9tablit la derni\u00E8re action annul\u00E9e ou r\u00E9p\u00E8te l\u2019action pr\u00E9c\u00E9dente\"),\n\n        Download: tuple(\"T\u00E9l\u00E9charger\", \"T\u00E9l\u00E9charge le circuit (ou les composants personnalis\u00E9s avec la touche Option/Alt)\"),\n        Screenshot: tuple(\"Screenshot\", \"T\u00E9l\u00E9charge le circuit sous forme d\u2019image (PNG ou SVG avec touche Option/Alt)\"),\n        Open: tuple(\"Ouvrir\", \"Ouvre un circuit pr\u00E9c\u00E9demment t\u00E9l\u00E9charg\u00E9\"),\n        Restore: tuple(\"Restaurer\", \"Restaure le circuit pr\u00E9c\u00E9demment modifi\u00E9\"),\n        Reset: tuple(\"R\u00E9initialiser\", \"R\u00E9initialise l\u2019\u00E9tat de ce circuit\"),\n\n        TimelinePlay: tuple(\"Play\", \"D\u00E9marre l\u2019\u00E9coulement du temps\"),\n        TimelinePause: tuple(\"Pause\", \"Arr\u00EAte l\u2019\u00E9coulement du temps\"),\n        TimelineStep: tuple(\"Pas \u00E0 pas\", \"Avance au prochain \u00E9v\u00E9nement\"),\n        TimeLabel: \"Temps: \",\n\n        Design: tuple(\"Concevoir\", \"Compose ou modifie le circuit\"),\n        Delete: tuple(\"Supprimer\", \"Supprime des \u00E9l\u00E9ments du circuit\"),\n        Move: tuple(\"D\u00E9placer\", \"D\u00E9place tout le circuit\"),\n\n        Tests: tuple(\"Tests\", \"Montre les tests pour ce circuit\"),\n    },\n    Messages: {\n        UnsupportedFileType: template(\"Type de fichier non pris en charge: ${type}.\"),\n        LoadedDefinitions: template(\"${n} composant$s{n} personnalis\u00E9$s{n} charg\u00E9$s{n}\"),\n        SavedToUrl: \"Circuit enregistr\u00E9 dans l\u2019URL\",\n        SetAnchorPrompt: \"Cliquez sur le composant auquel s\u2019ancrer\",\n        AnchorAdded: \"Ancrage ajout\u00E9\",\n        CircularAnchorsForbidden: \"Les ancrages circulaires ne sont pas pris en charge.\",\n        NotImplemented: \"Cette fonctionnalit\u00E9 n\u2019est pas encore impl\u00E9ment\u00E9e.\",\n        NoPermission: \"Cette action n\u2019est pas autoris\u00E9e dans ce mode.\",\n        ReallyCloseWindow: \"Voulez-vous vraiment fermer la fen\u00EAtre sans prendre en compte les derniers changements?\",\n        LoadedCircuitFromSessionStorage: template(\"Circuit restaur\u00E9 depuis sauvegarde automatique du ${day} \u00E0 ${time}\"),\n        FailedToLoadCircuitFromStorage: template(\"Impossible de restaurer le circuit (${error}).\"),\n        NoSavedData: \"Rien \u00E0 restaurer pour cet \u00E9diteur.\",\n        DevelopedBy: \"D\u00E9velopp\u00E9 par \",\n\n        DidUndo: \"Annuler\",\n        DidRedo: \"R\u00E9tablir\",\n        DidRepeat: \"R\u00E9p\u00E9ter\",\n        NothingToUndo: \"Rien \u00E0 annuler\",\n        NothingToRedo: \"Rien \u00E0 r\u00E9tablir ou r\u00E9p\u00E9ter\",\n\n        NewTestCaseTitle: \"Cr\u00E9ation d\u2019un nouveau test de circuit\",\n        NewTestCaseSetName: \"Entrez le nom du test:\",\n        TestCaseInputToSet: template(\"Entr\u00E9e$s{n} \u00E0 r\u00E9gler:\"),\n        TestCaseOuputToCheck: template(\"Sorties$s{n} attendue$s{n}:\"),\n        TooManyInputsForAutoTestCases: template(\"Impossible de cr\u00E9er automatiquement des tests pour plus de ${max} entr\u00E9es.\"),\n        AutoTestCasesWarning: template(\"Ceci va cr\u00E9er ${numCases} tests, un pour chacune des combinaisons des ${numInputs} entr\u00E9es. Voulez-vous continuer?\"),\n        ComputingTestCases: \"G\u00E9n\u00E9ration des tests\u2026\",\n        RunningTests: \"Exc\u00E9cution des tests\u2026\",\n\n    },\n    Components: {\n        Generic: {\n            contextMenu: {\n                Delete: \"Supprimer\",\n                Reset: \"R\u00E9activer\",\n\n                MakeNewComponent: \"Cr\u00E9er un nouveau composant\u2026\",\n                MakeNewComponentFailed: \"Impossible de cr\u00E9er un nouveau composant.\",\n\n                MakeNewTestCase: \"Cr\u00E9er un nouveau test\u2026\",\n                MakeAllTestCases: \"Cr\u00E9er tous les tests\u2026\",\n                MakeNewTestCaseFailed: \"Impossible de cr\u00E9er un nouveau test.\",\n\n                SetIdentifier: \"Attribuer un identifiant\u2026\",\n                ChangeIdentifier: tuple(\"Changer l\u2019identifiant (\", \")\u2026\"),\n                SetIdentifierPrompt: \"Choisissez l\u2019identifiant unique \u00E0 attribuer \u00E0 ce composant:\",\n                IdentifierCannotBeEmpty: \"L\u2019identifiant ne peut pas \u00EAtre vide.\",\n                IdentifierAlreadyInUseShouldSwap: \"L\u2019identifiant est d\u00E9j\u00E0 utilis\u00E9 par un autre composant. Voulez-vous inverser les identifiants?\",\n\n                SetAnchor: \"D\u00E9finir l\u2019ancrage\u2026\",\n                ClearAnchor: tuple(\"Supprimer l\u2019ancrage (\", \")\"),\n\n                Orientation: \"Orientation\",\n                ChangeOrientationDesc: \"Changez l\u2019orientation avec Commande + double-clic sur le composant\",\n                LockPosition: \"Verrouiller la position\",\n                ShowAsUnknown: \"Afficher comme inconnu\",\n\n                ForceOutputSingle: \"Forcer la sortie\",\n                ForceOutputMultiple: \"Forcer une sortie\",\n                Output: \"Sortie\",\n                NormalOutput: \"Sortie normale\",\n                ForceAsUnknown: \"Forcer comme \u00E9tat inconnu\",\n                ForceAs1: \"Forcer \u00E0 1\",\n                ForceAs0: \"Forcer \u00E0 0\",\n                ForceAsZ: \"Forcer \u00E0 haute imp\u00E9dance\",\n                ForceOutputDesc: \"Forcez une sortie avec Option + double-clic sur la sortie\",\n\n                SetName: \"Ajouter un nom\u2026\",\n                ChangeName: \"Changer le nom\u2026\",\n                SetNamePrompt: \"Choisissez le nom \u00E0 afficher ou laissez vide pour le supprimer:\",\n\n                SetFontPrompt: tuple(\"Entrez une sp\u00E9cification de police ou laissez vide pour la valeur par d\u00E9faut (\", \"):\"),\n\n                TriggerOn: \"Stocker au\",\n                TriggerRisingEdge: \"flanc montant\",\n                TriggerFallingEdge: \"flanc descendant\",\n\n                ShowContent: \"Montrer le contenu\",\n\n                ParamControlBitAtBottom: \"Bit de contr\u00F4le en bas\",\n                ParamControlBitsAtBottom: \"Bits de contr\u00F4le en bas\",\n\n                ParamNumInputs: tuple(\"Nombre d\u2019entr\u00E9es\", template(\"${val} entr\u00E9e$s{val}\")),\n                ParamNumBits: tuple(\"Nombre de bits\", template(\"${val} bit$s{val}\")),\n                ParamNumWords: tuple(\"Nombre de lignes\", template(\"${val} ligne$s{val}\")),\n            },\n\n            InputCarryInDesc: \"Cin (retenue pr\u00E9c\u00E9dente)\",\n            InputClockDesc: \"Clock (horloge)\",\n            InputClearDesc: \"C (Clear, mise \u00E0 0)\",\n            InputPresetDesc: \"P (Preset, mise \u00E0 1)\",\n            InputSetDesc: \"S (Set, mise \u00E0 1)\",\n            InputResetDesc: \"R (Reset, mise \u00E0 0)\",\n            InputDataDesc: \"D (Donn\u00E9es)\",\n            InputWriteEnableDesc: \"WE (\u00E9criture activ\u00E9e)\",\n\n            OutputSumDesc: \"S (somme)\",\n            OutputCarryDesc: \"C (retenue)\",\n            OutputCarryOutDesc: \"Cout (retenue)\",\n            OutputQDesc: \"Q (sortie normale)\",\n            OutputQBarDesc: \"Q\u0305 (sortie invers\u00E9e)\",\n        },\n        Custom: {\n            MenuButtonSuffix: \" (composant personnalis\u00E9)\",\n            contextMenu: {\n                ChangeName: \"Renommer\u2026\",\n                ChangeNamePrompt: \"Choisissez le nom de ce composant personnalit\u00E9:\",\n                ChangeNameEmpty: \"Le nom ne peut pas \u00EAtre vide.\",\n                ChangeCircuit: \"Modifier le circuit\",\n                Delete: \"Supprimer ce composant\",\n                EditFromComponentMessage: \"Vous pouvez modifier ce composant depuis le menu d\u2019un composant du circuit.\",\n                CannotDeleteInUse: \"Impossible de supprimer ce composant car il est utilis\u00E9 dans le circuit.\",\n                CannotDeleteInUseBy: template(\"Impossible de supprimer ce composant car il est utilis\u00E9 dans la d\u00E9finition d\u2019un autre composant (${caption}).\"),\n                ConfirmDelete: \"Voulez-vous vraiment supprimer ce composant personnalis\u00E9?\",\n            },\n            tooltip: {\n                titleSuffix: \" (composant personnalis\u00E9)\",\n                desc: \"Ce composant calcule ses sorties selon le circuit personnalis\u00E9 que vous avez d\u00E9fini.\",\n            },\n            messages: {\n                EmptySelection: \"Aucun composant n\u2019est s\u00E9lectionn\u00E9.\",\n                NoInput: \"Aucune entr\u00E9e n\u2019est s\u00E9lectionn\u00E9e.\",\n                NoOutput: \"Aucune sortie n\u2019est s\u00E9lectionn\u00E9e.\",\n                InputsOutputsMustHaveNames: \"Toutes les entr\u00E9es et sorties doivent avoir un nom.\",\n                MissingComponents: template(\"Les composants suivants sont connect\u00E9s \u00E0 des sorties mais ne sont pas s\u00E9lectionn\u00E9s: ${list}.\"),\n                NoWires: \"Aucun fil n\u2019est pr\u00E9sent entre les composants s\u00E9lectionn\u00E9s.\",\n                UselessComponents: template(\"Les composants suivants ne sont pas connect\u00E9s \u00E0 des sorties et sont inutiles: ${list}.\"),\n                CannotIncludeClock: \"Les horloges ne peuvent pas \u00EAtre incluses dans les composants personnalis\u00E9s. Ajoutez une entr\u00E9e normale, qui pourra \u00EAtre connect\u00E9e \u00E0 une horloge de l'ext\u00E9rieur du composant.\",\n                CannotBeModified: \"Ce composant ne peut pas \u00EAtre modifi\u00E9 dans ce mode.\",\n                EnterCaptionPrompt: \"Entrez le nom (unique) du composant personnalis\u00E9:\",\n                ComponentAlreadyExists: template(\"Un composant personnalis\u00E9 avec l\u2019identifiant '${id}' existe d\u00E9j\u00E0.\"),\n                InputsOutputsChanged: \"Les entr\u00E9es et sorties ont chang\u00E9 et certaines connexions pourront \u00EAtre supprim\u00E9es en adaptant le circuit. Voulez-vous continuer?\",\n                NotInMainEditor: \"Revenez d\u2019abord \u00E0 l\u2019\u00E9diteur principal pour modifier le circuit personnalis\u00E9 de ce composant.\",\n            },\n        },\n        Adder: {\n            tooltip: {\n                title: \"Additionneur\",\n                desc: \"Additionne deux bits A et B et une retenue d\u2019entr\u00E9e Cin, et fournit un bit de somme S et une retenue de sortie Cout.\",\n            },\n        },\n        AdderArray: {\n            tooltip: {\n                title: template(\"Additionneur \u00E0 ${numBits} bit$s{numBits}\"),\n                desc: \"Additionne les deux nombres d'entr\u00E9es A et B avec une retenue d\u2019entr\u00E9e Cin, et fournit les bits de somme S et une retenue de sortie Cout.\",\n            },\n        },\n        ALU: {\n            \"A+B\": tuple(\"+\", \"Addition\"),\n            \"A-B\": tuple(\"A\u2013B\", \"Soustraction (A \u2013 B)\"),\n            \"B-A\": tuple(\"B\u2013A\", \"Soustraction (B \u2013 A)\"),\n            \"A+1\": tuple(\"A+1\", \"A + 1\"),\n            \"A-1\": tuple(\"A\u20131\", \"A \u2013 1\"),\n            \"-A\": tuple(\"\u2013A\", \"N\u00E9gation d\u2019A\"),\n            \"A*2\": tuple(\"A\u00D72\", \"Addition d\u2019A \u00E0 lui-m\u00EAme (A \u00D7 2)\"),\n            \"A/2\": tuple(\"A/2\", \"D\u00E9calage arithm\u00E9tique \u00E0 droite de 1 (A / 2)\"),\n            \"A|B\": tuple(\"OU\", \"Disjonction (A OU B)\"),\n            \"A&B\": tuple(\"ET\", \"Conjonction (A ET B)\"),\n            \"A|~B\": tuple(\"OU-n\", \"A OU NON(B)\"),\n            \"A&~B\": tuple(\"ET-n\", \"A ET NON(B)\"),\n            \"~A\": tuple(\"A\u0305\", \"Inversion d\u2019A\"),\n            \"A^B\": tuple(\"OU-X\", \"Disjonction excl. (A OU-X B)\"),\n            \"A<<\": tuple(\"<<\", \"D\u00E9calage logique \u00E0 gauche de 1 de A\"),\n            \"A>>\": tuple(\">>\", \"D\u00E9calage logique \u00E0 droite de 1 de A\"),\n\n            InputCinDesc: \"retenue d\u2019entr\u00E9e\",\n            OutputCoutDesc: \"retenue de sortie\",\n            tooltip: {\n                title: \"Unit\u00E9 arithm\u00E9tique et logique (ALU)\",\n                CurrentlyCarriesOut: \"Effectue actuellement\",\n                SomeUnknownOperation: \"une op\u00E9ration inconnue\",\n                ThisOperation: \"l\u2019op\u00E9ration\",\n            },\n            contextMenu: {\n                toggleShowOp: \"Afficher l\u2019op\u00E9ration\",\n                ParamUseExtendedOpcode: \"Utiliser op\u00E9rations \u00E9tendues\",\n            },\n        },\n        Clock: {\n            tooltip: {\n                title: \"Horloge\",\n                period: tuple(\"P\u00E9riode: \", \" ms\"),\n                dutycycle: tuple(\"Rapport cyclique: \", \"%\"),\n                phase: tuple(\"D\u00E9phasage: \", \" ms\"),\n            },\n            contextMenu: {\n                Period: \"P\u00E9riode\",\n                CustomPeriod: \"Autre\",\n                SetPeriodMillis: \"Entrez la p\u00E9riode de l\u2019horloge en millisecondes:\",\n                InvalidPeriod: \"La p\u00E9riode doit \u00EAtre un nombre entier positif.\",\n                ReplaceWithInput: \"Remplacer par entr\u00E9e\",\n            },\n            timeline: {\n                NextRisingEdge: \"Prochain flanc montant de l\u2019horloge\",\n                NextFallingEdge: \"Prochain flanc descendant de l\u2019horloge\",\n            },\n        },\n        Comparator: {\n            tooltip: {\n                title: \"Comparateur\",\n                desc: \"Comparateur entre deux bits A et B, activ\u00E9 par une entr\u00E9e E.\",\n            },\n        },\n        Counter: {\n            tooltip: {\n                title: \"Compteur\",\n                desc: \"Compteur \u00E0 quatre bits.\",\n            },\n            contextMenu: {\n                DisplayTempl: template(\"Affichage ${desc}\"),\n                DisplayNone: \"absent\",\n                DisplayDecimal: \"d\u00E9cimal\",\n                DisplayHex: \"hexad\u00E9cimal\",\n            },\n        },\n        Decoder: {\n            tooltip: {\n                title: \"D\u00E9codeur binaire\",\n                desc: template(\"Ce d\u00E9codeur prend en entr\u00E9e un nombre binaire cod\u00E9 sur ${numFrom} bit$s{numFrom} et active la sortie correspondante parmi ${numTo} (actuellement, ${n}).\"),\n            },\n        },\n        Decoder7Seg: {\n            tooltip: \"D\u00E9codeur 7 segments\",\n        },\n        Decoder16Seg: {\n            tooltip: \"D\u00E9codeur ASCII vers 16 segments\",\n        },\n        DecoderBCD4: {\n            tooltip: \"D\u00E9codeur 4 bits vers BCD (binary-coded decimal)\",\n        },\n        Demux: {\n            tooltip: template(\"D\u00E9multiplexeur ${from} vers ${to}\"),\n        },\n        FlipflopD: {\n            tooltip: {\n                title: \"Bascule D\",\n                desc: \"Stocke un bit.\",\n            },\n        },\n        FlipflopJK: {\n            InputJDesc: \"J (Jump, mise \u00E0 1)\",\n            InputKDesc: \"K (Kill, mise \u00E0 0)\",\n            tooltip: {\n                title: \"Bascule JK\",\n                desc: \"Stocke un bit.\",\n            },\n        },\n        FlipflopT: {\n            InputTDesc: \"T (Toggle, bascule)\",\n            tooltip: {\n                title: \"Bascule T\",\n                desc: \"Stocke un bit.\",\n            },\n        },\n        Gate: {\n            not: tuple(\"NON\", \"NON\", \"La sortie est \u00E9gale \u00E0 l\u2019entr\u00E9e invers\u00E9e.\"),\n            buf: tuple(\"OUI\", \"OUI\", \"La sortie est \u00E9gale \u00E0 l\u2019entr\u00E9e.\"),\n\n            and: tuple(\"ET\", \"ET\", \"La sortie vaut 1 lorsque toutes les entr\u00E9es valent 1.\"),\n            or: tuple(\"OU\", \"OU\", \"La sortie vaut 1 lorsqu\u2019au moins une des entr\u00E9es vaut 1.\"),\n            xor: tuple(\"OU-X\", \"OU-X\", \"La sortie vaut 1 lorsqu\u2019un nombre impair d\u2019entr\u00E9es valent 1.\"),\n            nand: tuple(\"NON-ET\", \"N-ET\", \"Porte ET invers\u00E9e: la sortie vaut 1 \u00E0 moins que toutes les entr\u00E9es ne valent 1.\"),\n            nor: tuple(\"NON-OU\", \"N-OU\", \"Porte OU invers\u00E9e: la sortie vaut 1 lorsque toutes les entr\u00E9es valent 0.\"),\n            xnor: tuple(\"NON-OU-X\", \"N-OU-X\", \"Porte OU-X invers\u00E9e: la sortie vaut 1 lorsqu\u2019un nombre pair d\u2019entr\u00E9es valent 1.\"),\n\n            imply: tuple(\"IMPLIQUE\", \"IMPL\", \"La sortie vaut 1 si la premi\u00E8re entr\u00E9e vaut 0 ou si les deux entr\u00E9es valent 1.\"),\n            rimply: tuple(\"IMPLIQUE (bis)\", \"IMPL\", \"La sortie vaut 1 si la seconde entr\u00E9e vaut 0 ou si les deux entr\u00E9es valent 1.\"),\n            nimply: tuple(\"NON-IMPLIQUE\", \"N-IMPL\", \"Porte IMPLIQUE invers\u00E9e: la sortie ne vaut 1 que lorsque la premi\u00E8re entr\u00E9e vaut 1 et la seconde 0.\"),\n            rnimply: tuple(\"NON-IMPLIQUE (bis)\", \"N-IMPL\", \"Porte IMPLIQUE invers\u00E9e: la sortie ne vaut 1 que lorsque la premi\u00E8re entr\u00E9e vaut 0 et la seconde 1.\"),\n\n            txa: tuple(\"TRANSFERT-A\", undefined, \"La sortie est \u00E9gale \u00E0 la premi\u00E8re entr\u00E9e; la seconde entr\u00E9e est ignor\u00E9e.\"),\n            txb: tuple(\"TRANSFERT-B\", undefined, \"La sortie est \u00E9gale \u00E0 la seconde entr\u00E9e; la premi\u00E8re entr\u00E9e est ignor\u00E9e.\"),\n            txna: tuple(\"TRANSFERT-NON-A\", undefined, \"La sortie est \u00E9gale \u00E0 la premi\u00E8re entr\u00E9e invers\u00E9e; la seconde entr\u00E9e est ignor\u00E9e.\"),\n            txnb: tuple(\"TRANSFERT-NON-B\", undefined, \"La sortie est \u00E9gale \u00E0 la seconde entr\u00E9e invers\u00E9e; la premi\u00E8re entr\u00E9e est ignor\u00E9e.\"),\n\n\n            tooltip: {\n                GateTitle: (gateType: Modifier) => mods(\"Porte \", gateType),\n                UnknownGate: \"Porte inconnue\",\n                Input: \"Entr\u00E9e\",\n                Output: \"Sortie\",\n                CurrentlyDelivers: \"Actuellement, il livre\",\n                ShouldCurrentlyDeliver: \"Actuellement, il devrait livrer\",\n                UndeterminedOutputBecauseInputUnknown: \"une sortie ind\u00E9termin\u00E9e comme son entr\u00E9e n\u2019est pas connue. Sa table de v\u00E9rit\u00E9 est:\",\n                UndeterminedOutputBecauseInputsUnknown: \"une sortie ind\u00E9termin\u00E9e comme toutes ses entr\u00E9es ne sont connues. Sa table de v\u00E9rit\u00E9 est:\",\n                ThisOutput: \"une sortie de\",\n                BecauseInputIs: \"car son entr\u00E9e est\",\n                AccordingToTruthTable: \"selon la table de v\u00E9rit\u00E9 suivante:\",\n                Inverter: tuple(\"Inverseur (porte \", \")\"),\n                Buffer: tuple(\"Buffer (porte \", \")\"),\n            },\n\n            contextMenu: {\n                ReplaceBy: \"Remplacer par\",\n                GateTempl: template(\"Porte ${type}\"),\n                ShowAs: \"Afficher comme\",\n                NormalGateTempl: template(\"Porte ${type} normale\"),\n                UnknownGate: \"Porte inconnue (avec \u00AB?\u00BB)\",\n                VariantChangeDesc: \"Changez entre les variantes avec Majuscule + double-clic sur la porte\",\n            },\n        },\n        HalfAdder: {\n            tooltip: {\n                title: \"Demi-additionneur\",\n                desc: \"Additionne deux bits A et B et fournit un bit de somme S et une retenue de sortie C.\",\n            },\n        },\n        Input: {\n            tooltip: {\n                title: template(\"Entr\u00E9e (${numBits} bit$s{numBits})\"),\n            },\n            contextMenu: {\n                LockValue: \"Verrouiller cette valeur\",\n                PushButton: \"Poussoir\",\n                ToggleButton: \"Commutateur\",\n                ReplaceWithClock: \"Remplacer par horloge\",\n                InputSetFromOutside: \"Entr\u00E9e contr\u00F4l\u00E9e depuis l\u2019ext\u00E9rieur\",\n            },\n        },\n        Random: {\n            tooltip: {\n                title: \"Valeur al\u00E9atoire\",\n                desc: tuple(\"\u00C0 chaque coup d\u2019horloge, la valeur de sortie sera 1 avec une probabilit\u00E9 de \", \".\"),\n            },\n            contextMenu: {\n                ShowProb: \"Montrer la probabilit\u00E9\",\n            },\n        },\n        Rectangle: {\n            contextMenu: {\n                Size: \"Taille\",\n                SizePrompt: \"Entrez la taille de ce rectangle:\",\n                Rounded: \"Arrondi\",\n                WithBackgroundColor: \"Avec couleur de fond\",\n                SetTitle: \"Ajouter un titre\u2026\",\n                ChangeTitle: \"Changer le titre\u2026\",\n                SetTitlePrompt: \"Entrez le titre \u00E0 afficher ou laissez vide pour le supprimer:\",\n                InsideFrame: \"\u00C0 l\u2019int\u00E9rieur du cadre\",\n                Font: \"Police\u2026\",\n\n                Color: \"Couleur\",\n                ColorYellow: \"Jaune\",\n                ColorRed: \"Rouge\",\n                ColorGreen: \"Vert\",\n                ColorBlue: \"Bleu\",\n                ColorTurquoise: \"Turquoise\",\n                ColorGrey: \"Gris\",\n\n                Border: \"Bordure\",\n                BorderNone: \"Aucune bordure\",\n                Border1px: \"Fine (1 pixel)\",\n                Border2px: \"Moyenne (2 pixels)\",\n                Border3px: \"\u00C9paisse (3 pixels)\",\n                Border5px: \"Tr\u00E8s \u00E9paisse (5 pixels)\",\n                Border10px: \"\u00C9norme (10 pixels)\",\n\n                TitlePlacement: \"Position du titre\",\n                PlacementTop: \"En haut\",\n                PlacementTopLeft: \"En haut \u00E0 gauche\",\n                PlacementTopRight: \"En haut \u00E0 droite\",\n                PlacementBottom: \"En bas\",\n                PlacementBottomLeft: \"En bas \u00E0 gauche\",\n                PlacementBottomRight: \"En bas \u00E0 droite\",\n                PlacementLeft: \"\u00C0 gauche\",\n                PlacementRight: \"\u00C0 droite\",\n                PlacementCenter: \"Au centre\",\n            },\n        },\n        Label: {\n            contextMenu: {\n                ChangeText: \"Changer le texte\u2026\",\n                ChangeTextPrompt: \"Choisissez le texte \u00E0 afficher:\",\n                Font: \"Police\u2026\",\n            },\n        },\n        LatchSR: {\n            tooltip: {\n                title: \"Verrou SR\",\n                desc: \"Stocke un bit.\",\n            },\n        },\n        Mux: {\n            tooltip: template(\"Multiplexeur ${from} vers ${to}\"),\n        },\n        MuxDemux: {\n            contextMenu: {\n                ShowWiring: \"Afficher les connexions\",\n                UseZForDisconnected: \"Utiliser Z pour sorties d\u00E9connect\u00E9es\",\n\n                ParamNumFrom: tuple(\"Nombre d\u2019entr\u00E9es\", template(\"${val} entr\u00E9e$s{val}\")),\n                ParamNumTo: tuple(\"Nombre de sorties\", template(\"${val} sortie$s{val}\")),\n            },\n        },\n        Output: {\n            tooltip: {\n                title: template(\"Sortie (${numBits} bit$s{numBits})\"),\n            },\n        },\n        Display7Seg: {\n            tooltip: \"Afficheur 7 segments\",\n        },\n        Display16Seg: {\n            tooltip: \"Afficheur 16 segments\",\n        },\n        DisplayAscii: {\n            tooltip: {\n                title: \"Afficheur de caract\u00E8re ASCII\",\n                desc: tuple(\"Affiche le caract\u00E8re ASCII repr\u00E9sent\u00E9 par ses 7 entr\u00E9es, actuellement \", \".\"),\n                CurrentlyUndefined: \"Comme toutes ses entr\u00E9es ne sont pas connues, ce caract\u00E8re est actuellement ind\u00E9fini.\",\n                CurrentlyThisCharacter: \"Actuellement, c\u2019est le caract\u00E8re num\u00E9ro\",\n                WhichIsNotPrintable: \" (un caract\u00E8re non imprimable).\",\n            },\n            contextMenu: {\n                AdditionalDisplay: \"Affichage suppl\u00E9mentaire\",\n                DisplayNone: \"Aucun\",\n                DisplayDecimal: \"Valeur d\u00E9cimale\",\n                DisplayHex: \"Valeur hexad\u00E9cimale\",\n                ChangeDisplayDesc: \"Changez l\u2019affichage suppl\u00E9mentaire avec un double-clic sur le composant\",\n            },\n        },\n        DisplayBar: {\n            tooltip: {\n                title: \"Afficheur lumineux\",\n                ValueUnknown: \"Son \u00E9tat est ind\u00E9termin\u00E9 car son entr\u00E9e n\u2019est pas connue.\",\n                ValueZ: \"Son \u00E9tat est ind\u00E9termin\u00E9 car son entr\u00E9e est flottante (haute imp\u00E9dance).\",\n                Value1: tuple(\"Il est actuellement allum\u00E9 car son entr\u00E9e est de \", \".\"),\n                Value0: tuple(\"Il est actuellement \u00E9teint car son entr\u00E9e est de \", \".\"),\n            },\n            contextMenu: {\n                TransparentWhenOff: \"Transparent si \u00E9teint\",\n\n                Display: \"Affichage\",\n                DisplayVerticalBar: \"Barre verticale\",\n                DisplayHorizontalBar: \"Barre horizontale\",\n                DisplaySmallSquare: \"Petit carr\u00E9\",\n                DisplayLargeSquare: \"Grand carr\u00E9\",\n                DisplayChangeDesc: \"Changez l\u2019affichage avec un double-clic sur le composant\",\n\n                Color: \"Couleur\",\n                ColorGreen: \"Vert\",\n                ColorRed: \"Rouge\",\n                ColorYellow: \"Jaune\",\n            },\n        },\n        Display: {\n            tooltip: {\n                title: template(\"Afficheur ${numBits} bit$s{numBits}\"),\n                desc: tuple(template(\"Affiche la valeur ${radixStr} de ses ${numBits} entr\u00E9e$s{numBits}, actuellement \"), \".\"),\n\n                RadixBinary: \"binaire\",\n                RadixDecimal: \"d\u00E9cimale\",\n                RadixSignedDecimal: \"d\u00E9cimale sign\u00E9e\",\n                RadixHexadecimal: \"hexad\u00E9cimale\",\n                RadixGeneric: template(\"en base ${radix}\"),\n                CurrentlyUndefined: \"Comme toutes ses entr\u00E9es ne sont pas connues, cette valeur est actuellement ind\u00E9finie.\",\n            },\n            contextMenu: {\n                DisplayAs: \"Afficher\",\n                DisplayNone: \"Aucun\",\n                DisplayAsBinary: \"en binaire (base 2)\",\n                DisplayAsDecimal: \"en d\u00E9cimal (base 10)\",\n                DisplayAsSignedDecimal: \"en d\u00E9cimal sign\u00E9\",\n                DisplayAsOctal: \"en octal (base 8)\",\n                DisplayAsHexadecimal: \"en hexad\u00E9cimal (base 16)\",\n                DisplayAsUnknown: \"comme inconnu\",\n            },\n        },\n        ShiftDisplay: {\n            tooltip: \"Affichage \u00E0 d\u00E9calage\",\n            contextMenu: {\n                Decoding: \"D\u00E9codage\",\n                DecodingNone: \"Aucun\",\n                DecodingOctal: \"Octal\",\n                DecodingHex: \"Hexad\u00E9cimal\",\n                DecodingAscii7: \"ASCII (7 bits)\",\n                DecodingAscii8: \"ASCII (8 bits)\",\n                DecodingUint4: \"Entier sur 4 bits\",\n                DecodingInt4: \"Entier sign\u00E9 sur 4 bits\",\n                DecodingUint8: \"Entier sur 8 bits\",\n                DecodingInt8: \"Entier sign\u00E9 sur 8 bits\",\n                DecodingUint16: \"Entier sur 16 bits\",\n                DecodingInt16: \"Entier sign\u00E9 sur 16 bits\",\n                DecodingChangeWarning: \"Attention, changer le d\u00E9codage peut tronquer la valeur stock\u00E9e\",\n\n                Grouping: \"Regrouper les donn\u00E9es\",\n                GroupingNone: \"Pas de regroupement\",\n                GroupBy: template(\"Par ${n}\"),\n            },\n            EmptyCaption: \"(vide)\",\n        },\n        Passthrough: {\n            tooltip: \"Broche. Sert uniquement \u00E0 arranger les connexions.\",\n            contextMenu: {\n                Slant: \"Inclinaison\",\n                SlantNone: \"Aucune\",\n                SlantRight: \"De 45\u00B0 vers la droite\",\n                SlantLeft: \"De 45\u00B0 vers la gauche\",\n            },\n        },\n        Pixel: {\n            tooltip: \"Pixel. Affiche une couleur r\u00E9glable selon les entr\u00E9es.\",\n            contextMenu: {\n                Full: \"Remplir le carr\u00E9 entier\",\n                ParamNumBits: tuple(\"Nombre de bits par composant\", template(\"${val} bit$s{val}\")),\n                ParamGrayscale: \"Niveaux de gris\",\n                ParamTouch: \"Avec sortie tactile\",\n            },\n        },\n        GateArray: {\n            tooltip: {\n                title: \"Porte multiple\",\n                desc: template(\"Effectue plusieurs fois en parall\u00E8le l\u2019op\u00E9ration logique choisie; actuellement, ${op}.\"),\n            },\n            contextMenu: {\n                Type: \"Type\",\n                ShowAsUnknown: \"Masquer le type\",\n            },\n        },\n        TristateBufferArray: {\n            tooltip: {\n                title: \"Sortie \u00E0 3 \u00E9tats multiple\",\n                desc: \"Repr\u00E9sente plusieurs sorties \u00E0 trois \u00E9tats, contr\u00F4l\u00E9es par un seul bit de contr\u00F4le.\",\n            },\n        },\n        RAM: {\n            tooltip: {\n                title: \"RAM (m\u00E9moire vive)\",\n                desc: template(\"Stocke ${numWords} ligne$s{numWords} de ${numDataBits} bit$s{numDataBits}.\"),\n            },\n            contextMenu: {\n                SelectedDataDisplay: \"Affichage des donn\u00E9es address\u00E9es\",\n                EditContent: \"\u00C9diter le contenu\u2026\",\n                EditContentPrompt: \"Tapez le nouveau contenu de la m\u00E9moire en s\u00E9parant les lignes par des espaces. S\u2019il y a autant de caract\u00E8res que de bits, les donn\u00E9es sont lues comme \u00E9tant du binaire, sinon, comme de l'hexad\u00E9cimal.\",\n                SaveContent: \"Sauvegarder le contenu\",\n                LoadContent: \"Charger le contenu\u2026\",\n                SwapROMRAM: \"\u00C9changer ROM et RAM\",\n            },\n        },\n        ROM: {\n            tooltip: {\n                title: \"ROM (m\u00E9moire morte)\",\n                desc: template(\"Stocke ${numWords} ligne$s{numWords} de ${numDataBits} bits${numDataBits}.\"),\n            },\n        },\n        Register: {\n            tooltip: {\n                title: \"Registre\",\n                desc: template(\"Stocke ${numBits} bit$s{numBits}.\"),\n            },\n            contextMenu: {\n                ParamHasIncDec: \"Avec incr\u00E9mentaiton\",\n                Saturating: \"Avec saturation\",\n            },\n        },\n        ShiftRegister: {\n            tooltip: {\n                title: \"Registre \u00E0 d\u00E9calage\",\n                desc: template(\"Stocke ${numBits} bit$s{numBits} et les d\u00E9cale \u00E0 chaque activation.\"),\n            },\n        },\n        ControlledInverter: {\n            tooltip: {\n                title: \"Inverseur commut\u00E9\",\n                desc: \"Inverse ses entr\u00E9es si le bit de contr\u00F4le S vaut 1; sinon, les sorties sont \u00E9gales aux entr\u00E9es.\",\n            },\n        },\n        TristateBuffer: {\n            tooltip: \"Sortie \u00E0 3 \u00E9tats\",\n        },\n        Wire: {\n            contextMenu: {\n                AddMiddlePoint: \"Ajouter un point interm\u00E9diaire\",\n                AddPassthrough: \"Ajouter une broche\",\n\n                CustomPropagationDelay: template(\"D\u00E9lai de propagation sp\u00E9cifique${current}\u2026\"),\n                CustomPropagationDelayDesc: template(\"D\u00E9lai de propagation personnalis\u00E9 en millisecondes pour cette connexion (laisser vide pour utiliser la valeur par d\u00E9faut du circuit, actuellement de ${current} ms):\"),\n\n                WireColor: \"Couleur du fil\",\n                WireColorBlack: \"Noir (par d\u00E9faut)\",\n                WireColorRed: \"Rouge\",\n                WireColorBlue: \"Bleu\",\n                WireColorYellow: \"Jaune\",\n                WireColorGreen: \"Vert\",\n                WireColorWhite: \"Blanc\",\n\n                WireStyle: \"Style\",\n                WireStyleDefault: \"Par d\u00E9faut\",\n                WireStyleAuto: \"Auto\",\n                WireStyleStraight: \"Ligne\",\n                WireStyleSquareHV: \"H puis V\",\n                WireStyleSquareVH: \"V puis H\",\n                WireStyleCurved: \"Courbe\",\n\n                HiddenWire: \"Masquer le fil\",\n            },\n            timeline: {\n                PropagatingValue: template(\"Propagation de la valeur ${val} sur le fil\"),\n            },\n        },\n    },\n    Dialogs: {\n        Generic: {\n            Close: \"Fermer\",\n        },\n        Share: {\n            title: \"Partager ce circuit\",\n            URL: \"URL:\",\n            EmbedInIframe: \"Inclusion via <iframe>:\",\n            EmbedWithWebComp: \"Inclusion via un web component:\",\n            EmbedInMarkdown: \"Inclusion en Markdown/Myst:\",\n        },\n    },\n}\n\nconst Strings_en: Strings = {\n    plural: (n: number, plural?: string, singular?: string) => Math.abs(n) === 1 ? (singular ?? \"\") : (plural ?? \"s\"),\n    ComponentBar: {\n        SectionNames: {\n            InputOutput: \"Input/ Output\",\n            Gates: \"Gates\",\n            Layout: \"Layout\",\n            Components: \"Compo- nents\",\n            Custom: \"Custom\",\n        },\n        Labels: {\n            More: \"More\",\n            Less: \"Less\",\n        },\n        Components: RichStringEnum.withProps<ComponentStrings>()({\n            Input1: [\"Input\", \"IN\"],\n            InputN: [\"Multiple Inputs\", \"IN Mult.\"],\n            Input8: [\"Byte (8-Bit) Input\", \"IN (8-Bit)\"],\n            Clock: [\"Clock Generator\", \"Clock\"],\n            Random: [\"Random Input\", \"Random\"],\n            Output1: [\"Output\", \"OUT\"],\n            OutputN: [\"Multiple Outputs\", \"OUT Mult.\"],\n            Output8: [\"Byte (8-Bit) Output\", \"OUT (8-Bit)\"],\n            DisplayN: [\"Value Display\", \"Display\"],\n            Display8: [\"Byte (8-Bit) Display\", \"8-Bit Displ.\"],\n            Display7Seg: [\"7-Segment Display\", \"7-Segment\"],\n            Display16Seg: [\"16-Segment Display\", \"16-Segment\"],\n            DisplayAscii: [\"ASCII Character (7-Bit) Display\", \"Character\"],\n            DisplayBar: [\"Bit Display as a Light Bar\", \"Bar\"],\n            Pixel: [\"Pixel with adjustable color\", \"Pixel\"],\n            ShiftDisplay: [\"Display with Shift Buffer\", \"Shift Displ.\"],\n\n            Passthrough1: [\"Passthrough\", \"Passthrough\"],\n            PassthroughN: [\"Passthrough with multiple inputs-outputs\", \"Passthr. (n)\"],\n            Label: [\"Label\", \"Label\"],\n            Rectangle: [\"Grouping Rectangle\", \"Group\"],\n\n            not: [\"NOT Gate\", \"NOT\"],\n            buf: [\"Buffer\", \"BUF\"],\n            tri: [\"Tristate Buffer\", \"Tristate\"],\n            and: [\"AND Gate\", \"AND\"],\n            or: [\"OR Gate\", \"OR\"],\n            xor: [\"XOR Gate\", \"XOR\"],\n            nand: [\"NAND Gate\", \"NAND\"],\n            nor: [\"NOR Gate\", \"NOR\"],\n            xnor: [\"XNOR Gate\", \"XNOR\"],\n            imply: [\"IMPLY Gate\", \"IMPLY\"],\n            nimply: [\"NIMPLY Gate\", \"NIMPLY\"],\n            transfer: [\"Fake 2-Input TRANSFER Gate\", \"TRANSF.\"],\n\n            and3: [\"3-Input AND Gate\", \"AND (3)\"],\n            or3: [\"3-Input OR Gate\", \"OR (3)\"],\n            xor3: [\"3-Input XOR Gate\", \"XOR (3)\"],\n            nand3: [\"3-Input NAND Gate\", \"NAND (3)\"],\n            nor3: [\"3-Input NOR Gate\", \"NOR (3)\"],\n            xnor3: [\"3-Input XNOR Gate\", \"XNOR (3)\"],\n\n            and4: [\"4-Input AND Gate\", \"AND (4)\"],\n            or4: [\"4-Input AND Gate\", \"OR (4)\"],\n            xor4: [\"4-Input AND Gate\", \"XOR (4)\"],\n            nand4: [\"4-Input AND Gate\", \"NAND (4)\"],\n            nor4: [\"4-Input AND Gate\", \"NOR (4)\"],\n            xnor4: [\"4-Input AND Gate\", \"XNOR (4)\"],\n\n            ControlledInverter: [\"Switched Inverter\", \"Switched Inv.\"],\n            GateArray: [\"Gate Array\", \"Gate Array\"],\n            TristateBufferArray: [\"Tristate Buffer Array\", \"Tristate Arr.\"],\n\n            HalfAdder: [\"Half Adder\", \"Half Adder\"],\n            Adder: [\"Full Adder\", \"Full Adder\"],\n            AdderArray: [\"Adder Array\", \"Adder Arr.\"],\n            ALU: [\"Arithmetic and Logic Unit\", \"ALU\"],\n\n            Mux: [\"Multiplexer\", \"Mux\"],\n            Mux2to1: [\"2-to-1 Multiplexer (1 Control Bit)\", \"Mux 2-1\"],\n            Mux4to1: [\"4-to-1 Multiplexer (2 Control Bit)\", \"Mux 4-1\"],\n            Mux8to1: [\"8-to-1 Multiplexer (3 Control Bit)\", \"Mux 8-1\"],\n            Mux4to2: [\"4-to-2 Multiplexer (1 Control Bit)\", \"Mux 4-2\"],\n            Mux8to2: [\"8-to-2 Multiplexer (2 Control Bit)\", \"Mux 8-2\"],\n            Mux8to4: [\"8-to-4 Multiplexer (1 Control Bit)\", \"Mux 8-4\"],\n            Mux16to8: [\"16-to-8 Multiplexer (1 Control Bit)\", \"Mux 16-8\"],\n\n            Demux: [\"Demultiplexer\", \"Demux\"],\n            Demux1to2: [\"1-to-2 Demultiplexer (1 Control Bit)\", \"Demux 1-2\"],\n            Demux1to4: [\"1-to-4 Demultiplexer (2 Control Bit)\", \"Demux 1-4\"],\n            Demux1to8: [\"1-to-8 Demultiplexer (3 Control Bit)\", \"Demux 1-8\"],\n            Demux2to4: [\"2-to-4 Demultiplexer (1 Control Bit)\", \"Demux 2-4\"],\n            Demux2to8: [\"2-to-8 Demultiplexer (2 Control Bit)\", \"Demux 2-8\"],\n            Demux4to8: [\"4-to-8 Demultiplexer (1 Control Bit)\", \"Demux 4-8\"],\n            Demux8to16: [\"8-to-16 Demultiplexer (1 Control Bit)\", \"Demux 8-16\"],\n\n            LatchSR: [\"SR Latch\", \"SR Latch\"],\n            FlipflopJK: [\"JK Flip-Flop\", \"FF-JK\"],\n            FlipflopT: [\"T Flip-Flop\", \"FF-T\"],\n            FlipflopD: [\"D Flip-Flop\", \"FF-D\"],\n            Register: [\"Register\", \"Register\"],\n            ShiftRegister: [\"Shift Register\", \"Shift Reg.\"],\n            RAM: [\"RAM Module\", \"RAM\"],\n            ROM: [\"ROM Module\", \"ROM\"],\n\n            Counter: [\"4-Bit Counter\", \"Counter\"],\n            Decoder: [\"Binary to One-of-N Decoder\", \"Decoder\"],\n            Decoder7Seg: [\"7-Segment Decoder\", \"7-Seg. Dec.\"],\n            Decoder16Seg: [\"ASCII-to-16-Segment Decoder\", \"16-Seg. Dec.\"],\n            DecoderBCD4: [\"4-Bit-to-BCD Decoder\", \"BCD Dec.\"],\n\n            Comparator: [\"Comparator\", \"Compar.\"],\n        }),\n    },\n    Modes: {\n        FULL: tuple(\"Admin\", \"In addition to the full mode, this enables features like hiding wire colors, setting inputs and output to undetermined values, create faulty components, etc.\"),\n        DESIGN: tuple(\"Full\", \"All standard circuit-design features are enabled\"),\n        CONNECT: tuple(\"Connect\", \"You can move and connect components already on the canvas, but not add more components (the left component bar is not shown)\"),\n        TRYOUT: tuple(\"Tryout\", \"You can only change inputs to try out a already-designed circuit\"),\n        STATIC: tuple(\"Static\", \"Components are displayed without any possible interaction\"),\n    },\n    Orientations: {\n        e: \"Right (default)\",\n        s: \"Down\",\n        w: \"Left\",\n        n: \"Up\",\n    },\n    Settings: {\n        Settings: \"Settings\",\n        CircuitName: \"Name:\",\n        DefaultFileName: \"circuit\",\n        NameOfDownloadedFile: \"This will be the name of the downloaded file.\",\n        animateWires: tuple(\"Animate wires\", \"If checked, wires are shown as animated to show the propagation direction.\"),\n        hideWireColors: tuple(\"Hide wire colors\", \"If checked, wires are shown with a neutral color instead of showing whether they carry a 1 or a 0.\"),\n        hideInputColors: tuple(\"Hide input colors\", \"If checked, inputs are shown with a neutral color, even if they still deliver a well determined value. Can be used together with hidden wire colors.\"),\n        hideOutputColors: tuple(\"Hide output colors\", \"If checked, outputs are shown with a neutral color. Can be used together with hidden wire colors.\"),\n        hideMemoryContent: tuple(\"Hide stored values\", \"If checked, latches, flip-flops, registers and other memory components don\u2019t show the content they store.\"),\n        showGateTypes: tuple(\"Show gate types\", \"If checked, gates types are displayed textually on top of the gate symbol.\"),\n        showDisconnectedPins: tuple(\"Always show pins\", \"If unchecked, disconnected component pins are hidden in modes where new connections can\u2019t be made (but stay visible otherwise).\"),\n        hideTooltips: tuple(\"Disable tooltips\", \"If checked, additional information in component tooltips (such as truth tables) won\u2019t be shown.\"),\n        groupParallelWires: tuple(\"Group parallel wires\", \"If checked, parallel wires from one component to another will be grouped together as a thicker wire.\"),\n        showHiddenWires: tuple(\"Show hidden wires\", \"If checked, hidden wires will still be shown.\"),\n        showAnchors: tuple(\"Show anchors\", \"If checked, arrows will be shown to denote which component is anchored to which other component while moving.\"),\n        showIds: tuple(\"Show IDs\", \"If checked, component IDs will be shown on top of them\"),\n        propagationDelay: \"A 1 or 0 output on some wire will propagate to the other end of the wire after this propagation delay.\",\n        propagationDelayField: tuple(\"Propagation in\", \"ms\"),\n        zoomLevel: \"The zoom level on the circuit components.\",\n        zoomLevelField: tuple(\"Zoom:\", \"%\"),\n        showUserDataLink: tuple(\"See \", \"linked data\"),\n        userDataHeader: \"This data is exported with the circuit:\",\n        wireStyle: \"Wire style:\",\n    },\n    Tests: {\n        Title: \"Tests\",\n        DefaultTestCaseName: \"Test\",\n        DefaultTestSuiteName: \"Test Suite\",\n        SetInputs: \"Inputs\",\n        WantedOutputs: \"Outputs\",\n        SetTheseInputs: \"Set these inputs\",\n        Run: \"Run\",\n        RunTestSuite: \"Run test suite\",\n        DeleteTestCase: \"Delete this test case\",\n        EditTestCaseName: \"Rename this test case\",\n        TestSuiteShownClickToHide: \"Test suite visible (click to hide)\",\n        TestSuiteHiddenClickToShow: \"Test suite hidden (click to show)\",\n        EnterNewTestCaseName: \"Enter the new name for this test case:\",\n        ComponentUsedInTestSuite: template(\"This component is used in test suites. Do you really want to delete it? The tests will be kept, but won\u2019t work until another component with this reference (\u201C${ref}\u201D) is added to the circuit.\"),\n    },\n    TopBar: {\n        DirtyTooltip: \"The circuit has been modified since the last download/save\",\n        CircuitNameTooltip: \"Name of the circuit; click to change\",\n        SetCircuitName: \"Set the name of the circuit (or leave empty to use the default name):\",\n        CustomComponentCaptionTooltip: \"Name of the subcircuit currently being edited; click to change\",\n        CloseCircuit: \"Back to the main circuit\",\n\n        Undo: tuple(\"Undo\", \"Undo the last action\"),\n        Redo: tuple(\"Redo\", \"Redo the last undone action or repeat the last action\"),\n\n        Download: tuple(\"Download\", \"Download the circuit (or the custom components with Option/Alt key down)\"),\n        Screenshot: tuple(\"Screenshot\", \"Download the circuit as an image (PNG or SVG with Option/Alt key down)\"),\n        Open: tuple(\"Open\", \"Open a previously downloaded circuit\"),\n        Restore: tuple(\"Restore\", \"Restore the circuit to the last state\"),\n        Reset: tuple(\"Reset\", \"Reset the state of this circuit\"),\n\n        TimelinePlay: tuple(\"Play\", \"Starts logical time\"),\n        TimelinePause: tuple(\"Pause\", \"Stops logical time\"),\n        TimelineStep: tuple(\"Step\", \"Moves logical time to the next scheduled event\"),\n        TimeLabel: \"Time: \",\n\n        Design: tuple(\"Design\", \"Create or modify the circuit\"),\n        Delete: tuple(\"Delete\", \"Delete elements from the circuit\"),\n        Move: tuple(\"Move\", \"Move the whole circuit\"),\n\n        Tests: tuple(\"Tests\", \"Show tests for the circuit\"),\n    },\n    Messages: {\n        UnsupportedFileType: template(\"Unsupported file type: ${type}.\"),\n        LoadedDefinitions: template(\"Loaded ${n} custom component definition$s{n}\"),\n        SavedToUrl: \"Circuit saved to URL\",\n        SetAnchorPrompt: \"Click on the component to anchor to\",\n        AnchorAdded: \"Anchor added\",\n        CircularAnchorsForbidden: \"Circular anchors are not supported.\",\n        NotImplemented: \"This feature is not implemented yet.\",\n        NoPermission: \"This action is not allowed in this mode.\",\n        ReallyCloseWindow: \"Do you really want to close the window without saving the changes?\",\n        LoadedCircuitFromSessionStorage: template(\"Loaded from last session on ${day} at ${time}\"),\n        FailedToLoadCircuitFromStorage: template(\"Failed to load the circuit (${error})\"),\n        NoSavedData: \"Nothing to restore for this editor.\",\n        DevelopedBy: \"Developed by\",\n\n        DidUndo: \"Undo\",\n        DidRedo: \"Redo\",\n        DidRepeat: \"Repeat\",\n        NothingToUndo: \"Nothing to undo\",\n        NothingToRedo: \"Nothing to redo or repeat\",\n\n        NewTestCaseTitle: \"Create a new test case\",\n        NewTestCaseSetName: \"Enter the name of the new test case:\",\n        TestCaseInputToSet: template(\"Input$s{n} to set:\"),\n        TestCaseOuputToCheck: template(\"Output$s{n} to check:\"),\n        TooManyInputsForAutoTestCases: template(\"Cannot create test cases automatically for more than ${max} inputs.\"),\n        AutoTestCasesWarning: template(\"This will create ${numCases} test cases, one for each combination of the ${numInputs} inputs. Do you want to continue?\"),\n        ComputingTestCases: \"Generating test cases\u2026\",\n        RunningTests: \"Running test cases\u2026\",\n\n    },\n    Components: {\n        Generic: {\n            contextMenu: {\n                Delete: \"Delete\",\n                Reset: \"Reset\",\n\n                MakeNewComponent: \"Make New Component\u2026\",\n                MakeNewComponentFailed: \"Cannot create new custom component.\",\n\n                MakeNewTestCase: \"Make New Test Case\u2026\",\n                MakeAllTestCases: \"Make All Test Cases\u2026\",\n                MakeNewTestCaseFailed: \"Cannot create new test case.\",\n\n                SetIdentifier: \"Set Identifier\u2026\",\n                ChangeIdentifier: tuple(\"Change Identifier (\", \")\u2026\"),\n                SetIdentifierPrompt: \"Choose the unique identifier to use for this component:\",\n                IdentifierCannotBeEmpty: \"The identifier cannot be empty.\",\n                IdentifierAlreadyInUseShouldSwap: \"The identifier is already in use. Do you want to swap the component identifiers?\",\n\n                SetAnchor: \"Set Anchor\u2026\",\n                ClearAnchor: tuple(\"Remove Anchor (\", \")\"),\n\n                Orientation: \"Orientation\",\n                ChangeOrientationDesc: \"Change the orientation with Command + double click on the component\",\n                LockPosition: \"Lock Position\",\n                ShowAsUnknown: \"Show As Unknown\",\n\n                ForceOutputSingle: \"Force Output\",\n                ForceOutputMultiple: \"Force an Output\",\n                Output: \"Output\",\n                NormalOutput: \"Normal Output\",\n                ForceAsUnknown: \"Force as Unkown\",\n                ForceAs1: \"Force as 1\",\n                ForceAs0: \"Force as 0\",\n                ForceAsZ: \"Force as High Impedance\",\n                ForceOutputDesc: \"Force an output with Option + click on an output node\",\n\n                SetName: \"Set Name\u2026\",\n                ChangeName: \"Change Name\u2026\",\n                SetNamePrompt: \"Choose the name to display or leave empty to remove it:\",\n\n                SetFontPrompt: tuple(\"Enter a font specification or leave empty to use the default value (\", \"):\"),\n\n                TriggerOn: \"Trigger on\",\n                TriggerRisingEdge: \"Rising Edge\",\n                TriggerFallingEdge: \"Fallling Edge\",\n\n                ShowContent: \"Show Content\",\n\n                ParamControlBitAtBottom: \"Control Bit at Bottom\",\n                ParamControlBitsAtBottom: \"Control Bits at Bottom\",\n\n                ParamNumInputs: tuple(\"Number of Inputs\", template(\"${val} Input$s{val}\")),\n                ParamNumBits: tuple(\"Number of Bits\", template(\"${val} Bit$s{val}\")),\n                ParamNumWords: tuple(\"Number of Lines\", template(\"${val} Line$s{val}\")),\n            },\n\n            InputCarryInDesc: \"Cin (Previous Carry)\",\n            InputClockDesc: \"Clock\",\n            InputClearDesc: \"C (Clear, set to 0)\",\n            InputPresetDesc: \"P (Preset, set to 1)\",\n            InputSetDesc: \"S (Set, set to 1)\",\n            InputResetDesc: \"R (Reset, set to 0)\",\n            InputDataDesc: \"D (Data)\",\n            InputWriteEnableDesc: \"WE (Write Enable)\",\n\n            OutputSumDesc: \"S (Sum)\",\n            OutputCarryDesc: \"C (Carry)\",\n            OutputCarryOutDesc: \"Cout (Carry)\",\n            OutputQDesc: \"Q (Normal Output)\",\n            OutputQBarDesc: \"Q\u0305 (Inverted Output)\",\n        },\n        Custom: {\n            MenuButtonSuffix: \" (custom component)\",\n            contextMenu: {\n                ChangeName: \"Rename\u2026\",\n                ChangeNamePrompt: \"Enter the name of this custom component:\",\n                ChangeNameEmpty: \"The name cannot be empty.\",\n                ChangeCircuit: \"Edit Circuit\",\n                Delete: \"Delete Custom Component\",\n                EditFromComponentMessage: \"You can edit this custom component by right-clicking such a component in the circuit.\",\n                CannotDeleteInUse: \"Cannot delete this custom component because it is in use in the circuit.\",\n                CannotDeleteInUseBy: template(\"Cannot delete this custom component because it is used to define another component (${caption}).\"),\n                ConfirmDelete: \"Are you sure you want to delete this custom component?\",\n            },\n            tooltip: {\n                titleSuffix: \" (Custom Component)\",\n                desc: \"This custom component computes its outputs according to the circuit you have defined.\",\n            },\n            messages: {\n                EmptySelection: \"No components are selected.\",\n                NoInput: \"No input is selected.\",\n                NoOutput: \"No output is selected.\",\n                InputsOutputsMustHaveNames: \"All inputs and outputs must have unique (non-dynamic) names.\",\n                MissingComponents: template(\"The following components are connected to outputs but are missing from selection: ${list}.\"),\n                NoWires: \"There are no wires between the selected components.\",\n                UselessComponents: template(\"The following components are not connected to outputs and are useless: ${list}.\"),\n                CannotIncludeClock: \"Clocks cannot be included in custom components. Add a normal input, which can later be connected to an external clock.\",\n                CannotBeModified: \"This custom component cannot be modified in this mode.\",\n                EnterCaptionPrompt: \"Entrez le nom (unique) du composant personnalis\u00E9:\",\n                ComponentAlreadyExists: template(\"A custom component definition with id '${id}' already exists.\"),\n                InputsOutputsChanged: \"The inputs and outputs have changed and some connections may be removed by adapting the circuit. Do you want to continue?\",\n                NotInMainEditor: \"Please go back to the main editor to edit the custom circuit of this component.\",\n            },\n        },\n        Adder: {\n            tooltip: {\n                title: \"Adder\",\n                desc: \"Adds two bits A and B together with an input carry Cin, and outputs a sum bit S and an output carry Cout.\",\n            },\n        },\n        AdderArray: {\n            tooltip: {\n                title: template(\"${numBits}-Bit Adder Array\"),\n                desc: \"Adds the two inputs numbers A et B together with an input carry Cin, and outputs sum bits S and an output carry Cout.\",\n            },\n        },\n        ALU: {\n            \"A+B\": tuple(\"+\", \"Addition\"),\n            \"A-B\": tuple(\"A\u2013B\", \"Subtraction (A \u2013 B)\"),\n            \"B-A\": tuple(\"B\u2013A\", \"Subtraction (B \u2013 A)\"),\n            \"A+1\": tuple(\"A+1\", \"A + 1\"),\n            \"A-1\": tuple(\"A\u20131\", \"A \u2013 1\"),\n            \"-A\": tuple(\"\u2013A\", \"Negation of A\"),\n            \"A*2\": tuple(\"A\u00D72\", \"Addition of A to itself (A \u00D7 2)\"),\n            \"A/2\": tuple(\"A/2\", \"Arithmetic right shift by 1 (A/2)\"),\n            \"A|B\": tuple(\"OR\", \"Disjunction (A OR B)\"),\n            \"A&B\": tuple(\"AND\", \"Conjunction (A AND B)\"),\n            \"A|~B\": tuple(\"ORn\", \"A OR NOT(B)\"),\n            \"A&~B\": tuple(\"ANDn\", \"A AND NOT(B)\"),\n            \"~A\": tuple(\"A\u0305\", \"Inversion of A\"),\n            \"A^B\": tuple(\"XOR\", \"Excl. Disjunction (A XOR B)\"),\n            \"A<<\": tuple(\"<<\", \"Logical Left Shift by 1 of A\"),\n            \"A>>\": tuple(\">>\", \"Logical Right Shift by 1 of A\"),\n\n            InputCinDesc: \"input carry\",\n            OutputCoutDesc: \"output carry\",\n            tooltip: {\n                title: \"Arithmetic and Logic Unit (ALU)\",\n                CurrentlyCarriesOut: \"Currently carries out\",\n                SomeUnknownOperation: \"an unknown operation\",\n                ThisOperation: \"operation\",\n            },\n            contextMenu: {\n                toggleShowOp: \"Show Operation\",\n                ParamUseExtendedOpcode: \"Use Extended Opcode\",\n            },\n        },\n        Clock: {\n            tooltip: {\n                title: \"Clock\",\n                period: tuple(\"Period: \", \" ms\"),\n                dutycycle: tuple(\"Duty cycle: \", \"%\"),\n                phase: tuple(\"Phase: \", \" ms\"),\n            },\n            contextMenu: {\n                Period: \"Period\",\n                CustomPeriod: \"Other\",\n                SetPeriodMillis: \"Enter the period in milliseconds:\",\n                InvalidPeriod: \"The period must be a positive number.\",\n                ReplaceWithInput: \"Replace with Input\",\n            },\n            timeline: {\n                NextRisingEdge: \"Next rising edge of the clock\",\n                NextFallingEdge: \"Next falling edge of the clock\",\n            },\n        },\n        Comparator: {\n            tooltip: {\n                title: \"Comparator\",\n                desc: \"Comparator between two bits A and B, enabled by an input E.\",\n            },\n        },\n        Counter: {\n            tooltip: {\n                title: \"Counter\",\n                desc: \"4-bit counter.\",\n            },\n            contextMenu: {\n                DisplayTempl: template(\"${desc} Display\"),\n                DisplayNone: \"No\",\n                DisplayDecimal: \"Decimal\",\n                DisplayHex: \"Hexadecimal\",\n            },\n        },\n        Decoder: {\n            tooltip: {\n                title: \"Binary Decoder\",\n                desc: template(\"Takes as input a binary number coded on ${numFrom} bit$s{numFrom} and activates the corresponding output among ${numTo} (currently, ${n}).\"),\n            },\n        },\n        Decoder7Seg: {\n            tooltip: \"7-Segment Decoder\",\n        },\n        Decoder16Seg: {\n            tooltip: \"7-Bit ASCII to 16-Segment Decoder\",\n        },\n        DecoderBCD4: {\n            tooltip: \"4-Bit to BCD (Binary-Coded Decimal) Decoder\",\n        },\n        Demux: {\n            tooltip: template(\"${from}-to-${to} Demultiplexer\"),\n        },\n        FlipflopD: {\n            tooltip: {\n                title: \"D Flip-Flop\",\n                desc: \"Stores one bit.\",\n            },\n        },\n        FlipflopJK: {\n            InputJDesc: \"J (Jump, set to 1)\",\n            InputKDesc: \"K (Kill, set to 0)\",\n            tooltip: {\n                title: \"JK Flip-Flop\",\n                desc: \"Stores one bit.\",\n            },\n        },\n        FlipflopT: {\n            InputTDesc: \"T (Toggle)\",\n            tooltip: {\n                title: \"T Flip-Flop\",\n                desc: \"Stores one bit.\",\n            },\n        },\n        Gate: {\n            not: tuple(\"NOT\", \"NOT\", \"The output is the inverted input.\"),\n            buf: tuple(\"BUF\", \"BUF\", \"The output is the same as the input.\"),\n\n            and: tuple(\"AND\", \"AND\", \"The output is 1 when all inputs are 1.\"),\n            or: tuple(\"OR\", \"OR\", \"The output is 1 when at least one of the inputs is 1.\"),\n            xor: tuple(\"XOR\", \"XOR\", \"The output is 1 when an odd number of inputs are 1.\"),\n            nand: tuple(\"NAND\", \"NAND\", \"Inverted AND gate: the output is 1 unless all inputs are 1.\"),\n            nor: tuple(\"NOR\", \"NOR\", \"Inverted OR gate: the output is 1 when all inputs are 0.\"),\n            xnor: tuple(\"XNOR\", \"XNOR\", \"Inverted XOR gate: the output is 1 when an even number of inputs are 1.\"),\n\n            imply: tuple(\"IMPLY\", \"IMPL\", \"The output is 1 if the first input is 0 or if both inputs are 1.\"),\n            rimply: tuple(\"IMPLY (bis)\", \"IMPL\", \"The output is 1 if the second input is 0 or if both inputs are 1.\"),\n            nimply: tuple(\"NIMPLY\", \"N-IMPL\", \"Inverted IMPLY gate: the output is only 1 if the first input is 1 and the second one 0.\"),\n            rnimply: tuple(\"NIMPLY (bis)\", \"N-IMPL\", \"Inverted IMPLY gate: la sortie ne vaut 1 que lorsque la premi\u00E8re entr\u00E9e vaut 0 et la seconde 1.\"),\n\n            txa: tuple(\"TRANSFER-A\", undefined, \"The output is the same as the first input; the second input is ignored.\"),\n            txb: tuple(\"TRANSFER-B\", undefined, \"The output is the same as the second input; the first input is ignored.\"),\n            txna: tuple(\"TRANSFER-NOT-A\", undefined, \"The output is the inverted first input; the second input is ignored.\"),\n            txnb: tuple(\"TRANSFER-NOT-B\", undefined, \"The output is the inverted second input; the first input is ignored.\"),\n\n            tooltip: {\n                GateTitle: (gateType: Modifier) => mods(gateType, \" Gate\"),\n                UnknownGate: \"Unknown Gate\",\n                Input: \"Input\",\n                Output: \"Output\",\n                CurrentlyDelivers: \"It currently delivers\",\n                ShouldCurrentlyDeliver: \"it should currently deliver\",\n                UndeterminedOutputBecauseInputUnknown: \"an unknown output as its input is unknown. Its truth table is:\",\n                UndeterminedOutputBecauseInputsUnknown: \"an unknown output as not all inputs are known. Its truth table is:\",\n                ThisOutput: \"the output\",\n                BecauseInputIs: \"because its input is\",\n                AccordingToTruthTable: \"according to the following truth table:\",\n                Inverter: tuple(\"Inverter (\", \" gate)\"),\n                Buffer: tuple(\"Buffer (\", \" gate)\"),\n            },\n\n            contextMenu: {\n                ReplaceBy: \"Replace By\",\n                GateTempl: template(\"${type} Gate\"),\n                ShowAs: \"Show As\",\n                NormalGateTempl: template(\"Normal ${type} Gate\"),\n                UnknownGate: \"Unknown Gate (with \u201C?\u201D)\",\n                VariantChangeDesc: \"Switch to a variant with Shift + double-click on the gate\",\n            },\n        },\n        HalfAdder: {\n            tooltip: {\n                title: \"Half Adder\",\n                desc: \"Adds two bits A and B. Outputs a sum bit S and an output carry bit C.\",\n            },\n        },\n        Input: {\n            tooltip: {\n                title: template(\"Input (${numBits}-Bit)\"),\n            },\n            contextMenu: {\n                LockValue: \"Lock This Value\",\n                PushButton: \"Push Button\",\n                ToggleButton: \"Toggle Button\",\n                ReplaceWithClock: \"Replace With Clock\",\n                InputSetFromOutside: \"Input set from outside\",\n            },\n        },\n        Random: {\n            tooltip: {\n                title: \"Random Input\",\n                desc: tuple(\"When triggered by the clock, the output value will be 1 with probability \", \".\"),\n            },\n            contextMenu: {\n                ShowProb: \"Show Probability\",\n            },\n        },\n        Rectangle: {\n            contextMenu: {\n                Size: \"Size\",\n                SizePrompt: \"Enter the size of this rectangle:\",\n                Rounded: \"Rounded\",\n                WithBackgroundColor: \"With Background Color\",\n                SetTitle: \"Add Title\u2026\",\n                ChangeTitle: \"Change Title\u2026\",\n                SetTitlePrompt: \"Enter the title to display or leave empty to remove it:\",\n                InsideFrame: \"Inside Frame\",\n                Font: \"Font\",\n\n                Color: \"Color\",\n                ColorYellow: \"Yellow\",\n                ColorRed: \"Red\",\n                ColorGreen: \"Green\",\n                ColorBlue: \"Blue\",\n                ColorTurquoise: \"Turquoise\",\n                ColorGrey: \"Grey\",\n\n                Border: \"Border\",\n                BorderNone: \"None\",\n                Border1px: \"Fine (1 pixel)\",\n                Border2px: \"Medium (2 pixels)\",\n                Border3px: \"Thick (3 pixels)\",\n                Border5px: \"Very Thick (5 pixels)\",\n                Border10px: \"Huge (10 pixels)\",\n\n                TitlePlacement: \"Title Placement\",\n                PlacementTop: \"Top\",\n                PlacementTopLeft: \"Top Left\",\n                PlacementTopRight: \"Top Right\",\n                PlacementBottom: \"Bottom\",\n                PlacementBottomLeft: \"Bottom Left\",\n                PlacementBottomRight: \"Bottom Right\",\n                PlacementLeft: \"Left\",\n                PlacementRight: \"Right\",\n                PlacementCenter: \"Center\",\n            },\n        },\n        Label: {\n            contextMenu: {\n                ChangeText: \"Change Text\u2026\",\n                ChangeTextPrompt: \"Type the text to display:\",\n                Font: \"Font\u2026\",\n            },\n        },\n        LatchSR: {\n            tooltip: {\n                title: \"SR Latch\",\n                desc: \"Stores one bit.\",\n            },\n        },\n        Mux: {\n            tooltip: template(\"${from}-to-${to} Multiplexer\"),\n        },\n        MuxDemux: {\n            contextMenu: {\n                ShowWiring: \"Show Internal Wiring\",\n                UseZForDisconnected: \"Use Z For Disconnected Pins\",\n\n                ParamNumFrom: tuple(\"Number of Inputs\", template(\"${val} Input$s{val}\")),\n                ParamNumTo: tuple(\"Number of Outputs\", template(\"${val} Output$s{val}\")),\n            },\n        },\n        Output: {\n            tooltip: {\n                title: template(\"Output (${numBits}-Bit)\"),\n            },\n        },\n        Display7Seg: {\n            tooltip: \"7-Segment Display\",\n        },\n        Display16Seg: {\n            tooltip: \"16-Segment Display\",\n        },\n        DisplayAscii: {\n            tooltip: {\n                title: \"ASCII Character Display\",\n                desc: tuple(\"Displays the ASCII character represented by the 7 inputs, currently \", \".\"),\n                CurrentlyUndefined: \"As not all inputs are known, this character is currently undefined.\",\n                CurrentlyThisCharacter: \"Currently, this character is\",\n                WhichIsNotPrintable: \" (a non-printable character).\",\n            },\n            contextMenu: {\n                AdditionalDisplay: \"Additional Display\",\n                DisplayNone: \"None\",\n                DisplayDecimal: \"Decimal Value\",\n                DisplayHex: \"Hexadecimal Value\",\n                ChangeDisplayDesc: \"Change the additional display with a double-click on the component\",\n            },\n        },\n        DisplayBar: {\n            tooltip: {\n                title: \"Bar/LED Display\",\n                ValueUnknown: \"Its state is undefined because its input is unknown.\",\n                ValueZ: \"Its state is undefined because its input is floating (high impedance).\",\n                Value1: tuple(\"It is currently on because its input is \", \".\"),\n                Value0: tuple(\"It is currently off because its input is \", \".\"),\n            },\n            contextMenu: {\n                TransparentWhenOff: \"Transparent When Off\",\n\n                Display: \"Display\",\n                DisplayVerticalBar: \"Vertical Bar\",\n                DisplayHorizontalBar: \"Horizontal Bar\",\n                DisplaySmallSquare: \"Small Square\",\n                DisplayLargeSquare: \"Large Square\",\n                DisplayChangeDesc: \"Change display types with a double-click on the component\",\n\n                Color: \"Color\",\n                ColorGreen: \"Green\",\n                ColorRed: \"Red\",\n                ColorYellow: \"Yellow\",\n            },\n        },\n        Display: {\n            tooltip: {\n                title: template(\"${numBits}-Bit Display\"),\n                desc: tuple(template(\"Displays the ${radixStr} value of its ${numBits} input$s{numBits}, which is currently \"), \".\"),\n\n                RadixBinary: \"binary\",\n                RadixDecimal: \"decimal\",\n                RadixSignedDecimal: \"signed decimal\",\n                RadixHexadecimal: \"hexadecimal\",\n                RadixGeneric: template(\"base-${radix}\"),\n\n                CurrentlyUndefined: \"As not all inputs are known, this value is currently undefined.\",\n            },\n            contextMenu: {\n                DisplayAs: \"Display as\",\n                DisplayNone: \"None\",\n                DisplayAsBinary: \"Binary (Base 2)\",\n                DisplayAsDecimal: \"Decimal (Base 10)\",\n                DisplayAsSignedDecimal: \"Signed Decimal\",\n                DisplayAsOctal: \"Octal (Base 8)\",\n                DisplayAsHexadecimal: \"Hexadecimal (Base 16)\",\n                DisplayAsUnknown: \"Unkown\",\n            },\n        },\n        ShiftDisplay: {\n            tooltip: \"Shift Buffer Display\",\n            contextMenu: {\n                Decoding: \"Decoding\",\n                DecodingNone: \"None\",\n                DecodingOctal: \"Octal\",\n                DecodingHex: \"Hexadecimal\",\n                DecodingAscii7: \"ASCII (on 7 bits)\",\n                DecodingAscii8: \"ASCII (on 8 bits)\",\n                DecodingUint4: \"4-Bit Integer\",\n                DecodingInt4: \"4-Bit Signed Integer\",\n                DecodingUint8: \"8-Bit Integer\",\n                DecodingInt8: \"8-Bit Signed Integer\",\n                DecodingUint16: \"16-Bit Integer\",\n                DecodingInt16: \"16-Bit Signed Integer\",\n                DecodingChangeWarning: \"Changing the decoding may truncate the stored value.\",\n\n                Grouping: \"Group Data\",\n                GroupingNone: \"No Grouping\",\n                GroupBy: template(\"By ${n}\"),\n            },\n            EmptyCaption: \"(empty)\",\n        },\n        Passthrough: {\n            tooltip: \"Passthrough. Only used to arrange wires.\",\n            contextMenu: {\n                Slant: \"Slant\",\n                SlantNone: \"None\",\n                SlantRight: \"Rightward By 45\u00B0\",\n                SlantLeft: \"Leftward By 45\u00B0\",\n            },\n        },\n        Pixel: {\n            tooltip: \"Pixel. Displays a color that can be set with the inputs.\",\n            contextMenu: {\n                Full: \"Fill Full Square\",\n                ParamNumBits: tuple(\"Number of Bits per Component\", template(\"${val} Bit$s{val}\")),\n                ParamGrayscale: \"Grayscale Only\",\n                ParamTouch: \"With Touch Output\",\n            },\n        },\n        GateArray: {\n            tooltip: {\n                title: \"Gate Array\",\n                desc: template(\"Computes in parallel several times the chosen logical operation, which currently is ${op}.\"),\n            },\n            contextMenu: {\n                Type: \"Type\",\n                ShowAsUnknown: \"Hide Type\",\n            },\n        },\n        TristateBufferArray: {\n            tooltip: {\n                title: \"Tristate Buffer Array\",\n                desc: \"Represents multiple tristate buffers switched by a single control bit.\",\n            },\n        },\n        RAM: {\n            tooltip: {\n                title: \"RAM (Random-Access Memory)\",\n                desc: template(\"Stores ${numWords} row$s{numWords} of ${numDataBits} bit$s{numDataBits}.\"),\n            },\n            contextMenu: {\n                SelectedDataDisplay: \"Addressed Data Display\",\n                EditContent: \"Edit Content\u2026\",\n                EditContentPrompt: \"Type in the new memory content, separating lines with spaces. If there are as many characters as bits, the input is parsed as a binary string, and otherwise as a hexadecimal string.\",\n                SaveContent: \"Save Content\",\n                LoadContent: \"Load Content\u2026\",\n                SwapROMRAM: \"Swap ROM/RAM\",\n            },\n        },\n        ROM: {\n            tooltip: {\n                title: \"ROM (Read-Only Memory)\",\n                desc: template(\"Stores ${numWords} row$s{numWords} of ${numDataBits} bit$s{numDataBits}.\"),\n            },\n        },\n        Register: {\n            tooltip: {\n                title: \"Register\",\n                desc: template(\"Stores ${numBits} bit$s{numBits}.\"),\n            },\n            contextMenu: {\n                ParamHasIncDec: \"With Increment/Decrement\",\n                Saturating: \"Saturating\",\n            },\n        },\n        ShiftRegister: {\n            tooltip: {\n                title: \"Shift Register\",\n                desc: template(\"Stores ${numBits} bit$s{numBits} and shifts them left or right at each activation.\"),\n            },\n        },\n        ControlledInverter: {\n            tooltip: {\n                title: \"Switched Inverter\",\n                desc: \"Inverts its inputs when the control bit S is on; otherwise, just outputs the inputs.\",\n            },\n        },\n        TristateBuffer: {\n            tooltip: \"Tristate Buffer\",\n        },\n        Wire: {\n            contextMenu: {\n                AddMiddlePoint: \"Add Middle Point\",\n                AddPassthrough: \"Add Passthrough\",\n\n                CustomPropagationDelay: template(\"Specific Propagation Delay${current}\u2026\"),\n                CustomPropagationDelayDesc: template(\"Specific propagation delay in milliseconds for this connection (leave empty to use the default value for the circuit, which currently is ${current} ms):\"),\n\n                WireColor: \"Wire Color\",\n                WireColorBlack: \"Black (default)\",\n                WireColorRed: \"Red\",\n                WireColorGreen: \"Green\",\n                WireColorBlue: \"Blue\",\n                WireColorYellow: \"Yellow\",\n                WireColorWhite: \"White\",\n\n                WireStyle: \"Style\",\n                WireStyleDefault: \"By Default\",\n                WireStyleAuto: \"Auto\",\n                WireStyleStraight: \"Straight\",\n                WireStyleSquareHV: \"H then V\",\n                WireStyleSquareVH: \"V then H\",\n                WireStyleCurved: \"Curve\",\n\n                HiddenWire: \"Hide Wire\",\n            },\n            timeline: {\n                PropagatingValue: template(\"Propagation of value ${val} on wire\"),\n            },\n        },\n    },\n    Dialogs: {\n        Generic: {\n            Close: \"Close\",\n        },\n        Share: {\n            title: \"Share Circuit\",\n            URL: \"URL:\",\n            EmbedInIframe: \"Embed using <iframe>:\",\n            EmbedWithWebComp: \"Embed with a web component:\",\n            EmbedInMarkdown: \"Embed in Markdown/Myst:\",\n        },\n    },\n}\n\n\nconst langs = {\n    fr: Strings_fr,\n    en: Strings_en,\n}\n\nexport type Lang = keyof typeof langs\n\nexport function isLang(lang: string): lang is Lang {\n    return lang in langs\n}\n\nexport function setLang(l: Lang) {\n    // console.log(`Setting language to '${l}'`)\n    S = langs[l]\n    _lang = l\n}\n\nexport function getLang(): Lang {\n    return _lang\n}\n\nexport const DefaultLang: Lang = \"en\"\n\n/** The current language strings. */\nexport let S: Strings = langs[DefaultLang]\nlet _lang: Lang = DefaultLang\n", "import { Bezier } from \"./bezier.js\";\n\n// math-inlining.\nconst { abs, cos, sin, acos, atan2, sqrt, pow } = Math;\n\n// cube root function yielding real roots\nfunction crt(v) {\n  return v < 0 ? -pow(-v, 1 / 3) : pow(v, 1 / 3);\n}\n\n// trig constants\nconst pi = Math.PI,\n  tau = 2 * pi,\n  quart = pi / 2,\n  // float precision significant decimal\n  epsilon = 0.000001,\n  // extremas used in bbox calculation and similar algorithms\n  nMax = Number.MAX_SAFE_INTEGER || 9007199254740991,\n  nMin = Number.MIN_SAFE_INTEGER || -9007199254740991,\n  // a zero coordinate, which is surprisingly useful\n  ZERO = { x: 0, y: 0, z: 0 };\n\n// Bezier utility functions\nconst utils = {\n  // Legendre-Gauss abscissae with n=24 (x_i values, defined at i=n as the roots of the nth order Legendre polynomial Pn(x))\n  Tvalues: [\n    -0.0640568928626056260850430826247450385909,\n    0.0640568928626056260850430826247450385909,\n    -0.1911188674736163091586398207570696318404,\n    0.1911188674736163091586398207570696318404,\n    -0.3150426796961633743867932913198102407864,\n    0.3150426796961633743867932913198102407864,\n    -0.4337935076260451384870842319133497124524,\n    0.4337935076260451384870842319133497124524,\n    -0.5454214713888395356583756172183723700107,\n    0.5454214713888395356583756172183723700107,\n    -0.6480936519369755692524957869107476266696,\n    0.6480936519369755692524957869107476266696,\n    -0.7401241915785543642438281030999784255232,\n    0.7401241915785543642438281030999784255232,\n    -0.8200019859739029219539498726697452080761,\n    0.8200019859739029219539498726697452080761,\n    -0.8864155270044010342131543419821967550873,\n    0.8864155270044010342131543419821967550873,\n    -0.9382745520027327585236490017087214496548,\n    0.9382745520027327585236490017087214496548,\n    -0.9747285559713094981983919930081690617411,\n    0.9747285559713094981983919930081690617411,\n    -0.9951872199970213601799974097007368118745,\n    0.9951872199970213601799974097007368118745,\n  ],\n\n  // Legendre-Gauss weights with n=24 (w_i values, defined by a function linked to in the Bezier primer article)\n  Cvalues: [\n    0.1279381953467521569740561652246953718517,\n    0.1279381953467521569740561652246953718517,\n    0.1258374563468282961213753825111836887264,\n    0.1258374563468282961213753825111836887264,\n    0.121670472927803391204463153476262425607,\n    0.121670472927803391204463153476262425607,\n    0.1155056680537256013533444839067835598622,\n    0.1155056680537256013533444839067835598622,\n    0.1074442701159656347825773424466062227946,\n    0.1074442701159656347825773424466062227946,\n    0.0976186521041138882698806644642471544279,\n    0.0976186521041138882698806644642471544279,\n    0.086190161531953275917185202983742667185,\n    0.086190161531953275917185202983742667185,\n    0.0733464814110803057340336152531165181193,\n    0.0733464814110803057340336152531165181193,\n    0.0592985849154367807463677585001085845412,\n    0.0592985849154367807463677585001085845412,\n    0.0442774388174198061686027482113382288593,\n    0.0442774388174198061686027482113382288593,\n    0.0285313886289336631813078159518782864491,\n    0.0285313886289336631813078159518782864491,\n    0.0123412297999871995468056670700372915759,\n    0.0123412297999871995468056670700372915759,\n  ],\n\n  arcfn: function (t, derivativeFn) {\n    const d = derivativeFn(t);\n    let l = d.x * d.x + d.y * d.y;\n    if (typeof d.z !== \"undefined\") {\n      l += d.z * d.z;\n    }\n    return sqrt(l);\n  },\n\n  compute: function (t, points, _3d) {\n    // shortcuts\n    if (t === 0) {\n      points[0].t = 0;\n      return points[0];\n    }\n\n    const order = points.length - 1;\n\n    if (t === 1) {\n      points[order].t = 1;\n      return points[order];\n    }\n\n    const mt = 1 - t;\n    let p = points;\n\n    // constant?\n    if (order === 0) {\n      points[0].t = t;\n      return points[0];\n    }\n\n    // linear?\n    if (order === 1) {\n      const ret = {\n        x: mt * p[0].x + t * p[1].x,\n        y: mt * p[0].y + t * p[1].y,\n        t: t,\n      };\n      if (_3d) {\n        ret.z = mt * p[0].z + t * p[1].z;\n      }\n      return ret;\n    }\n\n    // quadratic/cubic curve?\n    if (order < 4) {\n      let mt2 = mt * mt,\n        t2 = t * t,\n        a,\n        b,\n        c,\n        d = 0;\n      if (order === 2) {\n        p = [p[0], p[1], p[2], ZERO];\n        a = mt2;\n        b = mt * t * 2;\n        c = t2;\n      } else if (order === 3) {\n        a = mt2 * mt;\n        b = mt2 * t * 3;\n        c = mt * t2 * 3;\n        d = t * t2;\n      }\n      const ret = {\n        x: a * p[0].x + b * p[1].x + c * p[2].x + d * p[3].x,\n        y: a * p[0].y + b * p[1].y + c * p[2].y + d * p[3].y,\n        t: t,\n      };\n      if (_3d) {\n        ret.z = a * p[0].z + b * p[1].z + c * p[2].z + d * p[3].z;\n      }\n      return ret;\n    }\n\n    // higher order curves: use de Casteljau's computation\n    const dCpts = JSON.parse(JSON.stringify(points));\n    while (dCpts.length > 1) {\n      for (let i = 0; i < dCpts.length - 1; i++) {\n        dCpts[i] = {\n          x: dCpts[i].x + (dCpts[i + 1].x - dCpts[i].x) * t,\n          y: dCpts[i].y + (dCpts[i + 1].y - dCpts[i].y) * t,\n        };\n        if (typeof dCpts[i].z !== \"undefined\") {\n          dCpts[i] = dCpts[i].z + (dCpts[i + 1].z - dCpts[i].z) * t;\n        }\n      }\n      dCpts.splice(dCpts.length - 1, 1);\n    }\n    dCpts[0].t = t;\n    return dCpts[0];\n  },\n\n  computeWithRatios: function (t, points, ratios, _3d) {\n    const mt = 1 - t,\n      r = ratios,\n      p = points;\n\n    let f1 = r[0],\n      f2 = r[1],\n      f3 = r[2],\n      f4 = r[3],\n      d;\n\n    // spec for linear\n    f1 *= mt;\n    f2 *= t;\n\n    if (p.length === 2) {\n      d = f1 + f2;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z) / d,\n        t: t,\n      };\n    }\n\n    // upgrade to quadratic\n    f1 *= mt;\n    f2 *= 2 * mt;\n    f3 *= t * t;\n\n    if (p.length === 3) {\n      d = f1 + f2 + f3;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z) / d,\n        t: t,\n      };\n    }\n\n    // upgrade to cubic\n    f1 *= mt;\n    f2 *= 1.5 * mt;\n    f3 *= 3 * mt;\n    f4 *= t * t * t;\n\n    if (p.length === 4) {\n      d = f1 + f2 + f3 + f4;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x + f4 * p[3].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y + f4 * p[3].y) / d,\n        z: !_3d\n          ? false\n          : (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z + f4 * p[3].z) / d,\n        t: t,\n      };\n    }\n  },\n\n  derive: function (points, _3d) {\n    const dpoints = [];\n    for (let p = points, d = p.length, c = d - 1; d > 1; d--, c--) {\n      const list = [];\n      for (let j = 0, dpt; j < c; j++) {\n        dpt = {\n          x: c * (p[j + 1].x - p[j].x),\n          y: c * (p[j + 1].y - p[j].y),\n        };\n        if (_3d) {\n          dpt.z = c * (p[j + 1].z - p[j].z);\n        }\n        list.push(dpt);\n      }\n      dpoints.push(list);\n      p = list;\n    }\n    return dpoints;\n  },\n\n  between: function (v, m, M) {\n    return (\n      (m <= v && v <= M) ||\n      utils.approximately(v, m) ||\n      utils.approximately(v, M)\n    );\n  },\n\n  approximately: function (a, b, precision) {\n    return abs(a - b) <= (precision || epsilon);\n  },\n\n  length: function (derivativeFn) {\n    const z = 0.5,\n      len = utils.Tvalues.length;\n\n    let sum = 0;\n\n    for (let i = 0, t; i < len; i++) {\n      t = z * utils.Tvalues[i] + z;\n      sum += utils.Cvalues[i] * utils.arcfn(t, derivativeFn);\n    }\n    return z * sum;\n  },\n\n  map: function (v, ds, de, ts, te) {\n    const d1 = de - ds,\n      d2 = te - ts,\n      v2 = v - ds,\n      r = v2 / d1;\n    return ts + d2 * r;\n  },\n\n  lerp: function (r, v1, v2) {\n    const ret = {\n      x: v1.x + r * (v2.x - v1.x),\n      y: v1.y + r * (v2.y - v1.y),\n    };\n    if (v1.z !== undefined && v2.z !== undefined) {\n      ret.z = v1.z + r * (v2.z - v1.z);\n    }\n    return ret;\n  },\n\n  pointToString: function (p) {\n    let s = p.x + \"/\" + p.y;\n    if (typeof p.z !== \"undefined\") {\n      s += \"/\" + p.z;\n    }\n    return s;\n  },\n\n  pointsToString: function (points) {\n    return \"[\" + points.map(utils.pointToString).join(\", \") + \"]\";\n  },\n\n  copy: function (obj) {\n    return JSON.parse(JSON.stringify(obj));\n  },\n\n  angle: function (o, v1, v2) {\n    const dx1 = v1.x - o.x,\n      dy1 = v1.y - o.y,\n      dx2 = v2.x - o.x,\n      dy2 = v2.y - o.y,\n      cross = dx1 * dy2 - dy1 * dx2,\n      dot = dx1 * dx2 + dy1 * dy2;\n    return atan2(cross, dot);\n  },\n\n  // round as string, to avoid rounding errors\n  round: function (v, d) {\n    const s = \"\" + v;\n    const pos = s.indexOf(\".\");\n    return parseFloat(s.substring(0, pos + 1 + d));\n  },\n\n  dist: function (p1, p2) {\n    const dx = p1.x - p2.x,\n      dy = p1.y - p2.y;\n    return sqrt(dx * dx + dy * dy);\n  },\n\n  closest: function (LUT, point) {\n    let mdist = pow(2, 63),\n      mpos,\n      d;\n    LUT.forEach(function (p, idx) {\n      d = utils.dist(point, p);\n      if (d < mdist) {\n        mdist = d;\n        mpos = idx;\n      }\n    });\n    return { mdist: mdist, mpos: mpos };\n  },\n\n  abcratio: function (t, n) {\n    // see ratio(t) note on http://pomax.github.io/bezierinfo/#abc\n    if (n !== 2 && n !== 3) {\n      return false;\n    }\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    } else if (t === 0 || t === 1) {\n      return t;\n    }\n    const bottom = pow(t, n) + pow(1 - t, n),\n      top = bottom - 1;\n    return abs(top / bottom);\n  },\n\n  projectionratio: function (t, n) {\n    // see u(t) note on http://pomax.github.io/bezierinfo/#abc\n    if (n !== 2 && n !== 3) {\n      return false;\n    }\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    } else if (t === 0 || t === 1) {\n      return t;\n    }\n    const top = pow(1 - t, n),\n      bottom = pow(t, n) + top;\n    return top / bottom;\n  },\n\n  lli8: function (x1, y1, x2, y2, x3, y3, x4, y4) {\n    const nx =\n        (x1 * y2 - y1 * x2) * (x3 - x4) - (x1 - x2) * (x3 * y4 - y3 * x4),\n      ny = (x1 * y2 - y1 * x2) * (y3 - y4) - (y1 - y2) * (x3 * y4 - y3 * x4),\n      d = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\n    if (d == 0) {\n      return false;\n    }\n    return { x: nx / d, y: ny / d };\n  },\n\n  lli4: function (p1, p2, p3, p4) {\n    const x1 = p1.x,\n      y1 = p1.y,\n      x2 = p2.x,\n      y2 = p2.y,\n      x3 = p3.x,\n      y3 = p3.y,\n      x4 = p4.x,\n      y4 = p4.y;\n    return utils.lli8(x1, y1, x2, y2, x3, y3, x4, y4);\n  },\n\n  lli: function (v1, v2) {\n    return utils.lli4(v1, v1.c, v2, v2.c);\n  },\n\n  makeline: function (p1, p2) {\n    return new Bezier(\n      p1.x,\n      p1.y,\n      (p1.x + p2.x) / 2,\n      (p1.y + p2.y) / 2,\n      p2.x,\n      p2.y\n    );\n  },\n\n  findbbox: function (sections) {\n    let mx = nMax,\n      my = nMax,\n      MX = nMin,\n      MY = nMin;\n    sections.forEach(function (s) {\n      const bbox = s.bbox();\n      if (mx > bbox.x.min) mx = bbox.x.min;\n      if (my > bbox.y.min) my = bbox.y.min;\n      if (MX < bbox.x.max) MX = bbox.x.max;\n      if (MY < bbox.y.max) MY = bbox.y.max;\n    });\n    return {\n      x: { min: mx, mid: (mx + MX) / 2, max: MX, size: MX - mx },\n      y: { min: my, mid: (my + MY) / 2, max: MY, size: MY - my },\n    };\n  },\n\n  shapeintersections: function (\n    s1,\n    bbox1,\n    s2,\n    bbox2,\n    curveIntersectionThreshold\n  ) {\n    if (!utils.bboxoverlap(bbox1, bbox2)) return [];\n    const intersections = [];\n    const a1 = [s1.startcap, s1.forward, s1.back, s1.endcap];\n    const a2 = [s2.startcap, s2.forward, s2.back, s2.endcap];\n    a1.forEach(function (l1) {\n      if (l1.virtual) return;\n      a2.forEach(function (l2) {\n        if (l2.virtual) return;\n        const iss = l1.intersects(l2, curveIntersectionThreshold);\n        if (iss.length > 0) {\n          iss.c1 = l1;\n          iss.c2 = l2;\n          iss.s1 = s1;\n          iss.s2 = s2;\n          intersections.push(iss);\n        }\n      });\n    });\n    return intersections;\n  },\n\n  makeshape: function (forward, back, curveIntersectionThreshold) {\n    const bpl = back.points.length;\n    const fpl = forward.points.length;\n    const start = utils.makeline(back.points[bpl - 1], forward.points[0]);\n    const end = utils.makeline(forward.points[fpl - 1], back.points[0]);\n    const shape = {\n      startcap: start,\n      forward: forward,\n      back: back,\n      endcap: end,\n      bbox: utils.findbbox([start, forward, back, end]),\n    };\n    shape.intersections = function (s2) {\n      return utils.shapeintersections(\n        shape,\n        shape.bbox,\n        s2,\n        s2.bbox,\n        curveIntersectionThreshold\n      );\n    };\n    return shape;\n  },\n\n  getminmax: function (curve, d, list) {\n    if (!list) return { min: 0, max: 0 };\n    let min = nMax,\n      max = nMin,\n      t,\n      c;\n    if (list.indexOf(0) === -1) {\n      list = [0].concat(list);\n    }\n    if (list.indexOf(1) === -1) {\n      list.push(1);\n    }\n    for (let i = 0, len = list.length; i < len; i++) {\n      t = list[i];\n      c = curve.get(t);\n      if (c[d] < min) {\n        min = c[d];\n      }\n      if (c[d] > max) {\n        max = c[d];\n      }\n    }\n    return { min: min, mid: (min + max) / 2, max: max, size: max - min };\n  },\n\n  align: function (points, line) {\n    const tx = line.p1.x,\n      ty = line.p1.y,\n      a = -atan2(line.p2.y - ty, line.p2.x - tx),\n      d = function (v) {\n        return {\n          x: (v.x - tx) * cos(a) - (v.y - ty) * sin(a),\n          y: (v.x - tx) * sin(a) + (v.y - ty) * cos(a),\n        };\n      };\n    return points.map(d);\n  },\n\n  roots: function (points, line) {\n    line = line || { p1: { x: 0, y: 0 }, p2: { x: 1, y: 0 } };\n\n    const order = points.length - 1;\n    const aligned = utils.align(points, line);\n    const reduce = function (t) {\n      return 0 <= t && t <= 1;\n    };\n\n    if (order === 2) {\n      const a = aligned[0].y,\n        b = aligned[1].y,\n        c = aligned[2].y,\n        d = a - 2 * b + c;\n      if (d !== 0) {\n        const m1 = -sqrt(b * b - a * c),\n          m2 = -a + b,\n          v1 = -(m1 + m2) / d,\n          v2 = -(-m1 + m2) / d;\n        return [v1, v2].filter(reduce);\n      } else if (b !== c && d === 0) {\n        return [(2 * b - c) / (2 * b - 2 * c)].filter(reduce);\n      }\n      return [];\n    }\n\n    // see http://www.trans4mind.com/personal_development/mathematics/polynomials/cubicAlgebra.htm\n    const pa = aligned[0].y,\n      pb = aligned[1].y,\n      pc = aligned[2].y,\n      pd = aligned[3].y;\n\n    let d = -pa + 3 * pb - 3 * pc + pd,\n      a = 3 * pa - 6 * pb + 3 * pc,\n      b = -3 * pa + 3 * pb,\n      c = pa;\n\n    if (utils.approximately(d, 0)) {\n      // this is not a cubic curve.\n      if (utils.approximately(a, 0)) {\n        // in fact, this is not a quadratic curve either.\n        if (utils.approximately(b, 0)) {\n          // in fact in fact, there are no solutions.\n          return [];\n        }\n        // linear solution:\n        return [-c / b].filter(reduce);\n      }\n      // quadratic solution:\n      const q = sqrt(b * b - 4 * a * c),\n        a2 = 2 * a;\n      return [(q - b) / a2, (-b - q) / a2].filter(reduce);\n    }\n\n    // at this point, we know we need a cubic solution:\n\n    a /= d;\n    b /= d;\n    c /= d;\n\n    const p = (3 * b - a * a) / 3,\n      p3 = p / 3,\n      q = (2 * a * a * a - 9 * a * b + 27 * c) / 27,\n      q2 = q / 2,\n      discriminant = q2 * q2 + p3 * p3 * p3;\n\n    let u1, v1, x1, x2, x3;\n    if (discriminant < 0) {\n      const mp3 = -p / 3,\n        mp33 = mp3 * mp3 * mp3,\n        r = sqrt(mp33),\n        t = -q / (2 * r),\n        cosphi = t < -1 ? -1 : t > 1 ? 1 : t,\n        phi = acos(cosphi),\n        crtr = crt(r),\n        t1 = 2 * crtr;\n      x1 = t1 * cos(phi / 3) - a / 3;\n      x2 = t1 * cos((phi + tau) / 3) - a / 3;\n      x3 = t1 * cos((phi + 2 * tau) / 3) - a / 3;\n      return [x1, x2, x3].filter(reduce);\n    } else if (discriminant === 0) {\n      u1 = q2 < 0 ? crt(-q2) : -crt(q2);\n      x1 = 2 * u1 - a / 3;\n      x2 = -u1 - a / 3;\n      return [x1, x2].filter(reduce);\n    } else {\n      const sd = sqrt(discriminant);\n      u1 = crt(-q2 + sd);\n      v1 = crt(q2 + sd);\n      return [u1 - v1 - a / 3].filter(reduce);\n    }\n  },\n\n  droots: function (p) {\n    // quadratic roots are easy\n    if (p.length === 3) {\n      const a = p[0],\n        b = p[1],\n        c = p[2],\n        d = a - 2 * b + c;\n      if (d !== 0) {\n        const m1 = -sqrt(b * b - a * c),\n          m2 = -a + b,\n          v1 = -(m1 + m2) / d,\n          v2 = -(-m1 + m2) / d;\n        return [v1, v2];\n      } else if (b !== c && d === 0) {\n        return [(2 * b - c) / (2 * (b - c))];\n      }\n      return [];\n    }\n\n    // linear roots are even easier\n    if (p.length === 2) {\n      const a = p[0],\n        b = p[1];\n      if (a !== b) {\n        return [a / (a - b)];\n      }\n      return [];\n    }\n\n    return [];\n  },\n\n  curvature: function (t, d1, d2, _3d, kOnly) {\n    let num,\n      dnm,\n      adk,\n      dk,\n      k = 0,\n      r = 0;\n\n    //\n    // We're using the following formula for curvature:\n    //\n    //              x'y\" - y'x\"\n    //   k(t) = ------------------\n    //           (x'\u00B2 + y'\u00B2)^(3/2)\n    //\n    // from https://en.wikipedia.org/wiki/Radius_of_curvature#Definition\n    //\n    // With it corresponding 3D counterpart:\n    //\n    //          sqrt( (y'z\" - y\"z')\u00B2 + (z'x\" - z\"x')\u00B2 + (x'y\" - x\"y')\u00B2)\n    //   k(t) = -------------------------------------------------------\n    //                     (x'\u00B2 + y'\u00B2 + z'\u00B2)^(3/2)\n    //\n\n    const d = utils.compute(t, d1);\n    const dd = utils.compute(t, d2);\n    const qdsum = d.x * d.x + d.y * d.y;\n\n    if (_3d) {\n      num = sqrt(\n        pow(d.y * dd.z - dd.y * d.z, 2) +\n          pow(d.z * dd.x - dd.z * d.x, 2) +\n          pow(d.x * dd.y - dd.x * d.y, 2)\n      );\n      dnm = pow(qdsum + d.z * d.z, 3 / 2);\n    } else {\n      num = d.x * dd.y - d.y * dd.x;\n      dnm = pow(qdsum, 3 / 2);\n    }\n\n    if (num === 0 || dnm === 0) {\n      return { k: 0, r: 0 };\n    }\n\n    k = num / dnm;\n    r = dnm / num;\n\n    // We're also computing the derivative of kappa, because\n    // there is value in knowing the rate of change for the\n    // curvature along the curve. And we're just going to\n    // ballpark it based on an epsilon.\n    if (!kOnly) {\n      // compute k'(t) based on the interval before, and after it,\n      // to at least try to not introduce forward/backward pass bias.\n      const pk = utils.curvature(t - 0.001, d1, d2, _3d, true).k;\n      const nk = utils.curvature(t + 0.001, d1, d2, _3d, true).k;\n      dk = (nk - k + (k - pk)) / 2;\n      adk = (abs(nk - k) + abs(k - pk)) / 2;\n    }\n\n    return { k: k, r: r, dk: dk, adk: adk };\n  },\n\n  inflections: function (points) {\n    if (points.length < 4) return [];\n\n    // FIXME: TODO: add in inflection abstraction for quartic+ curves?\n\n    const p = utils.align(points, { p1: points[0], p2: points.slice(-1)[0] }),\n      a = p[2].x * p[1].y,\n      b = p[3].x * p[1].y,\n      c = p[1].x * p[2].y,\n      d = p[3].x * p[2].y,\n      v1 = 18 * (-3 * a + 2 * b + 3 * c - d),\n      v2 = 18 * (3 * a - b - 3 * c),\n      v3 = 18 * (c - a);\n\n    if (utils.approximately(v1, 0)) {\n      if (!utils.approximately(v2, 0)) {\n        let t = -v3 / v2;\n        if (0 <= t && t <= 1) return [t];\n      }\n      return [];\n    }\n\n    const d2 = 2 * v1;\n\n    if (utils.approximately(d2, 0)) return [];\n\n    const trm = v2 * v2 - 4 * v1 * v3;\n\n    if (trm < 0) return [];\n\n    const sq = Math.sqrt(trm);\n\n    return [(sq - v2) / d2, -(v2 + sq) / d2].filter(function (r) {\n      return 0 <= r && r <= 1;\n    });\n  },\n\n  bboxoverlap: function (b1, b2) {\n    const dims = [\"x\", \"y\"],\n      len = dims.length;\n\n    for (let i = 0, dim, l, t, d; i < len; i++) {\n      dim = dims[i];\n      l = b1[dim].mid;\n      t = b2[dim].mid;\n      d = (b1[dim].size + b2[dim].size) / 2;\n      if (abs(l - t) >= d) return false;\n    }\n    return true;\n  },\n\n  expandbox: function (bbox, _bbox) {\n    if (_bbox.x.min < bbox.x.min) {\n      bbox.x.min = _bbox.x.min;\n    }\n    if (_bbox.y.min < bbox.y.min) {\n      bbox.y.min = _bbox.y.min;\n    }\n    if (_bbox.z && _bbox.z.min < bbox.z.min) {\n      bbox.z.min = _bbox.z.min;\n    }\n    if (_bbox.x.max > bbox.x.max) {\n      bbox.x.max = _bbox.x.max;\n    }\n    if (_bbox.y.max > bbox.y.max) {\n      bbox.y.max = _bbox.y.max;\n    }\n    if (_bbox.z && _bbox.z.max > bbox.z.max) {\n      bbox.z.max = _bbox.z.max;\n    }\n    bbox.x.mid = (bbox.x.min + bbox.x.max) / 2;\n    bbox.y.mid = (bbox.y.min + bbox.y.max) / 2;\n    if (bbox.z) {\n      bbox.z.mid = (bbox.z.min + bbox.z.max) / 2;\n    }\n    bbox.x.size = bbox.x.max - bbox.x.min;\n    bbox.y.size = bbox.y.max - bbox.y.min;\n    if (bbox.z) {\n      bbox.z.size = bbox.z.max - bbox.z.min;\n    }\n  },\n\n  pairiteration: function (c1, c2, curveIntersectionThreshold) {\n    const c1b = c1.bbox(),\n      c2b = c2.bbox(),\n      r = 100000,\n      threshold = curveIntersectionThreshold || 0.5;\n\n    if (\n      c1b.x.size + c1b.y.size < threshold &&\n      c2b.x.size + c2b.y.size < threshold\n    ) {\n      return [\n        (((r * (c1._t1 + c1._t2)) / 2) | 0) / r +\n          \"/\" +\n          (((r * (c2._t1 + c2._t2)) / 2) | 0) / r,\n      ];\n    }\n\n    let cc1 = c1.split(0.5),\n      cc2 = c2.split(0.5),\n      pairs = [\n        { left: cc1.left, right: cc2.left },\n        { left: cc1.left, right: cc2.right },\n        { left: cc1.right, right: cc2.right },\n        { left: cc1.right, right: cc2.left },\n      ];\n\n    pairs = pairs.filter(function (pair) {\n      return utils.bboxoverlap(pair.left.bbox(), pair.right.bbox());\n    });\n\n    let results = [];\n\n    if (pairs.length === 0) return results;\n\n    pairs.forEach(function (pair) {\n      results = results.concat(\n        utils.pairiteration(pair.left, pair.right, threshold)\n      );\n    });\n\n    results = results.filter(function (v, i) {\n      return results.indexOf(v) === i;\n    });\n\n    return results;\n  },\n\n  getccenter: function (p1, p2, p3) {\n    const dx1 = p2.x - p1.x,\n      dy1 = p2.y - p1.y,\n      dx2 = p3.x - p2.x,\n      dy2 = p3.y - p2.y,\n      dx1p = dx1 * cos(quart) - dy1 * sin(quart),\n      dy1p = dx1 * sin(quart) + dy1 * cos(quart),\n      dx2p = dx2 * cos(quart) - dy2 * sin(quart),\n      dy2p = dx2 * sin(quart) + dy2 * cos(quart),\n      // chord midpoints\n      mx1 = (p1.x + p2.x) / 2,\n      my1 = (p1.y + p2.y) / 2,\n      mx2 = (p2.x + p3.x) / 2,\n      my2 = (p2.y + p3.y) / 2,\n      // midpoint offsets\n      mx1n = mx1 + dx1p,\n      my1n = my1 + dy1p,\n      mx2n = mx2 + dx2p,\n      my2n = my2 + dy2p,\n      // intersection of these lines:\n      arc = utils.lli8(mx1, my1, mx1n, my1n, mx2, my2, mx2n, my2n),\n      r = utils.dist(arc, p1);\n\n    // arc start/end values, over mid point:\n    let s = atan2(p1.y - arc.y, p1.x - arc.x),\n      m = atan2(p2.y - arc.y, p2.x - arc.x),\n      e = atan2(p3.y - arc.y, p3.x - arc.x),\n      _;\n\n    // determine arc direction (cw/ccw correction)\n    if (s < e) {\n      // if s<m<e, arc(s, e)\n      // if m<s<e, arc(e, s + tau)\n      // if s<e<m, arc(e, s + tau)\n      if (s > m || m > e) {\n        s += tau;\n      }\n      if (s > e) {\n        _ = e;\n        e = s;\n        s = _;\n      }\n    } else {\n      // if e<m<s, arc(e, s)\n      // if m<e<s, arc(s, e + tau)\n      // if e<s<m, arc(s, e + tau)\n      if (e < m && m < s) {\n        _ = e;\n        e = s;\n        s = _;\n      } else {\n        e += tau;\n      }\n    }\n    // assign and done.\n    arc.s = s;\n    arc.e = e;\n    arc.r = r;\n    return arc;\n  },\n\n  numberSort: function (a, b) {\n    return a - b;\n  },\n};\n\nexport { utils };\n", "import { utils } from \"./utils.js\";\n\n/**\n * Poly Bezier\n * @param {[type]} curves [description]\n */\nclass PolyBezier {\n  constructor(curves) {\n    this.curves = [];\n    this._3d = false;\n    if (!!curves) {\n      this.curves = curves;\n      this._3d = this.curves[0]._3d;\n    }\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n\n  toString() {\n    return (\n      \"[\" +\n      this.curves\n        .map(function (curve) {\n          return utils.pointsToString(curve.points);\n        })\n        .join(\", \") +\n      \"]\"\n    );\n  }\n\n  addCurve(curve) {\n    this.curves.push(curve);\n    this._3d = this._3d || curve._3d;\n  }\n\n  length() {\n    return this.curves\n      .map(function (v) {\n        return v.length();\n      })\n      .reduce(function (a, b) {\n        return a + b;\n      });\n  }\n\n  curve(idx) {\n    return this.curves[idx];\n  }\n\n  bbox() {\n    const c = this.curves;\n    var bbox = c[0].bbox();\n    for (var i = 1; i < c.length; i++) {\n      utils.expandbox(bbox, c[i].bbox());\n    }\n    return bbox;\n  }\n\n  offset(d) {\n    const offset = [];\n    this.curves.forEach(function (v) {\n      offset.push(...v.offset(d));\n    });\n    return new PolyBezier(offset);\n  }\n}\n\nexport { PolyBezier };\n", "/**\n  A javascript Bezier curve library by Pomax.\n\n  Based on http://pomax.github.io/bezierinfo\n\n  This code is MIT licensed.\n**/\n\nimport { utils } from \"./utils.js\";\nimport { PolyBezier } from \"./poly-bezier.js\";\n\n// math-inlining.\nconst { abs, min, max, cos, sin, acos, sqrt } = Math;\nconst pi = Math.PI;\n// a zero coordinate, which is surprisingly useful\nconst ZERO = { x: 0, y: 0, z: 0 };\n\n/**\n * Bezier curve constructor.\n *\n * ...docs pending...\n */\nclass Bezier {\n  constructor(coords) {\n    let args =\n      coords && coords.forEach ? coords : Array.from(arguments).slice();\n    let coordlen = false;\n\n    if (typeof args[0] === \"object\") {\n      coordlen = args.length;\n      const newargs = [];\n      args.forEach(function (point) {\n        [\"x\", \"y\", \"z\"].forEach(function (d) {\n          if (typeof point[d] !== \"undefined\") {\n            newargs.push(point[d]);\n          }\n        });\n      });\n      args = newargs;\n    }\n\n    let higher = false;\n    const len = args.length;\n\n    if (coordlen) {\n      if (coordlen > 4) {\n        if (arguments.length !== 1) {\n          throw new Error(\n            \"Only new Bezier(point[]) is accepted for 4th and higher order curves\"\n          );\n        }\n        higher = true;\n      }\n    } else {\n      if (len !== 6 && len !== 8 && len !== 9 && len !== 12) {\n        if (arguments.length !== 1) {\n          throw new Error(\n            \"Only new Bezier(point[]) is accepted for 4th and higher order curves\"\n          );\n        }\n      }\n    }\n\n    const _3d = (this._3d =\n      (!higher && (len === 9 || len === 12)) ||\n      (coords && coords[0] && typeof coords[0].z !== \"undefined\"));\n\n    const points = (this.points = []);\n    for (let idx = 0, step = _3d ? 3 : 2; idx < len; idx += step) {\n      var point = {\n        x: args[idx],\n        y: args[idx + 1],\n      };\n      if (_3d) {\n        point.z = args[idx + 2];\n      }\n      points.push(point);\n    }\n    const order = (this.order = points.length - 1);\n\n    const dims = (this.dims = [\"x\", \"y\"]);\n    if (_3d) dims.push(\"z\");\n    this.dimlen = dims.length;\n\n    // is this curve, practically speaking, a straight line?\n    const aligned = utils.align(points, { p1: points[0], p2: points[order] });\n    const baselength = utils.dist(points[0], points[order]);\n    this._linear = aligned.reduce((t, p) => t + abs(p.y), 0) < baselength / 50;\n\n    this._lut = [];\n    this._t1 = 0;\n    this._t2 = 1;\n    this.update();\n  }\n\n  static quadraticFromPoints(p1, p2, p3, t) {\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    }\n    // shortcuts, although they're really dumb\n    if (t === 0) {\n      return new Bezier(p2, p2, p3);\n    }\n    if (t === 1) {\n      return new Bezier(p1, p2, p2);\n    }\n    // real fitting.\n    const abc = Bezier.getABC(2, p1, p2, p3, t);\n    return new Bezier(p1, abc.A, p3);\n  }\n\n  static cubicFromPoints(S, B, E, t, d1) {\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    }\n    const abc = Bezier.getABC(3, S, B, E, t);\n    if (typeof d1 === \"undefined\") {\n      d1 = utils.dist(B, abc.C);\n    }\n    const d2 = (d1 * (1 - t)) / t;\n\n    const selen = utils.dist(S, E),\n      lx = (E.x - S.x) / selen,\n      ly = (E.y - S.y) / selen,\n      bx1 = d1 * lx,\n      by1 = d1 * ly,\n      bx2 = d2 * lx,\n      by2 = d2 * ly;\n    // derivation of new hull coordinates\n    const e1 = { x: B.x - bx1, y: B.y - by1 },\n      e2 = { x: B.x + bx2, y: B.y + by2 },\n      A = abc.A,\n      v1 = { x: A.x + (e1.x - A.x) / (1 - t), y: A.y + (e1.y - A.y) / (1 - t) },\n      v2 = { x: A.x + (e2.x - A.x) / t, y: A.y + (e2.y - A.y) / t },\n      nc1 = { x: S.x + (v1.x - S.x) / t, y: S.y + (v1.y - S.y) / t },\n      nc2 = {\n        x: E.x + (v2.x - E.x) / (1 - t),\n        y: E.y + (v2.y - E.y) / (1 - t),\n      };\n    // ...done\n    return new Bezier(S, nc1, nc2, E);\n  }\n\n  static getUtils() {\n    return utils;\n  }\n\n  getUtils() {\n    return Bezier.getUtils();\n  }\n\n  static get PolyBezier() {\n    return PolyBezier;\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n\n  toString() {\n    return utils.pointsToString(this.points);\n  }\n\n  toSVG() {\n    if (this._3d) return false;\n    const p = this.points,\n      x = p[0].x,\n      y = p[0].y,\n      s = [\"M\", x, y, this.order === 2 ? \"Q\" : \"C\"];\n    for (let i = 1, last = p.length; i < last; i++) {\n      s.push(p[i].x);\n      s.push(p[i].y);\n    }\n    return s.join(\" \");\n  }\n\n  setRatios(ratios) {\n    if (ratios.length !== this.points.length) {\n      throw new Error(\"incorrect number of ratio values\");\n    }\n    this.ratios = ratios;\n    this._lut = []; //  invalidate any precomputed LUT\n  }\n\n  verify() {\n    const print = this.coordDigest();\n    if (print !== this._print) {\n      this._print = print;\n      this.update();\n    }\n  }\n\n  coordDigest() {\n    return this.points\n      .map(function (c, pos) {\n        return \"\" + pos + c.x + c.y + (c.z ? c.z : 0);\n      })\n      .join(\"\");\n  }\n\n  update() {\n    // invalidate any precomputed LUT\n    this._lut = [];\n    this.dpoints = utils.derive(this.points, this._3d);\n    this.computedirection();\n  }\n\n  computedirection() {\n    const points = this.points;\n    const angle = utils.angle(points[0], points[this.order], points[1]);\n    this.clockwise = angle > 0;\n  }\n\n  length() {\n    return utils.length(this.derivative.bind(this));\n  }\n\n  static getABC(order = 2, S, B, E, t = 0.5) {\n    const u = utils.projectionratio(t, order),\n      um = 1 - u,\n      C = {\n        x: u * S.x + um * E.x,\n        y: u * S.y + um * E.y,\n      },\n      s = utils.abcratio(t, order),\n      A = {\n        x: B.x + (B.x - C.x) / s,\n        y: B.y + (B.y - C.y) / s,\n      };\n    return { A, B, C, S, E };\n  }\n\n  getABC(t, B) {\n    B = B || this.get(t);\n    let S = this.points[0];\n    let E = this.points[this.order];\n    return Bezier.getABC(this.order, S, B, E, t);\n  }\n\n  getLUT(steps) {\n    this.verify();\n    steps = steps || 100;\n    if (this._lut.length === steps) {\n      return this._lut;\n    }\n    this._lut = [];\n    // n steps means n+1 points\n    steps++;\n    this._lut = [];\n    for (let i = 0, p, t; i < steps; i++) {\n      t = i / (steps - 1);\n      p = this.compute(t);\n      p.t = t;\n      this._lut.push(p);\n    }\n    return this._lut;\n  }\n\n  on(point, error) {\n    error = error || 5;\n    const lut = this.getLUT(),\n      hits = [];\n    for (let i = 0, c, t = 0; i < lut.length; i++) {\n      c = lut[i];\n      if (utils.dist(c, point) < error) {\n        hits.push(c);\n        t += i / lut.length;\n      }\n    }\n    if (!hits.length) return false;\n    return (t /= hits.length);\n  }\n\n  project(point) {\n    // step 1: coarse check\n    const LUT = this.getLUT(),\n      l = LUT.length - 1,\n      closest = utils.closest(LUT, point),\n      mpos = closest.mpos,\n      t1 = (mpos - 1) / l,\n      t2 = (mpos + 1) / l,\n      step = 0.1 / l;\n\n    // step 2: fine check\n    let mdist = closest.mdist,\n      t = t1,\n      ft = t,\n      p;\n    mdist += 1;\n    for (let d; t < t2 + step; t += step) {\n      p = this.compute(t);\n      d = utils.dist(point, p);\n      if (d < mdist) {\n        mdist = d;\n        ft = t;\n      }\n    }\n    ft = ft < 0 ? 0 : ft > 1 ? 1 : ft;\n    p = this.compute(ft);\n    p.t = ft;\n    p.d = mdist;\n    return p;\n  }\n\n  get(t) {\n    return this.compute(t);\n  }\n\n  point(idx) {\n    return this.points[idx];\n  }\n\n  compute(t) {\n    if (this.ratios) {\n      return utils.computeWithRatios(t, this.points, this.ratios, this._3d);\n    }\n    return utils.compute(t, this.points, this._3d, this.ratios);\n  }\n\n  raise() {\n    const p = this.points,\n      np = [p[0]],\n      k = p.length;\n    for (let i = 1, pi, pim; i < k; i++) {\n      pi = p[i];\n      pim = p[i - 1];\n      np[i] = {\n        x: ((k - i) / k) * pi.x + (i / k) * pim.x,\n        y: ((k - i) / k) * pi.y + (i / k) * pim.y,\n      };\n    }\n    np[k] = p[k - 1];\n    return new Bezier(np);\n  }\n\n  derivative(t) {\n    return utils.compute(t, this.dpoints[0], this._3d);\n  }\n\n  dderivative(t) {\n    return utils.compute(t, this.dpoints[1], this._3d);\n  }\n\n  align() {\n    let p = this.points;\n    return new Bezier(utils.align(p, { p1: p[0], p2: p[p.length - 1] }));\n  }\n\n  curvature(t) {\n    return utils.curvature(t, this.dpoints[0], this.dpoints[1], this._3d);\n  }\n\n  inflections() {\n    return utils.inflections(this.points);\n  }\n\n  normal(t) {\n    return this._3d ? this.__normal3(t) : this.__normal2(t);\n  }\n\n  __normal2(t) {\n    const d = this.derivative(t);\n    const q = sqrt(d.x * d.x + d.y * d.y);\n    return { t, x: -d.y / q, y: d.x / q };\n  }\n\n  __normal3(t) {\n    // see http://stackoverflow.com/questions/25453159\n    const r1 = this.derivative(t),\n      r2 = this.derivative(t + 0.01),\n      q1 = sqrt(r1.x * r1.x + r1.y * r1.y + r1.z * r1.z),\n      q2 = sqrt(r2.x * r2.x + r2.y * r2.y + r2.z * r2.z);\n    r1.x /= q1;\n    r1.y /= q1;\n    r1.z /= q1;\n    r2.x /= q2;\n    r2.y /= q2;\n    r2.z /= q2;\n    // cross product\n    const c = {\n      x: r2.y * r1.z - r2.z * r1.y,\n      y: r2.z * r1.x - r2.x * r1.z,\n      z: r2.x * r1.y - r2.y * r1.x,\n    };\n    const m = sqrt(c.x * c.x + c.y * c.y + c.z * c.z);\n    c.x /= m;\n    c.y /= m;\n    c.z /= m;\n    // rotation matrix\n    const R = [\n      c.x * c.x,\n      c.x * c.y - c.z,\n      c.x * c.z + c.y,\n      c.x * c.y + c.z,\n      c.y * c.y,\n      c.y * c.z - c.x,\n      c.x * c.z - c.y,\n      c.y * c.z + c.x,\n      c.z * c.z,\n    ];\n    // normal vector:\n    const n = {\n      t,\n      x: R[0] * r1.x + R[1] * r1.y + R[2] * r1.z,\n      y: R[3] * r1.x + R[4] * r1.y + R[5] * r1.z,\n      z: R[6] * r1.x + R[7] * r1.y + R[8] * r1.z,\n    };\n    return n;\n  }\n\n  hull(t) {\n    let p = this.points,\n      _p = [],\n      q = [],\n      idx = 0;\n    q[idx++] = p[0];\n    q[idx++] = p[1];\n    q[idx++] = p[2];\n    if (this.order === 3) {\n      q[idx++] = p[3];\n    }\n    // we lerp between all points at each iteration, until we have 1 point left.\n    while (p.length > 1) {\n      _p = [];\n      for (let i = 0, pt, l = p.length - 1; i < l; i++) {\n        pt = utils.lerp(t, p[i], p[i + 1]);\n        q[idx++] = pt;\n        _p.push(pt);\n      }\n      p = _p;\n    }\n    return q;\n  }\n\n  split(t1, t2) {\n    // shortcuts\n    if (t1 === 0 && !!t2) {\n      return this.split(t2).left;\n    }\n    if (t2 === 1) {\n      return this.split(t1).right;\n    }\n\n    // no shortcut: use \"de Casteljau\" iteration.\n    const q = this.hull(t1);\n    const result = {\n      left:\n        this.order === 2\n          ? new Bezier([q[0], q[3], q[5]])\n          : new Bezier([q[0], q[4], q[7], q[9]]),\n      right:\n        this.order === 2\n          ? new Bezier([q[5], q[4], q[2]])\n          : new Bezier([q[9], q[8], q[6], q[3]]),\n      span: q,\n    };\n\n    // make sure we bind _t1/_t2 information!\n    result.left._t1 = utils.map(0, 0, 1, this._t1, this._t2);\n    result.left._t2 = utils.map(t1, 0, 1, this._t1, this._t2);\n    result.right._t1 = utils.map(t1, 0, 1, this._t1, this._t2);\n    result.right._t2 = utils.map(1, 0, 1, this._t1, this._t2);\n\n    // if we have no t2, we're done\n    if (!t2) {\n      return result;\n    }\n\n    // if we have a t2, split again:\n    t2 = utils.map(t2, t1, 1, 0, 1);\n    return result.right.split(t2).left;\n  }\n\n  extrema() {\n    const result = {};\n    let roots = [];\n\n    this.dims.forEach(\n      function (dim) {\n        let mfn = function (v) {\n          return v[dim];\n        };\n        let p = this.dpoints[0].map(mfn);\n        result[dim] = utils.droots(p);\n        if (this.order === 3) {\n          p = this.dpoints[1].map(mfn);\n          result[dim] = result[dim].concat(utils.droots(p));\n        }\n        result[dim] = result[dim].filter(function (t) {\n          return t >= 0 && t <= 1;\n        });\n        roots = roots.concat(result[dim].sort(utils.numberSort));\n      }.bind(this)\n    );\n\n    result.values = roots.sort(utils.numberSort).filter(function (v, idx) {\n      return roots.indexOf(v) === idx;\n    });\n\n    return result;\n  }\n\n  bbox() {\n    const extrema = this.extrema(),\n      result = {};\n    this.dims.forEach(\n      function (d) {\n        result[d] = utils.getminmax(this, d, extrema[d]);\n      }.bind(this)\n    );\n    return result;\n  }\n\n  overlaps(curve) {\n    const lbbox = this.bbox(),\n      tbbox = curve.bbox();\n    return utils.bboxoverlap(lbbox, tbbox);\n  }\n\n  offset(t, d) {\n    if (typeof d !== \"undefined\") {\n      const c = this.get(t),\n        n = this.normal(t);\n      const ret = {\n        c: c,\n        n: n,\n        x: c.x + n.x * d,\n        y: c.y + n.y * d,\n      };\n      if (this._3d) {\n        ret.z = c.z + n.z * d;\n      }\n      return ret;\n    }\n    if (this._linear) {\n      const nv = this.normal(0),\n        coords = this.points.map(function (p) {\n          const ret = {\n            x: p.x + t * nv.x,\n            y: p.y + t * nv.y,\n          };\n          if (p.z && nv.z) {\n            ret.z = p.z + t * nv.z;\n          }\n          return ret;\n        });\n      return [new Bezier(coords)];\n    }\n    return this.reduce().map(function (s) {\n      if (s._linear) {\n        return s.offset(t)[0];\n      }\n      return s.scale(t);\n    });\n  }\n\n  simple() {\n    if (this.order === 3) {\n      const a1 = utils.angle(this.points[0], this.points[3], this.points[1]);\n      const a2 = utils.angle(this.points[0], this.points[3], this.points[2]);\n      if ((a1 > 0 && a2 < 0) || (a1 < 0 && a2 > 0)) return false;\n    }\n    const n1 = this.normal(0);\n    const n2 = this.normal(1);\n    let s = n1.x * n2.x + n1.y * n2.y;\n    if (this._3d) {\n      s += n1.z * n2.z;\n    }\n    return abs(acos(s)) < pi / 3;\n  }\n\n  reduce() {\n    // TODO: examine these var types in more detail...\n    let i,\n      t1 = 0,\n      t2 = 0,\n      step = 0.01,\n      segment,\n      pass1 = [],\n      pass2 = [];\n    // first pass: split on extrema\n    let extrema = this.extrema().values;\n    if (extrema.indexOf(0) === -1) {\n      extrema = [0].concat(extrema);\n    }\n    if (extrema.indexOf(1) === -1) {\n      extrema.push(1);\n    }\n\n    for (t1 = extrema[0], i = 1; i < extrema.length; i++) {\n      t2 = extrema[i];\n      segment = this.split(t1, t2);\n      segment._t1 = t1;\n      segment._t2 = t2;\n      pass1.push(segment);\n      t1 = t2;\n    }\n\n    // second pass: further reduce these segments to simple segments\n    pass1.forEach(function (p1) {\n      t1 = 0;\n      t2 = 0;\n      while (t2 <= 1) {\n        for (t2 = t1 + step; t2 <= 1 + step; t2 += step) {\n          segment = p1.split(t1, t2);\n          if (!segment.simple()) {\n            t2 -= step;\n            if (abs(t1 - t2) < step) {\n              // we can never form a reduction\n              return [];\n            }\n            segment = p1.split(t1, t2);\n            segment._t1 = utils.map(t1, 0, 1, p1._t1, p1._t2);\n            segment._t2 = utils.map(t2, 0, 1, p1._t1, p1._t2);\n            pass2.push(segment);\n            t1 = t2;\n            break;\n          }\n        }\n      }\n      if (t1 < 1) {\n        segment = p1.split(t1, 1);\n        segment._t1 = utils.map(t1, 0, 1, p1._t1, p1._t2);\n        segment._t2 = p1._t2;\n        pass2.push(segment);\n      }\n    });\n    return pass2;\n  }\n\n  translate(v, d1, d2) {\n    d2 = typeof d2 === \"number\" ? d2 : d1;\n\n    // TODO: make this take curves with control points outside\n    //       of the start-end interval into account\n\n    const o = this.order;\n    let d = this.points.map((_, i) => (1 - i / o) * d1 + (i / o) * d2);\n    return new Bezier(\n      this.points.map((p, i) => ({\n        x: p.x + v.x * d[i],\n        y: p.y + v.y * d[i],\n      }))\n    );\n  }\n\n  scale(d) {\n    const order = this.order;\n    let distanceFn = false;\n    if (typeof d === \"function\") {\n      distanceFn = d;\n    }\n    if (distanceFn && order === 2) {\n      return this.raise().scale(distanceFn);\n    }\n\n    // TODO: add special handling for non-linear degenerate curves.\n\n    const clockwise = this.clockwise;\n    const points = this.points;\n\n    if (this._linear) {\n      return this.translate(\n        this.normal(0),\n        distanceFn ? distanceFn(0) : d,\n        distanceFn ? distanceFn(1) : d\n      );\n    }\n\n    const r1 = distanceFn ? distanceFn(0) : d;\n    const r2 = distanceFn ? distanceFn(1) : d;\n    const v = [this.offset(0, 10), this.offset(1, 10)];\n    const np = [];\n    const o = utils.lli4(v[0], v[0].c, v[1], v[1].c);\n\n    if (!o) {\n      throw new Error(\"cannot scale this curve. Try reducing it first.\");\n    }\n\n    // move all points by distance 'd' wrt the origin 'o',\n    // and move end points by fixed distance along normal.\n    [0, 1].forEach(function (t) {\n      const p = (np[t * order] = utils.copy(points[t * order]));\n      p.x += (t ? r2 : r1) * v[t].n.x;\n      p.y += (t ? r2 : r1) * v[t].n.y;\n    });\n\n    if (!distanceFn) {\n      // move control points to lie on the intersection of the offset\n      // derivative vector, and the origin-through-control vector\n      [0, 1].forEach((t) => {\n        if (order === 2 && !!t) return;\n        const p = np[t * order];\n        const d = this.derivative(t);\n        const p2 = { x: p.x + d.x, y: p.y + d.y };\n        np[t + 1] = utils.lli4(p, p2, o, points[t + 1]);\n      });\n      return new Bezier(np);\n    }\n\n    // move control points by \"however much necessary to\n    // ensure the correct tangent to endpoint\".\n    [0, 1].forEach(function (t) {\n      if (order === 2 && !!t) return;\n      var p = points[t + 1];\n      var ov = {\n        x: p.x - o.x,\n        y: p.y - o.y,\n      };\n      var rc = distanceFn ? distanceFn((t + 1) / order) : d;\n      if (distanceFn && !clockwise) rc = -rc;\n      var m = sqrt(ov.x * ov.x + ov.y * ov.y);\n      ov.x /= m;\n      ov.y /= m;\n      np[t + 1] = {\n        x: p.x + rc * ov.x,\n        y: p.y + rc * ov.y,\n      };\n    });\n    return new Bezier(np);\n  }\n\n  outline(d1, d2, d3, d4) {\n    d2 = d2 === undefined ? d1 : d2;\n\n    if (this._linear) {\n      // TODO: find the actual extrema, because they might\n      //       be before the start, or past the end.\n\n      const n = this.normal(0);\n      const start = this.points[0];\n      const end = this.points[this.points.length - 1];\n      let s, mid, e;\n\n      if (d3 === undefined) {\n        d3 = d1;\n        d4 = d2;\n      }\n\n      s = { x: start.x + n.x * d1, y: start.y + n.y * d1 };\n      e = { x: end.x + n.x * d3, y: end.y + n.y * d3 };\n      mid = { x: (s.x + e.x) / 2, y: (s.y + e.y) / 2 };\n      const fline = [s, mid, e];\n\n      s = { x: start.x - n.x * d2, y: start.y - n.y * d2 };\n      e = { x: end.x - n.x * d4, y: end.y - n.y * d4 };\n      mid = { x: (s.x + e.x) / 2, y: (s.y + e.y) / 2 };\n      const bline = [e, mid, s];\n\n      const ls = utils.makeline(bline[2], fline[0]);\n      const le = utils.makeline(fline[2], bline[0]);\n      const segments = [ls, new Bezier(fline), le, new Bezier(bline)];\n      return new PolyBezier(segments);\n    }\n\n    const reduced = this.reduce(),\n      len = reduced.length,\n      fcurves = [];\n\n    let bcurves = [],\n      p,\n      alen = 0,\n      tlen = this.length();\n\n    const graduated = typeof d3 !== \"undefined\" && typeof d4 !== \"undefined\";\n\n    function linearDistanceFunction(s, e, tlen, alen, slen) {\n      return function (v) {\n        const f1 = alen / tlen,\n          f2 = (alen + slen) / tlen,\n          d = e - s;\n        return utils.map(v, 0, 1, s + f1 * d, s + f2 * d);\n      };\n    }\n\n    // form curve oulines\n    reduced.forEach(function (segment) {\n      const slen = segment.length();\n      if (graduated) {\n        fcurves.push(\n          segment.scale(linearDistanceFunction(d1, d3, tlen, alen, slen))\n        );\n        bcurves.push(\n          segment.scale(linearDistanceFunction(-d2, -d4, tlen, alen, slen))\n        );\n      } else {\n        fcurves.push(segment.scale(d1));\n        bcurves.push(segment.scale(-d2));\n      }\n      alen += slen;\n    });\n\n    // reverse the \"return\" outline\n    bcurves = bcurves\n      .map(function (s) {\n        p = s.points;\n        if (p[3]) {\n          s.points = [p[3], p[2], p[1], p[0]];\n        } else {\n          s.points = [p[2], p[1], p[0]];\n        }\n        return s;\n      })\n      .reverse();\n\n    // form the endcaps as lines\n    const fs = fcurves[0].points[0],\n      fe = fcurves[len - 1].points[fcurves[len - 1].points.length - 1],\n      bs = bcurves[len - 1].points[bcurves[len - 1].points.length - 1],\n      be = bcurves[0].points[0],\n      ls = utils.makeline(bs, fs),\n      le = utils.makeline(fe, be),\n      segments = [ls].concat(fcurves).concat([le]).concat(bcurves);\n\n    return new PolyBezier(segments);\n  }\n\n  outlineshapes(d1, d2, curveIntersectionThreshold) {\n    d2 = d2 || d1;\n    const outline = this.outline(d1, d2).curves;\n    const shapes = [];\n    for (let i = 1, len = outline.length; i < len / 2; i++) {\n      const shape = utils.makeshape(\n        outline[i],\n        outline[len - i],\n        curveIntersectionThreshold\n      );\n      shape.startcap.virtual = i > 1;\n      shape.endcap.virtual = i < len / 2 - 1;\n      shapes.push(shape);\n    }\n    return shapes;\n  }\n\n  intersects(curve, curveIntersectionThreshold) {\n    if (!curve) return this.selfintersects(curveIntersectionThreshold);\n    if (curve.p1 && curve.p2) {\n      return this.lineIntersects(curve);\n    }\n    if (curve instanceof Bezier) {\n      curve = curve.reduce();\n    }\n    return this.curveintersects(\n      this.reduce(),\n      curve,\n      curveIntersectionThreshold\n    );\n  }\n\n  lineIntersects(line) {\n    const mx = min(line.p1.x, line.p2.x),\n      my = min(line.p1.y, line.p2.y),\n      MX = max(line.p1.x, line.p2.x),\n      MY = max(line.p1.y, line.p2.y);\n    return utils.roots(this.points, line).filter((t) => {\n      var p = this.get(t);\n      return utils.between(p.x, mx, MX) && utils.between(p.y, my, MY);\n    });\n  }\n\n  selfintersects(curveIntersectionThreshold) {\n    // \"simple\" curves cannot intersect with their direct\n    // neighbour, so for each segment X we check whether\n    // it intersects [0:x-2][x+2:last].\n\n    const reduced = this.reduce(),\n      len = reduced.length - 2,\n      results = [];\n\n    for (let i = 0, result, left, right; i < len; i++) {\n      left = reduced.slice(i, i + 1);\n      right = reduced.slice(i + 2);\n      result = this.curveintersects(left, right, curveIntersectionThreshold);\n      results.push(...result);\n    }\n    return results;\n  }\n\n  curveintersects(c1, c2, curveIntersectionThreshold) {\n    const pairs = [];\n    // step 1: pair off any overlapping segments\n    c1.forEach(function (l) {\n      c2.forEach(function (r) {\n        if (l.overlaps(r)) {\n          pairs.push({ left: l, right: r });\n        }\n      });\n    });\n    // step 2: for each pairing, run through the convergence algorithm.\n    let intersections = [];\n    pairs.forEach(function (pair) {\n      const result = utils.pairiteration(\n        pair.left,\n        pair.right,\n        curveIntersectionThreshold\n      );\n      if (result.length > 0) {\n        intersections = intersections.concat(result);\n      }\n    });\n    return intersections;\n  }\n\n  arcs(errorThreshold) {\n    errorThreshold = errorThreshold || 0.5;\n    return this._iterate(errorThreshold, []);\n  }\n\n  _error(pc, np1, s, e) {\n    const q = (e - s) / 4,\n      c1 = this.get(s + q),\n      c2 = this.get(e - q),\n      ref = utils.dist(pc, np1),\n      d1 = utils.dist(pc, c1),\n      d2 = utils.dist(pc, c2);\n    return abs(d1 - ref) + abs(d2 - ref);\n  }\n\n  _iterate(errorThreshold, circles) {\n    let t_s = 0,\n      t_e = 1,\n      safety;\n    // we do a binary search to find the \"good `t` closest to no-longer-good\"\n    do {\n      safety = 0;\n\n      // step 1: start with the maximum possible arc\n      t_e = 1;\n\n      // points:\n      let np1 = this.get(t_s),\n        np2,\n        np3,\n        arc,\n        prev_arc;\n\n      // booleans:\n      let curr_good = false,\n        prev_good = false,\n        done;\n\n      // numbers:\n      let t_m = t_e,\n        prev_e = 1,\n        step = 0;\n\n      // step 2: find the best possible arc\n      do {\n        prev_good = curr_good;\n        prev_arc = arc;\n        t_m = (t_s + t_e) / 2;\n        step++;\n\n        np2 = this.get(t_m);\n        np3 = this.get(t_e);\n\n        arc = utils.getccenter(np1, np2, np3);\n\n        //also save the t values\n        arc.interval = {\n          start: t_s,\n          end: t_e,\n        };\n\n        let error = this._error(arc, np1, t_s, t_e);\n        curr_good = error <= errorThreshold;\n\n        done = prev_good && !curr_good;\n        if (!done) prev_e = t_e;\n\n        // this arc is fine: we can move 'e' up to see if we can find a wider arc\n        if (curr_good) {\n          // if e is already at max, then we're done for this arc.\n          if (t_e >= 1) {\n            // make sure we cap at t=1\n            arc.interval.end = prev_e = 1;\n            prev_arc = arc;\n            // if we capped the arc segment to t=1 we also need to make sure that\n            // the arc's end angle is correct with respect to the bezier end point.\n            if (t_e > 1) {\n              let d = {\n                x: arc.x + arc.r * cos(arc.e),\n                y: arc.y + arc.r * sin(arc.e),\n              };\n              arc.e += utils.angle({ x: arc.x, y: arc.y }, d, this.get(1));\n            }\n            break;\n          }\n          // if not, move it up by half the iteration distance\n          t_e = t_e + (t_e - t_s) / 2;\n        } else {\n          // this is a bad arc: we need to move 'e' down to find a good arc\n          t_e = t_m;\n        }\n      } while (!done && safety++ < 100);\n\n      if (safety >= 100) {\n        break;\n      }\n\n      // console.log(\"L835: [F] arc found\", t_s, prev_e, prev_arc.x, prev_arc.y, prev_arc.s, prev_arc.e);\n\n      prev_arc = prev_arc ? prev_arc : arc;\n      circles.push(prev_arc);\n      t_s = prev_e;\n    } while (t_e < 1);\n    return circles;\n  }\n}\n\nexport { Bezier };\n", "import { Bezier, Offset } from \"bezier-js\"\nimport * as t from \"io-ts\"\nimport { BezierCoords, COLOR_ANCHOR_NEW, COLOR_MOUSE_OVER, COLOR_UNKNOWN, COLOR_WIRE, GRID_STEP, LineCoords, NodeStyle, OPACITY_HIDDEN_ITEMS, WAYPOINT_DIAMETER, WIRE_WIDTH, colorForLogicValue, distSquaredToWaypointIfOver, drawAnchorTo, drawStraightWireLine, drawWaypoint, makeBezierCoords, strokeWireOutline, strokeWireOutlineAndSingleValue, strokeWireValue } from \"../drawutils\"\nimport { span, style, title } from \"../htmlgen\"\nimport { DrawParams } from \"../LogicEditor\"\nimport { S } from \"../strings\"\nimport { Timestamp } from \"../Timeline\"\nimport { PointerDragEvent } from \"../UIEventManager\"\nimport { InteractionResult, LogicValue, Mode, isArray, isString, toLogicValueRepr, typeOrNull, typeOrUndefined } from \"../utils\"\nimport { Component, NodeGroup } from \"./Component\"\nimport { DrawContext, Drawable, DrawableParent, DrawableWithDraggablePosition, DrawableWithPosition, GraphicsRendering, MenuData, Orientation, Orientations_, PositionSupportRepr } from \"./Drawable\"\nimport { Node, NodeIn, NodeOut, WireColor, tryMakeRepeatableNodeAction } from \"./Node\"\nimport { Passthrough, PassthroughDef } from \"./Passthrough\"\nimport { WirePath } from \"./WirePath\"\n\n\ntype WaypointRepr = t.TypeOf<typeof Waypoint.Repr>\n\nexport class Waypoint extends DrawableWithDraggablePosition {\n\n    public static get Repr() {\n        return t.union([\n            // alternatives with more fields first\n            t.tuple([t.number, t.number, t.keyof(Orientations_), typeOrNull(t.string), t.partial({\n                lockPos: t.boolean,\n            })]),\n            t.tuple([t.number, t.number, t.keyof(Orientations_), t.string]),\n            t.tuple([t.number, t.number, t.keyof(Orientations_)]),\n            t.tuple([t.number, t.number]),\n        ], \"Wire\")\n    }\n\n    public static toSuperRepr(saved?: WaypointRepr | undefined): PositionSupportRepr | undefined {\n        if (saved === undefined) {\n            return undefined\n        }\n        const [posX, posY, orient, anchor, options] = saved\n        return {\n            pos: [posX, posY],\n            anchor: anchor === null ? undefined : anchor,\n            lockPos: options?.lockPos,\n            orient,\n            ref: undefined,\n        }\n    }\n\n    public constructor(\n        public readonly wire: Wire,\n        saved: WaypointRepr | undefined,\n    ) {\n        super(wire.parent, Waypoint.toSuperRepr(saved))\n    }\n\n    public toJSON(): WaypointRepr {\n        // check to determine representation (orientation, anchor, lockPos, etc.)\n        const anchor = this.anchor?.ref\n        if (this.lockPos) {\n            // full representation with obj as last element\n            return [this.posX, this.posY, this.orient, anchor ?? null, {\n                lockPos: this.lockPos,\n            }]\n        }\n        if (anchor !== undefined) {\n            // representation with string as last element\n            return [this.posX, this.posY, this.orient, anchor]\n        }\n        if (this.orient !== Orientation.default) {\n            // representation with 3 elements\n            return [this.posX, this.posY, this.orient]\n        }\n        // minimal representation with 2 elements\n        return [this.posX, this.posY]\n    }\n\n    public override doSetOrient(newOrient: Orientation) {\n        super.doSetOrient(newOrient)\n        this.wire.invalidateWirePath()\n    }\n\n    public get unrotatedWidth(): number {\n        return WAYPOINT_DIAMETER\n    }\n\n    public get unrotatedHeight(): number {\n        return WAYPOINT_DIAMETER\n    }\n\n    public override isOver(x: number, y: number) {\n        if (!(this.parent.mode >= Mode.CONNECT)) {\n            return false\n        }\n        return distSquaredToWaypointIfOver(x, y, this.posX, this.posY, false) !== undefined\n    }\n\n    protected override positionChanged(__delta: [number, number]) {\n        this.wire.invalidateWirePath()\n    }\n\n    public override cursorWhenMouseover(e?: PointerEvent) {\n        const mode = this.parent.mode\n        if ((e?.ctrlKey ?? false) && mode >= Mode.CONNECT) {\n            return \"context-menu\"\n        }\n        if (!this.lockPos && mode >= Mode.CONNECT) {\n            return \"grab\"\n        }\n        return undefined\n    }\n\n    public getPrevAndNextAnchors(): [DrawableWithPosition, DrawableWithPosition] {\n        const waypoints = this.wire.waypoints\n        const index = waypoints.indexOf(this)\n        const prev = index > 0 ? waypoints[index - 1] : this.wire.startNode\n        const next = index < waypoints.length - 1 ? waypoints[index + 1] : (this.wire.endNode ?? this.wire.startNode)\n        return [prev, next]\n    }\n\n    public removeFromParent() {\n        this.wire.removeWaypoint(this)\n    }\n\n    protected doDraw(g: GraphicsRendering, ctx: DrawContext): void {\n        if (this.parent.mode < Mode.CONNECT) {\n            return\n        }\n\n        if (this.wire.behavesHidden) {\n            return\n        }\n\n        g.globalAlpha = this.wire.isHidden ? OPACITY_HIDDEN_ITEMS : 1.0\n        const neutral = this.parent.editor.options.hideWireColors\n        drawWaypoint(g, ctx, this.posX, this.posY, NodeStyle.WAYPOINT, this.wire.startNode.value, ctx.isMouseOver, neutral, false, false, false)\n        g.globalAlpha = 1.0\n    }\n\n    public override makeContextMenu(): MenuData {\n        return [\n            ...this.makeOrientationAndPosMenuItems().map(it => it[1]),\n            MenuData.sep(),\n            MenuData.item(\"trash\", S.Components.Generic.contextMenu.Delete, () => {\n                this.removeFromParent()\n            }, \"\u232B\", true),\n        ]\n    }\n}\n\nexport const WireStyles = {\n    auto: \"auto\",\n    straight: \"straight\",\n    hv: \"hv\",\n    vh: \"vh\",\n    bezier: \"bezier\",\n} as const\n\nexport type WireStyle = keyof typeof WireStyles\n\ntype WireRepr = t.TypeOf<typeof Wire.Repr>\ntype WireOptions = Exclude<WireRepr[2], undefined>\n\nexport class Wire extends Drawable {\n\n    public static get Repr() {\n        const simpleRepr = t.tuple([t.number, t.number])\n        const fullRepr = t.tuple([\n            t.number, t.number,\n            // include an object specifying additional properties\n            t.type({\n                ref: typeOrUndefined(t.string),\n                via: typeOrUndefined(t.array(Waypoint.Repr)),\n                propagationDelay: typeOrUndefined(t.number),\n                style: typeOrUndefined(t.keyof(WireStyles)),\n                hidden: typeOrUndefined(t.boolean),\n            }),\n        ])\n        return t.union([fullRepr, simpleRepr], \"Wire\")\n    }\n\n    private _startNode: NodeOut\n    private _endNode: NodeIn\n    private _waypoints: Waypoint[] = []\n    private _wirePath: WirePath | undefined = undefined\n    private _style: WireStyle | undefined = undefined\n    private _isHidden = false\n    private _propagatingValues: [LogicValue, Timestamp][] = []\n    private _waypointBeingDragged: Waypoint | undefined = undefined\n    public customPropagationDelay: number | undefined = undefined\n    public ribbon: Ribbon | undefined = undefined\n\n    public constructor(startNode: NodeOut, endNode: NodeIn) {\n        const parent = startNode.parent\n        super(parent)\n\n        this._startNode = startNode\n        this._endNode = endNode\n\n        const longAgo = Number.MIN_SAFE_INTEGER / 2\n        this._propagatingValues.push([startNode.value, longAgo])\n\n        this.setStartNode(startNode)\n        this.setEndNode(endNode)\n    }\n\n    // called immediately after construction by Serialization\n    public setOptions(wireOptions: WireOptions, componentsByRef: Record<string, Component>) {\n        this.doSetValidatedId(wireOptions.ref)\n        if (wireOptions.via !== undefined) {\n            this.setWaypoints(wireOptions.via, componentsByRef)\n        }\n        if (wireOptions.propagationDelay !== undefined) {\n            this.customPropagationDelay = wireOptions.propagationDelay\n        }\n        if (wireOptions.style !== undefined) {\n            this.doSetStyle(wireOptions.style)\n        }\n        if (wireOptions.hidden !== undefined) {\n            this.doSetHidden(wireOptions.hidden)\n        }\n    }\n\n    public toJSON(): WireRepr {\n        const endID = this._endNode.id\n        if (this._waypoints.length === 0 && this.customPropagationDelay === undefined && this.ref === undefined && this.style === undefined && !this.isHidden) {\n            // no need for node options\n            return [this._startNode.id, endID]\n\n        } else {\n            // add node options\n            const waypoints = this._waypoints.map(w => w.toJSON())\n            return [this._startNode.id, endID, {\n                ref: this.ref,\n                via: (waypoints.length === 0) ? undefined : waypoints,\n                propagationDelay: this.customPropagationDelay,\n                style: this.style,\n                hidden: this.isHidden === false ? undefined : this.isHidden,\n            }]\n        }\n    }\n\n    public get startNode(): NodeOut {\n        return this._startNode\n    }\n\n    public get endNode(): NodeIn {\n        return this._endNode\n    }\n\n    public isInRect(__rect: DOMRect) {\n        return false\n    }\n\n    public get waypoints(): readonly Waypoint[] {\n        return this._waypoints\n    }\n\n    public setWaypoints(reprs: WaypointRepr[], componentsByRef: Record<string, Component>) {\n        this._waypoints = reprs.map(repr => {\n            const wp = new Waypoint(this, repr)\n            const anchorRef = repr[3]\n            if (isString(anchorRef)) {\n                const anchor = componentsByRef[anchorRef]\n                if (anchor !== undefined) {\n                    wp.anchor = anchor\n                } else {\n                    console.warn(`Couldn't find anchor '${anchorRef}' for waypoint of wire between ${this._startNode.component.ref} and ${this._endNode.component.ref}`)\n                }\n            }\n            return wp\n        })\n    }\n\n    private get wirePath(): WirePath {\n        if (this._wirePath === undefined) {\n            // eslint-disable-next-line prefer-const\n            let [startX, startY, prevX, prevY, prevProlong] = this.startNode.drawCoords\n            const [endLeadX, endLeadY, endNodeX, endNodeY, endNodeProlong] = this.endNode.drawCoords\n            const lastWaypointData = { posX: endNodeX, posY: endNodeY, orient: endNodeProlong }\n            const allWaypoints = [...this._waypoints, lastWaypointData]\n\n            const pathParts: Array<LineCoords | BezierCoords> =\n                [[startX, startY, prevX, prevY]] // first part, start lead\n            const wireStyle = this.style ?? this.startNode.parent.editor.options.wireStyle\n            for (const waypoint of allWaypoints) {\n                const nextX = waypoint.posX\n                const nextY = waypoint.posY\n                const deltaX = nextX - prevX\n                const deltaY = nextY - prevY\n                const nextProlong = waypoint.orient\n                let c1x, c1y, c2x, c2y\n                if (wireStyle === WireStyles.straight || (wireStyle === WireStyles.auto && (prevX === nextX || prevY === nextY))) {\n                    // straight line\n                    pathParts.push([prevX, prevY, nextX, nextY])\n                } else if (wireStyle === WireStyles.hv) {\n                    // horizontal then vertical line\n                    if (prevX !== nextX) {\n                        pathParts.push([prevX, prevY, nextX, prevY])\n                    }\n                    if (prevY !== nextY) {\n                        pathParts.push([nextX, prevY, nextX, nextY])\n                    }\n                } else if (wireStyle === WireStyles.vh) {\n                    // vertical then horizontal line\n                    if (prevY !== nextY) {\n                        pathParts.push([prevX, prevY, prevX, nextY])\n                    }\n                    if (prevX !== nextX) {\n                        pathParts.push([prevX, nextY, nextX, nextY])\n                    }\n                } else {\n                    // bezier curve\n                    const bezierAnchorPointDistX = Math.max(25, Math.abs(deltaX) / 3)\n                    const bezierAnchorPointDistY = Math.max(25, Math.abs(deltaY) / 3);\n\n                    // first anchor point\n                    [c1x, c1y] = bezierAnchorForWire(prevProlong, prevX, prevY, bezierAnchorPointDistX, bezierAnchorPointDistY);\n                    [c2x, c2y] = bezierAnchorForWire(nextProlong, nextX, nextY, bezierAnchorPointDistX, bezierAnchorPointDistY)\n                    pathParts.push(makeBezierCoords([prevX, prevY, nextX, nextY, c1x, c1y, c2x, c2y]))\n                }\n\n                prevX = nextX\n                prevY = nextY\n                prevProlong = Orientation.invert(nextProlong)\n            }\n            // last part, end lead\n            pathParts.push([prevX, prevY, endLeadX, endLeadY])\n\n            this._wirePath = new WirePath(pathParts)\n        }\n        return this._wirePath\n    }\n\n    public invalidateWirePath() {\n        this._wirePath = undefined\n    }\n\n    public get style() {\n        return this._style\n    }\n\n    public doSetStyle(style: WireStyle | undefined) {\n        this._style = style\n        this.invalidateWirePath()\n        this.requestRedraw({ why: \"style changed\", invalidateMask: true })\n    }\n\n    public get isHidden() {\n        return this._isHidden\n    }\n\n    public get behavesHidden() {\n        return this._isHidden && !this.parent.editor.options.showHiddenWires\n    }\n\n    public doSetHidden(hidden: boolean) {\n        this._isHidden = hidden\n        this.requestRedraw({ why: \"hidden changed\", invalidateMask: true })\n    }\n\n    public setStartNode(startNode: NodeOut, now?: Timestamp) {\n        if (this._startNode !== undefined) {\n            this._startNode.removeOutgoingWire(this)\n        }\n\n        this._startNode = startNode\n        startNode.addOutgoingWire(this)\n\n        if (now !== undefined) {\n            this.propagateNewValue(this._startNode.value, now)\n        }\n\n        this.invalidateWirePath()\n    }\n\n    public setEndNode(endNode: NodeIn) {\n        if (this._endNode !== undefined) {\n            this._endNode.incomingWire = null\n        }\n        this._endNode = endNode\n        if (endNode.incomingWire !== null && endNode.incomingWire !== undefined) {\n            console.warn(`Unexpectedly replacing existing incoming wire on node ${this._endNode.id}`)\n        }\n        endNode.incomingWire = this\n        endNode.value = this._startNode.value\n        endNode.doSetColor(this._startNode.color)\n\n        this.invalidateWirePath()\n    }\n\n    public propagateNewValue(newValue: LogicValue, logicalTime: Timestamp) {\n        if (this._propagatingValues[this._propagatingValues.length - 1][0] !== newValue) {\n            this._propagatingValues.push([newValue, logicalTime])\n        }\n        const propagationDelay = this.customPropagationDelay ?? this.parent.editor.options.propagationDelay\n        if (propagationDelay === 0) {\n            this.endNode.value = newValue\n            // remove all but the last value\n            this._propagatingValues.splice(0, this._propagatingValues.length - 1)\n        } else {\n            const desc = S.Components.Wire.timeline.PropagatingValue.expand({ val: toLogicValueRepr(newValue) })\n            this.parent.editor.timeline.scheduleAt(logicalTime + propagationDelay, () => {\n                this.endNode.value = newValue\n            }, desc, false)\n        }\n    }\n\n    public destroy() {\n        if (Node.isOutput(this._startNode)) {\n            this._startNode.removeOutgoingWire(this)\n        }\n        if (this._endNode !== null) {\n            this._endNode.incomingWire = null\n        }\n        // for (const waypoint of this._waypoints) {\n        //     waypoint.destroy()\n        // }\n    }\n\n    public get isAlive() {\n        return this.startNode.isAlive && this.endNode.isAlive\n    }\n\n    public addPassthroughFrom(e: MouseEvent): Passthrough | undefined {\n        const parent = this.parent\n        const [x, y] = parent.editor.offsetXYForContextMenu(e, true)\n        const endNode = this.endNode\n\n        const passthrough = PassthroughDef.make<Passthrough>(parent, { bits: 1 })\n        passthrough.setSpawned()\n        passthrough.setPosition(x, y, false)\n        // passthrough.anchor = this.startNode.component // this is too intrusive\n\n        // modify this wire to go to the passthrough\n        this.setEndNode(passthrough.inputs.In[0])\n\n        // create a new wire from the passthrough to the end node\n        const newWire = parent.linkMgr.addWire(passthrough.outputs.Out[0], endNode, false)\n        if (newWire === undefined) {\n            console.warn(\"Couldn't create new wire\")\n            return\n        }\n        newWire.doSetStyle(this.style)\n        return passthrough\n    }\n\n    public addWaypointFrom(e: MouseEvent): Waypoint {\n        const [x, y] = this.parent.editor.offsetXYForContextMenu(e, false)\n        return this.addWaypointWith(x, y)\n    }\n\n    public addWaypointWith(x: number, y: number): Waypoint {\n        const wirePath = this.wirePath\n        let partIndex = wirePath.partIndexIfMouseover(x, y)\n        if (partIndex === undefined) {\n            // shouldn't happen since we're calling this form a context menu\n            // which was invoked when we were in a mouseover state\n            console.warn(`Couldn't find waypoint to insert at for (${x}, ${y})`)\n            partIndex = 1\n        }\n\n        // determine initial direction\n        const [startX, startY, endX, endY] = wirePath.parts[partIndex]\n        const deltaX = endX - startX\n        const deltaY = endY - startY\n\n        let orient: Orientation\n        if (Math.abs(deltaX) >= Math.abs(deltaY)) {\n            // initial orientation will be horizontal\n            if (endX >= startX) {\n                orient = \"e\"\n            } else {\n                orient = \"w\"\n            }\n        } else {\n            // initial orientation will be vertical\n            if (endY >= startY) {\n                orient = \"s\"\n            } else {\n                orient = \"n\"\n            }\n        }\n\n        const waypoint = new Waypoint(this, [x, y, orient])\n        // waypoint.anchor = this.startNode.component // this is too intrusive\n        // partIndex - 1 because there is always a \"lead\" part before the main connecting parts (and also an end part, which we don't care about)\n        this._waypoints.splice(partIndex - 1, 0, waypoint)\n        this.invalidateWirePath()\n        return waypoint\n    }\n\n    public removeWaypoint(waypoint: Waypoint) {\n        const i = this._waypoints.indexOf(waypoint)\n        if (i !== -1) {\n            this._waypoints.splice(i, 1)\n            this.invalidateWirePath()\n            this.requestRedraw({ why: \"waypoint deleted\", invalidateMask: true })\n        }\n    }\n\n    private prunePropagatingValues(now: Timestamp, propagationDelay: number): LogicValue {\n        // first, prune obsolete values if needed\n        let removeBefore = 0\n        for (let i = 1; i < this._propagatingValues.length; i++) {\n            if (now >= this._propagatingValues[i][1] + propagationDelay) {\n                // item i has fully propagated\n                removeBefore = i\n            } else {\n                // item i is still propagating\n                break\n            }\n        }\n        if (removeBefore > 0) {\n            this._propagatingValues.splice(0, removeBefore)\n        }\n        return this._propagatingValues[0][0]\n    }\n\n    protected doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        // this has to be checked _before_ we prune the list,\n        // otherwise we won't get a chance to have a next animation frame\n        // and to run the pending updates created by possibly setting\n        // the value of the end node\n        const isAnimating = this._propagatingValues.length > 1\n\n        const options = this.parent.editor.options\n        const propagationDelay = this.customPropagationDelay ?? options.propagationDelay\n        const neutral = options.hideWireColors\n        const drawTime = ctx.drawParams.drawTime\n        this.prunePropagatingValues(drawTime, propagationDelay)\n\n        if (this.behavesHidden) {\n            return\n        }\n\n        g.globalAlpha = this._isHidden ? OPACITY_HIDDEN_ITEMS : 1.0\n\n        const wirePath = this.wirePath\n        wirePath.draw(g)\n\n        const drawParams = ctx.drawParams\n        // highlight if needed\n        if (drawParams.highlightColor !== undefined && (drawParams.highlightedItems?.wires.includes(this) ?? false)) {\n            g.lineWidth = 15\n            g.shadowColor = drawParams.highlightColor\n            g.shadowBlur = 20\n            g.shadowOffsetX = 0\n            g.shadowOffsetY = 0\n            g.strokeStyle = g.shadowColor\n            g.stroke()\n            g.shadowBlur = 0 // reset\n        }\n\n        // outline\n        const color = this._startNode.color\n        strokeWireOutline(g, color, ctx.isMouseOver)\n        // single value\n        if (this._propagatingValues.length === 1) {\n            // no need to compute the length of the path, which is costly\n            const [value, timeSet] = this._propagatingValues[0]\n            const frac = Math.min(1.0, (drawTime - timeSet) / propagationDelay)\n            if (frac < 1.0) {\n                console.warn(`Propagating value not fully propagated but drawn as such (frac=${frac} < 1.0, drawTime=${drawTime}, timeSet=${timeSet}, propagationDelay=${propagationDelay})`)\n            }\n            strokeWireValue(g, value, undefined, neutral, drawParams.drawTimeAnimationFraction)\n\n        } else {\n            // multiple propagating values\n            const totalLength = wirePath.length\n            for (const [value, timeSet] of this._propagatingValues) {\n                const frac = Math.min(1.0, (drawTime - timeSet) / propagationDelay)\n                const lengthToDraw = totalLength * frac\n                strokeWireValue(g, value, [lengthToDraw, totalLength], neutral, drawParams.drawTimeAnimationFraction)\n            }\n        }\n\n        // wirePath.drawBezierDebug(g)\n\n        g.globalAlpha = 1.0\n\n        if (isAnimating && !this.parent.editor.timeline.isPaused) {\n            this.requestRedraw({ why: \"propagating value\", isPropagation: true })\n        }\n    }\n\n    public isOver(x: number, y: number): boolean {\n        if (this.parent.mode < Mode.CONNECT || !this.startNode.isAlive || !this.endNode.isAlive || this.behavesHidden) {\n            return false\n        }\n        return this.wirePath.isOver(x, y)\n    }\n\n    public override pointerDown(e: PointerEvent) {\n        if (e.altKey && this.parent.mode >= Mode.DESIGN) {\n            const passthrough = this.addPassthroughFrom(e)\n            if (passthrough !== undefined) {\n                return passthrough.outputs.Out[0].pointerDown(e)\n            }\n        }\n        return super.pointerDown(e)\n    }\n\n    public override pointerDragged(e: PointerDragEvent) {\n        if (this._waypointBeingDragged !== undefined) {\n            this._waypointBeingDragged.pointerDragged(e)\n        } else {\n            if (this.parent.editor.eventMgr.currentSelectionEmpty()) {\n                const waypoint = this.addWaypointFrom(e)\n                this._waypointBeingDragged = waypoint\n                waypoint.pointerDown(e)\n                waypoint.pointerDragged(e)\n            }\n        }\n    }\n\n    public override pointerUp(e: PointerEvent) {\n        if (this._waypointBeingDragged !== undefined) {\n            this._waypointBeingDragged.pointerUp(e)\n            this._waypointBeingDragged = undefined\n            return InteractionResult.SimpleChange\n        }\n        return InteractionResult.NoChange\n    }\n\n    public override makeContextMenu(): MenuData {\n\n        const s = S.Components.Wire.contextMenu\n        const currentPropDelayStr = this.customPropagationDelay === undefined ? \"\" : ` (${this.customPropagationDelay} ms)`\n\n        const makeItemUseColor = (desc: string, color: WireColor) => {\n            const isCurrent = this._startNode.color === color\n            const icon = isCurrent ? \"check\" : \"none\"\n            const action = isCurrent ? () => undefined : () => this._startNode.doSetColor(color)\n            const cssColor = COLOR_WIRE[color]\n            return MenuData.item(icon, span(title(desc), style(`display: inline-block; width: 140px; height: ${WIRE_WIDTH}px; background-color: ${cssColor}; margin-right: 8px`)), action)\n        }\n\n\n        const makeItemDisplayStyle = (desc: string, style: WireStyle | undefined) => {\n            const isCurrent = this.style === style\n            const icon = isCurrent ? \"check\" : \"none\"\n            const action = isCurrent ? () => undefined : () => this.doSetStyle(style)\n            return MenuData.item(icon, desc, action)\n        }\n\n        const hiddenMenuItem =\n            MenuData.item(this.isHidden ? \"check\" : \"none\", s.HiddenWire, () => {\n                this.doSetHidden(!this.isHidden)\n            })\n\n        const setWireOptionsItems =\n            this.parent.mode < Mode.DESIGN ? [] : [\n                MenuData.sep(),\n                MenuData.item(\"timer\", s.CustomPropagationDelay.expand({ current: currentPropDelayStr }), (__itemEvent) => {\n                    const currentStr = this.customPropagationDelay === undefined ? \"\" : String(this.customPropagationDelay)\n                    const defaultDelay = String(this.parent.editor.options.propagationDelay)\n                    const message = s.CustomPropagationDelayDesc.expand({ current: defaultDelay })\n                    const newValueStr = prompt(message, currentStr)\n                    if (newValueStr !== null) {\n                        if (newValueStr === \"\") {\n                            this.customPropagationDelay = undefined\n                        } else {\n                            const asInt = parseInt(newValueStr)\n                            if (!isNaN(asInt)) {\n                                this.customPropagationDelay = asInt\n                            }\n                        }\n                    }\n                }),\n                MenuData.submenu(\"palette\", s.WireColor, [\n                    makeItemUseColor(s.WireColorBlack, WireColor.black),\n                    makeItemUseColor(s.WireColorRed, WireColor.red),\n                    makeItemUseColor(s.WireColorBlue, WireColor.blue),\n                    makeItemUseColor(s.WireColorYellow, WireColor.yellow),\n                    makeItemUseColor(s.WireColorGreen, WireColor.green),\n                    makeItemUseColor(s.WireColorWhite, WireColor.white),\n                ]),\n                MenuData.submenu(\"wirestyle\", s.WireStyle, [\n                    makeItemDisplayStyle(s.WireStyleDefault, undefined),\n                    MenuData.sep(),\n                    makeItemDisplayStyle(s.WireStyleAuto, WireStyles.auto),\n                    makeItemDisplayStyle(s.WireStyleStraight, WireStyles.straight),\n                    makeItemDisplayStyle(s.WireStyleSquareHV, WireStyles.hv),\n                    makeItemDisplayStyle(s.WireStyleSquareVH, WireStyles.vh),\n                    makeItemDisplayStyle(s.WireStyleCurved, WireStyles.bezier),\n                ]),\n\n                MenuData.sep(),\n                hiddenMenuItem,\n            ]\n\n        const setRefItems =\n            this.parent.mode < Mode.FULL ? [] : [\n                MenuData.sep(),\n                this.makeSetIdContextMenuItem(),\n            ]\n\n        return [\n            MenuData.item(\"add\", s.AddMiddlePoint, (__itemEvent, contextEvent) => {\n                this.addWaypointFrom(contextEvent)\n            }),\n            MenuData.item(\"add\", s.AddPassthrough, (__itemEvent, contextEvent) => {\n                this.addPassthroughFrom(contextEvent)\n            }),\n            ...setWireOptionsItems,\n            ...setRefItems,\n            MenuData.sep(),\n            MenuData.item(\"trash\", S.Components.Generic.contextMenu.Delete, () => {\n                return this.parent.linkMgr.deleteWire(this)\n            }, \"\u232B\", true),\n        ]\n    }\n\n}\n\nexport class Ribbon extends Drawable {\n\n    private _startGroupStartIndex = Number.MAX_SAFE_INTEGER\n    private _startGroupEndIndex = Number.MIN_SAFE_INTEGER\n    private _endGroupStartIndex = Number.MAX_SAFE_INTEGER\n    private _endGroupEndIndex = Number.MIN_SAFE_INTEGER\n    private _coveredWires: Wire[] = []\n    // private _startNodes: NodeOut[] = []\n    // private _endNodes: NodeIn[] = []\n\n    public constructor(parent: DrawableParent,\n        public readonly startNodeGroup: NodeGroup<NodeOut>,\n        public readonly endNodeGroup: NodeGroup<NodeIn>,\n    ) {\n        super(parent)\n    }\n\n    public isEmpty() {\n        return this._coveredWires.length === 0\n    }\n\n    public addCoveredWire(wire: Wire, newNodeGroupStartIndex: number, newNodeGroupEndIndex: number) {\n        this._coveredWires.push(wire)\n        this.updateIndices(newNodeGroupStartIndex, newNodeGroupEndIndex)\n    }\n\n    public wireWasDeleted(__wire: Wire) {\n        // TODO check ribbons here\n        // const index = this._coveredWires.indexOf(wire)\n        // if (index >= 0) {\n        //     this._coveredWires.splice(index, 1)\n        // }\n        // // remove start node\n        // const startNode = wire.startNode\n        // const startNodeIndex = this._startNodes.indexOf(startNode)\n        // if (startNodeIndex >= 0) {\n        //     this._startNodes.splice(startNodeIndex, 1)\n        // }\n        // // remove end node\n        // const endNode = wire.endNode\n        // const endNodeIndex = this._endNodes.indexOf(endNode)\n        // if (endNodeIndex >= 0) {\n        //     this._endNodes.splice(endNodeIndex, 1)\n        // }\n        // // recalculate start and end group indices\n        // this._startGroupStartIndex = Number.MAX_SAFE_INTEGER\n        // this._startGroupEndIndex = Number.MIN_SAFE_INTEGER\n        // this._endGroupStartIndex = Number.MAX_SAFE_INTEGER\n        // this._endGroupEndIndex = Number.MIN_SAFE_INTEGER\n        // for (const coveredWire of this._coveredWires) {\n\n        //     this.updateIndices(coveredWire)\n        // }\n    }\n\n    private updateIndices(newNodeGroupStartIndex: number, newNodeGroupEndIndex: number) {\n        this._startGroupStartIndex = Math.min(this._startGroupStartIndex, newNodeGroupStartIndex)\n        this._startGroupEndIndex = Math.max(this._startGroupEndIndex, newNodeGroupStartIndex)\n        this._endGroupStartIndex = Math.min(this._endGroupStartIndex, newNodeGroupEndIndex)\n        this._endGroupEndIndex = Math.max(this._endGroupEndIndex, newNodeGroupEndIndex)\n    }\n\n\n    protected doDraw(g: GraphicsRendering, ctx: DrawContext): void {\n        const [[startX, startY], startOrient] = this.drawRibbonEnd(g, ctx, this.startNodeGroup, this._startGroupStartIndex, this._startGroupEndIndex)\n        const [[endX, endY], endOrient] = this.drawRibbonEnd(g, ctx, this.endNodeGroup, this._endGroupStartIndex, this._endGroupEndIndex)\n\n        const deltaX = endX - startX\n        const deltaY = endY - startY\n        // bezier curve\n        const bezierAnchorPointDistX = Math.max(25, Math.abs(deltaX) / 3)\n        const bezierAnchorPointDistY = Math.max(25, Math.abs(deltaY) / 3)\n\n        // first anchor point\n        const [anchor1X, anchor1Y] = bezierAnchorForWire(Orientation.invert(startOrient), startX, startY, bezierAnchorPointDistX, bezierAnchorPointDistY)\n        const [anchor2X, anchor2Y] = bezierAnchorForWire(Orientation.invert(endOrient), endX, endY, bezierAnchorPointDistX, bezierAnchorPointDistY)\n\n        const b = new Bezier(startX, startY, anchor1X, anchor1Y, anchor2X, anchor2Y, endX, endY)\n\n        const values: LogicValue[] = []\n        for (let i = this._startGroupStartIndex; i <= this._startGroupEndIndex; i++) {\n            values.push(this.startNodeGroup.nodes[i].value)\n        }\n        this.strokeWireBezier(g, b, values, WireColor.black, ctx.isMouseOver, false)\n    }\n\n    private strokeWireBezier(g: GraphicsRendering, b: Bezier, values: LogicValue[], color: WireColor, isMouseOver: boolean, neutral: boolean) {\n        const numWires = values.length\n\n        const WIRE_MARGIN_OUTER = (numWires === 1) ? 1 : (numWires <= 4 || numWires > 8) ? 2 : 3\n        const WIRE_MARGIN_INNER = 1\n        const WIRE_WIDTH = (numWires <= 8) ? 2 : 1\n\n        if (numWires === 0) {\n            return\n        }\n\n        const totalWidth = 2 * WIRE_MARGIN_OUTER + numWires * WIRE_WIDTH + (numWires - 1) * WIRE_MARGIN_INNER\n\n        const addBezierToPath = (b: Bezier) => {\n            const [p0, a0, a1, p1] = b.points\n            g.moveTo(p0.x, p0.y)\n            g.bezierCurveTo(a0.x, a0.y, a1.x, a1.y, p1.x, p1.y)\n        }\n\n        const drawBezier = (b: Bezier) => {\n            g.beginPath()\n            addBezierToPath(b)\n            g.stroke()\n        }\n\n        const drawBeziers = (bs: Offset | Bezier[]) => {\n            if (isArray(bs)) {\n                g.beginPath()\n                for (const bb of bs) {\n                    addBezierToPath(bb)\n                }\n                g.stroke()\n            }\n        }\n\n        const oldLineCap = g.lineCap\n        g.lineCap = \"butt\"\n\n        // margin\n        if (isMouseOver) {\n            g.lineWidth = totalWidth + 2\n            g.strokeStyle = COLOR_MOUSE_OVER\n            drawBezier(b)\n            g.lineWidth = totalWidth - 2 * WIRE_MARGIN_OUTER\n        } else {\n            g.lineWidth = totalWidth\n        }\n\n        g.strokeStyle = COLOR_WIRE[color]\n        drawBezier(b)\n\n        g.lineWidth = WIRE_WIDTH\n        let dist = -((numWires - 1) / 2) * (WIRE_WIDTH + WIRE_MARGIN_INNER)\n        for (const value of values) {\n            g.strokeStyle = neutral ? COLOR_UNKNOWN : colorForLogicValue(value)\n            const b1 = b.offset(dist)\n            drawBeziers(b1)\n            dist += WIRE_WIDTH + WIRE_MARGIN_INNER\n        }\n\n        // restore\n        g.lineCap = oldLineCap\n    }\n\n    private drawRibbonEnd(g: GraphicsRendering, ctx: DrawContext, nodeGroup: NodeGroup<Node>, startIndex: number, endIndex: number): [readonly [number, number], Orientation] {\n        const nodes = nodeGroup.nodes\n        const orient = nodes[startIndex].orient\n        const numNodes = endIndex - startIndex + 1\n\n        let minX = Number.POSITIVE_INFINITY\n        let minY = Number.POSITIVE_INFINITY\n        let maxX = Number.NEGATIVE_INFINITY\n        let maxY = Number.NEGATIVE_INFINITY\n        let sumX = 0\n        let sumY = 0\n        for (let i = startIndex; i <= endIndex; i++) {\n            const node = nodes[i]\n            const x = node.posX\n            const y = node.posY\n            minX = Math.min(minX, x)\n            minY = Math.min(minY, y)\n            maxX = Math.max(maxX, x)\n            maxY = Math.max(maxY, y)\n            sumX += x\n            sumY += y\n        }\n\n        const [[startX, startY], [endX, endY], mid] = (() => {\n            switch (orient) {\n                case \"e\": return [[maxX, minY], [maxX, maxY], [maxX, sumY / numNodes]] as const\n                case \"w\": return [[minX, minY], [minX, maxY], [minX, sumY / numNodes]] as const\n                case \"s\": return [[minX, minY], [maxX, minY], [sumX / numNodes, minY]] as const\n                case \"n\": return [[minX, maxY], [maxX, maxY], [sumX / numNodes, maxY]] as const\n            }\n        })()\n\n        drawStraightWireLine(g, startX, startY, endX, endY, \"Z\", \"black\", true, ctx.drawParams.drawTimeAnimationFraction)\n        return [mid, orient]\n    }\n\n\n    public isOver(__x: number, __y: number): boolean {\n        return false // TODO\n    }\n    public isInRect(__rect: DOMRect): boolean {\n        return false // TODO\n    }\n\n}\n\n\n\n/**\n * Manages links between components, i.e., wires and ribbons, and the anchor being set.\n */\nexport class LinkManager {\n\n    public readonly parent: DrawableParent\n\n    // wires and ribbons\n    private readonly _wires: Wire[] = []\n    private readonly _ribbons: Ribbon[] = []\n    private _wireBeingAddedFrom: Node | undefined = undefined\n\n    // anchors\n    private _anchorBeingSetFrom: DrawableWithPosition | undefined = undefined\n\n    public constructor(parent: DrawableParent) {\n        this.parent = parent\n    }\n\n    public get wires(): readonly Wire[] {\n        return this._wires\n    }\n\n    public get ribbons(): readonly Ribbon[] {\n        return this._ribbons\n    }\n\n    public get isAddingWire() {\n        return this._wireBeingAddedFrom !== undefined\n    }\n\n    public get isSettingAnchor() {\n        return this._anchorBeingSetFrom !== undefined\n    }\n\n    public draw(g: GraphicsRendering, drawParams: DrawParams) {\n        this.removeDeadWires()\n        const useRibbons = this.parent.editor.options.groupParallelWires\n        if (useRibbons) {\n            for (const ribbon of this._ribbons) {\n                ribbon.draw(g, drawParams)\n            }\n        }\n        for (const wire of this._wires) {\n            if (useRibbons && wire.ribbon !== undefined) {\n                continue\n            }\n            wire.draw(g, drawParams)\n            for (const waypoint of wire.waypoints) {\n                waypoint.draw(g, drawParams)\n            }\n        }\n        this.drawWireBeingAdded(g, drawParams)\n        this.drawAnchorBeingSet(g)\n    }\n\n    private drawWireBeingAdded(g: GraphicsRendering, drawParams: DrawParams) {\n        // TODO use some PartialWire class to draw this and allow adding waypoints\n        // while dragging, e.g. with the A or Space key\n        const nodeFrom = this._wireBeingAddedFrom\n        if (nodeFrom !== undefined) {\n            const x1 = nodeFrom.posX\n            const y1 = nodeFrom.posY\n            const editor = this.parent.editor\n            const x2 = editor.pointerX\n            const y2 = editor.pointerY\n            g.beginPath()\n            g.moveTo(x1, y1)\n            if (this.parent.editor.options.wireStyle === WireStyles.straight) {\n                g.lineTo(x2, y2)\n            } else {\n                const deltaX = x2 - x1\n                const deltaY = y2 - y1\n                // bezier curve\n                const bezierAnchorPointDistX = Math.max(25, Math.abs(deltaX) / 3)\n                const bezierAnchorPointDistY = Math.max(25, Math.abs(deltaY) / 3)\n\n                // first anchor point\n                const outgoingOrient = Orientation.add(nodeFrom.component.orient, nodeFrom.orient)\n                const [a1x, a1y] = bezierAnchorForWire(Orientation.invert(outgoingOrient), x1, y1, bezierAnchorPointDistX, bezierAnchorPointDistY)\n                const [a2x, a2y] = bezierAnchorForWire(outgoingOrient, x2, y2, bezierAnchorPointDistX, bezierAnchorPointDistY)\n                g.bezierCurveTo(a1x, a1y, a2x, a2y, x2, y2)\n            }\n            strokeWireOutlineAndSingleValue(g, nodeFrom.value, nodeFrom.color, false, drawParams.drawTimeAnimationFraction)\n        }\n    }\n\n    private drawAnchorBeingSet(g: GraphicsRendering) {\n        const drawable = this._anchorBeingSetFrom\n        if (drawable !== undefined) {\n            const x1 = drawable.posX\n            const y1 = drawable.posY\n            const editor = this.parent.editor\n            const x2 = editor.pointerX\n            const y2 = editor.pointerY\n            drawAnchorTo(g, x1, y1, x2, y2, 6, COLOR_ANCHOR_NEW, undefined)\n        }\n    }\n\n    private removeDeadWires() {\n        let i = 0\n        while (i < this._wires.length) {\n            const wire = this._wires[i]\n            if (!wire.isAlive) {\n                wire.destroy()\n                this._wires.splice(i, 1)\n            } else {\n                i++\n            }\n        }\n    }\n\n    public addWire(startNode: NodeOut, endNode: NodeIn, tryOffset: boolean): Wire | undefined {\n        if (!startNode.acceptsMoreConnections || !endNode.acceptsMoreConnections) {\n            return undefined\n        }\n        const wire = new Wire(startNode, endNode)\n        this._wires.push(wire)\n        if (tryOffset) {\n            // done only when creating a new wire manually\n            this.offsetWireIfNeeded(wire)\n        }\n        this.tryMergeWire(wire)\n        this.parent.ifEditing?.setToolCursor(null)\n        this.parent.ifEditing?.setDirty(\"added wire\")\n        this.parent.ifEditing?.redrawMgr.requestRedraw({ why: \"wire added\", invalidateMask: true, invalidateTests: true })\n        return wire\n    }\n\n    public startSettingAnchorFrom(drawable: DrawableWithPosition) {\n        if (this._anchorBeingSetFrom !== undefined) {\n            console.warn(\"LinkManager.startSettingAnchorFrom: already setting anchor from a drawable\")\n        }\n        this._anchorBeingSetFrom = drawable\n        this.parent.ifEditing?.setToolCursor(\"alias\")\n    }\n\n    public stopSettingAnchorOn(comp: Component): InteractionResult {\n        const anchorBeingSetFrom = this._anchorBeingSetFrom\n        if (anchorBeingSetFrom) {\n            return this.trySetAnchor(anchorBeingSetFrom, comp)\n        }\n        return InteractionResult.NoChange\n    }\n\n    public trySetAnchor(from: DrawableWithPosition, to: Component): InteractionResult {\n        this.tryCancelSetAnchor()\n\n        if (to.ref === undefined) {\n            console.warn(\"LinkManager.stopSettingAnchorOn: component has no ref\")\n        }\n        if (to !== from) {\n            let forbidden = false\n            let current = to\n            while (current.anchor !== undefined) {\n                current = current.anchor\n                if (current === from) {\n                    forbidden = true\n                    break\n                }\n            }\n            if (forbidden) {\n                this.parent.editor.showMessage(S.Messages.CircularAnchorsForbidden)\n            } else {\n                from.anchor = to\n                this.parent.editor.showMessage(S.Messages.AnchorAdded)\n                return InteractionResult.SimpleChange\n            }\n        }\n        return InteractionResult.NoChange\n    }\n\n    public tryCancelSetAnchor() {\n        this._anchorBeingSetFrom = undefined\n        this.parent.ifEditing?.setToolCursor(null)\n    }\n\n    public startDraggingWireFrom(node: Node) {\n        if (this._wireBeingAddedFrom !== undefined) {\n            console.warn(\"LinkManager.startDraggingFrom: already dragging from a node\")\n        }\n        if (!node.acceptsMoreConnections) {\n            return\n        }\n        this._wireBeingAddedFrom = node\n        this.parent.ifEditing?.setToolCursor(\"crosshair\")\n    }\n\n    public stopDraggingWireOn(newNode: Node): Wire | undefined {\n        const nodes = this.getOutInNodesForNewWire(newNode)\n        this._wireBeingAddedFrom = undefined\n        if (nodes === undefined) {\n            return undefined\n        }\n        return this.addWire(nodes[0], nodes[1], true)\n    }\n\n    public isValidNodeToConnect(node: Node): boolean {\n        return this.getOutInNodesForNewWire(node) !== undefined\n    }\n\n    private getOutInNodesForNewWire(newNode: Node): [NodeOut, NodeIn] | undefined {\n        const otherNode = this._wireBeingAddedFrom\n        if (otherNode === undefined) {\n            return undefined\n        }\n\n        if (newNode === otherNode) {\n            // can't connect to itself\n            return undefined\n        }\n\n        if (otherNode.isOutput()) {\n            if (newNode.isOutput() || !newNode.acceptsMoreConnections) {\n                // can't connect two outputs or to an input that can't accept more connections\n                return undefined\n            } else {\n                return [otherNode, newNode]\n            }\n        } else {\n            if (newNode.isOutput()) {\n                // that works\n                return [newNode, otherNode]\n            } else {\n                // two inputs: if one is connected to some output already, connect to that\n                let otherStartNode = newNode.incomingWire?.startNode\n                if (otherStartNode !== undefined && otherNode.acceptsMoreConnections) {\n                    return [otherStartNode, otherNode]\n                }\n                otherStartNode = otherNode.incomingWire?.startNode\n                if (otherStartNode !== undefined && newNode.acceptsMoreConnections) {\n                    return [otherStartNode, newNode]\n                }\n\n                // nothing else we can do\n                return undefined\n            }\n        }\n    }\n\n    public tryCancelWireOrAnchor(): boolean {\n        if (this._wireBeingAddedFrom !== undefined) {\n            this._wireBeingAddedFrom = undefined\n            this.parent.ifEditing?.setToolCursor(null)\n            return true\n        }\n        if (this._anchorBeingSetFrom !== undefined) {\n            this._anchorBeingSetFrom = undefined\n            this.parent.ifEditing?.setToolCursor(null)\n            return true\n        }\n        return false\n    }\n\n    private offsetWireIfNeeded(wire: Wire) {\n        const startNode = wire.startNode\n        const endNode = wire.endNode\n        const comp = startNode.component as Component\n        if (comp !== endNode.component) {\n            return\n        }\n        const dx2 = (endNode.posX - startNode.posX) / 2\n        const dy2 = (endNode.posY - startNode.posY) / 2\n        const midpointX = startNode.posX + dx2\n        const midpointY = startNode.posY + dy2\n        if (!comp.isOver(midpointX, midpointY)) {\n            return\n        }\n\n        const addToX = dx2 > dy2\n\n        const dir = addToX\n            ? (startNode.posX < endNode.posX ? 1 : startNode.posX > endNode.posX ? -1 : startNode.posX < comp.posX ? -1 : 1)\n            : (startNode.posY < endNode.posY ? 1 : startNode.posY > endNode.posY ? -1 : startNode.posY < comp.posY ? -1 : 1)\n        const calcOffsetFromDim = (dim: number) => {\n            return dir * (dim / 2 + 2 * GRID_STEP)\n        }\n\n        const isVertical = Orientation.isVertical(comp.orient)\n\n        const waypointX = midpointX + (addToX ? calcOffsetFromDim(isVertical ? comp.unrotatedHeight : comp.unrotatedWidth) : 0)\n        const waypointY = midpointY + (addToX ? 0 : calcOffsetFromDim(isVertical ? comp.unrotatedWidth : comp.unrotatedHeight))\n        const waypoint = wire.addWaypointWith(waypointX, waypointY)\n        waypoint.anchor = comp\n    }\n\n    private tryMergeWire(wire: Wire) {\n        const startNode = wire.startNode\n        const endNode = wire.endNode\n\n        const startGroup = startNode.group\n        const endGroup = endNode.group\n        if (startGroup === undefined || endGroup === undefined) {\n            return\n        }\n\n        const findWire = (group1: NodeGroup<NodeOut>, i1: number, group2: NodeGroup<NodeIn>, i2: number): Wire | undefined => {\n            if (i1 < 0 || i2 < 0 || i1 >= group1.nodes.length || i2 >= group2.nodes.length) {\n                return undefined\n            }\n            return group1.nodes[i1].findWireTo(group2.nodes[i2])\n        }\n\n        const indexStart = startGroup.nodes.indexOf(startNode)\n        const indexEnd = endGroup.nodes.indexOf(endNode)\n\n        const wireBefore = findWire(startGroup, indexStart - 1, endGroup, indexEnd - 1)\n        if (wireBefore !== undefined) {\n            let ribbon = wireBefore.ribbon\n            if (ribbon === undefined) {\n                ribbon = new Ribbon(startNode.parent, startGroup, endGroup)\n                this._ribbons.push(ribbon) // TODO determine when we must remove them\n                wireBefore.ribbon = ribbon\n                ribbon.addCoveredWire(wireBefore, indexStart - 1, indexEnd - 1)\n            }\n            ribbon.addCoveredWire(wire, indexStart, indexEnd)\n            wire.ribbon = ribbon\n        }\n\n        // TODO merge after, too!\n\n        // if (wireAfter !== undefined) {\n        //     console.log(\"we have a wire after\")\n        // }\n\n\n        // const wireAfter = findWire(startGroup, indexStart + 1, endGroup, indexEnd + 1)\n    }\n\n    public deleteWire(wire: Wire): InteractionResult {\n        // TODO check in ribbon\n        const oldStartNode = wire.startNode\n        const oldEndNode = wire.endNode\n        const deleted = this.doDeleteWire(wire)\n        if (!deleted) {\n            return InteractionResult.NoChange\n        }\n        return tryMakeRepeatableNodeAction(oldStartNode, oldEndNode, (startNode, endNode) => {\n            const wire = endNode.incomingWire\n            if (wire === null || wire.startNode !== startNode) {\n                return false\n            }\n            return this.doDeleteWire(wire)\n        })\n    }\n\n    private doDeleteWire(wire: Wire): boolean {\n        // TODO check in ribbon\n        wire.destroy()\n        const ribbon = wire.ribbon\n        if (ribbon !== undefined) {\n            ribbon.wireWasDeleted(wire)\n            if (ribbon.isEmpty()) {\n                this._ribbons.splice(this._ribbons.indexOf(ribbon), 1)\n            }\n        }\n        // remove wire from array\n        this._wires.splice(this._wires.indexOf(wire), 1)\n        this.parent.ifEditing?.redrawMgr.requestRedraw({ why: \"wire deleted\", invalidateMask: true, invalidateTests: true })\n        return true\n    }\n\n    public invalidateAllWirePaths() {\n        for (const wire of this._wires) {\n            wire.invalidateWirePath()\n        }\n    }\n\n    public clearAll() {\n        // TODO clear ribbons\n        for (const wire of this._wires) {\n            wire.destroy()\n        }\n        this._wires.length = 0\n        this.parent.ifEditing?.redrawMgr.requestRedraw({ why: \"all wires deleted\", invalidateMask: true, invalidateTests: true })\n    }\n\n}\n\n\nfunction bezierAnchorForWire(wireProlongDirection: Orientation, x: number, y: number, distX: number, distY: number): [number, number] {\n    switch (wireProlongDirection) {\n        case \"e\": // going east, so anchor point is before on X\n            return [x - distX, y]\n        case \"w\": // going west, so anchor point is after on X\n            return [x + distX, y]\n        case \"s\":// going south, so anchor point is before on Y\n            return [x, y - distY]\n        case \"n\":// going north, so anchor point is after on Y\n            return [x, y + distY]\n    }\n}\n", "import * as t from \"io-ts\"\nimport JSON5 from \"json5\"\nimport type { ComponentKey, DefAndParams, LibraryButtonOptions, LibraryButtonProps, LibraryItem } from \"../ComponentMenu\"\nimport { DrawParams, LogicEditor } from \"../LogicEditor\"\nimport { PointerDragEvent } from \"../UIEventManager\"\nimport { UIPermissions } from \"../UIPermissions\"\nimport { COLOR_BACKGROUND, COLOR_COMPONENT_INNER_LABELS, COLOR_GROUP_SPAN, DrawingRect, GRID_STEP, drawClockInput, drawComponentName, drawLabel, drawWireLineToComponent, isTrivialNodeName, shouldDrawLeadsTo, useCompact } from \"../drawutils\"\nimport { IconName, ImageName } from \"../images\"\nimport { S, Template } from \"../strings\"\nimport { ArrayFillUsing, ArrayOrDirect, EdgeTrigger, Expand, FixedArrayMap, HasField, HighImpedance, InteractionResult, LogicValue, LogicValueRepr, Mode, Unknown, brand, deepArrayEquals, isArray, isBoolean, isNumber, isRecord, isString, mergeWhereDefined, toLogicValueRepr, typeOrUndefined, validateJson } from \"../utils\"\nimport { DrawContext, DrawContextExt, DrawableParent, DrawableWithDraggablePosition, DrawableWithPosition, GraphicsRendering, MenuData, MenuItem, MenuItemPlacement, MenuItems, Orientation, PositionSupportRepr } from \"./Drawable\"\nimport { DEFAULT_WIRE_COLOR, Node, NodeBase, NodeIn, NodeOut, WireColor } from \"./Node\"\n\n\ntype NodeSeqRepr<TFullNodeRepr> =\n    ArrayOrDirect<number | string | TFullNodeRepr>\n\nexport const NodeSeqRepr = <T>(fullNodeRepr: t.Type<T>) =>\n    t.union([\n        t.number, // just the ID\n        t.string, // a range of IDs as string\n        fullNodeRepr,\n        t.array(t.union([\n            t.number,\n            t.string,\n            fullNodeRepr,\n        ])),\n    ], \"NodeSeqRepr\")\n\nexport const InputNodeRepr = t.type({\n    id: t.number,\n}, \"InputNode\")\nexport type InputNodeRepr = t.TypeOf<typeof InputNodeRepr>\n\nexport const OutputNodeRepr = t.intersection([\n    t.type({ id: t.number }),\n    t.partial({\n        force: LogicValueRepr,\n        initialValue: LogicValueRepr,\n        color: t.keyof(WireColor),\n    })], \"OutputNode\")\nexport type OutputNodeRepr = t.TypeOf<typeof OutputNodeRepr>\n\nexport const InputNodeSeqRepr = NodeSeqRepr(InputNodeRepr)\ntype InputNodeSeqRepr = t.TypeOf<typeof InputNodeSeqRepr>\n\nexport const OutputNodeSeqRepr = NodeSeqRepr(OutputNodeRepr)\ntype OutputNodeSeqRepr = t.TypeOf<typeof OutputNodeSeqRepr>\n\n// Defines how the JSON looks like depending on the number of inputs and outputs.\n// If only inputs or only outputs, all IDs are put into an \"id\" field.\n// If both inputs and outputs are present, we have separate \"in\" and \"out\" fields.\n\n// These are just 3 intermediate types\nconst OnlyInNodeIds = t.partial({ id: InputNodeSeqRepr })\ntype OnlyInNodeIds = t.TypeOf<typeof OnlyInNodeIds>\n\nconst OnlyOutNodeIds = t.partial({ id: OutputNodeSeqRepr })\ntype OnlyOutNodeIds = t.TypeOf<typeof OnlyOutNodeIds>\n\nconst InAndOutNodeIds = t.partial({\n    in: InputNodeSeqRepr,\n    out: OutputNodeSeqRepr,\n})\ntype InAndOutNodeIds = t.TypeOf<typeof InAndOutNodeIds>\n\nconst NoNodeIds = t.type({})\ntype NoNodeIds = t.TypeOf<typeof NoNodeIds>\n\n\n// This is the final conditional type showing what the JSON representation\n// will look like depending on number of inputs and outputs\nexport const NodeIDsRepr = <THasIn extends boolean, THasOut extends boolean>(hasIn: THasIn, hasOut: THasOut)\n    : THasIn extends true\n    ? (THasOut extends true ? typeof InAndOutNodeIds : typeof OnlyInNodeIds)\n    : (THasOut extends true ? typeof OnlyOutNodeIds : typeof NoNodeIds) => (\n        hasIn ? (hasOut ? InAndOutNodeIds : OnlyInNodeIds)\n            : (hasOut ? OnlyOutNodeIds : NoNodeIds)\n    ) as any\n\ntype NodeIDsRepr<THasIn extends boolean, THasOut extends boolean>\n    = THasIn extends true\n    ? THasOut extends true ? InAndOutNodeIds : OnlyInNodeIds\n    : THasOut extends true ? OnlyOutNodeIds : NoNodeIds\n\n\n/**\n * Base representation of a component: position & repr of nodes\n */\nexport type ComponentRepr<THasIn extends boolean, THasOut extends boolean> =\n    { type: string } & PositionSupportRepr & NodeIDsRepr<THasIn, THasOut>\n\nexport const ComponentRepr = <THasIn extends boolean, THasOut extends boolean>(hasIn: THasIn, hasOut: THasOut) =>\n    t.intersection([\n        t.type({\n            type: t.string,\n        }),\n        PositionSupportRepr,\n        NodeIDsRepr(hasIn, hasOut),\n    ], \"Component\")\n\nexport function isNodeArray<TNode extends Node>(obj: undefined | number | Node | ReadonlyGroupedNodeArray<TNode>): obj is ReadonlyGroupedNodeArray<TNode> {\n    return isArray(obj)\n}\n\nexport class NodeGroup<TNode extends Node> {\n\n    private _orient: Orientation = \"e\" // default changed when nodes are added\n    private _nodes: GroupedNodeArray<TNode>\n    private _avgGridOffets: [number, number] | undefined = undefined\n    public hasNameOverrides: boolean = false\n\n    public constructor(\n        public readonly parent: Component,\n        public readonly name: string,\n    ) {\n        this._nodes = [] as unknown as GroupedNodeArray<TNode>\n        this._nodes.group = this\n    }\n\n    public get nodes(): ReadonlyGroupedNodeArray<TNode> {\n        return this._nodes\n    }\n\n    public addNode(node: TNode) {\n        if (this._avgGridOffets !== undefined) {\n            console.warn(\"Adding nodes to a group after the group's position has been used\")\n        }\n        this._nodes.push(node)\n        this._orient = node.orient\n    }\n\n    private get avgGridOffsets(): [number, number] {\n        if (this._avgGridOffets === undefined) {\n            let x = 0\n            let y = 0\n            for (const node of this._nodes) {\n                x += node.gridOffsetX\n                y += node.gridOffsetY\n            }\n            const len = this._nodes.length\n            this._avgGridOffets = [x / len, y / len]\n        }\n        return this._avgGridOffets\n    }\n\n    public get orient(): Orientation {\n        return this._orient\n    }\n\n    public get posXInParentTransform() {\n        return this.parent.posX + this.avgGridOffsets[0] * GRID_STEP\n    }\n\n    public get posYInParentTransform() {\n        return this.parent.posY + this.avgGridOffsets[1] * GRID_STEP\n    }\n\n    // allows the Node type (rather than N for group.nodes.indexOf(...))\n    public indexOf(node: Node): number {\n        for (let i = 0; i < this._nodes.length; i++) {\n            if (this._nodes[i] === node) {\n                return i\n            }\n        }\n        return -1\n    }\n\n}\n\nexport enum ComponentState {\n    SPAWNING, // during placement drag\n    SPAWNED,  // regular use\n    DEAD,     // after deletion\n    INVALID,  // if cannot be updated because of circular dependencies\n}\n\n// Simplified, generics-free representation of a component\nexport type Component = ComponentBase<any, any, NamedNodes<NodeIn>, NamedNodes<NodeOut>, any, any>\n\nexport type DynamicName = Record<string | number, string>\nexport function isDynamicName(obj: unknown): obj is DynamicName {\n    if (!isRecord(obj)) {\n        return false\n    }\n    for (const key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key) && typeof obj[key] !== \"string\") {\n            return false\n        }\n    }\n    return true\n}\nexport type ComponentName = string | DynamicName | undefined\nexport const ComponentNameRepr = typeOrUndefined(\n    t.union([\n        t.string,\n        t.record(t.union([t.string, t.number]), t.string),\n    ])\n)\n\ntype NodeOutDescOptions = { hasTriangle?: boolean, labelName?: string, leadLength?: number }\nexport type NodeOutDesc =\n    | readonly [x: number, y: number, orient: Orientation, opts?: NodeOutDescOptions]\n    | readonly [x: number, y: number, orient: Orientation, fullName?: string, opts?: NodeOutDescOptions]\n\n\ntype NodeInDescOptions = { hasTriangle?: boolean, labelName?: string, leadLength?: number, prefersSpike?: boolean, isClock?: boolean }\nexport type NodeInDesc =\n    | readonly [x: number, y: number, orient: Orientation, opts?: NodeInDescOptions]\n    | readonly [x: number, y: number, orient: Orientation, fullName?: string, opts?: NodeInDescOptions]\n\nexport type NodeDesc = NodeOutDesc | NodeInDesc\nexport type NodeDescInGroup = readonly [x: number, y: number, shortNameOverride?: string, opts?: NodeInDescOptions]\nexport type NodeGroupDesc<D extends NodeDesc> = ReadonlyArray<D>\nexport type NodeGroupMultiDesc<D extends NodeDesc> = ReadonlyArray<NodeGroupDesc<D>>\nexport type NodeRec<D extends NodeDesc> = Record<string, undefined | D | NodeGroupDesc<D> | NodeGroupMultiDesc<D>>\n\nfunction isNodeDesc<D extends NodeDesc>(desc: D | NodeGroupDesc<D> | NodeGroupMultiDesc<D>): desc is D {\n    return isNumber(desc[0])\n}\n\ntype GroupedNodeArray<TNode extends Node> = TNode[] & { group: NodeGroup<TNode> }\nexport type ReadonlyGroupedNodeArray<TNode extends Node> = readonly TNode[] & { group: NodeGroup<TNode> }\n\ntype MapDescToNode<TDesc, TNode extends Node>\n    = TDesc extends NodeDesc ? TNode\n    : TDesc extends Array<NodeDesc> ? GroupedNodeArray<TNode>\n    : TDesc extends Array<Array<NodeDesc>> ? GroupedNodeArray<TNode>[]\n    : never\n\ntype MapRecToNodes<TRec, TNode extends Node> = {\n    [K in keyof TRec]: MapDescToNode<TRec[K], TNode>\n}\n\n\n// Named nodes according to the node description always have\n// an '_all' array of all nodes in addition to the names\ntype NamedNodes<TNode> = { _all: readonly TNode[] }\n\ntype ExtractNodes<TRepr, TField extends \"ins\" | \"outs\", TNode extends Node> = Expand<\n    (TRepr extends { _META?: { nodeRecs: { [K in TField]: infer TNodeRec } } }\n        ? MapRecToNodes<TNodeRec, TNode> : { _empty: true })\n    & NamedNodes<TNode>>\n\nexport type NodesIn<TRepr> = ExtractNodes<TRepr, \"ins\", NodeIn>\nexport type NodesOut<TRepr> = ExtractNodes<TRepr, \"outs\", NodeOut>\n\nexport type IsNonEmpty<TNamedNodes> = TNamedNodes extends { _empty: true } ? false : true\n\nexport type ExtractValue<TRepr> = TRepr extends { _META?: { value: infer TValue } } ? TValue : never\n\nexport type ExtractParams<TRepr> = TRepr extends { _META?: { params: infer TParams } } ? TParams : {}\n\nexport type ExtractParamDefs<TRepr> = TRepr extends { _META?: { paramDefs: infer TParamDefs extends Record<string, ParamDef<unknown>> } } ? TParamDefs : Record<string, ParamDef<unknown>>\n\n\n\nexport type InOutRecs = {\n    ins?: NodeRec<NodeInDesc>\n    outs?: NodeRec<NodeOutDesc>\n}\n\n\n\n//\n// Base class for all components\n//\n\nexport abstract class ComponentBase<\n    TRepr extends ComponentRepr<THasIn, THasOut>, // JSON representation\n    TValue = ExtractValue<TRepr>, // internal value recomputed when inputs change\n    TInputNodes extends NamedNodes<NodeIn> = NodesIn<TRepr>,\n    TOutputNodes extends NamedNodes<NodeOut> = NodesOut<TRepr>,\n    THasIn extends boolean = IsNonEmpty<TInputNodes>,\n    THasOut extends boolean = IsNonEmpty<TOutputNodes>, // in-out node presence\n> extends DrawableWithDraggablePosition {\n\n    public readonly def: InstantiatedComponentDef<TRepr, TValue>\n    private _anchoredDrawables: DrawableWithDraggablePosition[] = []\n    private _width: number\n    private _height: number\n    private _state!: ComponentState\n    private _value: TValue\n    public readonly inputs: TInputNodes\n    public readonly outputs: TOutputNodes\n    public readonly inputGroups: Map<string, NodeGroup<NodeIn>>\n    public readonly outputGroups: Map<string, NodeGroup<NodeOut>>\n\n    protected constructor(\n        parent: DrawableParent,\n        def: InstantiatedComponentDef<TRepr, TValue>,\n        saved: TRepr | undefined\n    ) {\n        super(parent, saved)\n\n        this.def = def\n        this._width = def.size.gridWidth * GRID_STEP\n        this._height = def.size.gridHeight * GRID_STEP\n        this._value = def.initialValue(saved)\n\n        const ins = def.nodeRecs.ins\n        const outs = def.nodeRecs.outs\n\n        function countNodes(rec: NodeRec<NodeDesc> | undefined) {\n            if (rec === undefined) {\n                return 0\n            }\n            let count = 0\n            for (const desc of Object.values(rec)) {\n                if (desc === undefined) {\n                    continue\n                }\n                if (isNodeDesc(desc)) {\n                    count++\n                } else {\n                    for (const innerDesc of desc) {\n                        if (isNodeDesc(innerDesc)) {\n                            count++\n                        } else {\n                            count += innerDesc.length\n                        }\n                    }\n                }\n            }\n            return count\n        }\n\n        const numInputs = countNodes(ins)\n        const numOutputs = countNodes(outs)\n\n        if (saved !== undefined) {\n            // restoring\n            this._state = ComponentState.SPAWNED\n        } else {\n            // newly placed\n            this.setSpawning()\n        }\n\n        // build node specs either from scratch if new or from saved data\n        const [inputSpecs, outputSpecs, hasAnyPrecomputedInitialValues] =\n            this.nodeSpecsFromRepr(saved, numInputs, numOutputs);\n\n        // so, hasAnyPrecomputedInitialValues is true if ANY of the outputs was built\n        // with \"initialValue\" in the JSON. This is used to stabilize circuits (such as\n        // an SR latch) that would otherwise oscillate. But this also means that NO OTHER\n        // OUTPUT from this component would be recomputed (even if they are always\n        // propagated). So, it is a good idea to either set no initial values at all, or\n        // to set all of them.\n\n        // generate the input and output nodes\n        [this.inputs, this.inputGroups] = this.makeNodes(ins, inputSpecs, NodeIn) as [TInputNodes, Map<string, NodeGroup<NodeIn>>];\n        [this.outputs, this.outputGroups] = this.makeNodes(outs, outputSpecs, NodeOut) as [TOutputNodes, Map<string, NodeGroup<NodeOut>>]\n\n        // setNeedsRecalc with a force propadation is needed:\n        // * the forced propagation allows the current value (e.g. for InputBits)\n        //   to be set to the outputs, if if the \"new\" value is the same as the current one\n        // * setNeedsRecalc schedules a recalculation (e.g. for Gates)\n        if (!hasAnyPrecomputedInitialValues) {\n            this.setNeedsRecalc(true)\n        } else {\n            this.requestPropagate()\n        }\n    }\n\n    public setSpawning() {\n        this._state = ComponentState.SPAWNING\n        this.parent.ifEditing?.moveMgr.setDrawableMoving(this)\n    }\n\n    public setSpawned() {\n        this._state = ComponentState.SPAWNED\n        this.parent.ifEditing?.moveMgr.setDrawableStoppedMoving(this)\n    }\n\n    public setInvalid() {\n        this._state = ComponentState.INVALID\n    }\n\n    public abstract toJSON(): TRepr\n\n    /**\n     * Returns the JSON representation of this component, but without nodes\n     * and without the id. This is useful to clone a component. Nodes and ids\n     * can then be restored on the clone.\n     */\n    protected toNodelessJSON(): TRepr {\n        // useful to clone a component without its node numbers,\n        // which will be reobtained when the new component is created\n        const repr = this.toJSON()\n        delete repr.ref\n        delete (repr as ComponentRepr<true, true>).in\n        delete (repr as ComponentRepr<true, true>).out\n        delete (repr as ComponentRepr<true, false>).id\n        return repr\n    }\n\n    /**\n     * Returns the JSON representation of the fields this superclass knows\n     * about. Typically used by subclasses to provide only their specific JSON,\n     * splatting in the result of super.toJSONBase() in the object.\n     */\n    protected override toJSONBase(): ComponentRepr<THasIn, THasOut> {\n        const typeHolder = {\n            // not sure why we need a separate object to splat in just\n            // a few lines below, but this makes the compiler happy\n            type: this.jsonType(),\n        }\n        return {\n            ...typeHolder,\n            ...super.toJSONBase(),\n            ...this.buildNodesRepr(),\n        }\n    }\n\n    protected jsonType(): string {\n        return this.def.type\n    }\n\n    // creates the input/output nodes based on array of offsets (provided\n    // by subclass) and spec (either loaded from JSON repr or newly generated)\n    private makeNodes<TNode extends Node, TDesc extends (TNode extends NodeIn ? NodeInDesc : NodeOutDesc)>(\n        nodeRec: NodeRec<TDesc> | undefined,\n        specs: readonly (InputNodeRepr | OutputNodeRepr)[],\n        node: new (\n            parent: Component,\n            nodeSpec: InputNodeRepr | OutputNodeRepr,\n            group: NodeGroup<TNode> | undefined,\n            shortName: string,\n            fullName: string,\n            _gridOffsetX: number,\n            _gridOffsetY: number,\n            hasTriangle: boolean,\n            orient: Orientation,\n            leadLength: number | undefined,\n        ) => TNode) {\n\n        const nodes: Record<string, TNode | ReadonlyArray<TNode> | ReadonlyArray<ReadonlyArray<TNode>>> = {}\n        const allNodes: TNode[] = []\n        const nodeGroups: Map<string, NodeGroup<TNode>> = new Map()\n\n        if (nodeRec !== undefined) {\n            const makeNode = (group: NodeGroup<TNode> | undefined, shortName: string, desc: TDesc) => {\n                const spec = specs[nextSpecIndex++]\n                const [offsetX, offsetY, orient, nameOrOptions, options_] = desc\n                let nameOverride: string | undefined = undefined\n                let options: NodeInDescOptions | undefined = undefined\n                if (isString(nameOrOptions)) {\n                    nameOverride = nameOrOptions\n                } else if (nameOrOptions !== undefined) {\n                    options = nameOrOptions\n                }\n                if (options_ !== undefined) {\n                    options = options_\n                }\n                const isClock = options?.isClock ?? false\n                const prefersSpike = options?.prefersSpike ?? false\n                const leadLength = options?.leadLength\n                const hasTriangle = options?.hasTriangle ?? false\n                if (group !== undefined && nameOverride !== undefined) {\n                    // names in groups are considered short names to be used as labels\n                    shortName = nameOverride\n                    group.hasNameOverrides = true\n                } else if (options?.labelName !== undefined) {\n                    shortName = options.labelName\n                }\n                const fullName = nameOverride === undefined ? shortName : nameOverride\n                const newNode = new node(\n                    this,\n                    spec,\n                    group,\n                    shortName,\n                    fullName,\n                    offsetX,\n                    offsetY,\n                    hasTriangle,\n                    orient,\n                    leadLength,\n                )\n                if (prefersSpike || isClock) {\n                    if (newNode instanceof NodeIn) {\n                        newNode.prefersSpike = true // clock also prefers spike\n                        newNode.isClock = isClock\n                    } else {\n                        console.warn(`prefersSpike is only supported for inputs, can't set it for ${name}`)\n                    }\n                }\n                allNodes.push(newNode)\n                return newNode\n            }\n            let nextSpecIndex = 0\n            for (const [fieldName, desc] of Object.entries(nodeRec)) {\n                if (desc === undefined) {\n                    continue\n                }\n                if (isNodeDesc(desc)) {\n                    // single\n                    nodes[fieldName] = makeNode(undefined, fieldName, desc)\n                } else {\n                    // group\n                    const makeNodesForGroup = (groupDesc: NodeGroupDesc<TDesc>, groupName: string, namePrefix: string) => {\n                        const group = new NodeGroup<TNode>(this, groupName)\n                        nodeGroups.set(groupName, group)\n                        for (let i = 0; i < groupDesc.length; i++) {\n                            group.addNode(makeNode(group, namePrefix + i, groupDesc[i]))\n                        }\n                        return group.nodes\n                    }\n\n                    if (isNodeDesc(desc[0])) {\n                        // normal group\n                        const groupDesc = desc as NodeGroupDesc<TDesc>\n                        nodes[fieldName] = makeNodesForGroup(groupDesc, fieldName, fieldName)\n                    } else {\n                        // nested group\n                        const groupMultiDesc = desc as NodeGroupMultiDesc<TDesc>\n                        nodes[fieldName] = groupMultiDesc.map((groupDesc, i) => makeNodesForGroup(groupDesc, `${fieldName}${i}`, `${fieldName}${i}.`))\n                    }\n                }\n            }\n        }\n        nodes._all = allNodes\n        return [nodes, nodeGroups]\n    }\n\n    // generates two arrays of normalized node specs either as loaded from\n    // JSON or obtained with default values when _repr is null and we're\n    // creating a new component from scratch\n    private nodeSpecsFromRepr(_repr: NodeIDsRepr<THasIn, THasOut> | undefined, numInputs: number, numOutputs: number): [\n        inputSpecs: Array<InputNodeRepr>,\n        outputSpecs: Array<OutputNodeRepr>,\n        hasAnyPrecomputedInitialValues: boolean\n    ] {\n        const nodeMgr = this.parent.nodeMgr\n        const makeDefaultSpec = () => ({ id: nodeMgr.getFreeId() })\n        const makeDefaultSpecArray = (len: number) => ArrayFillUsing(makeDefaultSpec, len)\n\n        if (_repr === undefined) {\n            return [\n                makeDefaultSpecArray(numInputs),\n                makeDefaultSpecArray(numOutputs),\n                false,\n            ]\n        }\n\n        let inputSpecs: InputNodeRepr[] = []\n        let outputSpecs: OutputNodeRepr[] = []\n\n        const makeNormalizedSpecs = <TNodeRepr extends InputNodeRepr | OutputNodeRepr>(\n            num: number,\n            seqRepr?: ArrayOrDirect<string | number | TNodeRepr>,\n        ) => {\n            if (seqRepr === undefined) {\n                return makeDefaultSpecArray(num)\n            }\n\n            const specs: Array<TNodeRepr> = []\n            function pushId(sourceId: number) {\n                const id = nodeMgr.getFreeIdFrom(sourceId)\n                specs.push({ id } as TNodeRepr)\n            }\n\n            for (const spec of (isArray(seqRepr) ? seqRepr : [seqRepr])) {\n                if (isNumber(spec)) {\n                    pushId(spec)\n                } else if (isString(spec)) {\n                    const [start, end] = spec.split('-').map(s => parseInt(s))\n                    for (let i = start; i <= end; i++) {\n                        pushId(i)\n                    }\n                } else {\n                    spec.id = nodeMgr.getFreeIdFrom(spec.id)\n                    specs.push(spec)\n                }\n            }\n            return specs\n        }\n\n        // manually distinguishing the cases where we have no inputs or no\n        // outputs as we then have a more compact JSON representation\n        if (numInputs !== 0) {\n            if (numOutputs !== 0) {\n                const repr = _repr as InAndOutNodeIds\n                inputSpecs = makeNormalizedSpecs(numInputs, repr.in)\n                outputSpecs = makeNormalizedSpecs(numOutputs, repr.out)\n            } else {\n                const repr = _repr as OnlyInNodeIds\n                inputSpecs = makeNormalizedSpecs(numInputs, repr.id)\n            }\n        } else if (numOutputs !== 0) {\n            const repr = _repr as OnlyOutNodeIds\n            outputSpecs = makeNormalizedSpecs(numOutputs, repr.id)\n        }\n\n        const hasAnyPrecomputedInitialValues =\n            outputSpecs.some(spec => spec.initialValue !== undefined)\n\n        return [inputSpecs, outputSpecs, hasAnyPrecomputedInitialValues]\n    }\n\n    // from the known nodes, builds the JSON representation of them,\n    // using the most compact form available\n    private buildNodesRepr(): NodeIDsRepr<THasIn, THasOut> {\n        const numInputs = this.inputs._all.length\n        const numOutputs = this.outputs._all.length\n\n        // these two functions return either an array of JSON\n        // representations, or just the element skipping the array\n        // if there is only one\n        function inNodeReprs(nodes: readonly Node[]): ArrayOrDirect<number | string> {\n            const reprOne = (node: Node) => node.id\n            if (nodes.length === 1) {\n                return reprOne(nodes[0])\n            } else {\n                return compactRepr(nodes.map(reprOne))\n            }\n        }\n        function outNodeReprs(nodes: readonly Node[]): ArrayOrDirect<number | string | OutputNodeRepr> {\n            const reprOne = (node: Node) => {\n                const valueNotForced = node.forceValue === undefined\n                const noInitialValue = node.initialValue === undefined\n                const hasStandardColor = node.color === DEFAULT_WIRE_COLOR\n                if (valueNotForced && hasStandardColor && noInitialValue) {\n                    return node.id\n                } else {\n                    return {\n                        id: node.id,\n                        intialValue: noInitialValue ? undefined : toLogicValueRepr(node.initialValue),\n                        force: valueNotForced ? undefined : toLogicValueRepr(node.forceValue),\n                        color: hasStandardColor ? undefined : node.color,\n                    }\n                }\n            }\n            if (nodes.length === 1) {\n                return reprOne(nodes[0])\n            } else {\n                return compactRepr(nodes.map(reprOne))\n            }\n        }\n\n        function compactRepr<TFullNodeRepr>(reprs: Array<number | TFullNodeRepr>): ArrayOrDirect<number | string | TFullNodeRepr> {\n            // collapses consecutive numbers intro a string of the form \"start-end\" to save JSON space\n            const newArray: Array<number | string | TFullNodeRepr> = []\n            let currentRangeStart: number | undefined = undefined\n            let currentRangeEnd: number | undefined = undefined\n            function pushRange() {\n                if (currentRangeStart !== undefined && currentRangeEnd !== undefined) {\n                    if (currentRangeStart === currentRangeEnd) {\n                        newArray.push(currentRangeStart)\n                    } else if (currentRangeEnd === currentRangeStart + 1) {\n                        newArray.push(currentRangeStart)\n                        newArray.push(currentRangeEnd)\n                    } else {\n                        newArray.push(`${currentRangeStart}-${currentRangeEnd}`)\n                    }\n                    currentRangeStart = undefined\n                    currentRangeEnd = undefined\n                }\n            }\n            for (const repr of reprs) {\n                if (isNumber(repr)) {\n                    if (currentRangeStart !== undefined && repr - 1 === currentRangeEnd) {\n                        currentRangeEnd = repr\n                    } else {\n                        pushRange()\n                        currentRangeStart = currentRangeEnd = repr\n                    }\n                } else {\n                    pushRange()\n                    newArray.push(repr)\n                }\n            }\n            pushRange()\n\n            if (newArray.length === 1) {\n                return newArray[0]\n            }\n            return newArray\n        }\n\n        return (\n            numInputs !== 0\n                ? numOutputs !== 0\n                    ? { in: inNodeReprs(this.inputs._all), out: outNodeReprs(this.outputs._all) }\n                    : { id: inNodeReprs(this.inputs._all) }\n                : numOutputs !== 0\n                    ? { id: outNodeReprs(this.outputs._all) }\n                    : {}\n        ) as NodeIDsRepr<THasIn, THasOut>\n    }\n\n    public get anchoredDrawables(): readonly DrawableWithPosition[] {\n        return this._anchoredDrawables\n    }\n\n    // only called by Drawable when setting/clearing anchor\n    public addAnchoredDrawable(drawable: DrawableWithDraggablePosition) {\n        this._anchoredDrawables.push(drawable)\n    }\n\n    // only called by Drawable when setting/clearing anchor\n    public removeAnchoredDrawable(drawable: DrawableWithPosition) {\n        this._anchoredDrawables = this._anchoredDrawables.filter(d => d !== drawable)\n    }\n\n    public get unrotatedWidth() {\n        return this._width\n    }\n\n    public get unrotatedHeight() {\n        return this._height\n    }\n\n    protected override toStringDetails(): string {\n        const maybeName = (this as any)._name\n        const name = maybeName !== undefined ? `name='${maybeName}', ` : ''\n        return name + String(this.value)\n    }\n\n    public get state() {\n        return this._state\n    }\n\n    public get allowsForcedOutputs() {\n        return true\n    }\n\n    public get alwaysDrawMultiOutNodes() {\n        return false\n    }\n\n    public *allNodes() {\n        for (const node of this.inputs._all) {\n            yield node\n        }\n        for (const node of this.outputs._all) {\n            yield node\n        }\n    }\n\n    public *allNodeGroups() {\n        for (const group of this.inputGroups.values()) {\n            yield group\n        }\n        for (const group of this.outputGroups.values()) {\n            yield group\n        }\n    }\n\n    public get value(): TValue {\n        return this._value\n    }\n\n    protected doSetValue(newValue: TValue, forcePropagate = false) {\n        const oldValue = this._value\n        if (forcePropagate || !deepArrayEquals(newValue, oldValue)) {\n            this._value = newValue\n            this.requestRedraw({ why: \"value changed\", invalidateTests: true })\n            this.requestPropagate()\n        }\n    }\n\n    public recalcValue(forcePropagate: boolean) {\n        this.doSetValue(this.doRecalcValue(), forcePropagate)\n    }\n\n    protected abstract doRecalcValue(): TValue\n\n    public propagateCurrentValue() {\n        this.propagateValue(this._value)\n    }\n\n    protected propagateValue(__newValue: TValue) {\n        // by default, do nothing\n    }\n\n    protected inputValues(nodes: readonly NodeIn[]): LogicValue[] {\n        return nodes.map(node => node.value)\n    }\n\n    protected outputValues(nodes: readonly NodeOut[], values: LogicValue[], reverse = false) {\n        const num = nodes.length\n        if (values.length !== num) {\n            throw new Error(`outputValues: expected ${num} values, got ${values.length}`)\n        }\n        for (let i = 0; i < num; i++) {\n            const j = reverse ? num - i - 1 : i\n            nodes[i].value = values[j]\n        }\n    }\n\n    public setNeedsRecalc(forcePropagate = false) {\n        this.parent.recalcMgr.enqueueForRecalc(this, forcePropagate)\n    }\n\n    private requestPropagate() {\n        this.parent.recalcMgr.enqueueForPropagate(this)\n    }\n\n    private updateNodePositions() {\n        for (const node of this.allNodes()) {\n            node.updatePositionFromParent()\n        }\n    }\n\n    protected bounds(honorRotation: boolean = false): DrawingRect {\n        return new DrawingRect(this, honorRotation)\n        // use with:\n        // const bounds = this.bounds()\n        // const { top, left, bottom, right, width, height } = bounds\n        // g.fill(bounds.outline(g))\n    }\n\n    public override draw(g: GraphicsRendering, drawParams: DrawParams): void {\n        super.draw(g, drawParams)\n        if (this._state === ComponentState.INVALID) {\n            g.fillStyle = \"rgba(255, 0, 0, 0.3)\"\n            const bounds = this.bounds(true)\n            g.fill(bounds.outline(g, 5))\n        }\n    }\n\n    protected doDraw(g: GraphicsRendering, ctx: DrawContext): void {\n        this.doDrawDefault(g, ctx)\n    }\n\n    protected doDrawDefault(\n        g: GraphicsRendering, ctx: DrawContext,\n        opts_?: ((ctx: DrawContextExt, bounds: DrawingRect) => void) | {\n            drawLabels?: (ctx: DrawContextExt, bounds: DrawingRect) => void,\n            drawInside?: (bounds: DrawingRect) => void,\n            skipLabels?: boolean,\n            labelSize?: number,\n            background?: string,\n            componentName?: [name: ComponentName, onRight: boolean, value: string | number | (() => string | number)]\n        }\n    ) {\n        const bounds = this.bounds()\n        const opts = typeof opts_ !== \"function\" ? opts_ : { drawLabels: opts_ }\n\n        // background\n        g.fillStyle = opts?.background ?? COLOR_BACKGROUND\n        const outline = bounds.outline(g)\n        g.fill(outline)\n\n        // inputs/outputs lines\n        for (const node of this.allNodes()) {\n            this.drawWireLineTo(g, node, bounds)\n        }\n\n        // group boxes\n        const drawLabels = !(opts?.skipLabels ?? false)\n        if (drawLabels) {\n            for (const group of this.allNodeGroups()) {\n                if (!group.hasNameOverrides) {\n                    this.drawGroupBox(g, group, bounds)\n                }\n            }\n        }\n\n        // additional inside drawing\n        opts?.drawInside?.(bounds)\n\n        // outline\n        g.lineWidth = 3\n        g.strokeStyle = ctx.borderColor\n        g.stroke(outline)\n\n        // labels\n        ctx.inNonTransformedFrame(ctx => {\n            if (opts?.componentName?.[0] !== undefined) {\n                const [name, onRight, value] = opts.componentName\n                const val = isNumber(value) || isString(value) ? value : value()\n                drawComponentName(g, ctx, name, val, this, onRight)\n            }\n\n            if (drawLabels) {\n                const labelSize = opts?.labelSize ?? 11\n                g.fillStyle = COLOR_COMPONENT_INNER_LABELS\n                g.textAlign = \"center\"\n\n                g.font = `bold ${labelSize}px sans-serif`\n                for (const group of this.allNodeGroups()) {\n                    if (!group.hasNameOverrides) {\n                        this.drawGroupLabel(ctx, group, bounds)\n                    }\n                }\n\n                g.font = `${labelSize}px sans-serif`\n                for (const node of this.allNodes()) {\n                    if (node.group === undefined || node.group.hasNameOverrides) {\n                        this.drawNodeLabel(ctx, node, bounds)\n                    }\n                }\n            }\n\n            opts?.drawLabels?.(ctx, bounds)\n        })\n    }\n\n    protected drawWireLineTo(g: GraphicsRendering, node: Node, bounds: DrawingRect) {\n        if (node.isClock) {\n            drawClockInput(g, bounds.left, node, (this as any)[\"_trigger\"] ?? EdgeTrigger.rising)\n            return\n        }\n\n        drawWireLineToComponent(g, node)\n    }\n\n    protected drawGroupBox(g: GraphicsRendering, group: NodeGroup<Node>, bounds: DrawingRect) {\n        if (!shouldDrawLeadsTo(group.nodes)) {\n            return\n        }\n\n        const groupWidth = Orientation.isVertical(Orientation.add(this.orient, group.orient)) ? 8 : 6\n        const first = group.nodes[0]\n        const last = group.nodes[group.nodes.length - 1]\n        const beforeAfterMargin = 2\n\n        g.beginPath()\n        switch (group.orient) {\n            case \"e\":\n                g.rect(bounds.right - groupWidth, first.posYInParentTransform - beforeAfterMargin, groupWidth, last.posYInParentTransform - first.posYInParentTransform + 2 * beforeAfterMargin)\n                break\n            case \"w\":\n                g.rect(bounds.left, first.posYInParentTransform - beforeAfterMargin, groupWidth, last.posYInParentTransform - first.posYInParentTransform + 2 * beforeAfterMargin)\n                break\n            case \"n\":\n                g.rect(last.posXInParentTransform - beforeAfterMargin, bounds.top, first.posXInParentTransform - last.posXInParentTransform + 2 * beforeAfterMargin, groupWidth)\n                break\n            case \"s\":\n                g.rect(last.posXInParentTransform - beforeAfterMargin, bounds.bottom - groupWidth, first.posXInParentTransform - last.posXInParentTransform + 2 * beforeAfterMargin, groupWidth)\n                break\n        }\n\n        g.fillStyle = COLOR_GROUP_SPAN\n        g.fill()\n    }\n\n    protected drawNodeLabel(ctx: DrawContextExt, node: Node, bounds: DrawingRect): void {\n        if (!node.isClock && !isTrivialNodeName(node.shortName)) {\n            drawLabel(ctx, this.orient, node.shortName, node.orient, ...this.anchorFor(node, bounds, 1), node)\n        }\n    }\n\n    protected drawGroupLabel(ctx: DrawContextExt, group: NodeGroup<Node>, bounds: DrawingRect): void {\n        if (!isTrivialNodeName(group.name)) {\n            drawLabel(ctx, this.orient, group.name, group.orient, ...this.anchorFor(group, bounds, 1), group.nodes)\n        }\n    }\n\n    private anchorFor(elem: Node | NodeGroup<Node>, bounds: DrawingRect, offset: number): [number, number] {\n        switch (elem.orient) {\n            case \"e\": return [bounds.right + offset, elem.posYInParentTransform]\n            case \"w\": return [bounds.left - offset, elem.posYInParentTransform]\n            case \"n\": return [elem.posXInParentTransform, bounds.top - offset]\n            case \"s\": return [elem.posXInParentTransform, bounds.bottom + offset]\n        }\n    }\n\n    protected replaceWithComponent(newComp: Component): Component {\n        // any component will work, but only inputs and outputs with\n        // the same names will be reconnected and others will be lost\n\n        const saveWires = <TNode extends NodeBase<any>, TWires>(nodes: readonly TNode[], getWires: (node: TNode) => null | TWires): Map<string, TWires> => {\n            const savedWires: Map<string, TWires> = new Map()\n            for (const node of nodes) {\n                const wires = getWires(node)\n                if (wires === null) {\n                    continue\n                }\n                const group = node.group\n                const keyName = group === undefined ? node.shortName : `${group.name}[${group.nodes.indexOf(node)}]`\n                savedWires.set(keyName, wires)\n            }\n            return savedWires\n        }\n\n        const savedWiresIn = saveWires(this.inputs._all, node => node.incomingWire)\n        const savedWiresOut = saveWires(this.outputs._all, node => node.outgoingWires)\n\n        const restoreNodes = <TNode extends NodeBase<any>, TWires>(savedWires: Map<string, TWires>, nodes: readonly TNode[], setWires: (wires: TWires, node: TNode) => void) => {\n            for (const node of nodes) {\n                const group = node.group\n                if (group === undefined) {\n                    // single node\n                    let wires = savedWires.get(node.shortName)\n                    if (wires === undefined) {\n                        // try to restore from array version\n                        wires = savedWires.get(node.shortName + \"[0]\")\n                    }\n                    if (wires !== undefined) {\n                        setWires(wires, node)\n                    }\n                } else {\n                    // node group\n                    const i = group.nodes.indexOf(node)\n                    let wires = savedWires.get(`${group.name}[${i}]`)\n                    if (wires === undefined && i === 0) {\n                        // try to restore from single version\n                        wires = savedWires.get(group.name)\n                    }\n                    if (wires !== undefined) {\n                        setWires(wires, node)\n                    }\n                }\n            }\n        }\n\n        restoreNodes(savedWiresIn, newComp.inputs._all, (wire, node) => {\n            wire.setEndNode(node)\n        })\n\n        const now = this.parent.editor.timeline.logicalTime()\n        restoreNodes(savedWiresOut, newComp.outputs._all, (wires, node) => {\n            for (const wire of [...wires]) {\n                wire.setStartNode(node, now)\n            }\n        })\n\n        // do this after restoring wires, otherwise wires are deleted\n        const componentList = this.parent.components\n        const deleted = componentList.tryDelete(this)\n        if (!deleted) {\n            console.warn(\"Could not delete old component\")\n        }\n\n        // restore component properties\n        newComp.setPosition(this.posX, this.posY, false)\n        newComp.setSpawned()\n        const ref = this.ref\n        if (ref !== undefined && !componentList.looksLikeAutoGeneratedId(this)) {\n            // only change the id if it is not auto-generated\n            componentList.changeIdOf(newComp, ref)\n        }\n\n\n        this.parent.ifEditing?.undoMgr.takeSnapshot()\n        this.parent.ifEditing?.redrawMgr.requestRedraw({ why: \"component replaced\", component: newComp, invalidateMask: true, invalidateTests: true })\n\n        return newComp\n    }\n\n    protected override makeClone(setSpawning: boolean): DrawableWithDraggablePosition | undefined {\n        const repr = this.toNodelessJSON()\n        const newComp = this.def.makeFromJSON(this.parent, repr)\n        if (newComp === undefined) {\n            console.warn(\"Could not create component clone\")\n        } else {\n            if (setSpawning) {\n                newComp.setSpawning()\n            }\n        }\n        return newComp\n    }\n\n    public override pointerDown(e: PointerEvent) {\n        if (this.parent.mode >= Mode.CONNECT && !e.shiftKey) {\n            // try clearing selection\n            const eventMgr = this.parent.editor.eventMgr\n            let elems\n            if (eventMgr.currentSelection !== undefined\n                && (elems = eventMgr.currentSelection.previouslySelectedElements).size > 0\n                && !elems.has(this)) {\n                eventMgr.currentSelection = undefined\n            }\n        }\n\n        return super.pointerDown(e)\n    }\n\n    public override pointerUp(e: PointerEvent): InteractionResult {\n        let wasSpawning = false\n        if (this._state === ComponentState.SPAWNING) {\n            this._state = ComponentState.SPAWNED\n            wasSpawning = true\n        }\n        const wasMoving = super.pointerUp(e).isChange\n        if (wasSpawning || wasMoving) {\n            const newLinks = this.parent.nodeMgr.tryConnectNodesOf(this)\n            if (newLinks.length > 0) {\n                this.autoConnected(newLinks)\n            }\n            this.parent.ifEditing?.setDirty(\"moved component\")\n            return InteractionResult.SimpleChange\n        }\n        const linkMgr = this.parent.editor.linkMgr\n        if (linkMgr.isSettingAnchor) {\n            return linkMgr.stopSettingAnchorOn(this)\n        }\n        return InteractionResult.NoChange\n    }\n\n    protected autoConnected(__newLinks: [Node, Component, Node][]) {\n        // by default, do nothing\n    }\n\n    protected override updateSelfPositionIfNeeded(x: number, y: number, snapToGrid: boolean, e: PointerDragEvent): undefined | [number, number] {\n        if (this._state === ComponentState.SPAWNING) {\n            return this.trySetPosition(x, y, snapToGrid)\n        }\n        return super.updateSelfPositionIfNeeded(x, y, snapToGrid, e)\n    }\n\n    protected override positionChanged(delta: [number, number]) {\n        this.updateNodePositions()\n        for (const anchored of this._anchoredDrawables) {\n            anchored.setPosition(anchored.posX + delta[0], anchored.posY + delta[1], false)\n        }\n    }\n\n    public override pointerClicked(e: PointerEvent): InteractionResult {\n        if (this.parent.mode >= Mode.CONNECT && e.shiftKey) {\n            this.parent.editor.eventMgr.toggleSelect(this)\n            return InteractionResult.SimpleChange\n        }\n        return InteractionResult.NoChange\n    }\n\n    public override pointerDoubleClicked(e: PointerEvent): InteractionResult {\n        if (this.parent.mode >= Mode.CONNECT && e.metaKey && this.canRotate()) {\n            const doChange = () => {\n                this.doSetOrient(Orientation.nextClockwise(this.orient))\n                return true\n            }\n            doChange()\n            return InteractionResult.RepeatableChange(doChange)\n        }\n        return InteractionResult.NoChange\n    }\n\n    public override doSetOrient(orient: Orientation) {\n        super.doSetOrient(orient)\n        this.updateNodePositions()\n    }\n\n    public destroy() {\n        this._state = ComponentState.DEAD\n        for (const node of this.allNodes()) {\n            node.destroy()\n        }\n    }\n\n    public override cursorWhenMouseover(e?: PointerEvent): string | undefined {\n        const mode = this.parent.mode\n        if ((e?.ctrlKey ?? false) && mode >= Mode.CONNECT) {\n            return \"context-menu\"\n        }\n        if ((e?.altKey ?? false) && mode >= Mode.DESIGN) {\n            return \"copy\"\n        }\n        if (!this.lockPos && mode >= Mode.CONNECT) {\n            return \"grab\"\n        }\n        return undefined\n    }\n\n    public override makeContextMenu(): MenuData | undefined {\n        const menuItems: MenuData = []\n\n        const baseItems = this.makeBaseContextMenu(this.parent.editor)\n        const specificItems = this.makeComponentSpecificContextMenuItems()\n\n        let lastWasSep = true\n        function addItemsAt(placement: MenuItemPlacement, items: MenuItems, insertSep = false) {\n            if (insertSep) {\n                if (!lastWasSep) {\n                    menuItems.push(MenuData.sep())\n                }\n                lastWasSep = true\n            }\n            for (const [pl, it] of items) {\n                if (pl === placement) {\n                    menuItems.push(it)\n                    lastWasSep = it._tag === \"sep\"\n                }\n            }\n        }\n\n        addItemsAt(\"start\", specificItems)\n        addItemsAt(\"start\", baseItems)\n        addItemsAt(\"mid\", baseItems, true)\n        addItemsAt(\"mid\", specificItems)\n        addItemsAt(\"end\", baseItems, true)\n        addItemsAt(\"end\", specificItems)\n\n        return menuItems\n    }\n\n    private makeBaseContextMenu(editor: LogicEditor): MenuItems {\n        const s = S.Components.Generic.contextMenu\n\n        // only allow to make new custom components or test cases in main editor\n        const nonEmptySelectionInMainEditor = !editor.eventMgr.currentSelectionEmpty() && this.parent.isMainEditor()\n\n        const makeNewComponentItems: MenuItems =\n            (!nonEmptySelectionInMainEditor || !UIPermissions.canModifyCustomComponents(this.parent)) ? [] : [\n                [\"start\", MenuData.item(\"newcomponent\", s.MakeNewComponent, () => {\n                    const result = editor.factory.tryMakeNewCustomComponent(editor)\n                    if (isString(result)) {\n                        if (result.length > 0) {\n                            window.alert(s.MakeNewComponentFailed + \" \" + result)\n                        }\n                    } else {\n                        editor.options.showOnly?.push(result.id)\n                        editor.updateCustomComponentButtons()\n                    }\n                })],\n            ]\n\n        const makeNewTestCaseItems: MenuItems =\n            (!nonEmptySelectionInMainEditor || !UIPermissions.canModifyTestCases(this.parent)) ? [] : [\n                [\"start\", MenuData.item(\"testcase\", s.MakeNewTestCase, () => {\n                    const result = editor.factory.tryMakeNewTestCase(editor)\n                    if (isString(result)) {\n                        if (result.length > 0) {\n                            window.alert(s.MakeNewTestCaseFailed + \" \" + result)\n                        }\n                        return\n                    }\n                    this.parent.editor.addTestCases(result)\n                })],\n                [\"start\", MenuData.item(\"testcase\", s.MakeAllTestCases, async () => {\n                    const result = await editor.factory.tryMakeAllTestCases(editor)\n                    if (isString(result)) {\n                        if (result.length > 0) {\n                            window.alert(s.MakeNewTestCaseFailed + \" \" + result)\n                        }\n                        return\n                    }\n                    this.parent.editor.addTestCases(result)\n                })],\n            ]\n\n        if (makeNewComponentItems.length > 0 || makeNewTestCaseItems.length > 0) {\n            makeNewTestCaseItems.push([\"start\", MenuData.sep()])\n        }\n\n        const setRefItems: MenuItems =\n            editor.mode < Mode.FULL ? [] : [\n                [\"end\", this.makeSetIdContextMenuItem()],\n                [\"end\", MenuData.sep()],\n            ]\n\n        const resetItem: MenuItems =\n            this.state !== ComponentState.INVALID ? [] : [\n                [\"end\", MenuData.item(\"reset\", s.Reset, () => {\n                    this._state = ComponentState.SPAWNED\n                    this.setNeedsRecalc(true)\n                })],\n            ]\n\n        const deleteItem = MenuData.item(\"trash\", s.Delete, () => {\n            const deleted = this.parent.components.tryDelete(this)\n            if (deleted) {\n                this.requestRedraw({ why: \"deleted component\", invalidateMask: true, invalidateTests: true })\n                return InteractionResult.SimpleChange\n            }\n            return InteractionResult.NoChange\n        }, \"\u232B\", true)\n\n        return [\n            [\"start\", MenuData.sep()],\n            ...makeNewComponentItems,\n            ...makeNewTestCaseItems,\n            ...this.makeOrientationAndPosMenuItems(),\n            ...setRefItems,\n            ...resetItem,\n            [\"end\", deleteItem],\n        ]\n    }\n\n    protected makeComponentSpecificContextMenuItems(): MenuItems {\n        return []\n    }\n\n    protected makeForceOutputsContextMenuItem(withSepBefore = false): MenuItems {\n        const numOutputs = this.outputs._all.length\n\n        if (numOutputs === 0 || this.parent.mode < Mode.FULL) {\n            return []\n        }\n\n        const s = S.Components.Generic.contextMenu\n\n        function makeOutputItems(out: NodeOut): MenuItem[] {\n            const currentForceValue = out.forceValue\n            const items = [undefined, Unknown, true, false, HighImpedance]\n                .map(newForceValue => MenuData.item(\n                    currentForceValue === newForceValue ? \"check\" : \"none\",\n                    (() => {\n                        switch (newForceValue) {\n                            case undefined: return s.NormalOutput\n                            case Unknown: return s.ForceAsUnknown\n                            case true: return s.ForceAs1\n                            case false: return s.ForceAs0\n                            case HighImpedance: return s.ForceAsZ\n                        }\n                    })(),\n                    () => {\n                        out.forceValue = newForceValue\n                    }\n                ))\n\n            // insert separator\n            items.splice(1, 0, MenuData.sep())\n            return items\n        }\n\n        const footerItems = [\n            MenuData.sep(),\n            MenuData.text(s.ForceOutputDesc),\n        ]\n\n        const items: MenuItems = []\n        if (withSepBefore) {\n            items.push([\"mid\", MenuData.sep()])\n        }\n        if (numOutputs === 1) {\n            items.push([\"mid\", MenuData.submenu(\"force\", s.ForceOutputSingle, [\n                ...makeOutputItems(this.outputs._all[0]),\n                ...footerItems,\n            ])])\n\n        } else {\n            items.push([\"mid\", MenuData.submenu(\"force\", s.ForceOutputMultiple, [\n                ...this.outputs._all.map((out) => {\n                    const icon = out.forceValue !== undefined ? \"force\" : \"none\"\n                    return MenuData.submenu(icon, s.Output + \" \" + out.fullName,\n                        makeOutputItems(out)\n                    )\n                }),\n                ...footerItems,\n            ])])\n        }\n\n        return items\n    }\n\n    protected makeSetNameContextMenuItem(currentName: ComponentName, handler: (newName: ComponentName) => void): MenuItem {\n        const s = S.Components.Generic.contextMenu\n        const caption = currentName === undefined ? s.SetName : s.ChangeName\n        return MenuData.item(\"pen\", caption, () => this.runSetNameDialog(currentName, handler), \"\u21A9\uFE0E\")\n    }\n\n    protected runSetNameDialog(currentName: ComponentName, handler: (newName: ComponentName) => void): void {\n        const currentDisplayName = currentName === undefined || isString(currentName) ? currentName : JSON5.stringify(currentName)\n        const promptReturnValue = window.prompt(S.Components.Generic.contextMenu.SetNamePrompt, currentDisplayName)\n        if (promptReturnValue !== null) {\n            // OK button pressed\n            let newName\n            if (promptReturnValue.length === 0) {\n                newName = undefined\n            } else {\n                // is it JSON that can be valid as a DynamicName?\n                try {\n                    const parsedValue: unknown = JSON5.parse(promptReturnValue)\n                    if (isDynamicName(parsedValue)) {\n                        newName = parsedValue\n                    } else {\n                        newName = promptReturnValue\n                    }\n                } catch {\n                    newName = promptReturnValue\n                }\n            }\n            handler(newName)\n        }\n    }\n\n    protected runSetFontDialog(currentFont: string, defaultIfEmpty: string, callback: (font: string) => void) {\n        const s = S.Components.Generic.contextMenu\n        const promptReturnValue = window.prompt(s.SetFontPrompt[0] + defaultIfEmpty + s.SetFontPrompt[1], currentFont === defaultIfEmpty ? \"\" : currentFont)\n        if (promptReturnValue !== null) {\n            const newFont = promptReturnValue.length === 0 ? defaultIfEmpty : promptReturnValue\n            callback(newFont)\n        }\n    }\n\n}\n\n\nexport abstract class ParametrizedComponentBase<\n    TRepr extends ComponentRepr<THasIn, THasOut>, // JSON representation\n    TValue = ExtractValue<TRepr>, // internal value recomputed when inputs change\n    TParamDefs extends ExtractParamDefs<TRepr> = ExtractParamDefs<TRepr>,\n    TParams extends ExtractParams<TRepr> = ExtractParams<TRepr>,\n    TInputNodes extends NamedNodes<NodeIn> = NodesIn<TRepr>,\n    TOutputNodes extends NamedNodes<NodeOut> = NodesOut<TRepr>,\n    THasIn extends boolean = IsNonEmpty<TInputNodes>,\n    THasOut extends boolean = IsNonEmpty<TOutputNodes>,// in-out node presence\n> extends ComponentBase<\n    TRepr,\n    TValue,\n    TInputNodes,\n    TOutputNodes,\n    THasIn,\n    THasOut\n> {\n\n    private readonly _defP: SomeParamCompDef<TParamDefs>\n\n    protected constructor(\n        parent: DrawableParent,\n        [instance, def]: [\n            InstantiatedComponentDef<TRepr, TValue>,\n            SomeParamCompDef<TParamDefs>,\n        ],\n        saved: TRepr | undefined\n    ) {\n        super(parent, instance, saved)\n        this._defP = def\n    }\n\n    protected makeChangeParamsContextMenuItem<\n        TField extends (keyof TParams & keyof TParamDefs),\n        TVal extends TParams[TField] = TParams[TField]\n    >(\n        icon: IconName,\n        [caption, itemCaption]: [string, Template<[\"val\"]>],\n        currentValue: TVal,\n        fieldName: TField,\n        values?: readonly TVal[],\n    ): [MenuItemPlacement, MenuItem] {\n        const makeChangeValueItem = (val: TVal) => {\n            const isCurrent = currentValue === val\n            const icon = isCurrent ? \"check\" : \"none\"\n            const action = isCurrent ? () => undefined : () => {\n                this.replaceWithNewParams({ [fieldName]: val } as Partial<TParams>)\n            }\n            return MenuData.item(icon, itemCaption.expand({ val }), action)\n        }\n\n        if (values === undefined) {\n            values = (this._defP.paramDefs[fieldName] as ParamDef<TVal>).range\n        }\n        return [\"mid\", MenuData.submenu(icon, caption, values.map(makeChangeValueItem))]\n    }\n\n    protected makeChangeBooleanParamsContextMenuItem<\n        TField extends (keyof TParams & keyof TParamDefs),\n    >(\n        caption: string,\n        currentValue: boolean,\n        fieldName: TField,\n    ): [MenuItemPlacement, MenuItem] {\n        const icon = currentValue ? \"check\" : \"none\"\n        return [\"mid\", MenuData.item(icon, caption, () => {\n            this.replaceWithNewParams({ [fieldName]: !currentValue } as Partial<TParams>)\n        })]\n    }\n\n    protected replaceWithNewParams(newParams: Partial<TParams>): Component | undefined {\n        const currentRepr = this.toNodelessJSON()\n        const newRepr = { ...currentRepr, ...newParams }\n\n        const newComp = this._defP.makeFromJSON(this.parent, newRepr)\n        if (newComp === undefined) {\n            console.warn(\"Could not create component variant\")\n            return undefined\n        }\n\n        return this.replaceWithComponent(newComp)\n    }\n\n    public override keyDown(e: KeyboardEvent): void {\n        if (e.key === \"+\") {\n            this.tryChangeParam(0, true)\n        } else if (e.key === \"-\") {\n            this.tryChangeParam(0, false)\n        } else if (e.key === \"*\") {\n            this.tryChangeParam(1, true)\n        } else if (e.key === \"/\") {\n            this.tryChangeParam(1, false)\n        } else {\n            super.keyDown(e)\n        }\n    }\n\n    private tryChangeParam(paramIndex: number, increase: boolean): void {\n        const params = Object.keys(this._defP.defaultParams)\n        const numParams = params.length\n        if (paramIndex >= numParams) {\n            return\n        }\n        const paramName = params[paramIndex]\n        let currentParamValue = (this.toJSON() as any)[paramName]\n        const paramDef = this._defP.paramDefs[paramName]\n        if (currentParamValue === undefined) {\n            currentParamValue = paramDef.defaultValue\n        }\n\n        let newParamValue: number | boolean | undefined\n        if (isNumber(currentParamValue)) {\n            newParamValue = (paramDef as ParamDef<number>).nextValue(currentParamValue, increase)\n            if (newParamValue === undefined || newParamValue === currentParamValue) {\n                return\n            }\n        } else if (isBoolean(currentParamValue)) {\n            newParamValue = !currentParamValue\n        }\n        if (newParamValue === undefined) {\n            return\n        }\n\n        const newComp = this.replaceWithNewParams({ [paramName]: newParamValue } as Partial<TParams>)\n        if (newComp !== undefined) {\n            this.parent.editor.eventMgr.setCurrentComponentUnderPointer(newComp)\n        }\n    }\n\n}\n\n\n\n//\n// Node definition helpers\n//\n\nexport function group<const TDescArr extends readonly NodeDescInGroup[]>(orient: Orientation, nodes: TDescArr) {\n    return FixedArrayMap(nodes, ([x, y, name, opts]) => [x, y, orient, name, opts] as const)\n}\n\nexport function groupVertical(orient: \"e\" | \"w\", x: number, yCenter: number, num: number, spacing?: number, opts?: NodeInDescOptions) {\n    const spacing_ = spacing ?? (useCompact(num) ? 1 : 2)\n    const span = (num - 1) * spacing_\n    const yTop = yCenter - span / 2\n    return group(orient,\n        ArrayFillUsing(i => [x, yTop + i * spacing_, undefined, opts], num)\n    )\n}\n\nexport function groupVerticalMulti(orient: \"e\" | \"w\", x: number, yCenter: number, numOuter: number, numInner: number) {\n    const innerSpacing = useCompact(numInner === 1 ? numOuter : numInner) ? 1 : 2\n    const groupSpacing = numInner === 1 ? innerSpacing : innerSpacing * 2\n    const groupOffset = (numInner - 1) * innerSpacing + groupSpacing\n    const span = numOuter * (numInner - 1) * innerSpacing + (numOuter - 1) * groupSpacing\n    const yTop = yCenter - span / 2\n    return ArrayFillUsing(g => group(orient,\n        ArrayFillUsing(i => [x, yTop + g * groupOffset + i * innerSpacing], numInner)\n    ), numOuter)\n}\n\nexport function groupHorizontal(orient: \"n\" | \"s\", xCenter: number, y: number, num: number, spacing?: number, opts?: NodeInDescOptions) {\n    const spacing_ = spacing ?? (useCompact(num) ? 1 : 2)\n    const span = (num - 1) * spacing_\n    const xRight = xCenter + span / 2\n    return group(orient,\n        ArrayFillUsing(i => [xRight - i * spacing_, y, undefined, opts], num)\n    )\n}\n\n\n\n//\n// Repr and friends\n//\n\n/** Represents the JSON object holding properties from the passed component def */\nexport type Repr<TDef>\n    // case: Parameterized component def\n    = TDef extends ParametrizedComponentDef<infer THasIn, infer THasOut, infer TProps, infer TParamDefs, infer TInOutRecs, infer TValue, infer __TValueDefaults, infer TParams, infer __TResolvedParams, infer __TWeakRepr>\n    ? t.TypeOf<t.TypeC<TProps>> & ComponentRepr<THasIn, THasOut> & {\n        _META?: {\n            nodeRecs: TInOutRecs,\n            value: TValue,\n            paramDefs: TParamDefs,\n            params: TParams,\n        }\n    }\n    // case: Unparameterized component def\n    : TDef extends ComponentDef<infer TInOutRecs, infer TValue, infer __TValueDefaults, infer TProps, infer THasIn, infer THasOut, infer __TWeakRepr>\n    ? t.TypeOf<t.TypeC<TProps>> & ComponentRepr<THasIn, THasOut> & {\n        _META?: {\n            nodeRecs: TInOutRecs,\n            value: TValue,\n            paramDefs: {},\n            params: {},\n        }\n    }\n    // case: Abstract parameterized component def\n    : TDef extends {\n        repr: infer TProps extends t.Props,\n        params: infer TParamDefs extends Record<string, ParamDef<unknown>>,\n        makeNodes: (...args: any) => infer TInOutRecs,\n        initialValue?: (...args: any) => infer TValue,\n    }\n    ? Expand<t.TypeOf<t.TypeC<TProps>> & ComponentRepr<true, true> & {\n        _META?: {\n            nodeRecs: TInOutRecs,\n            value: TValue,\n            paramDefs: TParamDefs,\n            params: ParamsFromDefs<TParamDefs>,\n        }\n    }>\n    // case: Abstract component def\n    : TDef extends {\n        repr: infer TProps extends t.Props,\n        makeNodes: (...args: any) => infer TInOutRecs,\n        initialValue?: (...args: any) => infer TValue,\n    }\n    ? Expand<t.TypeOf<t.TypeC<TProps>> & ComponentRepr<true, true> & {\n        _META?: {\n            nodeRecs: TInOutRecs,\n            value: TValue,\n            paramDefs: {},\n            params: {},\n        }\n    }>\n    : never\n\nexport type Value<TDef>\n    = TDef extends ParametrizedComponentDef<infer __THasIn, infer __THasOut, infer __TProps, infer __TParamDefs, infer __TInOutRecs, infer TValue, infer __TValueDefaults, infer __TParams, infer __TResolvedParams, infer __TWeakRepr>\n    ? TValue : never\n\n\nfunction makeComponentRepr<\n    TProps extends t.Props,\n    THasIn extends boolean,\n    THasOut extends boolean,\n>(type: string, hasIn: THasIn, hasOut: THasOut, props: TProps) {\n    return t.intersection([t.type({\n        type: t.string,\n        ...props,\n    }), ComponentRepr(hasIn, hasOut)], type)\n}\n\n\n\n//\n// ComponentDef and friends\n//\n\nexport type ComponentGridSize = { gridWidth: number, gridHeight: number }\n\nexport type InstantiatedComponentDef<\n    TRepr extends t.TypeOf<t.Mixed>,\n    TValue,\n> = {\n    type: string,\n    idPrefix: string | ((self: any) => string),\n    size: ComponentGridSize,\n    nodeRecs: InOutRecs,\n    initialValue: (saved: TRepr | undefined) => TValue,\n    makeFromJSON: (parent: DrawableParent, data: Record<string, unknown>) => Component | undefined,\n}\n\nexport class ComponentDef<\n    TInOutRecs extends InOutRecs,\n    TValue,\n    TValueDefaults extends Record<string, unknown> = Record<string, unknown>,\n    TProps extends t.Props = {},\n    THasIn extends boolean = HasField<TInOutRecs, \"ins\">,\n    THasOut extends boolean = HasField<TInOutRecs, \"outs\">,\n    TRepr extends ReprWith<THasIn, THasOut, TProps> = ReprWith<THasIn, THasOut, TProps>,\n> implements InstantiatedComponentDef<TRepr, TValue> {\n\n    public readonly nodeRecs: TInOutRecs\n    public readonly repr: t.Decoder<Record<string, unknown>, TRepr>\n\n    public impl: (new (parent: DrawableParent, saved?: TRepr) => Component) = undefined as any\n\n    public constructor(\n        public readonly type: string,\n        public readonly idPrefix: string,\n        public readonly aults: TValueDefaults,\n        public readonly size: ComponentGridSize,\n        private readonly _buttonProps: LibraryButtonProps,\n        private readonly _initialValue: (saved: t.TypeOf<t.TypeC<TProps>> | undefined, defaults: TValueDefaults) => TValue,\n        makeNodes: (size: ComponentGridSize, defaults: TValueDefaults) => TInOutRecs,\n        repr?: TProps,\n    ) {\n        const nodes = makeNodes(size, aults)\n        this.nodeRecs = nodes\n\n        const hasIn = (\"ins\" in nodes) as THasIn\n        const hasOut = (\"outs\" in nodes) as THasOut\n        this.repr = makeComponentRepr(type, hasIn, hasOut, repr ?? ({} as TProps)) as any\n    }\n\n    public isValid() {\n        return this.impl !== undefined\n    }\n\n    public initialValue(saved?: TRepr): TValue {\n        return this._initialValue(saved, this.aults)\n    }\n\n    public button(visual: ComponentKey & ImageName | [ComponentKey, ImageName], options?: LibraryButtonOptions): LibraryItem {\n        return {\n            type: this.type,\n            visual,\n            width: this._buttonProps.imgWidth,\n            ...options,\n        }\n    }\n\n    public make<TComp extends Component>(parent: DrawableParent): TComp {\n        const comp = new this.impl(parent)\n        parent.components.add(comp)\n        return comp as TComp\n    }\n\n    public makeFromJSON(parent: DrawableParent, data: Record<string, unknown>): Component | undefined {\n        const validated = validateJson(data, this.repr, this.impl!.name ?? \"component\")\n        if (validated === undefined) {\n            return undefined\n        }\n        const comp = new this.impl(parent, validated)\n        parent.components.add(comp)\n        return comp\n    }\n}\n\n\nexport function defineComponent<\n    TInOutRecs extends InOutRecs,\n    TValue,\n    TValueDefaults extends Record<string, unknown> = Record<string, unknown>,\n    TProps extends t.Props = {},\n>(\n    type: string,\n    { idPrefix, button, repr, valueDefaults, size, makeNodes, initialValue }: {\n        idPrefix: string,\n        button: LibraryButtonProps,\n        repr?: TProps,\n        valueDefaults: TValueDefaults,\n        size: ComponentGridSize,\n        makeNodes: (size: ComponentGridSize, defaults: TValueDefaults) => TInOutRecs,\n        initialValue?: (saved: t.TypeOf<t.TypeC<TProps>> | undefined, defaults: TValueDefaults) => TValue\n    }\n) {\n    return new ComponentDef(type, idPrefix, valueDefaults, size, button, initialValue ?? (() => undefined as TValue), makeNodes, repr)\n}\n\n\n\nexport function defineAbstractComponent<\n    TProps extends t.Props,\n    TValueDefaults extends Record<string, unknown>,\n    TArgs extends any[],\n    TInOutRecs extends InOutRecs,\n    TValue,\n    TRepr extends t.TypeOf<t.TypeC<TProps>> = t.TypeOf<t.TypeC<TProps>>,\n>(\n    items: {\n        button: { imgWidth: number },\n        repr: TProps,\n        valueDefaults: TValueDefaults,\n        size: ComponentGridSize,\n        makeNodes: (...args: TArgs) => TInOutRecs,\n        initialValue: (saved: TRepr | undefined, defaults: TValueDefaults) => TValue\n    },\n) {\n    return {\n        ...items,\n        aults: items.valueDefaults,\n    }\n}\n\n\n\n//\n// ParameterizedComponentDef and friends\n//\n\nexport type SomeParamCompDef<TParamDefs extends Record<string, ParamDef<unknown>>> = ParametrizedComponentDef<boolean, boolean, t.Props, TParamDefs, InOutRecs, unknown, any, ParamsFromDefs<TParamDefs>, any, any>\n\nexport class ParamDef<T> {\n\n    public constructor(\n        public readonly defaultValue: T,\n        public readonly range: readonly T[],\n        public readonly isAllowed: (val: unknown) => boolean,\n    ) { }\n\n    public validate(n: T, context: string) {\n        if (this.isAllowed(n)) {\n            return n\n        } else {\n            console.warn(`Using default value ${this.defaultValue} for ${context} instead of invalid value ${n}; allowed values are: ${this.range.join(\", \")}`)\n            return this.defaultValue\n        }\n    }\n\n    public nextValue(value: T, increase: boolean): T | undefined {\n        const i = this.range.indexOf(value)\n        if (i === -1) {\n            return this.defaultValue\n        }\n        const j = i + (increase ? 1 : -1)\n        if (j < 0 || j >= this.range.length) {\n            return undefined\n        }\n        return this.range[j]\n    }\n\n}\n\nexport function param<T>(defaultValue: T, range?: readonly T[]): ParamDef<T> {\n    if (range === undefined) {\n        return new ParamDef(defaultValue, [], () => true)\n    }\n    return new ParamDef(defaultValue, range, val => range.includes(val as T))\n}\n\nexport function paramBool(): ParamDef<boolean> {\n    return new ParamDef(false, [false, true], isBoolean)\n}\n\nexport type ParamsFromDefs<TDefs extends Record<string, ParamDef<unknown>>> = {\n    [K in keyof TDefs]: TDefs[K] extends ParamDef<infer T> ? T : never\n}\n\nfunction paramDefaults<TParamDefs extends Record<string, ParamDef<unknown>>>(defs: TParamDefs): ParamsFromDefs<TParamDefs> {\n    return Object.fromEntries(Object.entries(defs).map(([k, v]) => [k, v.defaultValue])) as any\n}\n\nexport class ParametrizedComponentDef<\n    THasIn extends boolean,\n    THasOut extends boolean,\n    TProps extends t.Props,\n    TParamDefs extends Record<string, ParamDef<unknown>>,\n    TInOutRecs extends InOutRecs,\n    TValue,\n    TValueDefaults extends Record<string, unknown> = Record<string, unknown>,\n    TParams extends ParamsFromDefs<TParamDefs> = ParamsFromDefs<TParamDefs>,\n    TResolvedParams extends Record<string, unknown> = TParams,\n    TRepr extends ReprWith<THasIn, THasOut, TProps> = ReprWith<THasIn, THasOut, TProps>,\n> {\n\n    public readonly defaultParams: TParams\n    public readonly aults: TValueDefaults & TParams\n    public readonly repr: t.Decoder<Record<string, unknown>, TRepr>\n\n    public impl: (new (parent: DrawableParent, params: TResolvedParams, saved?: TRepr) => Component & TResolvedParams) = undefined as any\n\n    public constructor(\n        public readonly type: string,\n        public readonly idPrefix: string | ((params: TResolvedParams) => string),\n        hasIn: THasIn,\n        hasOut: THasOut,\n        public readonly variantName: (params: TParams) => string | string[],\n        private readonly _buttonProps: LibraryButtonProps,\n        repr: TProps,\n        valueDefaults: TValueDefaults,\n        public readonly paramDefs: TParamDefs,\n        public readonly size: (params: TResolvedParams) => ComponentGridSize,\n        private readonly _makeNodes: (params: TResolvedParams & ComponentGridSize, valueDefaults: TValueDefaults) => TInOutRecs,\n        private readonly _initialValue: (saved: TRepr | undefined, params: TResolvedParams) => TValue,\n        private readonly _validateParams: (params: TParams, jsonType: string | undefined, defaults: TParamDefs) => TResolvedParams,\n    ) {\n        this.defaultParams = paramDefaults(paramDefs) as TParams\n        this.aults = { ...valueDefaults, ...this.defaultParams }\n        this.repr = makeComponentRepr(type, hasIn, hasOut, repr ?? ({} as TProps)) as any\n    }\n\n    public isValid() {\n        return this.impl !== undefined\n    }\n\n    public with(params: TResolvedParams): [InstantiatedComponentDef<TRepr, TValue>, this] {\n        const size = this.size(params)\n        const nodes = this._makeNodes({ ...size, ...params }, this.aults)\n        return [{\n            type: this.type,\n            idPrefix: this.idPrefix,\n            size,\n            nodeRecs: nodes,\n            initialValue: (saved: TRepr | undefined) => this._initialValue(saved, params),\n            makeFromJSON: this.makeFromJSON.bind(this),\n        }, this]\n    }\n\n    public button(params: TParams, visual: ComponentKey & ImageName | [ComponentKey, ImageName], options?: LibraryButtonOptions): LibraryItem {\n        return {\n            type: this.type,\n            params: defParams<TParamDefs, TParams>(this, params),\n            visual,\n            width: this._buttonProps.imgWidth,\n            ...options,\n        }\n    }\n\n    public make<TComp extends Component>(parent: DrawableParent, params?: TParams): TComp {\n        const fullParams = params === undefined ? this.defaultParams : mergeWhereDefined(this.defaultParams, params)\n        const resolvedParams = this.doValidate(fullParams, undefined)\n        const comp = new this.impl(parent, resolvedParams)\n        parent.components.add(comp)\n        return comp as unknown as TComp\n    }\n\n    public makeFromJSON(parent: DrawableParent, data: Record<string, unknown>): Component | undefined {\n        const validated = validateJson(data, this.repr, this.impl!.name ?? \"component\")\n        if (validated === undefined) {\n            return undefined\n        }\n        const fullParams = mergeWhereDefined(this.defaultParams, validated)\n        const resolvedParams = this.doValidate(fullParams, validated.type)\n        const comp = new this.impl(parent, resolvedParams, validated)\n        parent.components.add(comp)\n        return comp\n    }\n\n    private doValidate(fullParams: TParams, jsonType: string | undefined) {\n        const className = this.impl?.name ?? \"component\"\n        // auto validate params\n        fullParams = Object.fromEntries(Object.entries(this.paramDefs).map(([paramName, paramDef]) => {\n            const paramValue = fullParams[paramName] ?? paramDef.defaultValue\n            if (paramName === \"type\") {\n                // skip type param, validated separately for Gate and GateArray\n                return [paramName, paramValue]\n            } else {\n                const validatedValue = paramDef.validate(paramValue, `${className}.${paramName}`)\n                return [paramName, validatedValue]\n            }\n        })) as TParams\n        return this._validateParams(fullParams, jsonType, this.paramDefs)\n    }\n\n}\n\nexport type Params<TDef>\n    // case: Parameterized component def\n    = TDef extends ParametrizedComponentDef<infer __THasIn, infer __THasOut, infer __TProps, infer __TParamDefs, infer __TInOutRecs, infer __TValue, infer __TValueDefaults, infer TParams, infer __TResolvedParams, infer __TWeakRepr> ? TParams\n    // case: Abstract base component def\n    : TDef extends { paramDefs: infer TParamDefs extends Record<string, ParamDef<unknown>> } ? ParamsFromDefs<TParamDefs>\n    : never\n\nexport type ResolvedParams<TDef>\n    // case: Parameterized component def\n    = TDef extends ParametrizedComponentDef<infer __THasIn, infer __THasOut, infer __TProps, infer __TParamDefs, infer __TInOutRecs, infer __TValue, infer __TValueDefaults, infer __TParams, infer TResolvedParams, infer __TWeakRepr> ? TResolvedParams\n    // case: Abstract base component def\n    : TDef extends { validateParams?: infer TFunc } ?\n    TFunc extends (...args: any) => any ? ReturnType<TFunc> : never\n    : never\n\n\ntype ReprWith<\n    THasIn extends boolean,\n    THasOut extends boolean,\n    TProps extends t.Props,\n> = t.TypeOf<t.TypeC<TProps>> & ComponentRepr<THasIn, THasOut>\n\n\nexport function defineParametrizedComponent<\n    THasIn extends boolean,\n    THasOut extends boolean,\n    TProps extends t.Props,\n    TValueDefaults extends Record<string, unknown>,\n    TParamDefs extends Record<string, ParamDef<unknown>>,\n    TInOutRecs extends InOutRecs,\n    TValue,\n    TParams extends ParamsFromDefs<TParamDefs> = ParamsFromDefs<TParamDefs>,\n    TResolvedParams extends Record<string, unknown> = TParams,\n    TRepr extends ReprWith<THasIn, THasOut, TProps> = ReprWith<THasIn, THasOut, TProps>,\n>(\n    type: string, hasIn: THasIn, hasOut: THasOut,\n    { variantName, idPrefix, button, repr, valueDefaults, params, validateParams, size, makeNodes, initialValue }: {\n        variantName: (params: TParams) => string | string[],\n        idPrefix: string | ((params: TResolvedParams) => string),\n        button: LibraryButtonProps,\n        repr: TProps,\n        valueDefaults: TValueDefaults,\n        params: TParamDefs,\n        validateParams?: (params: TParams, jsonType: string | undefined, defaults: TParamDefs) => TResolvedParams,\n        size: (params: TResolvedParams) => ComponentGridSize,\n        makeNodes: (params: TResolvedParams & ComponentGridSize, valueDefaults: TValueDefaults) => TInOutRecs,\n        initialValue: (saved: TRepr | undefined, params: TResolvedParams) => TValue,\n    },\n) {\n    return new ParametrizedComponentDef(type, idPrefix, hasIn, hasOut, variantName, button, repr, valueDefaults, params, size, makeNodes, initialValue, validateParams ?? ((params: TParams) => params as unknown as TResolvedParams))\n}\n\nfunction defParams<\n    TParamDefs extends Record<string, ParamDef<unknown>>,\n    TParams extends ParamsFromDefs<TParamDefs>\n>(\n    def: ParametrizedComponentDef<boolean, boolean, any, TParamDefs, InOutRecs, any, any, TParams, any, any>,\n    params: TParams\n): t.Branded<DefAndParams<TParamDefs, TParams>, \"params\"> {\n    return brand<\"params\">()({ def, params } as DefAndParams<TParamDefs, TParams>)\n}\n\nexport function defineAbstractParametrizedComponent<\n    TProps extends t.Props,\n    TValueDefaults extends Record<string, unknown>,\n    TParamDefs extends Record<string, ParamDef<unknown>>,\n    TInOutRecs extends InOutRecs,\n    TValue,\n    TParams extends ParamsFromDefs<TParamDefs> = ParamsFromDefs<TParamDefs>,\n    TResolvedParams extends Record<string, unknown> = TParams,\n    TRepr extends t.TypeOf<t.TypeC<TProps>> = t.TypeOf<t.TypeC<TProps>>,\n>(\n    items: {\n        button: { imgWidth: number },\n        repr: TProps,\n        valueDefaults: TValueDefaults,\n        params: TParamDefs,\n        validateParams?: (params: TParams, jsonType: string | undefined, defaults: TParamDefs) => TResolvedParams\n        size: (params: TResolvedParams) => ComponentGridSize,\n        makeNodes: (params: TResolvedParams & ComponentGridSize, valueDefaults: TValueDefaults) => TInOutRecs,\n        initialValue: (saved: TRepr | undefined, params: TResolvedParams) => TValue,\n    },\n) {\n    return items\n}\n", "import { type DrawableParent } from \"./components/Drawable\"\nimport { type LogicEditor } from \"./LogicEditor\"\nimport { Mode } from \"./utils\"\n\nfunction perm(mode: Mode) {\n    return (parent: DrawableParent) => parent.editor.mode >= mode\n}\n\nexport type UIPermission = keyof typeof UIPermissions\n\nexport const UIPermissions = {\n\n    canModifyTestCases: perm(Mode.FULL),\n\n    canModifyCustomComponents: perm(Mode.DESIGN),\n\n} as const satisfies Record<string, (editor: LogicEditor) => boolean>\n", "import * as t from \"io-ts\"\nimport { ComponentList } from \"../ComponentList\"\nimport { DrawParams, LogicEditor } from \"../LogicEditor\"\nimport { type MoveManager } from \"../MoveManager\"\nimport { type NodeManager } from \"../NodeManager\"\nimport { RecalcManager, RedrawManager, RedrawRequest } from \"../RedrawRecalcManager\"\nimport { type SVGRenderingContext } from \"../SVGRenderingContext\"\nimport { TestSuites } from \"../TestSuite\"\nimport { TestsPalette } from \"../TestsPalette\"\nimport { PointerDragEvent } from \"../UIEventManager\"\nimport { UndoManager } from \"../UndoManager\"\nimport { COLOR_COMPONENT_BORDER, COLOR_MOUSE_OVER, COLOR_MOUSE_OVER_DANGER, ColorString, DrawZIndex, GRID_STEP, inRect } from \"../drawutils\"\nimport { fixedWidthInContextMenu, Modifier, ModifierObject, span } from \"../htmlgen\"\nimport { IconName } from \"../images\"\nimport { S } from \"../strings\"\nimport { Expand, FixedArray, InteractionResult, Mode, PromiseOrValue, RichStringEnum, typeOrUndefined } from \"../utils\"\nimport { Component, ComponentBase } from \"./Component\"\nimport { type LinkManager } from \"./Wire\"\n\nexport type GraphicsRendering =\n    | CanvasRenderingContext2D & {\n        fill(): void,\n        beginGroup(className?: string): void\n        endGroup(): void,\n        createPath(path?: Path2D | string): Path2D\n    }\n    | SVGRenderingContext\n\nexport interface DrawContext {\n    g: GraphicsRendering\n    drawParams: DrawParams\n    isMouseOver: boolean\n    borderColor: ColorString\n    inNonTransformedFrame(f: (ctx: DrawContextExt) => unknown): void\n}\n\nexport interface DrawContextExt extends DrawContext {\n    rotatePoint(x: number, y: number): readonly [x: number, y: number]\n}\n\nexport type MenuItem =\n    | { _tag: \"sep\" }\n    | {\n        _tag: \"text\",\n        caption: Modifier\n    }\n    | {\n        _tag: \"submenu\",\n        icon: IconName | undefined,\n        caption: Modifier,\n        items: MenuData\n    }\n    | {\n        _tag: \"item\",\n        icon: IconName | undefined,\n        caption: Modifier,\n        shortcut: string | undefined,\n        danger: boolean | undefined,\n        action: (itemEvent: MouseEvent, menuEvent: MouseEvent) => PromiseOrValue<InteractionResult | undefined | void>\n    }\n\nexport type MenuData = MenuItem[]\nexport const MenuData = {\n    sep(): MenuItem {\n        return { _tag: \"sep\" }\n    },\n    text(caption: Modifier): MenuItem {\n        return { _tag: \"text\", caption }\n    },\n    item(icon: IconName | undefined, caption: Modifier, action: (itemEvent: MouseEvent, menuEvent: MouseEvent) => PromiseOrValue<InteractionResult | undefined | void>, shortcut?: string, danger?: boolean): MenuItem {\n        return { _tag: \"item\", icon, caption, action, shortcut, danger }\n    },\n    submenu(icon: IconName | undefined, caption: Modifier, items: MenuData): MenuItem {\n        return { _tag: \"submenu\", icon, caption, items }\n    },\n}\n\nexport type MenuItemPlacement = \"start\" | \"mid\" | \"end\" // where to insert items created by components\nexport type MenuItems = Array<[MenuItemPlacement, MenuItem]>\n\nclass _DrawContextImpl implements DrawContext, DrawContextExt {\n\n    private readonly entranceTransform: DOMMatrix\n    private readonly entranceTransformInv: DOMMatrix\n    private readonly componentTransform: DOMMatrix\n\n    public constructor(\n        comp: Drawable,\n        public readonly g: GraphicsRendering,\n        public readonly drawParams: DrawParams,\n        public readonly isMouseOver: boolean,\n        public readonly borderColor: ColorString,\n    ) {\n        this.entranceTransform = g.getTransform()\n        this.entranceTransformInv = this.entranceTransform.inverse()\n        comp.applyDrawTransform(g)\n        this.componentTransform = g.getTransform()\n    }\n\n    public exit() {\n        this.g.setTransform(this.entranceTransform)\n    }\n\n    public inNonTransformedFrame(f: (ctx: DrawContextExt) => unknown) {\n        this.g.setTransform(this.entranceTransform)\n        f(this)\n        this.g.setTransform(this.componentTransform)\n    }\n\n    public rotatePoint(x: number, y: number): readonly [x: number, y: number] {\n        return mult(this.entranceTransformInv, ...mult(this.componentTransform, x, y))\n    }\n\n}\n\nfunction mult(m: DOMMatrix, x: number, y: number): [x: number, y: number] {\n    return [\n        m.a * x + m.c * y + m.e,\n        m.b * x + m.d * y + m.f,\n    ]\n}\n\nexport interface DrawableParent {\n\n    isMainEditor(): this is LogicEditor\n    readonly editor: LogicEditor\n    // nice to forward...\n    readonly mode: Mode\n\n    // implemented as one per (editor + instantiated custom component)\n    readonly components: ComponentList\n    readonly testSuites: TestSuites\n    readonly nodeMgr: NodeManager\n    readonly linkMgr: LinkManager\n    readonly recalcMgr: RecalcManager\n\n    // defined only when editing the main circuit or a custom comp\n    readonly ifEditing: EditTools | undefined\n\n    stopEditingThis(): void\n    startEditingThis(tools: EditTools): void\n}\n\nexport type EditTools = {\n    readonly redrawMgr: RedrawManager\n    readonly moveMgr: MoveManager\n    readonly undoMgr: UndoManager\n    readonly testsPalette: TestsPalette\n    setDirty(reason: string): void\n    setToolCursor(cursor: string | null): void\n}\n\nexport abstract class Drawable {\n\n    public readonly parent: DrawableParent\n    private _ref: string | undefined = undefined\n\n    protected constructor(parent: DrawableParent) {\n        this.parent = parent\n        // this.requestRedraw({ why: \"newly created\", invalidateMask: true })\n    }\n\n    public get ref() {\n        return this._ref\n    }\n\n    public doSetValidatedId(id: string | undefined) {\n        // For components, the id must have been validated by a component list;\n        // for other drawbles, ids are largely unregulated, they can be \n        // undefined or even duplicated since we don't refer to them for nodes\n        this._ref = id\n    }\n\n    protected requestRedraw(req: Omit<RedrawRequest, \"component\">) {\n        const fullReq: RedrawRequest = req\n        fullReq.component = this\n        this.parent.ifEditing?.redrawMgr.requestRedraw(req)\n    }\n\n    public get drawZIndex(): DrawZIndex {\n        return DrawZIndex.Normal\n    }\n\n    public draw(g: GraphicsRendering, drawParams: DrawParams): void {\n        const inSelectionRect = drawParams.currentSelection?.isSelected(this) ?? false\n        const isPointerOver = this === drawParams.currentCompUnderPointer || inSelectionRect\n        const borderColor = !isPointerOver\n            ? COLOR_COMPONENT_BORDER\n            : drawParams.anythingMoving && this.lockPos\n                ? COLOR_MOUSE_OVER_DANGER\n                : COLOR_MOUSE_OVER\n\n        const ctx = new _DrawContextImpl(this, g, drawParams, isPointerOver, borderColor)\n        try {\n            this.doDraw(g, ctx)\n        } finally {\n            ctx.exit()\n        }\n    }\n\n    public applyDrawTransform(__g: GraphicsRendering) {\n        // by default, do nothing\n    }\n\n    protected abstract doDraw(g: GraphicsRendering, ctx: DrawContext): void\n\n    public abstract isOver(x: number, y: number): boolean\n\n    public abstract isInRect(rect: DOMRect): boolean\n\n    public get lockPos(): boolean {\n        return false\n    }\n\n    public cursorWhenMouseover(__e?: PointerEvent): string | undefined {\n        return undefined\n    }\n\n    public toString(): string {\n        return `${this.constructor.name}(${this.toStringDetails()})`\n    }\n\n    protected toStringDetails(): string {\n        return \"\"\n    }\n\n    public makeTooltip(): ModifierObject | undefined {\n        return undefined\n    }\n\n    public makeContextMenu(): MenuData | undefined {\n        return undefined\n    }\n\n    protected makeSetIdContextMenuItem(): MenuItem {\n        const currentId = this._ref\n        const s = S.Components.Generic.contextMenu\n        const caption: Modifier = currentId === undefined ? s.SetIdentifier : span(s.ChangeIdentifier[0], span(fixedWidthInContextMenu, currentId), s.ChangeIdentifier[1])\n        return MenuData.item(\"ref\", caption, () => {\n            this.runSetIdDialog()\n        }, \"\u2325\u21A9\uFE0E\")\n    }\n\n    private runSetIdDialog() {\n        const s = S.Components.Generic.contextMenu\n        // eslint-disable-next-line no-constant-condition\n        while (true) {\n            const currentId = this._ref\n            const newId = window.prompt(s.SetIdentifierPrompt, currentId)\n            if (newId === null) {\n                // cancel button pressed\n                break\n            }\n            if (newId === currentId) {\n                // no change\n                break\n            }\n\n            if (!(this instanceof ComponentBase)) {\n                // ids are unregulated\n                this.doSetValidatedId(newId.length === 0 ? undefined : newId)\n\n            } else {\n                // we're a component, check with the component list\n                if (newId.length === 0) {\n                    window.alert(s.IdentifierCannotBeEmpty)\n                    continue\n                }\n                const componentList = this.parent.components\n                const otherComp = componentList.get(newId)\n                if (otherComp === undefined) {\n                    // OK button pressed\n                    componentList.changeIdOf(this, newId)\n                } else {\n                    if (window.confirm(s.IdentifierAlreadyInUseShouldSwap)) {\n                        componentList.swapIdsOf(otherComp, this)\n                    } else {\n                        continue\n                    }\n                }\n            }\n            this.requestRedraw({ why: \"ref changed\" })\n            break\n        }\n    }\n\n    // Return { wantsDragEvents: true } (default) to signal the component\n    // wants to get all mouseDragged and the final mouseUp event. Useful to\n    // return false to allow drag destinations to get a mouseUp\n    public pointerDown(__: PointerEvent): { wantsDragEvents: boolean } {\n        // empty default implementation\n        return { wantsDragEvents: true }\n    }\n\n    public pointerDragged(__: PointerEvent) {\n        // empty default implementation\n    }\n\n    public pointerUp(__: PointerEvent): InteractionResult {\n        // empty default implementation\n        return InteractionResult.NoChange\n    }\n\n    // Return true to indicate it was handled and had an effect\n    // (and presumably doesn't need to be handled any more)\n    public pointerClicked(__: PointerEvent): InteractionResult {\n        // empty default implementation\n        return InteractionResult.NoChange\n    }\n\n    // Return true to indicate it was handled and had an effect\n    // (and presumably doesn't need to be handled any more)\n    public pointerDoubleClicked(__: PointerEvent): InteractionResult {\n        // empty default implementation\n        return InteractionResult.NoChange\n    }\n\n    public keyDown(e: KeyboardEvent): void {\n        if (e.key === \"Enter\" && e.altKey) {\n            this.runSetIdDialog()\n        }\n    }\n\n}\n\n\n// implemented by components with no array to hold the members\n// for direct access for performance\nexport interface HasPosition {\n\n    readonly posX: number\n    readonly posY: number\n\n}\n\nexport const Orientations_ = {\n    \"e\": {},\n    \"s\": {},\n    \"w\": {},\n    \"n\": {},\n} as const\n\nexport const Orientations = RichStringEnum.withProps<{\n}>()(Orientations_)\n\n\nexport type Orientation = typeof Orientations.type\n\nexport const Orientation = {\n    default: \"e\" as Orientation,\n    invert(o: Orientation): Orientation {\n        switch (o) {\n            case \"e\": return \"w\"\n            case \"w\": return \"e\"\n            case \"n\": return \"s\"\n            case \"s\": return \"n\"\n        }\n    },\n    nextClockwise(o: Orientation): Orientation {\n        switch (o) {\n            case \"e\": return \"s\"\n            case \"s\": return \"w\"\n            case \"w\": return \"n\"\n            case \"n\": return \"e\"\n        }\n    },\n    nextCounterClockwise(o: Orientation): Orientation {\n        switch (o) {\n            case \"e\": return \"n\"\n            case \"n\": return \"w\"\n            case \"w\": return \"s\"\n            case \"s\": return \"e\"\n        }\n    },\n    isVertical(o: Orientation): o is \"s\" | \"n\" {\n        return o === \"s\" || o === \"n\"\n    },\n    add(compOrient: Orientation, nodeOrient: Orientation): Orientation {\n        switch (compOrient) {\n            case \"e\": return nodeOrient\n            case \"w\": return Orientation.invert(nodeOrient)\n            case \"s\": return Orientation.nextClockwise(nodeOrient)\n            case \"n\": return Orientation.nextCounterClockwise(nodeOrient)\n        }\n    },\n}\n\n\n// for compact JSON repr, pos is an array\nexport const PositionSupportRepr = t.type({\n    pos: t.readonly(t.tuple([t.number, t.number])),\n    anchor: typeOrUndefined(t.string),\n    lockPos: typeOrUndefined(t.boolean),\n    orient: typeOrUndefined(t.keyof(Orientations_)),\n    ref: typeOrUndefined(t.string),\n})\n\nexport type PositionSupportRepr = Expand<t.TypeOf<typeof PositionSupportRepr>>\n\n\nexport abstract class DrawableWithPosition extends Drawable implements HasPosition {\n\n    private _posX: number\n    private _posY: number\n    private _lockPos: boolean\n    private _orient: Orientation\n    protected _anchor: Component | undefined = undefined // not set in ctor, always begins as undefined\n\n    protected constructor(parent: DrawableParent, saved?: PositionSupportRepr) {\n        super(parent)\n\n        // using null and not undefined to prevent subclasses from\n        // unintentionally skipping the parameter\n\n        if (saved !== undefined) {\n            // restoring from saved object\n            this.doSetValidatedId(saved.ref)\n            this._posX = saved.pos[0]\n            this._posY = saved.pos[1]\n            this._lockPos = saved.lockPos ?? false\n            this._orient = saved.orient ?? Orientation.default\n        } else {\n            // creating new object\n            const editor = this.parent.editor\n            this._posX = Math.max(0, editor.pointerX)\n            this._posY = editor.pointerY\n            this._lockPos = false\n            this._orient = Orientation.default\n        }\n    }\n\n    protected toJSONBase(): PositionSupportRepr {\n        return {\n            pos: [this.posX, this.posY] as const,\n            lockPos: !this._lockPos ? undefined : true,\n            orient: this.orient === Orientation.default ? undefined : this.orient,\n            anchor: this._anchor?.ref,\n            ref: this.ref, // last because usually stripped by serialization\n        }\n    }\n\n    public abstract get anchor()\n\n    public abstract set anchor(anchor: Component | undefined)\n\n    public get posX() {\n        return this._posX\n    }\n\n    public get posY() {\n        return this._posY\n    }\n\n    public override get lockPos() {\n        return this._lockPos\n    }\n\n    public isInRect(rect: DOMRect) {\n        return this._posX >= rect.left && this._posX <= rect.right && this._posY >= rect.top && this._posY <= rect.bottom\n    }\n\n    public get orient() {\n        return this._orient\n    }\n\n    public canRotate() {\n        return true\n    }\n\n    public canLockPos() {\n        return true\n    }\n\n    public doSetLockPos(lockPos: boolean) {\n        this._lockPos = lockPos\n        // no need to redraw\n    }\n\n    public doSetOrient(newOrient: Orientation) {\n        this._orient = newOrient\n        this.requestRedraw({ why: \"orientation changed\", invalidateMask: true })\n    }\n\n    public get width(): number {\n        return Orientation.isVertical(this._orient) ? this.unrotatedHeight : this.unrotatedWidth\n    }\n\n    public get height(): number {\n        return Orientation.isVertical(this._orient) ? this.unrotatedWidth : this.unrotatedHeight\n    }\n\n    public abstract get unrotatedWidth(): number\n\n    public abstract get unrotatedHeight(): number\n\n    public override applyDrawTransform(g: GraphicsRendering) {\n        const abcd: FixedArray<number, 4> | undefined = (() => {\n            switch (this._orient) {\n                case \"e\": return undefined\n                case \"s\": return [0, 1, -1, 0]\n                case \"w\": return [-1, 0, 0, -1]\n                case \"n\": return [0, -1, 1, 0]\n            }\n        })()\n\n        if (abcd !== undefined) {\n            g.translate(this.posX, this.posY)\n            g.transform(...abcd, 0, 0)\n            g.translate(-this.posX, -this.posY)\n        }\n    }\n\n    public isOver(x: number, y: number) {\n        // TODO this mode check should not actually be done here\n        return this.parent.mode >= Mode.CONNECT && this._isOverThisRect(x, y)\n    }\n\n    protected _isOverThisRect(x: number, y: number): boolean {\n        return inRect(this._posX, this._posY, this.width, this.height, x, y)\n    }\n\n    protected trySetPosition(posX: number, posY: number, snapToGrid: boolean): undefined | [number, number] {\n        const newPos = this.tryMakePosition(posX, posY, snapToGrid)\n        if (newPos === undefined) {\n            return\n        }\n        this.doSetPosition(newPos[0], newPos[1])\n        return newPos\n    }\n\n    protected tryMakePosition(posX: number, posY: number, snapToGrid: boolean): undefined | [number, number] {\n        const roundTo = snapToGrid ? (GRID_STEP / 2) : 1\n        posX = Math.round(posX / roundTo) * roundTo\n        posY = Math.round(posY / roundTo) * roundTo\n        if (posX !== this._posX || posY !== this.posY) {\n            return [posX, posY]\n        }\n        return undefined\n    }\n\n    protected doSetPosition(posX: number, posY: number) {\n        const delta: [number, number] = [posX - this._posX, posY - this._posY]\n        this._posX = posX\n        this._posY = posY\n        this.requestRedraw({ why: \"position changed\", invalidateMask: true })\n        this.positionChanged(delta)\n    }\n\n    protected abstract positionChanged(delta: [number, number]): void\n\n    protected makeOrientationAndPosMenuItems(): MenuItems {\n        const s = S.Components.Generic.contextMenu\n\n        const shortcuts = { e: \"\u2192\", s: \"\u2193\", w: \"\u2190\", n: \"\u2191\" }\n        const rotateItem: MenuItems = !this.canRotate() ? [] : [\n            [\"start\", MenuData.submenu(\"direction\", s.Orientation, [\n                ...Orientations.values.map(orient => {\n                    const isCurrent = this._orient === orient\n                    const icon = isCurrent ? \"check\" : \"none\"\n                    const caption = S.Orientations[orient]\n                    const action = isCurrent ? () => undefined : () => {\n                        this.doSetOrient(orient)\n                    }\n                    return MenuData.item(icon, caption, action, shortcuts[orient])\n                }),\n                MenuData.sep(),\n                MenuData.text(s.ChangeOrientationDesc),\n            ])],\n        ]\n\n        const lockPosItem: MenuItems = !this.canLockPos() ? [] : [\n            [\"start\", MenuData.item(this.lockPos ? \"check\" : \"none\", s.LockPosition, () => {\n                this.doSetLockPos(!this.lockPos)\n            }, \"L\")],\n        ]\n\n        const anchorItem: MenuItems = this._anchor === undefined ? [\n            [\"start\", MenuData.item(\"none\", s.SetAnchor, () => {\n                this.parent.editor.showMessage(S.Messages.SetAnchorPrompt)\n                this.parent.editor.setCurrentPointerAction(\"setanchor\", false, this)\n            })],\n        ] : [\n            [\"start\", MenuData.item(\"none\", span(s.ClearAnchor[0], span(fixedWidthInContextMenu, this._anchor.ref ?? \"???\"), s.ClearAnchor[1]), () => {\n                this.anchor = undefined\n            })],\n        ]\n\n        return [...rotateItem, ...lockPosItem, ...anchorItem]\n    }\n\n    public override keyDown(e: KeyboardEvent): void {\n        if (this.canRotate()) {\n            if (e.key === \"ArrowRight\") {\n                this.doSetOrient(\"e\")\n                return\n            } else if (e.key === \"ArrowDown\") {\n                this.doSetOrient(\"s\")\n                return\n            } else if (e.key === \"ArrowLeft\") {\n                this.doSetOrient(\"w\")\n                return\n            } else if (e.key === \"ArrowUp\") {\n                this.doSetOrient(\"n\")\n                return\n            }\n        }\n        if (this.canLockPos()) {\n            if (e.key === \"l\") {\n                this.doSetLockPos(!this.lockPos)\n                return\n            }\n        }\n        super.keyDown(e)\n    }\n\n}\n\n\ninterface DragContext {\n    mouseOffsetToPosX: number\n    mouseOffsetToPosY: number\n    lastAnchorX: number\n    lastAnchorY: number\n    createdClone: DrawableWithDraggablePosition | undefined\n}\n\n\nexport abstract class DrawableWithDraggablePosition extends DrawableWithPosition {\n\n    private _isMovingWithContext: undefined | DragContext = undefined\n\n    protected constructor(parent: DrawableParent, saved?: PositionSupportRepr) {\n        super(parent, saved)\n    }\n\n    public get anchor() {\n        return this._anchor\n    }\n\n    // This will typically be called in the deserialization once all components\n    // have been created\n    public set anchor(anchor: Component | undefined) {\n        if (this._anchor !== anchor) {\n            if (this._anchor !== undefined) {\n                this._anchor.removeAnchoredDrawable(this)\n            }\n            this._anchor = anchor\n            if (anchor !== undefined) {\n                anchor.addAnchoredDrawable(this)\n            }\n        }\n    }\n\n    public get isMoving() {\n        return this._isMovingWithContext !== undefined\n    }\n\n    private tryStartMoving(e: PointerEvent) {\n        if (this.lockPos) {\n            return\n        }\n        if (this._isMovingWithContext === undefined) {\n            const [offsetX, offsetY] = this.parent.editor.offsetXY(e)\n            this._isMovingWithContext = {\n                mouseOffsetToPosX: offsetX - this.posX,\n                mouseOffsetToPosY: offsetY - this.posY,\n                lastAnchorX: this.posX,\n                lastAnchorY: this.posY,\n                createdClone: undefined,\n            }\n        }\n    }\n\n    private tryStopMoving(e: PointerEvent): boolean {\n        let wasMoving = false\n        if (this._isMovingWithContext !== undefined) {\n            this._isMovingWithContext = undefined\n            wasMoving = true\n        }\n        this.parent.ifEditing?.moveMgr.setDrawableStoppedMoving(this, e)\n        return wasMoving\n    }\n\n\n    public setPosition(x: number, y: number, snapToGrid: boolean) {\n        const newPos = this.tryMakePosition(x, y, snapToGrid)\n        if (newPos !== undefined) { // position would change indeed\n            this.doSetPosition(...newPos)\n        }\n    }\n\n    public override pointerDown(e: PointerEvent) {\n        if (this.parent.mode >= Mode.CONNECT) {\n            if (e.metaKey) {\n                this.parent.linkMgr.startSettingAnchorFrom(this)\n                return { wantsDragEvents: false }\n            }\n            this.tryStartMoving(e)\n        }\n        return { wantsDragEvents: true }\n    }\n\n    public override pointerDragged(e: PointerDragEvent) {\n        if (this.parent.mode >= Mode.CONNECT && !this.lockPos) {\n            this.parent.ifEditing?.moveMgr.setDrawableMoving(this, e)\n            const [x, y] = this.parent.editor.offsetXY(e)\n            const snapToGrid = !e.metaKey\n            this.updateSelfPositionIfNeeded(x, y, snapToGrid, e)\n        }\n    }\n\n    public override pointerUp(e: PointerEvent): InteractionResult {\n        this._isMovingWithContext?.createdClone?.pointerUp(e)\n        const result = this.tryStopMoving(e)\n        return InteractionResult.fromBoolean(result)\n    }\n\n    protected updateSelfPositionIfNeeded(x: number, y: number, snapToGrid: boolean, e: PointerDragEvent): undefined | [number, number] {\n        if (this._isMovingWithContext === undefined) {\n            return undefined\n        }\n        const { mouseOffsetToPosX, mouseOffsetToPosY, lastAnchorX, lastAnchorY, createdClone } = this._isMovingWithContext\n\n        if (createdClone !== undefined) {\n            createdClone.pointerDragged(e)\n            return undefined\n        }\n\n        let targetX = x - mouseOffsetToPosX\n        let targetY = y - mouseOffsetToPosY\n        if (e.shiftKey) {\n            // move along axis only\n            const dx = Math.abs(lastAnchorX - targetX)\n            const dy = Math.abs(lastAnchorY - targetY)\n            if (dx <= dy) {\n                targetX = lastAnchorX\n            } else {\n                targetY = lastAnchorY\n            }\n        }\n        const newPos = this.tryMakePosition(targetX, targetY, snapToGrid)\n        if (newPos === undefined) {\n            return undefined\n        }\n\n        let clone\n        if (e.altKey && this.parent.mode >= Mode.DESIGN && (clone = this.makeClone(true)) !== undefined) {\n            this._isMovingWithContext.createdClone = clone\n            this.parent.editor.eventMgr.setCurrentComponentUnderPointer(clone)\n        } else {\n            this.doSetPosition(...newPos)\n        }\n        return newPos\n    }\n\n    protected makeClone(__setSpawning: boolean): DrawableWithDraggablePosition | undefined {\n        return undefined\n    }\n\n}\n", "import { distSquaredToWaypointIfOver, drawWaypoint, GRID_STEP, NodeStyle, WAYPOINT_DIAMETER } from \"../drawutils\"\nimport { HighImpedance, InteractionResult, isUnknown, LogicValue, Mode, RepeatFunction, toLogicValue, Unknown } from \"../utils\"\nimport { Component, InputNodeRepr, NodeGroup, OutputNodeRepr } from \"./Component\"\nimport { DrawableWithPosition, DrawContext, GraphicsRendering, Orientation } from \"./Drawable\"\nimport { Wire } from \"./Wire\"\n\nexport type Node = NodeIn | NodeOut\n\nexport const WireColor = {\n    black: \"black\",\n    red: \"red\",\n    blue: \"blue\",\n    yellow: \"yellow\",\n    green: \"green\",\n    white: \"white\",\n} as const\n\nexport const DEFAULT_WIRE_COLOR = WireColor.black\n\nexport type WireColor = keyof typeof WireColor\n\nexport abstract class NodeBase<N extends Node> extends DrawableWithPosition {\n\n    public readonly id: number\n    private _isAlive = true\n    private _value: LogicValue = false\n    private _leadLength: number\n    protected _initialValue: LogicValue | undefined = undefined\n    protected _forceValue: LogicValue | undefined\n    protected _color: WireColor = DEFAULT_WIRE_COLOR\n\n    public constructor(\n        public readonly component: Component,\n        nodeSpec: InputNodeRepr | OutputNodeRepr,\n        public readonly group: NodeGroup<N> | undefined,\n        public readonly shortName: string,\n        public readonly fullName: string,\n        private _gridOffsetX: number,\n        private _gridOffsetY: number,\n        public readonly hasTriangle: boolean,\n        relativePosition: Orientation,\n        private readonly _leadLengthOverride: number | undefined,\n    ) {\n        super(component.parent)\n        this.id = nodeSpec.id\n        if (\"force\" in nodeSpec) {\n            this._forceValue = toLogicValue(nodeSpec.force)\n        }\n        if (\"color\" in nodeSpec && nodeSpec.color !== undefined) {\n            this._color = nodeSpec.color\n        }\n        if (\"initialValue\" in nodeSpec && nodeSpec.initialValue !== undefined) {\n            const initialValue = toLogicValue(nodeSpec.initialValue)\n            this._initialValue = initialValue\n            this._value = initialValue\n        }\n        this.parent.nodeMgr.addLiveNode(this.asNode)\n        this.updatePositionFromParent()\n        this.doSetOrient(relativePosition)\n        this._leadLength = this.updateLeadLength()\n    }\n\n    private get asNode(): Node {\n        return this as unknown as Node\n    }\n\n    public updateLeadLength(leadLengthOverride?: number) {\n        return this._leadLength = leadLengthOverride ?? this._leadLengthOverride ?? this.defaultLeadLength(Orientation.isVertical(this.orient))\n    }\n\n    private defaultLeadLength(isVertical: boolean): number {\n        const bias = this.hasTriangle ? -2 : 0\n        if (isVertical) {\n            return bias + Math.abs(this._gridOffsetY) * GRID_STEP - this.component.unrotatedHeight / 2\n        }\n        return bias + Math.abs(this._gridOffsetX) * GRID_STEP - this.component.unrotatedWidth / 2\n    }\n\n    public get leadLength() {\n        return this._leadLength\n    }\n\n    public abstract get connectedWires(): readonly Wire[]\n\n    /**\n     * @returns [leadEndX, leadEndY, nodeX, nodeY, wireProlongDirection]\n     */\n    public get drawCoords(): [number, number, number, number, Orientation] {\n        const dir = this.wireProlongDirection\n        const x = this.posX\n        const y = this.posY\n        switch (dir) {\n            case \"e\":\n                return [x + this.leadLength, y, x, y, dir]\n            case \"w\":\n                return [x - this.leadLength, y, x, y, dir]\n            case \"n\":\n                return [x, y - this.leadLength, x, y, dir]\n            case \"s\":\n                return [x, y + this.leadLength, x, y, dir]\n        }\n    }\n\n    /**\n     * @returns [leadEndX, leadEndY, nodeX, nodeY]\n     */\n    public get drawCoordsInParentTransform(): [number, number, number, number] {\n        const x = this.posXInParentTransform\n        const y = this.posYInParentTransform\n        switch (this.orient) {\n            case \"e\":\n                return [x - this.leadLength, y, x, y]\n            case \"w\":\n                return [x + this.leadLength, y, x, y]\n            case \"n\":\n                return [x, y + this.leadLength, x, y]\n            case \"s\":\n                return [x, y - this.leadLength, x, y]\n        }\n    }\n\n    public get anchor(): Component | undefined {\n        return undefined\n    }\n\n    public set anchor(__: Component | undefined) {\n        throw new Error(\"Node does not support anchoring\")\n    }\n\n    public isOutput(): this is NodeOut {\n        return Node.isOutput(this.asNode)\n    }\n\n    public abstract get isClock(): boolean\n\n    public get unrotatedWidth() {\n        return WAYPOINT_DIAMETER\n    }\n\n    public get unrotatedHeight() {\n        return WAYPOINT_DIAMETER\n    }\n\n    public get color(): WireColor {\n        return this._color\n    }\n\n    public doSetColor(color: WireColor) {\n        this._color = color\n        this.propagateColor(color)\n        this.requestRedraw({ why: \"color changed\" })\n    }\n\n    protected propagateColor(__color: WireColor) {\n        // nothing by default; overridden in NodeOut\n    }\n\n    public override isOver(x: number, y: number) {\n        return this.distSquaredIfOver(x, y, false) !== undefined\n    }\n\n    public distSquaredIfOver(x: number, y: number, moreTolerant: boolean): number | undefined {\n        if (!(this.parent.mode >= Mode.CONNECT && this.acceptsMoreConnections)) {\n            return undefined\n        }\n        return distSquaredToWaypointIfOver(x, y, this.posX, this.posY, moreTolerant)\n    }\n\n    public destroy() {\n        this.preDestroy()\n        this._isAlive = false\n        this.parent.nodeMgr.removeLiveNode(this.asNode)\n    }\n\n    protected abstract preDestroy(): void\n\n    protected forceDraw() {\n        return false\n    }\n\n    protected doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        const mode = this.parent.mode\n        if ((mode < Mode.CONNECT && !this.forceDraw()) || !this.acceptsMoreConnections) {\n            return\n        }\n\n        const showForced = this._forceValue !== undefined && mode >= Mode.FULL\n        const showForcedWarning = mode >= Mode.FULL && !isUnknown(this._value) && !isUnknown(this.value) && this._value !== this.value\n        const parentOrientIsVertical = Orientation.isVertical(this.component.orient)\n        const neutral = this.parent.editor.options.hideWireColors\n        drawWaypoint(g, ctx, this.posX, this.posY, this.nodeDisplayStyle, this.value, ctx.isMouseOver, neutral, showForced, showForcedWarning, parentOrientIsVertical)\n    }\n\n    protected abstract get nodeDisplayStyle(): NodeStyle\n\n    public get isAlive() {\n        return this._isAlive\n    }\n\n    public get value(): LogicValue {\n        return this._forceValue !== undefined ? this._forceValue : this._value\n    }\n\n    public set value(val: LogicValue) {\n        const oldVisibleValue = this.value\n        if (val !== this._value) {\n            this._value = val\n            this.propagateNewValueIfNeeded(oldVisibleValue)\n        }\n    }\n\n    protected propagateNewValueIfNeeded(oldVisibleValue: LogicValue) {\n        const newVisibleValue = this.value\n        if (newVisibleValue !== oldVisibleValue) {\n            this.propagateNewValue(newVisibleValue)\n        }\n    }\n\n    protected abstract propagateNewValue(newValue: LogicValue): void\n\n    public abstract get forceValue(): LogicValue | undefined\n\n    public abstract get initialValue(): LogicValue | undefined\n\n    public get gridOffsetX() {\n        return this._gridOffsetX\n    }\n\n    public set gridOffsetX(newVal: number) {\n        this._gridOffsetX = newVal\n        this.updatePositionFromParent()\n    }\n\n    public get gridOffsetY() {\n        return this._gridOffsetY\n    }\n\n    public set gridOffsetY(newVal: number) {\n        this._gridOffsetY = newVal\n        this.updatePositionFromParent()\n    }\n\n    public abstract get acceptsMoreConnections(): boolean\n\n    public get posXInParentTransform() {\n        return this.component.posX + this._gridOffsetX * GRID_STEP\n    }\n\n    public get posYInParentTransform() {\n        return this.component.posY + this._gridOffsetY * GRID_STEP\n    }\n\n    public updatePositionFromParent() {\n        const component = this.component\n        const [appliedGridOffsetX, appliedGridOffsetY] = (() => {\n            switch (component.orient) {\n                case \"e\": return [+this._gridOffsetX, +this._gridOffsetY]\n                case \"w\": return [-this._gridOffsetX, -this._gridOffsetY]\n                case \"s\": return [-this._gridOffsetY, +this._gridOffsetX]\n                case \"n\": return [+this._gridOffsetY, -this._gridOffsetX]\n            }\n        })()\n        return super.trySetPosition(\n            component.posX + appliedGridOffsetX * GRID_STEP,\n            component.posY + appliedGridOffsetY * GRID_STEP,\n            false\n        ) ?? [this.posX, this.posY]\n    }\n\n    /**\n     * Points in the direction with which an outgoing wire from this node should start,\n     * e.g. to draw a smooth curve\n     */\n    public get wireProlongDirection(): Orientation {\n        switch (this.component.orient) {\n            case \"e\":\n                switch (this.orient) {\n                    case \"e\": return \"w\"\n                    case \"w\": return \"e\"\n                    case \"s\": return \"n\"\n                    case \"n\": return \"s\"\n                }\n                break\n            case \"w\": return this.orient\n            case \"s\":\n                switch (this.orient) {\n                    case \"e\": return \"n\"\n                    case \"w\": return \"s\"\n                    case \"s\": return \"e\"\n                    case \"n\": return \"w\"\n                }\n                break\n            case \"n\":\n                switch (this.orient) {\n                    case \"e\": return \"s\"\n                    case \"w\": return \"n\"\n                    case \"s\": return \"w\"\n                    case \"n\": return \"e\"\n                }\n        }\n    }\n\n    public override cursorWhenMouseover(__e?: PointerEvent) {\n        return \"crosshair\"\n    }\n\n    public override pointerDown(__: PointerEvent) {\n        this.parent.linkMgr.startDraggingWireFrom(this.asNode)\n        return { wantsDragEvents: false }\n    }\n\n    public override pointerUp(__: PointerEvent) {\n        const newWire = this.parent.linkMgr.stopDraggingWireOn(this.asNode)\n        if (newWire === undefined) {\n            return InteractionResult.NoChange\n        }\n        return tryMakeRepeatableNodeAction(newWire.startNode, newWire.endNode, (startNode, endNode) => {\n            const newWire = this.parent.linkMgr.addWire(startNode, endNode, true)\n            return newWire !== undefined\n        })\n    }\n\n}\n\nexport class NodeIn extends NodeBase<NodeIn> {\n\n    public readonly _tag = \"_nodein\"\n\n    private _incomingWire: Wire | null = null\n    public prefersSpike = false\n    public isClock = false\n\n    public get incomingWire() {\n        return this._incomingWire\n    }\n\n    public set incomingWire(wire: Wire | null) {\n        this._incomingWire = wire\n        if (wire === null) {\n            this.value = false\n        } else {\n            this.value = wire.startNode.value\n        }\n    }\n\n    public get connectedWires() {\n        return this._incomingWire === null ? [] : [this._incomingWire]\n    }\n\n    protected preDestroy() {\n        if (this._incomingWire !== null) {\n            this.parent.linkMgr.deleteWire(this._incomingWire)\n        }\n    }\n\n    public get acceptsMoreConnections() {\n        return this._incomingWire === null\n    }\n\n    protected override positionChanged(__delta: [number, number]) {\n        this._incomingWire?.invalidateWirePath()\n    }\n\n    public get forceValue() {\n        return undefined\n    }\n\n    public get initialValue() {\n        return undefined\n    }\n\n    protected propagateNewValue(__newValue: LogicValue) {\n        this.component.setNeedsRecalc()\n    }\n\n    protected get nodeDisplayStyle() {\n        const disconnected = this._incomingWire === null\n        return disconnected ? NodeStyle.IN_DISCONNECTED : NodeStyle.IN_CONNECTED\n    }\n\n}\n\n\nexport class NodeOut extends NodeBase<NodeOut> {\n\n    public readonly _tag = \"_nodeout\"\n\n    private readonly _outgoingWires: Wire[] = []\n\n    public get isClock() {\n        return false\n    }\n\n    public addOutgoingWire(wire: Wire) {\n        // don't add the same wire twice\n        const i = this._outgoingWires.indexOf(wire)\n        if (i === -1) {\n            this._outgoingWires.push(wire)\n        }\n    }\n\n    public removeOutgoingWire(wire: Wire) {\n        const i = this._outgoingWires.indexOf(wire)\n        if (i !== -1) {\n            this._outgoingWires.splice(i, 1)\n        }\n    }\n\n    public get outgoingWires(): readonly Wire[] {\n        return this._outgoingWires\n    }\n\n    public get connectedWires() {\n        return this._outgoingWires\n    }\n\n    protected preDestroy() {\n        // we need to make a copy of the array because the wires will remove themselves from the array\n        for (const wire of [...this._outgoingWires]) {\n            this.parent.linkMgr.deleteWire(wire)\n        }\n    }\n\n    public get acceptsMoreConnections() {\n        return true\n    }\n\n    protected override positionChanged(__delta: [number, number]) {\n        if (this._outgoingWires !== undefined) {\n            for (const wire of this._outgoingWires) {\n                wire.invalidateWirePath()\n            }\n        }\n    }\n\n    public findWireTo(node: NodeIn): Wire | undefined {\n        return this._outgoingWires.find(wire => wire.endNode === node)\n    }\n\n    public get forceValue() {\n        return this._forceValue\n    }\n\n    public set forceValue(newForceValue: LogicValue | undefined) {\n        const oldVisibleValue = this.value\n        this._forceValue = newForceValue\n        this.propagateNewValueIfNeeded(oldVisibleValue)\n        this.requestRedraw({ why: \"changed forced output value\", invalidateTests: true })\n    }\n\n    public get initialValue() {\n        return this._initialValue\n    }\n\n    protected override propagateColor(color: WireColor) {\n        for (const wire of this._outgoingWires) {\n            wire.endNode.doSetColor(color)\n        }\n    }\n\n    protected propagateNewValue(newValue: LogicValue) {\n        const now = this.parent.editor.timeline.logicalTime()\n        for (const wire of this._outgoingWires) {\n            wire.propagateNewValue(newValue, now)\n        }\n    }\n\n    protected override forceDraw() {\n        return this._outgoingWires.length > 1 && this.component.alwaysDrawMultiOutNodes\n    }\n\n    protected get nodeDisplayStyle() {\n        const disconnected = this._outgoingWires.length === 0\n        return disconnected ? NodeStyle.OUT_DISCONNECTED : NodeStyle.OUT_CONNECTED\n    }\n\n    public override pointerDoubleClicked(e: PointerEvent): InteractionResult {\n        const superChange = super.pointerDoubleClicked(e)\n        if (superChange.isChange) {\n            return superChange // already handled\n        }\n        if (this.parent.mode >= Mode.FULL && e.altKey && this.isOutput() && this.component.allowsForcedOutputs) {\n            this.forceValue = (() => {\n                switch (this._forceValue) {\n                    case undefined: return Unknown\n                    case Unknown: return HighImpedance\n                    case HighImpedance: return false\n                    case false: return true\n                    case true: return undefined\n                }\n            })()\n            return InteractionResult.SimpleChange\n        }\n        return InteractionResult.NoChange\n    }\n\n}\n\nexport const Node = {\n    isOutput(node: Node): node is NodeOut {\n        return node._tag === \"_nodeout\"\n    },\n}\n\nexport function tryMakeRepeatableNodeAction(startNode: NodeOut, endNode: NodeIn, handleNodes: (startNode: NodeOut, endNode: NodeIn) => boolean): InteractionResult {\n    // if we just connected a group, we can repeat if there are\n    // more free nodes in the group\n    const startGroup = startNode.group\n    const endGroup = endNode.group\n    if (startGroup === undefined || endGroup === undefined) {\n        return InteractionResult.SimpleChange\n    }\n\n    const startIndex = startGroup.indexOf(startNode)\n    const startIncrement = startIndex < startGroup.nodes.length - 1 ? 1 : -1\n    const endIndex = endGroup.indexOf(endNode)\n    const endIncrement = endIndex < endGroup.nodes.length - 1 ? 1 : -1\n\n    const makeRepeatFunction = function makeRepeatFunction(startIndex: number, endIndex: number): false | RepeatFunction {\n        if (startIndex >= startGroup.nodes.length || startIndex < 0\n            || endIndex >= endGroup.nodes.length || endIndex < 0) {\n            return false\n        }\n\n        return () => {\n            const success = handleNodes(startGroup.nodes[startIndex], endGroup.nodes[endIndex])\n            if (success) {\n                return makeRepeatFunction(startIndex + startIncrement, endIndex + endIncrement)\n            }\n            return false\n        }\n\n    }\n\n    const repeat = makeRepeatFunction(startIndex + startIncrement, endIndex + endIncrement)\n    if (repeat === false) {\n        return InteractionResult.SimpleChange\n    }\n\n    return InteractionResult.RepeatableChange(repeat)\n}", "import { Component, ComponentBase, ComponentName, isNodeArray, ReadonlyGroupedNodeArray } from \"./components/Component\"\nimport { LedColor } from \"./components/DisplayBar\"\nimport { DrawableWithPosition, DrawContext, DrawContextExt, GraphicsRendering, HasPosition, Orientation } from \"./components/Drawable\"\nimport { Node, WireColor } from \"./components/Node\"\nimport { RectangleColor } from \"./components/Rectangle\"\nimport { Waypoint } from \"./components/Wire\"\nimport { LogicEditor } from \"./LogicEditor\"\nimport { EdgeTrigger, FixedArray, FixedArrayAssert, InBrowser, isArray, isHighImpedance, isNumber, isString, isUnknown, LogicValue, Mode, Unknown } from \"./utils\"\n\n\n//\n// GRID, GENERAL\n//\n\nexport const GRID_STEP = 10\nexport const WIRE_WIDTH = 8\nexport const WIRE_WIDTH_HALF_SQUARED = (WIRE_WIDTH / 2) ** 2\nexport const WAYPOINT_DIAMETER = 8\nconst WAYPOINT_HIT_RADIUS_SQUARED = (WAYPOINT_DIAMETER / 2 + 6) ** 2\nconst WAYPOINT_HIT_RADIUS_SQUARED_TOLERANT = (WAYPOINT_DIAMETER / 2 + 10) ** 2\n\n\nexport function pxToGrid(x: number) {\n    return Math.round(x / GRID_STEP)\n}\n\n/**\n * Squared to avoid the square root operation\n */\nexport function distSquared(x0: number, y0: number, x1: number, y1: number): number {\n    const dx = x1 - x0\n    const dy = y1 - y0\n    return dx * dx + dy * dy\n}\n\nexport function inRect(centerX: number, centerY: number, width: number, height: number, pointX: number, pointY: number): boolean {\n    const w2 = width / 2\n    const h2 = height / 2\n    return pointX >= centerX - w2 && pointX < centerX + w2 &&\n        pointY >= centerY - h2 && pointY < centerY + h2\n}\n\nexport class DrawingRect {\n\n    public readonly width: number\n    public readonly height: number\n\n    public readonly top: number\n    public readonly left: number\n    public readonly bottom: number\n    public readonly right: number\n\n    public constructor(comp: Component, honorRotation: boolean) {\n        this.width = comp.unrotatedWidth\n        this.height = comp.unrotatedHeight\n\n        const swapDims = honorRotation && Orientation.isVertical(comp.orient)\n        if (swapDims) {\n            [this.width, this.height] = [this.height, this.width]\n        }\n\n        this.top = comp.posY - this.height / 2\n        this.left = comp.posX - this.width / 2\n        this.bottom = this.top + this.height\n        this.right = this.left + this.width\n    }\n\n    public outline(g: GraphicsRendering, margin: number = 0): Path2D {\n        const path = g.createPath()\n        path.rect(this.left - margin, this.top - margin, this.width + margin * 2, this.height + margin * 2)\n        return path\n    }\n\n}\n\nexport const DrawZIndex = {\n    Background: 0,\n    Normal: 1,\n    Overlay: 2,\n} as const\nexport type DrawZIndex = (typeof DrawZIndex)[keyof typeof DrawZIndex]\n\n\n//\n// COLORS\n//\n\nexport type ColorGreyLevel = number\nexport type ColorComponentsRGB = [number, number, number]\nexport type ColorComponentsRGBA = [number, number, number, number]\nexport type ColorString = string\n\nexport const COLOR_TRANSPARENT: ColorString = \"rgba(0,0,0,0)\"\nexport const USER_COLORS = {\n    COLOR_BACKGROUND: undefined as ColorString | undefined,\n}\n\nexport let COLOR_BACKGROUND: ColorString\nexport let COLOR_OFF_BACKGROUND: ColorString\nexport let COLOR_BACKGROUND_UNUSED_REGION: ColorString\nexport let COLOR_BACKGROUND_INVALID: ColorString\nexport let COLOR_BORDER: ColorString\nexport let COLOR_GRID_LINES: ColorString\nexport let COLOR_GRID_LINES_GUIDES: ColorString\nexport let COLOR_LABEL_OFF: ColorString\nexport let COLOR_LABEL_ON: ColorString\nexport let COLORCOMP_COMPONENT_BORDER: ColorGreyLevel\nexport let COLOR_COMPONENT_BORDER: ColorString\nexport let COLOR_COMPONENT_INNER_LABELS: ColorString\nexport let COLOR_COMPONENT_ID: ColorString\nexport let COLOR_GROUP_SPAN: ColorString\nexport let COLOR_WIRE_BORDER: ColorString\nexport let COLOR_MOUSE_OVER: ColorString\nexport let COLOR_MOUSE_OVER_NORMAL: ColorString\nexport let COLOR_MOUSE_OVER_DANGER: ColorString\nexport let COLOR_NODE_MOUSE_OVER: ColorString\nexport let COLORCOMPS_FULL: ColorComponentsRGB\nexport let COLOR_FULL: ColorString\nexport let COLOR_FULL_ALT: ColorString\nexport let COLOR_DARK_RED: ColorString\nexport let COLORCOMPS_EMPTY: ColorComponentsRGB\nexport let COLOR_EMPTY: ColorString\nexport let COLOR_EMPTY_ALT: ColorString\nexport let COLORCOMPS_UNKNOWN: ColorComponentsRGB\nexport let COLOR_UNKNOWN: ColorString\nexport let COLOR_UNKNOWN_ALT: ColorString\nexport let COLOR_HIGH_IMPEDANCE: ColorString\nexport let COLOR_ANCHOR_IN: ColorString\nexport let COLOR_ANCHOR_OUT: ColorString\nexport let COLOR_ANCHOR_NEW: ColorString\nexport let COLOR_GATE_NAMES: ColorString\nexport let COLOR_LED_ON: { [C in LedColor]: ColorString }\nexport let COLOR_WIRE: { [C in WireColor]: ColorString }\nexport let COLOR_RECTANGLE_BACKGROUND: { [C in RectangleColor]: ColorString }\nexport let COLOR_RECTANGLE_BORDER: { [C in RectangleColor]: ColorString }\nexport let PATTERN_STRIPED_GRAY: CanvasPattern\n\nexport const OPACITY_HIDDEN_ITEMS = 0.3\n\nlet _currentModeIsDark = false\ndoSetColors(_currentModeIsDark)\n\nexport function setDarkMode(darkMode: boolean, force: boolean) {\n    if (force || darkMode !== _currentModeIsDark) {\n        doSetColors(darkMode)\n        for (const editor of LogicEditor.allConnectedEditors) {\n            editor.wrapHandler(() => {\n                editor.setDark(darkMode)\n                editor.editTools.redrawMgr.requestRedraw({ why: \"dark/light mode switch\" })\n            })()\n        }\n    }\n}\n\nexport function isDarkMode() {\n    return _currentModeIsDark\n}\n\nfunction doSetColors(darkMode: boolean) {\n    if (!darkMode) {\n        // Light Theme\n        COLOR_BACKGROUND = ColorString(0xFF)\n        COLOR_OFF_BACKGROUND = ColorString(0xDF)\n        COLOR_BACKGROUND_INVALID = ColorString([0xFF, 0xBB, 0xBB])\n        COLOR_BACKGROUND_UNUSED_REGION = ColorString(0xEE)\n        COLOR_BORDER = ColorString(200)\n        COLOR_GRID_LINES = ColorString(240)\n        COLOR_GRID_LINES_GUIDES = ColorString(215)\n        COLOR_LABEL_OFF = ColorString(0xFF)\n        COLOR_LABEL_ON = ColorString(0)\n        COLORCOMP_COMPONENT_BORDER = 0x00\n        COLOR_COMPONENT_INNER_LABELS = ColorString(0xAA)\n        COLOR_COMPONENT_ID = ColorString([50, 50, 250])\n        COLOR_GROUP_SPAN = ColorString([128, 128, 128, 0.13])\n        COLOR_WIRE_BORDER = ColorString(80)\n        COLOR_MOUSE_OVER_NORMAL = ColorString([0, 0x7B, 0xFF])\n        COLOR_MOUSE_OVER_DANGER = ColorString([194, 34, 14])\n        COLOR_NODE_MOUSE_OVER = ColorString([128, 128, 128, 0.5])\n        COLORCOMPS_FULL = [255, 193, 7]\n        COLOR_DARK_RED = ColorString([180, 0, 0])\n        COLORCOMPS_EMPTY = [52, 58, 64]\n        COLORCOMPS_UNKNOWN = [152, 158, 164]\n        COLOR_HIGH_IMPEDANCE = ColorString([137, 114, 35])\n        COLOR_GATE_NAMES = ColorString([190, 190, 190])\n        COLOR_LED_ON = {\n            green: ColorString([20, 232, 20]),\n            red: ColorString([232, 20, 20]),\n            yellow: ColorString([232, 232, 20]),\n        }\n        COLOR_WIRE = {\n            black: COLOR_WIRE_BORDER,\n            red: ColorString([206, 63, 57]),\n            blue: ColorString([77, 102, 153]),\n            yellow: ColorString([245, 209, 63]),\n            green: ColorString([87, 136, 97]),\n            white: ColorString([230, 217, 199]),\n        }\n        PATTERN_STRIPED_GRAY = createStripedPattern(COLOR_BACKGROUND, \"rgba(128,128,128,0.2)\")\n\n    } else {\n        // Dark Theme\n        COLOR_BACKGROUND = USER_COLORS.COLOR_BACKGROUND ?? ColorString(30)\n        COLOR_OFF_BACKGROUND = ColorString(60)\n        COLOR_BACKGROUND_INVALID = ColorString([0xA8, 0x14, 0x14])\n        COLOR_BACKGROUND_UNUSED_REGION = ColorString(55)\n        COLOR_BORDER = ColorString(0x55)\n        COLOR_GRID_LINES = ColorString(30)\n        COLOR_GRID_LINES_GUIDES = ColorString(45)\n        COLOR_LABEL_OFF = ColorString(185)\n        COLOR_LABEL_ON = COLOR_BACKGROUND\n        COLORCOMP_COMPONENT_BORDER = 220\n        COLOR_COMPONENT_INNER_LABELS = ColorString(0x8B)\n        COLOR_COMPONENT_ID = ColorString([0, 0, 150])\n        COLOR_GROUP_SPAN = ColorString([128, 128, 128, 0.13])\n        COLOR_WIRE_BORDER = ColorString(175)\n        COLOR_MOUSE_OVER_NORMAL = ColorString([0, 0x7B, 0xFF])\n        COLOR_MOUSE_OVER_DANGER = ColorString([194, 34, 14])\n        COLOR_NODE_MOUSE_OVER = ColorString([128, 128, 128, 0.5])\n        COLORCOMPS_FULL = [255, 193, 7]\n        COLOR_DARK_RED = ColorString([180, 0, 0])\n        COLORCOMPS_EMPTY = [80, 89, 99]\n        COLORCOMPS_UNKNOWN = [108, 106, 98]\n        COLOR_HIGH_IMPEDANCE = ColorString([103, 84, 23])\n        COLOR_GATE_NAMES = ColorString([95, 95, 95])\n        COLOR_LED_ON = {\n            green: ColorString([11, 144, 11]),\n            red: ColorString([144, 11, 11]),\n            yellow: ColorString([144, 144, 11]),\n        }\n        COLOR_WIRE = {\n            black: COLOR_WIRE_BORDER,\n            red: ColorString([206, 63, 57]), // TODO update these colors below\n            blue: ColorString([77, 102, 153]),\n            yellow: ColorString([245, 209, 63]),\n            green: ColorString([87, 136, 97]),\n            white: ColorString([230, 217, 199]),\n        }\n\n        PATTERN_STRIPED_GRAY = createStripedPattern(COLOR_BACKGROUND, \"rgba(128,128,128,0.4)\")\n\n    }\n\n    // same for both light and dark theme thanks to alpha\n    COLOR_RECTANGLE_BACKGROUND = {\n        yellow: ColorString([230, 230, 0, 0.2]),\n        blue: ColorString([54, 54, 255, 0.2]),\n        green: ColorString([54, 255, 54, 0.2]),\n        red: ColorString([255, 54, 54, 0.2]),\n        grey: ColorString([120, 120, 120, 0.2]),\n        turquoise: ColorString([0, 210, 210, 0.2]),\n    }\n    COLOR_RECTANGLE_BORDER = {\n        yellow: ColorString([196, 196, 0, 0.5]),\n        blue: ColorString([115, 115, 255, 0.5]),\n        green: ColorString([0, 167, 0, 0.5]),\n        red: ColorString([214, 0, 0, 0.5]),\n        grey: ColorString([35, 35, 35, 0.5]),\n        turquoise: ColorString([0, 162, 162, 0.5]),\n    }\n    COLOR_COMPONENT_BORDER = ColorString(COLORCOMP_COMPONENT_BORDER)\n    COLOR_UNKNOWN = ColorString(COLORCOMPS_UNKNOWN)\n    setColorPointerOverIsDanger(false)\n    COLOR_FULL = ColorString(COLORCOMPS_FULL)\n    COLOR_EMPTY = ColorString(COLORCOMPS_EMPTY)\n    COLOR_FULL_ALT = ligherColor(COLOR_FULL, 40)\n    COLOR_EMPTY_ALT = ligherColor(COLOR_EMPTY, 80)\n    COLOR_UNKNOWN_ALT = ligherColor(COLOR_UNKNOWN, 50)\n    COLOR_ANCHOR_IN = ColorString([200, 100, 100, 0.5])\n    COLOR_ANCHOR_OUT = ColorString([100, 100, 200, 0.5])\n    COLOR_ANCHOR_NEW = ColorString([100, 100, 100, 0.5])\n\n    _currentModeIsDark = darkMode\n}\n\nfunction createStripedPattern(background: ColorString, stripeColor: string) {\n    if (!InBrowser) {\n        return null!\n    }\n    const canvas = document.createElement(\"canvas\")\n    const step = 4\n    canvas.width = 2 * step\n    canvas.height = 6 * step\n    const g = canvas.getContext(\"2d\")!\n    g.fillStyle = background\n    g.fillRect(0, 0, canvas.width, canvas.height)\n    g.fillStyle = stripeColor\n    g.beginPath()\n    g.moveTo(step, 0)\n    g.lineTo(canvas.width, 0)\n    g.lineTo(0, canvas.height)\n    g.lineTo(0, 3 * step)\n    g.closePath()\n    g.moveTo(step, canvas.height)\n    g.lineTo(canvas.width, canvas.height)\n    g.lineTo(canvas.width, 3 * step)\n    g.closePath()\n    g.fill()\n    const pattern = g.createPattern(canvas, \"repeat\")\n    if (pattern === null) {\n        console.warn(\"Failed to create pattern\")\n    }\n    return pattern!\n}\n\nexport function setColorPointerOverIsDanger(mouseOverIsDanger: boolean) {\n    COLOR_MOUSE_OVER = mouseOverIsDanger ? COLOR_MOUSE_OVER_DANGER : COLOR_MOUSE_OVER_NORMAL\n}\n\nexport function ColorString(input: ColorGreyLevel | ColorComponentsRGB | ColorComponentsRGBA): ColorString {\n    if (isArray(input)) {\n        if (input.length === 3) {\n            return `rgb(${input[0]},${input[1]},${input[2]})`\n        }\n        // else, rgba\n        return `rgba(${input[0]},${input[1]},${input[2]},${input[3]})`\n    }\n    // else, grey\n    return `rgb(${input},${input},${input})`\n}\n\nexport function colorCompsRGB(c: ColorString): ColorComponentsRGB {\n    const PREFIX = \"rgb(\"\n    if (c.startsWith(PREFIX)) {\n        c = c.substring(PREFIX.length)\n    }\n    const SUFFIX = \")\"\n    if (c.endsWith(SUFFIX)) {\n        c = c.substring(0, c.length - SUFFIX.length)\n    }\n    const comps = c.split(',').map(compStr => parseInt(compStr))\n    return FixedArrayAssert(comps, 3)\n}\n\nexport function ligherColor(col: string, offset: number): string {\n    const components = colorCompsRGB(col)\n    const newComponents = FixedArrayAssert(components.map(c => Math.min(255, c + offset)), 3)\n    return ColorString(newComponents)\n}\n\nexport function colorForLogicValue(value: LogicValue): ColorString {\n    return isUnknown(value) ? COLOR_UNKNOWN : isHighImpedance(value) ? COLOR_HIGH_IMPEDANCE : value ? COLOR_FULL : COLOR_EMPTY\n}\nexport function colorsForLogicValue(value: LogicValue): [ColorString, ColorString] {\n    return isUnknown(value) ? [COLOR_UNKNOWN, COLOR_UNKNOWN_ALT] : isHighImpedance(value) ? [COLOR_HIGH_IMPEDANCE, COLOR_HIGH_IMPEDANCE /* not alt because High-Z is not animated*/] : value ? [COLOR_FULL, COLOR_FULL_ALT] : [COLOR_EMPTY, COLOR_EMPTY_ALT]\n}\n\nexport function colorForFraction(fraction: number): ColorString {\n    const c: ColorComponentsRGB = [\n        (COLORCOMPS_FULL[0] - COLORCOMPS_EMPTY[0]) * fraction + COLORCOMPS_EMPTY[0],\n        (COLORCOMPS_FULL[1] - COLORCOMPS_EMPTY[1]) * fraction + COLORCOMPS_EMPTY[1],\n        (COLORCOMPS_FULL[2] - COLORCOMPS_EMPTY[2]) * fraction + COLORCOMPS_EMPTY[2],\n    ]\n    return ColorString(c)\n}\n\nexport function parseColorToRGBA(col: string): FixedArray<number, 4> | undefined {\n    const canvas = document.createElement('canvas')\n    canvas.width = canvas.height = 1\n    const ctx = canvas.getContext('2d')!\n    ctx.clearRect(0, 0, 1, 1)\n    // In order to detect invalid values,\n    // we can't rely on col being in the same format as what fillStyle is computed as,\n    // but we can ask it to implicitly compute a normalized value twice and compare.\n    ctx.fillStyle = '#000'\n    ctx.fillStyle = col\n    const computed = ctx.fillStyle\n    ctx.fillStyle = '#fff'\n    ctx.fillStyle = col\n    if (computed !== ctx.fillStyle) {\n        return undefined\n    }\n    ctx.fillRect(0, 0, 1, 1)\n    return FixedArrayAssert([...ctx.getImageData(0, 0, 1, 1).data], 4)\n}\n\n\n\n//\n// FONTS\n//\n\nexport const FONT_LABEL_DEFAULT = \"18px sans-serif\"\n\nconst _cachedAscents = new Map<string, number>()\n\nexport function fontAscentHalf(g: GraphicsRendering): number {\n    const font = g.font\n    let halfAscent = _cachedAscents.get(font)\n    if (halfAscent === undefined) {\n        halfAscent = Math.ceil((g.measureText(\"0\").actualBoundingBoxAscent - 1)) / 2\n        // console.log(`Computing half ascent for font ${font}: ${halfAscent}`)\n        _cachedAscents.set(font, halfAscent)\n    }\n    return halfAscent\n}\n\nexport const TextVAlign = {\n    bottom: 0,\n    middle: 1,\n    top: 2,\n} as const\n\nexport type TextVAlign = (typeof TextVAlign)[keyof typeof TextVAlign]\n\nexport function strokeTextVAlign(g: GraphicsRendering, valign: TextVAlign, text: string, x: number, y: number) {\n    // eslint-disable-next-line no-restricted-syntax\n    g.strokeText(text, x, y + valign * fontAscentHalf(g))\n}\n\nexport function fillTextVAlign(g: GraphicsRendering, valign: TextVAlign, text: string, x: number, y: number) {\n    // eslint-disable-next-line no-restricted-syntax\n    g.fillText(text, x, y + valign * fontAscentHalf(g))\n}\n\n\n\n//\n// NODE DEFINITIONS\n//\n\n\nexport function useCompact(numNodes: number) {\n    return numNodes >= 5\n}\n\nconst trivialNameMatcher = /^(In|Out|in|out)\\d*$/\nexport function isTrivialNodeName(name: string | undefined): boolean {\n    return name === undefined || trivialNameMatcher.test(name)\n}\n\n\n//\n// DRAWING\n//\n\n// Adding to current path\n\nexport function triangle(g: GraphicsRendering, x0: number, y0: number, x1: number, y1: number, x2: number, y2: number) {\n    g.moveTo(x0, y0)\n    g.lineTo(x1, y1)\n    g.lineTo(x2, y2)\n    g.closePath()\n}\n\nexport function circle(g: GraphicsRendering, cx: number, cy: number, d: number) {\n    const r = d / 2\n    g.ellipse(cx, cy, r, r, 0, 0, 2 * Math.PI)\n}\n\n// Stroking/filling\n\nexport function strokeSingleLine(g: GraphicsRendering, x0: number, y0: number, x1: number, y1: number) {\n    g.beginPath()\n    g.moveTo(x0, y0)\n    g.lineTo(x1, y1)\n    g.stroke()\n}\n\nexport function strokeBezier(g: GraphicsRendering, x0: number, y0: number, anchorX0: number, anchorY0: number, anchorX1: number, anchorY1: number, x1: number, y1: number) {\n    g.beginPath()\n    g.moveTo(x0, y0)\n    g.bezierCurveTo(anchorX0, anchorY0, anchorX1, anchorY1, x1, y1)\n    g.stroke()\n}\n\nexport function shouldDrawLeadsTo(nodes: readonly Node[]): boolean {\n    return nodes.map(whatToDrawForNode).some(x => x.drawLead)\n}\n\n/**\n * @returns [showWire, showTriangle]\n */\nexport function whatToDrawForNode(node: Node): { drawLabel: boolean, drawLead: boolean, drawTriangle: boolean, drawHiddenMark: boolean } {\n    const editor = node.parent.editor\n    const wires = node.connectedWires\n    const connected = wires.length > 0\n    if (editor.mode <= Mode.TRYOUT && !connected && !editor.options.showDisconnectedPins) {\n        return { drawLabel: false, drawLead: false, drawTriangle: false, drawHiddenMark: false }\n    }\n    const drawHiddenMark = connected && wires.some(w => w.isHidden)\n    return { drawLabel: true, drawLead: !connected || drawHiddenMark, drawTriangle: node.hasTriangle, drawHiddenMark }\n}\n\nexport function shouldDrawNodeLabel(nodeOrArray: Node | readonly Node[]): boolean {\n    if (isArray(nodeOrArray)) {\n        return nodeOrArray.map(whatToDrawForNode).some(x => x.drawLabel)\n    }\n    const node = nodeOrArray as Node\n    return whatToDrawForNode(node).drawLabel\n}\n\nexport function drawWireLineToComponent(g: GraphicsRendering, node: Node) {\n    const { drawLead, drawTriangle, drawHiddenMark } = whatToDrawForNode(node)\n    const [x1, y1, x0, y0] = node.drawCoordsInParentTransform\n    if (drawLead) {\n        const neutral = node.parent.editor.options.hideWireColors\n        drawStraightWireLine(g, x0, y0, x1, y1, node.value, node.color, neutral, undefined)\n    }\n    if (drawTriangle) {\n        g.strokeStyle = COLOR_COMPONENT_BORDER\n        g.fillStyle = COLOR_COMPONENT_BORDER\n        g.beginPath()\n        if (x0 === x1) {\n            // vertical line\n            const pointsDown = (node.isOutput() && y1 <= y0) || (!node.isOutput() && y0 <= y1)\n            if (pointsDown) {\n                const shift = node.isOutput() ? 1 : 0\n                triangle(g,\n                    x1 - 3, y1 - 2 + shift,\n                    x1 + 3, y1 - 2 + shift,\n                    x1, y1 + 1 + shift,\n                )\n            } else {\n                const shift = node.isOutput() ? -3 : -4\n                triangle(g,\n                    x1 - 3, y1 - 2 - shift,\n                    x1 + 3, y1 - 2 - shift,\n                    x1, y1 - 5 - shift,\n                )\n            }\n        } else if (y0 === y1) {\n            // horizontal line\n            const shift = node.isOutput() ? 1 : 0\n            const pointsRight = (node.isOutput() && x1 <= x0) || (!node.isOutput() && x0 <= x1)\n            if (pointsRight) {\n                triangle(g,\n                    x1 - 2 + shift, y1 - 3,\n                    x1 - 2 + shift, y1 + 3,\n                    x1 + 1 + shift, y1,\n                )\n            } else {\n                triangle(g,\n                    x1 + 2 - shift, y1 - 3,\n                    x1 + 2 - shift, y1 + 3,\n                    x1 - 1 - shift, y1,\n                )\n            }\n        } else {\n            console.log(`ERROR  wireLineToComponent cannot draw triangle as line is not vertical or horizontal between (${x0}, ${y0}) and (${x1}, ${y1})`)\n        }\n        g.lineWidth = 2\n        g.fill()\n        g.stroke()\n    }\n    if (drawHiddenMark) {\n        g.lineWidth = 2\n        g.strokeStyle = COLOR_WIRE[node.color]\n        g.beginPath()\n        if (Orientation.isVertical(node.orient)) {\n            g.moveTo(x0 + 5, y0 + 1.5)\n            g.lineTo(x0 - 5, y0 - 1.5)\n        } else {\n            g.moveTo(x0 + 1.5, y0 - 5)\n            g.lineTo(x0 - 1.5, y0 + 5)\n        }\n        g.stroke()\n    }\n}\n\nexport function drawStraightWireLine(g: GraphicsRendering, x0: number, y0: number, x1: number, y1: number, value: LogicValue, color: WireColor, neutral: boolean, timeFraction: number | undefined) {\n    g.beginPath()\n    g.moveTo(x0, y0)\n    g.lineTo(x1, y1)\n    strokeWireOutlineAndSingleValue(g, value, color, neutral, timeFraction)\n}\n\n\nexport function strokeWireOutlineAndSingleValue(g: GraphicsRendering, value: LogicValue, color: WireColor, neutral: boolean, timeFraction: number | undefined) {\n    strokeWireOutline(g, color, false)\n    strokeWireValue(g, value, undefined, neutral, timeFraction)\n}\n\n/**\n * Draws the outline of a wire.\n * @param isMouseOver determines whether the border color is thicker with the mouse-over color\n */\nexport function strokeWireOutline(g: GraphicsRendering, color: WireColor, isMouseOver: boolean) {\n    const oldLineCap = g.lineCap\n    g.lineCap = \"butt\"\n\n    const mainStrokeWidth = WIRE_WIDTH / 2\n    if (isMouseOver) {\n        g.lineWidth = mainStrokeWidth + 2\n        g.strokeStyle = COLOR_MOUSE_OVER\n    } else {\n        g.lineWidth = mainStrokeWidth\n        g.strokeStyle = COLOR_WIRE[color]\n    }\n\n    g.stroke()\n    g.lineCap = oldLineCap\n}\n\n/**\n * Draws the (potentially fractional, potentially animated) value on a wire.\n * @param g the graphics rendering context\n * @param value the value to draw on the line\n * @param color one of the predefined wire color palettes to use\n * @param lengthToDrawAndTotal undefined to draw the whole line, or a pair of number to draw only that many units/\"pixels\" and the total length\n * @param neutral overrides the default wire color with a neutral color\n * @param timeFraction undefined to show no animation within the value being propagated, or a number between 0 and 1 to show an dashed line animation\n * @param path undefined to draw the current path in the context; otherwise, the path to draw\n */\nexport function strokeWireValue(g: GraphicsRendering, value: LogicValue, lengthToDrawAndTotal: [number, number] | undefined, neutral: boolean, timeFraction: number | undefined) {\n    const oldLineCap = g.lineCap\n    g.lineCap = \"butt\"\n\n    // inner value\n    g.lineWidth = WIRE_WIDTH / 2 - 2\n    const [baseColor, altColor] = neutral ? [COLOR_UNKNOWN, COLOR_UNKNOWN_ALT] : colorsForLogicValue(value)\n    g.strokeStyle = baseColor\n    const animationDashSize = 20\n\n    if (lengthToDrawAndTotal !== undefined) {\n        // draw only up to the given length, no other animation\n        const [lengthToDraw, totalLength] = lengthToDrawAndTotal\n        g.setLineDash([lengthToDraw, totalLength])\n        g.stroke()\n        g.setLineDash([])\n\n    } else {\n        // whole line\n\n        if (timeFraction === undefined) {\n            // no animation\n            g.stroke()\n\n        } else {\n            // animate the line\n            g.setLineDash([animationDashSize, animationDashSize])\n            g.lineDashOffset = -timeFraction * animationDashSize * 2\n            g.stroke()\n\n            g.strokeStyle = altColor\n            g.lineDashOffset += animationDashSize\n            g.stroke()\n\n            g.lineDashOffset = 0\n            g.setLineDash([])\n        }\n    }\n\n    g.lineCap = oldLineCap\n}\n\nexport function distSquaredToWaypointIfOver(x: number, y: number, waypointX: number, waypointY: number, moreTolerant: boolean): number | undefined {\n    const distSq = distSquared(x, y, waypointX, waypointY)\n    const hitRadiusSquared = moreTolerant ? WAYPOINT_HIT_RADIUS_SQUARED_TOLERANT : WAYPOINT_HIT_RADIUS_SQUARED\n    if (distSq < hitRadiusSquared) {\n        return distSq\n    }\n    return undefined\n}\n\nexport enum NodeStyle {\n    IN_CONNECTED,\n    IN_DISCONNECTED,\n    OUT_CONNECTED,\n    OUT_DISCONNECTED,\n    IN_OUT,\n    WAYPOINT,\n}\n\nexport function drawWaypoint(g: GraphicsRendering, ctx: DrawContext, x: number, y: number, style: NodeStyle, value: LogicValue, isMouseOver: boolean, neutral: boolean, showForced: boolean, showForcedWarning: boolean, parentOrientIsVertical: boolean) {\n\n    const [circleColor, thickness] =\n        showForced\n            ? [COLOR_DARK_RED, 3] // show forced nodes with red border if not in teacher mode\n            : [COLOR_WIRE_BORDER, 1]   // show normally\n\n    g.strokeStyle = circleColor\n    g.lineWidth = thickness\n    g.fillStyle = style === NodeStyle.IN_DISCONNECTED ? COLOR_BACKGROUND : (neutral ? COLOR_UNKNOWN : colorForLogicValue(value))\n\n    g.beginPath()\n    circle(g, x, y, WAYPOINT_DIAMETER)\n    g.fill()\n    g.stroke()\n\n    if (isMouseOver) {\n        g.fillStyle = COLOR_NODE_MOUSE_OVER\n        g.beginPath()\n        circle(g, x, y, WAYPOINT_DIAMETER * 2)\n        g.fill()\n        g.stroke()\n    }\n\n    if (showForcedWarning) {\n        // forced value to something that is contrary to normal output\n        g.textAlign = \"center\"\n        g.fillStyle = circleColor\n        g.font = \"bold 14px sans-serif\"\n\n        ctx.inNonTransformedFrame(ctx => {\n            fillTextVAlign(g, TextVAlign.middle, \"!!\", ...ctx.rotatePoint(\n                x + (parentOrientIsVertical ? 13 : 0),\n                y + (parentOrientIsVertical ? 0 : -13),\n            ))\n        })\n    }\n}\n\nexport function drawClockInput(g: GraphicsRendering, left: number, clockNode: Node, trigger: EdgeTrigger) {\n    const clockY = clockNode.posYInParentTransform\n    g.strokeStyle = COLOR_COMPONENT_BORDER\n    g.lineWidth = 2\n\n    g.beginPath()\n    g.moveTo(left + 1, clockY - 4)\n    g.lineTo(left + 9, clockY)\n    g.lineTo(left + 1, clockY + 4)\n    g.stroke()\n    if (trigger === EdgeTrigger.falling) {\n        g.fillStyle = COLOR_COMPONENT_BORDER\n        g.closePath()\n        g.fill()\n    }\n\n    drawWireLineToComponent(g, clockNode)\n}\n\nexport function drawLabel(ctx: DrawContextExt, compOrient: Orientation, text: string | undefined, anchor: Orientation | undefined, x: number, y: Node | ReadonlyGroupedNodeArray<Node>): void\nexport function drawLabel(ctx: DrawContextExt, compOrient: Orientation, text: string | undefined, anchor: Orientation | undefined, x: Node | ReadonlyGroupedNodeArray<Node>, y: number): void\nexport function drawLabel(ctx: DrawContextExt, compOrient: Orientation, text: string | undefined, anchor: Orientation | undefined, x: number, y: number, referenceNode: Node | ReadonlyGroupedNodeArray<Node> | undefined): void\n\nexport function drawLabel(ctx: DrawContextExt, compOrient: Orientation, text: string | undefined, anchor: Orientation | undefined, x: number | Node | ReadonlyGroupedNodeArray<Node>, y: number | Node | ReadonlyGroupedNodeArray<Node>, referenceNode?: Node | ReadonlyGroupedNodeArray<Node>) {\n    if (text === undefined) {\n        return\n    }\n\n    if (referenceNode === undefined) {\n        if (!isNumber(x)) {\n            referenceNode = x\n        } else if (!isNumber(y)) {\n            referenceNode = y\n        }\n    }\n\n    let showLabel = true\n    if (referenceNode !== undefined) {\n        showLabel = shouldDrawNodeLabel(referenceNode)\n    }\n    if (!showLabel) {\n        return\n    }\n\n    const [halign, valign, dx, dy] = (() => {\n        if (anchor === undefined) {\n            return [\"center\", TextVAlign.middle, 0, 0] as const\n        }\n        const rotatedAnchor = Orientation.add(compOrient, anchor)\n        switch (rotatedAnchor) {\n            case \"e\": return [\"right\", TextVAlign.middle, -3, 0] as const\n            case \"w\": return [\"left\", TextVAlign.middle, 3, 0] as const\n            case \"n\": return [\"center\", TextVAlign.top, 0, 4] as const\n            case \"s\": return [\"center\", TextVAlign.bottom, 0, -4] as const\n        }\n    })()\n\n    const xx = isNumber(x) ? x :\n        (isNodeArray(x) ? x.group : x).posXInParentTransform\n    const yy = isNumber(y) ? y :\n        (isNodeArray(y) ? y.group : y).posYInParentTransform\n    const [finalX, finalY] = ctx.rotatePoint(xx, yy)\n\n    // we assume a color and a font have been set before this function is called\n    const g = ctx.g\n    g.textAlign = halign\n    fillTextVAlign(g, valign, text, finalX + dx, finalY + dy)\n}\n\nexport function drawValueTextCentered(g: GraphicsRendering, value: LogicValue, comp: HasPosition, opts?: { fillStyle?: string, small?: boolean }) {\n    drawValueText(g, value, comp.posX, comp.posY, opts)\n}\n\nexport function drawValueText(g: GraphicsRendering, value: LogicValue, x: number, y: number, opts?: { fillStyle?: string, small?: boolean }) {\n\n    let spec = \"\"\n    let label = \"\"\n\n    const small = opts?.small ?? false\n    const fillStyle = opts?.fillStyle\n\n    const sizeStrBig = small ? \"12\" : \"18\"\n    const sizeStrSmall = small ? \"10\" : \"16\"\n\n    if (isUnknown(value)) {\n        g.fillStyle = fillStyle ?? COLOR_LABEL_OFF\n        spec = \"bold \" + sizeStrBig\n        label = '?'\n    } else if (isHighImpedance(value)) {\n        g.fillStyle = fillStyle ?? COLOR_LABEL_OFF\n        spec = sizeStrSmall\n        label = 'Z'\n    } else if (value) {\n        g.fillStyle = fillStyle ?? COLOR_LABEL_ON\n        spec = \"bold \" + sizeStrBig\n        label = '1'\n    } else {\n        g.fillStyle = fillStyle ?? COLOR_LABEL_OFF\n        spec = sizeStrBig\n        label = '0'\n    }\n    g.font = `${spec}px sans-serif`\n    g.textAlign = \"center\"\n    fillTextVAlign(g, TextVAlign.middle, label, x, y)\n}\n\n\n//\n// MISC\n//\n\nexport const INPUT_OUTPUT_DIAMETER = 26\n\nconst NAME_POSITION_SETTINGS = {\n    right: [\"start\", TextVAlign.middle, 7],\n    left: [\"end\", TextVAlign.middle, 9],\n    top: [\"center\", TextVAlign.bottom, 5],\n    bottom: [\"center\", TextVAlign.top, 5],\n} as const\n\nfunction textSettingsForName(onRight: boolean, orient: Orientation) {\n    if (onRight) {\n        switch (orient) {\n            case \"e\": return NAME_POSITION_SETTINGS.right\n            case \"w\": return NAME_POSITION_SETTINGS.left\n            case \"n\": return NAME_POSITION_SETTINGS.top\n            case \"s\": return NAME_POSITION_SETTINGS.bottom\n        }\n    } else {\n        switch (orient) {\n            case \"e\": return NAME_POSITION_SETTINGS.left\n            case \"w\": return NAME_POSITION_SETTINGS.right\n            case \"n\": return NAME_POSITION_SETTINGS.bottom\n            case \"s\": return NAME_POSITION_SETTINGS.top\n        }\n    }\n}\n\nexport function drawComponentName(g: GraphicsRendering, ctx: DrawContextExt, name: ComponentName, value: string | number, comp: Component, onRight: boolean) {\n    if (name === undefined) {\n        return\n    }\n\n    let displayName\n    if (isString(name)) {\n        displayName = name\n    } else {\n        // dynamic name\n        if (value in name) {\n            displayName = `${name[value]}`\n        } else if (\"default\" in name) {\n            displayName = `${name.default}`\n        } else if (isUnknown(value)) {\n            displayName = Unknown\n        } else {\n            displayName = undefined\n        }\n    }\n\n    if (displayName === undefined) {\n        return\n    }\n\n    const [hAlign, vAlign, deltaX] = textSettingsForName(onRight, comp.orient)\n    g.fillStyle = COLOR_COMPONENT_BORDER\n    g.font = \"italic 18px sans-serif\"\n    const point = ctx.rotatePoint(comp.posX + (onRight ? 1 : -1) * (comp.unrotatedWidth / 2 + deltaX), comp.posY)\n    g.textAlign = hAlign\n    fillTextVAlign(g, vAlign, displayName, ...point)\n}\n\nexport function drawAnchorsAroundComponent(g: GraphicsRendering, comp: DrawableWithPosition, includeTo: boolean) {\n    const anchor = comp.anchor\n    if (anchor !== undefined) {\n        const color = includeTo ? COLOR_ANCHOR_IN : COLOR_ANCHOR_NEW\n        drawAnchorTo(g, comp.posX, comp.posY, anchor.posX, anchor.posY, [anchor.width, anchor.height], color, undefined)\n    }\n    if (includeTo) {\n        drawAllTo(comp)\n    }\n\n    function drawAllTo(drawable: DrawableWithPosition) {\n        if (!(drawable instanceof ComponentBase)) {\n            return\n        }\n\n        for (const anchoredComp of drawable.anchoredDrawables) {\n            if (anchoredComp instanceof Waypoint) {\n                continue\n            }\n            drawAnchorTo(g, anchoredComp.posX, anchoredComp.posY, drawable.posX, drawable.posY, [drawable.width, drawable.height], COLOR_ANCHOR_OUT, comp)\n            drawAllTo(anchoredComp)\n        }\n    }\n}\n\nexport function adjustLineEndpoint(\n    x1: number, y1: number,\n    x2: number, y2: number,\n    w: number, h: number\n): [number, number] {\n    // Half dimensions of the square\n    const halfW = w / 2\n    const halfH = h / 2\n\n    // Line direction\n    const dx = x2 - x1\n    const dy = y2 - y1\n\n    // Calculate t for intersections\n    const tValues: number[] = []\n\n    // Left edge (x = x2 - halfW)\n    if (dx !== 0) {\n        const tLeft = (x2 - halfW - x1) / dx\n        const yAtLeft = y1 + tLeft * dy\n        if (tLeft >= 0 && tLeft <= 1 && yAtLeft >= y2 - halfH && yAtLeft <= y2 + halfH) {\n            tValues.push(tLeft)\n        }\n    }\n\n    // Right edge (x = x2 + halfW)\n    if (dx !== 0) {\n        const tRight = (x2 + halfW - x1) / dx\n        const yAtRight = y1 + tRight * dy\n        if (tRight >= 0 && tRight <= 1 && yAtRight >= y2 - halfH && yAtRight <= y2 + halfH) {\n            tValues.push(tRight)\n        }\n    }\n\n    // Top edge (y = y2 - halfH)\n    if (dy !== 0) {\n        const tTop = (y2 - halfH - y1) / dy\n        const xAtTop = x1 + tTop * dx\n        if (tTop >= 0 && tTop <= 1 && xAtTop >= x2 - halfW && xAtTop <= x2 + halfW) {\n            tValues.push(tTop)\n        }\n    }\n\n    // Bottom edge (y = y2 + halfH)\n    if (dy !== 0) {\n        const tBottom = (y2 + halfH - y1) / dy\n        const xAtBottom = x1 + tBottom * dx\n        if (tBottom >= 0 && tBottom <= 1 && xAtBottom >= x2 - halfW && xAtBottom <= x2 + halfW) {\n            tValues.push(tBottom)\n        }\n    }\n\n    // Find the smallest t value\n    const t = Math.min(...tValues)\n\n    // Adjusted endpoint\n    const adjustedX = x1 + t * dx\n    const adjustedY = y1 + t * dy\n\n    return [adjustedX, adjustedY]\n}\n\nexport function drawAnchorTo(g: GraphicsRendering, sX: number, sY: number, tX: number, tY: number, distOrDim: number | [number, number], color: string, whileDraggingComp: DrawableWithPosition | undefined) {\n    // This is the arrowhead and the names of the points, and the dir and perp vectors:\n    //               at\n    //               +                 perp\n    //      st     mt|\\                ^\n    //      +--------+ \\               |\n    // +s   |           +th   +t         --> dir\n    //      +--------+ /\n    //      sb     mb|/\n    //               + \n    //               ab\n\n    const ds = 0 // distance from s to the projection of st or sb\n    const wl = 3 // width of the line, distance from st to sb\n    const wh = 8 // width of the arrowhead, distance from mt to at or mb to ab\n    const h = 20 // height of the arrowhead, distance from th to the projection of mt or mb\n    const [dt, [tWidth, tHeight]] = isNumber(distOrDim) ? [distOrDim, [0, 0]] : [10, distOrDim] // TODO use width/height of the component\n\n    // if the start is within the target (e.g., we're dragging a group and the anchor is the group's center),\n    // do nothing, because it's visually clear that they should move together\n    if (Math.abs(sX - tX) < tWidth / 2 && Math.abs(sY - tY) < tHeight / 2) {\n        return\n    }\n\n    // if the start is within the target's exclusion box, do nothing\n    if (whileDraggingComp !== undefined) {\n        const c = whileDraggingComp\n        if (sX >= c.posX - c.width / 2 && sX <= c.posX + c.width / 2 &&\n            sY >= c.posY - c.height / 2 && sY <= c.posY + c.height / 2) {\n            return\n        }\n    }\n\n    // direction vector\n    let dirX = tX - sX\n    let dirY = tY - sY\n    const magn = Math.sqrt(dirX * dirX + dirY * dirY)\n    if (magn < 20) {\n        // too short to draw\n        return\n    }\n    dirX /= magn\n    dirY /= magn\n\n    // perpendicular vector\n    const perpX = -dirY\n    const perpY = dirX\n\n    sX += ds * dirX\n    sY += ds * dirY\n    const st = [sX + wl * perpX, sY + wl * perpY]\n    const sb = [sX - wl * perpX, sY - wl * perpY]\n\n    tX -= dt * dirX\n    tY -= dt * dirY\n    const th = [tX, tY]\n\n    tX -= h * dirX\n    tY -= h * dirY\n    const mt = [tX + wl * perpX, tY + wl * perpY]\n    const at = [tX + wh * perpX, tY + wh * perpY]\n    const mb = [tX - wl * perpX, tY - wl * perpY]\n    const ab = [tX - wh * perpX, tY - wh * perpY]\n\n    // fill this polygon\n    g.fillStyle = color\n    g.beginPath()\n    g.moveTo(st[0], st[1])\n    g.lineTo(mt[0], mt[1])\n    g.lineTo(at[0], at[1])\n    g.lineTo(th[0], th[1])\n    g.lineTo(ab[0], ab[1])\n    g.lineTo(mb[0], mb[1])\n    g.lineTo(sb[0], sb[1])\n    g.closePath()\n    g.fill()\n}\n\n// B\u00E9zier utils\n\nexport type LineCoords = readonly [\n    /* 0 */ startX: number,\n    /* 1 */ startY: number,\n    /* 2 */ endX: number,\n    /* 3 */ endY: number,\n]\n\n/**\n * Note that the control points are at the end such that the second pair of coordinates is the end of the curve, just like for LineCoords.\n */\nexport type BezierCoordsInit = readonly [\n    /* 0 */ startX: number,\n    /* 1 */ startY: number,\n    /* 2 */ endX: number,\n    /* 3 */ endY: number,\n    /* 4 */ control1X: number,\n    /* 5 */ control1Y: number,\n    /* 6 */ control2X: number,\n    /* 7 */ control2Y: number,\n]\n\nexport type BezierCoordsMeta = {\n    boundingBox: [left: number, top: number, right: number, bottom: number],\n    tStepSize: number,\n}\n\nexport type BezierCoords = readonly [...BezierCoordsInit, meta: BezierCoordsMeta]\n\n\nexport function bezierPoint(t: number, coords: BezierCoordsInit | BezierCoords): [number, number] {\n    const u = 1 - t\n    const f1 = u ** 3\n    const f2 = 3 * u ** 2 * t\n    const f3 = 3 * u * t ** 2\n    const f4 = t ** 3\n    const x = f1 * coords[0] + f2 * coords[4] + f3 * coords[6] + f4 * coords[2]\n    const y = f1 * coords[1] + f2 * coords[5] + f3 * coords[7] + f4 * coords[3]\n    return [x, y]\n}\n\n/**\n * Find the t values for the X or Y extrema of a cubic B\u00E9zier curve in one dimension\n * @param forY false for x, true for y\n * @returns the t values for the extrema\n */\nfunction bezierExtrema(coords: BezierCoordsInit, forY: boolean): number[] {\n    const di = Number(forY)\n    const start = coords[0 + di] as number\n    const end = coords[2 + di] as number\n    const c1 = coords[4 + di] as number\n    const c2 = coords[6 + di] as number\n\n    // a, b, c factors of the quadradic equation that is given by setting\n    // the derivative of the bezier curve to zero (for x or y)\n    const a = -3 * start + 9 * c1 - 9 * c2 + 3 * end\n    const b = 6 * start - 12 * c1 + 6 * c2\n    const c = -3 * start + 3 * c1\n\n    const roots: number[] = []\n    let r\n    if (Math.abs(a) < 1e-6) {\n        // Quadratic or linear case\n        if (Math.abs(b) > 1e-6 && (r = -c / b) > 0 && r < 1) {\n            roots.push(r)\n        }\n    } else {\n        // Solve quadratic equation: at^2 + bt + c = 0\n        const discriminant = b ** 2 - 4 * a * c\n        if (discriminant >= 0) {\n            const sqrtD = Math.sqrt(discriminant)\n            r = (-b - sqrtD) / (2 * a)\n            if (r > 0 && r < 1) {\n                roots.push(r)\n            }\n            r = (-b + sqrtD) / (2 * a)\n            if (r > 0 && r < 1) {\n                roots.push(r)\n            }\n        }\n    }\n\n    return roots\n}\n\nfunction bezierBoundingBox(coords: BezierCoordsInit, margin: number): [left: number, top: number, right: number, bottom: number] {\n    const xExtrema = bezierExtrema(coords, false)\n    const yExtrema = bezierExtrema(coords, true)\n\n    const ts = [0, 1, ...xExtrema, ...yExtrema]\n\n    let minX = Infinity, maxX = -Infinity, minY = Infinity, maxY = -Infinity\n\n    for (const t of ts) {\n        const [x, y] = bezierPoint(t, coords)\n        minX = Math.min(minX, x)\n        maxX = Math.max(maxX, x)\n        minY = Math.min(minY, y)\n        maxY = Math.max(maxY, y)\n    }\n\n    return [minX - margin, minY - margin, maxX + margin, maxY + margin]\n}\n\nexport function isPointOnStraightWire(x: number, y: number, coords: LineCoords): boolean {\n    const [x1, y1, x2, y2] = coords\n    const length2 = (x2 - x1) ** 2 + (y2 - y1) ** 2\n\n    // if the segment length is zero, check if the point matches the start\n    if (length2 === 0) {\n        return x === x1 && y === y1\n    }\n\n    // projection of the point onto the segment (t parameter, 0 <= t <= 1)\n    const t = ((x - x1) * (x2 - x1) + (y - y1) * (y2 - y1)) / length2\n    if (t < 0 || t > 1) {\n        return false\n    }\n\n    // closest point on the segment to the given point\n    const closestX = x1 + t * (x2 - x1)\n    const closestY = y1 + t * (y2 - y1)\n    const dist2 = (x - closestX) ** 2 + (y - closestY) ** 2\n    return dist2 <= WIRE_WIDTH_HALF_SQUARED\n}\n\nexport function makeBezierCoords(coords: BezierCoordsInit): BezierCoords {\n    const [startX, startY, endX, endY] = coords\n    const endpointDist = Math.sqrt((endX - startX) ** 2 + (endY - startY) ** 2)\n    const numPoints = Math.max(3, Math.ceil(endpointDist / WIRE_WIDTH * 1.25))\n    const tStepSize = 1 / numPoints\n    const boundingBox = bezierBoundingBox(coords, WIRE_WIDTH / 2)\n    const bezierMEta = { tStepSize, boundingBox }\n    return [...coords, bezierMEta]\n}\n\nexport function isPointOnBezierWire(x: number, y: number, coords: BezierCoords): boolean {\n    const bezierMeta = coords[8]\n\n    // fast reject outside bounding box\n    const [left, top, right, bottom] = bezierMeta.boundingBox\n    if (x < left || x > right || y < top || y > bottom) {\n        return false\n    }\n\n    // sample a series of points on the curve and check if the point is close to any of them\n    const stepSize = bezierMeta.tStepSize\n    for (let t = 0; t <= 1; t += stepSize) {\n        const [wx, wy] = bezierPoint(t, coords)\n        const dist2 = (wx - x) ** 2 + (wy - y) ** 2\n        if (dist2 <= WIRE_WIDTH_HALF_SQUARED) {\n            return true\n        }\n    }\n    return false\n}\n\n//\n// DATA CONVERSIONS FOR DISPLAY PURPOSES\n//\n\nexport function displayValuesFromArray(values: readonly LogicValue[], mostSignificantFirst: boolean): [binaryStringRep: string, value: number | Unknown] {\n    // lowest significant bit is the first bit\n    let binaryStringRep = \"\"\n    let hasUnset = false\n    const add: (v: any) => void = mostSignificantFirst\n        ? v => binaryStringRep = binaryStringRep + v\n        : v => binaryStringRep = v + binaryStringRep\n\n    for (const value of values) {\n        if (isUnknown(value) || isHighImpedance(value)) {\n            hasUnset = true\n            add(value)\n        } else {\n            add(+value)\n        }\n    }\n    const value = hasUnset ? Unknown : parseInt(binaryStringRep, 2)\n    return [binaryStringRep, value]\n}\n\nexport function formatWithRadix(value: number | Unknown, radix: number, numBits: number, withPrefix = true): string {\n    if (isUnknown(value)) {\n        return Unknown\n    }\n\n    if (radix === -10) {\n        // signed int\n        const asBinStr = (value >>> 0).toString(2).padStart(numBits, '0')\n        if (asBinStr[0] === '1') {\n            // negative\n            const rest = parseInt(asBinStr.substring(1), 2)\n            // swap hyphen for minus sign as en-dash\n            return '\u2013' + String(-(-Math.pow(2, numBits - 1) + rest))\n        } else {\n            return String(value)\n        }\n    } else {\n        const padWidth = radix === 10 ? 1 : Math.ceil(Math.log(Math.pow(2, numBits)) / Math.log(radix))\n        const caption = value.toString(radix).toUpperCase().padStart(padWidth, '0')\n        const prefix = !withPrefix ? \"\" : (() => {\n            switch (radix) {\n                case 16: return \"0x\"\n                case 8: return \"0o\"\n                case 2: return \"0b\"\n                default: return \"\"\n            }\n        })()\n        return prefix + caption\n    }\n}", "import * as t from \"io-ts\"\nimport { COLOR_COMPONENT_BORDER, COLOR_NODE_MOUSE_OVER, COLOR_UNKNOWN, drawWireLineToComponent, GRID_STEP, useCompact } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, LogicValue, Mode, typeOrUndefined } from \"../utils\"\nimport { defineParametrizedComponent, groupVertical, param, ParametrizedComponentBase, Repr, ResolvedParams } from \"./Component\"\nimport { DrawableParent, DrawContext, GraphicsRendering, MenuData, MenuItems } from \"./Drawable\"\nimport { NodeIn, NodeOut } from \"./Node\"\nimport { WireStyle } from \"./Wire\"\n\n\nexport const Slant = {\n    none: \"none\",\n    up: \"up\",\n    down: \"down\",\n} as const\n\nexport type Slant = keyof typeof Slant\n\n\nexport const PassthroughDef =\n    defineParametrizedComponent(\"pass\", true, true, {\n        variantName: ({ bits }) => `pass-${bits}`,\n        idPrefix: \"pass\",\n        button: { imgWidth: 32 },\n        repr: {\n            bits: typeOrUndefined(t.number),\n            slant: typeOrUndefined(t.keyof(Slant)),\n        },\n        valueDefaults: {\n            slant: Slant.none,\n        },\n        params: {\n            bits: param(1, [1, 2, 3, 4, 8, 16]),\n        },\n        validateParams: ({ bits }) => ({\n            numBits: bits,\n        }),\n        size: ({ numBits }) => ({\n            gridWidth: 2,\n            gridHeight: useCompact(numBits) ? numBits : 2 * numBits,\n        }),\n        makeNodes: ({ numBits }) => ({\n            ins: {\n                In: groupVertical(\"w\", -1, 0, numBits, undefined, { leadLength: 10 }),\n            },\n            outs: {\n                Out: groupVertical(\"e\", +1, 0, numBits, undefined, { leadLength: 10 }),\n            },\n        }),\n        initialValue: (saved, { numBits }) => ArrayFillWith<LogicValue>(false, numBits),\n    })\n\nexport type PassthroughRepr = Repr<typeof PassthroughDef>\nexport type PassthroughParams = ResolvedParams<typeof PassthroughDef>\n\n\nexport class Passthrough extends ParametrizedComponentBase<PassthroughRepr> {\n\n    public readonly numBits: number\n    private _slant: Slant\n    private _hShift: [number, number]\n\n    public constructor(parent: DrawableParent, params: PassthroughParams, saved?: PassthroughRepr) {\n        super(parent, PassthroughDef.with(params), saved)\n        this.numBits = params.numBits\n        this._hShift = [0, 0] // updated by updateNodeOffsets\n        this._slant = saved?.slant ?? PassthroughDef.aults.slant\n        this.updateNodeOffsets()\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            bits: this.numBits === PassthroughDef.aults.bits ? undefined : this.numBits,\n            slant: this._slant === PassthroughDef.aults.slant ? undefined : this._slant,\n        }\n    }\n\n    public override destroy(): void {\n        type SavedNodeProps = WireStyle | undefined\n        type EndNodes = [NodeIn, SavedNodeProps][]\n\n        const savedWireEnds: [NodeOut, EndNodes][] = []\n        for (let i = 0; i < this.numBits; i++) {\n            const nodeOut = this.inputs.In[i].incomingWire?.startNode\n            if (nodeOut === undefined || !(nodeOut instanceof NodeOut)) {\n                continue\n            }\n            const nodeIns: EndNodes = []\n            for (const wire of this.outputs.Out[i].outgoingWires) {\n                const endNode = wire.endNode\n                if (endNode !== null) {\n                    nodeIns.push([endNode, wire.style])\n                }\n            }\n            if (nodeIns.length > 0) {\n                savedWireEnds.push([nodeOut, nodeIns])\n            }\n        }\n\n        super.destroy()\n\n        if (savedWireEnds.length > 0) {\n            const linkMgr = this.parent.linkMgr\n            for (const [nodeOut, nodeIns] of savedWireEnds) {\n                for (const [nodeIn, style] of nodeIns) {\n                    const wire = linkMgr.addWire(nodeOut, nodeIn, false)\n                    if (wire === undefined) {\n                        console.error(\"Failed to add wire back\")\n                        continue\n                    }\n                    // restore wire properties\n                    if (style !== undefined) {\n                        wire.doSetStyle(style)\n                    }\n                }\n            }\n        }\n    }\n\n    public override get alwaysDrawMultiOutNodes() {\n        return true\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        return this.inputValues(this.inputs.In)\n    }\n\n    protected override propagateValue(newValue: LogicValue[]): void {\n        this.outputValues(this.outputs.Out, newValue)\n    }\n\n    public override isOver(x: number, y: number): boolean {\n        if (this._slant === Slant.none) {\n            return super.isOver(x, y)\n        }\n\n        let yPosWithNoHOffset = 0\n        let f = 0\n        switch (this._slant) {\n            case Slant.up:\n                yPosWithNoHOffset = this.inputs.In[0].posY\n                f = -1\n                break\n            case Slant.down:\n                yPosWithNoHOffset = this.inputs.In[this.numBits - 1].posY\n                f = 1\n                break\n        }\n\n        const deltaX = (y - yPosWithNoHOffset) * f\n        return super.isOver(x + deltaX, y)\n    }\n\n    public override makeTooltip() {\n        return tooltipContent(undefined, mods(\n            div(S.Components.Passthrough.tooltip)\n        ))\n    }\n\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        const width = 3\n        const height = this.unrotatedHeight\n        const top = this.posY - height / 2\n        const bottom = top + height\n        const mouseoverMargin = 4\n        const [topShift, bottomShift] = this._hShift\n\n        for (const input of this.inputs._all) {\n            drawWireLineToComponent(g, input)\n        }\n\n        for (const output of this.outputs._all) {\n            drawWireLineToComponent(g, output)\n        }\n\n        g.beginPath()\n        g.moveTo(this.posX + topShift, top)\n        g.lineTo(this.posX + bottomShift, bottom)\n\n        if (ctx.isMouseOver) {\n            g.lineWidth = width + mouseoverMargin * 2\n            g.strokeStyle = COLOR_NODE_MOUSE_OVER\n            g.stroke()\n\n            g.strokeStyle = COLOR_COMPONENT_BORDER\n        } else {\n            g.strokeStyle = COLOR_UNKNOWN\n        }\n\n        if (this.parent.mode >= Mode.CONNECT) {\n            g.lineWidth = width\n            g.stroke()\n        }\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        if (this.numBits === 1) {\n            return []\n        }\n\n        const s = S.Components.Passthrough.contextMenu\n\n        const makeItemSetSlant = (desc: string, slant: Slant) => {\n            const isCurrent = this._slant === slant\n            const icon = isCurrent ? \"check\" : \"none\"\n            const action = isCurrent ? () => undefined : () => this.doSetSlant(slant)\n            return MenuData.item(icon, desc, action)\n        }\n\n        return [\n            [\"mid\", MenuData.submenu(\"slanted\", s.Slant, [\n                makeItemSetSlant(s.SlantNone, Slant.none),\n                MenuData.sep(),\n                makeItemSetSlant(s.SlantRight, Slant.down),\n                makeItemSetSlant(s.SlantLeft, Slant.up),\n            ])],\n            [\"mid\", MenuData.sep()],\n            this.makeChangeParamsContextMenuItem(\"inputs\", S.Components.Generic.contextMenu.ParamNumBits, this.numBits, \"bits\"),\n        ]\n    }\n\n    private doSetSlant(slant: Slant) {\n        this._slant = slant\n        this.updateNodeOffsets()\n        this.requestRedraw({ why: \"slant changed\", invalidateMask: true })\n    }\n\n    private updateNodeOffsets() {\n        const n = this.numBits\n        switch (this._slant) {\n            case \"none\":\n                for (let i = 0; i < n; i++) {\n                    this.inputs.In[i].gridOffsetX = -1\n                    this.outputs.Out[i].gridOffsetX = +1\n                }\n                this._hShift = [0, 0]\n                break\n            case \"down\": {\n                const f = n > 4 ? 1 : 2\n                for (let i = 0; i < n; i++) {\n                    const shift = f * (n - 1 - i)\n                    this.inputs.In[i].gridOffsetX = -1 + shift\n                    this.outputs.Out[i].gridOffsetX = +1 + shift\n                }\n                this._hShift = [f * (n - 0.5) * GRID_STEP, -f * GRID_STEP / 2]\n                break\n            }\n            case \"up\": {\n                const f = n > 4 ? 1 : 2\n                for (let i = 0; i < n; i++) {\n                    const shift = f * i\n                    this.inputs.In[i].gridOffsetX = -1 + shift\n                    this.outputs.Out[i].gridOffsetX = +1 + shift\n                }\n                this._hShift = [-f * GRID_STEP / 2, f * (n - 0.5) * GRID_STEP]\n                break\n            }\n        }\n\n    }\n\n}\nPassthroughDef.impl = Passthrough\n", "import { BezierCoords, bezierPoint, circle, isPointOnBezierWire, isPointOnStraightWire, LineCoords, WIRE_WIDTH } from \"../drawutils\"\nimport { GraphicsRendering } from \"./Drawable\"\n\nexport class WirePath {\n\n    private _length: number | undefined = undefined\n\n    public constructor(\n        public parts: ReadonlyArray<LineCoords | BezierCoords>\n    ) {}\n\n    public get length(): number {\n        if (this._length === undefined) {\n            const helperElement = document.createElementNS('http://www.w3.org/2000/svg', \"path\")\n            helperElement.setAttributeNS(null, \"d\", buildPathDesc(this.parts))\n            this._length = helperElement.getTotalLength()\n        }\n        return this._length\n    }\n\n    public draw(g: GraphicsRendering) {\n        g.beginPath()\n        const start = this.parts[0]\n        g.moveTo(start[0], start[1])\n        for (const part of this.parts) {\n            if (part.length === 4) {\n                // line\n                g.lineTo(part[2], part[3])\n            } else {\n                // bezier\n                g.bezierCurveTo(part[4], part[5], part[6], part[7], part[2], part[3])\n            }\n        }\n\n    }\n\n    public drawBezierDebug(g: GraphicsRendering) {\n        g.strokeStyle = \"red\"\n        g.lineWidth = 1\n        for (const part of this.parts) {\n            if (part.length === 4) {\n                continue\n            }\n            // bounding box\n            const bezierMeta = part[8]\n            const [left, top, right, bottom] = bezierMeta.boundingBox\n            g.strokeRect(left, top, right - left, bottom - top)\n\n            const stepSize = bezierMeta.tStepSize\n            // sample a series of points on the curve and check if the point is close to any of them\n            for (let t = 0; t <= 1; t += stepSize) {\n                const [x, y] = bezierPoint(t, part)\n                g.beginPath()\n                circle(g, x, y, WIRE_WIDTH)\n                g.stroke()\n            }\n        }\n    }\n\n    public isOver(x: number, y: number): boolean {\n        return this.partIndexIfMouseover(x, y) !== undefined\n    }\n\n    public partIndexIfMouseover(x: number, y: number): undefined | number {\n        for (let i = 0; i < this.parts.length - 1; i++) {\n            const part = this.parts[i]\n            if (part.length === 4) {\n                // line\n                if (isPointOnStraightWire(x, y, part)) {\n                    return i\n                }\n            } else {\n                // bezier\n                if (isPointOnBezierWire(x, y, part)) {\n                    return i\n                }\n            }\n        }\n        return undefined\n    }\n\n}\n\n\nfunction buildPathDesc(parts: ReadonlyArray<LineCoords | BezierCoords>): string {\n    const start = parts[0]\n    const pathDescParts = [`M${start[0]} ${start[1]}`]\n    for (const part of parts) {\n        if (part.length === 4) {\n            // line\n            pathDescParts.push(`L${part[2]} ${part[3]}`)\n        } else {\n            // bezier\n            pathDescParts.push(`C${part[4]} ${part[5]},${part[6]} ${part[7]},${part[2]} ${part[3]}`)\n        }\n    }\n    return pathDescParts.join(\" \")\n}", "import * as t from \"io-ts\"\nimport { COLOR_BACKGROUND, COLOR_COMPONENT_BORDER, COLOR_COMPONENT_INNER_LABELS, COLOR_GROUP_SPAN, displayValuesFromArray, drawLabel, drawWireLineToComponent, fillTextVAlign, GRID_STEP, TextVAlign } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillUsing, ArrayFillWith, isBoolean, isHighImpedance, isUnknown, LogicValue, typeOrUndefined, Unknown } from \"../utils\"\nimport { defineParametrizedComponent, groupHorizontal, groupVertical, param, paramBool, ParametrizedComponentBase, Repr, ResolvedParams, Value } from \"./Component\"\nimport { DrawableParent, DrawContext, GraphicsRendering, MenuData, MenuItems, Orientation } from \"./Drawable\"\nimport { Gate1Types, Gate2toNType, Gate2toNTypes } from \"./GateTypes\"\n\n\nexport const ALUDef =\n    defineParametrizedComponent(\"alu\", true, true, {\n        variantName: ({ bits, ext }) => `alu-${bits}${ext ? \"e\" : \"\"}`,\n        idPrefix: \"alu\",\n        button: { imgWidth: 50 },\n        repr: {\n            bits: typeOrUndefined(t.number),\n            ext: typeOrUndefined(t.boolean),\n            showOp: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {\n            showOp: true,\n        },\n        params: {\n            bits: param(4, [2, 4, 8, 16]),\n            ext: paramBool(), // has the extended opcode\n        },\n        validateParams: ({ bits, ext }) => ({\n            numBits: bits,\n            usesExtendedOpcode: ext,\n        }),\n        size: ({ numBits }) => ({\n            gridWidth: 7,\n            gridHeight: 19 + Math.max(0, numBits - 8) * 2,\n        }),\n        makeNodes: ({ numBits, usesExtendedOpcode, gridWidth, gridHeight }) => {\n            const inputCenterY = 5 + Math.max(0, (numBits - 8) / 2)\n            const outputX = gridWidth / 2 + 1\n            const bottom = (gridHeight + 1) / 2\n            const top = -bottom\n            const topGroupBits = usesExtendedOpcode ? 5 : 3\n            // top group is built together\n            const topGroup = groupHorizontal(\"n\", 0, top, topGroupBits, undefined, { leadLength: 20 })\n            const cin = topGroup.pop()!\n            // extracted to be mapped correctly when switching between reduced/extended opcodes\n            const opMode = topGroup.pop()!\n            return {\n                ins: {\n                    A: groupVertical(\"w\", -outputX, -inputCenterY, numBits),\n                    B: groupVertical(\"w\", -outputX, inputCenterY, numBits),\n                    Op: topGroup,\n                    Mode: opMode,\n                    Cin: [cin[0], cin[1], \"n\", `Cin (${S.Components.ALU.InputCinDesc})`, { leadLength: 10 }],\n                },\n                outs: {\n                    S: groupVertical(\"e\", outputX, 0, numBits),\n                    V: [0, bottom, \"s\", \"V (oVerflow)\", { leadLength: 20 }],\n                    Z: [2, bottom, \"s\", \"Z (Zero)\", { leadLength: 20 }],\n                    Cout: [-2, bottom, \"s\", `Cout (${S.Components.ALU.OutputCoutDesc})`, { leadLength: 20 }],\n                },\n            }\n        },\n        initialValue: (saved, { numBits }) => {\n            const false_ = false as LogicValue\n            return { s: ArrayFillWith(false_, numBits), v: false_, cout: false_ }\n        },\n    })\n\nexport type ALURepr = Repr<typeof ALUDef>\nexport type ALUParams = ResolvedParams<typeof ALUDef>\n\ntype ALUValue = Value<typeof ALUDef>\n\nexport type ALUOp = typeof ALUOps[number]\nexport const ALUOp = {\n    shortName(op: ALUOp): string {\n        return S.Components.ALU[op][0]\n    },\n    fullName(op: ALUOp): string {\n        return S.Components.ALU[op][1]\n    },\n}\n\n\n\nexport const ALUOps = [\n    \"A+B\", \"A-B\", \"A+1\", \"A-1\",\n    //0000  0001   0010   0011\n    \"-A\", \"B-A\", \"A*2\", \"A/2\",\n    //0100 0101   0110   0111\n    \"A|B\", \"A&B\", \"A|~B\", \"A&~B\",\n    //1000  1001   1010    1011\n    \"~A\", \"A^B\", \"A<<\", \"A>>\",\n    //1100 1101   1110   1111\n] as const\n\nconst ALUOpsReduced: readonly ALUOp[] = [\"A+B\", \"A-B\", \"A|B\", \"A&B\"]\n//                                         00     01    10     11\n// Used to lookup the ALUOp from the reduced opcode, which is compatible with the extended\n// opcode, provided the extra control bits are inserted between the leftmost and the\n// rightmost bits of the reduced opcode. Reason for this is to keep the leftmost bit\n// acting as a \"mode\" bit switching between arithmetic (0) and logic (1) operations.\n\nexport class ALU extends ParametrizedComponentBase<ALURepr> {\n\n    public readonly numBits: number\n    public readonly usesExtendedOpcode: boolean\n    private _showOp: boolean\n\n    public constructor(parent: DrawableParent, params: ALUParams, saved?: ALURepr) {\n        super(parent, ALUDef.with(params), saved)\n\n        this.numBits = params.numBits\n        this.usesExtendedOpcode = params.usesExtendedOpcode\n\n        this._showOp = saved?.showOp ?? ALUDef.aults.showOp\n    }\n\n    public toJSON() {\n        return {\n            bits: this.numBits === ALUDef.aults.bits ? undefined : this.numBits,\n            ext: this.usesExtendedOpcode === ALUDef.aults.ext ? undefined : this.usesExtendedOpcode,\n            ...this.toJSONBase(),\n            showOp: (this._showOp !== ALUDef.aults.showOp) ? this._showOp : undefined,\n        }\n    }\n\n    public override makeTooltip() {\n        const op = this.op\n        const s = S.Components.ALU.tooltip\n        const opDesc = isUnknown(op) ? s.SomeUnknownOperation : s.ThisOperation + \" \" + ALUOp.fullName(op)\n        return tooltipContent(s.title, mods(\n            div(`${s.CurrentlyCarriesOut} ${opDesc}.`)\n        ))\n    }\n\n    public get op(): ALUOp | Unknown {\n        const opValues = this.inputValues(this.inputs.Op)\n        opValues.push(this.inputs.Mode.value)\n        const opIndex = displayValuesFromArray(opValues, false)[1]\n        return isUnknown(opIndex) ? Unknown : (this.usesExtendedOpcode ? ALUOps : ALUOpsReduced)[opIndex]\n    }\n\n    protected doRecalcValue(): ALUValue {\n        const op = this.op\n\n        if (isUnknown(op)) {\n            return { s: ArrayFillWith(Unknown, this.numBits), v: Unknown, cout: Unknown }\n        }\n\n        const a = this.inputValues(this.inputs.A)\n        const b = this.inputValues(this.inputs.B)\n        const cin = this.inputs.Cin.value\n\n        return doALUOp(op, a, b, cin)\n    }\n\n    protected override propagateValue(newValue: ALUValue) {\n        this.outputValues(this.outputs.S, newValue.s)\n        this.outputs.V.value = newValue.v\n        this.outputs.Z.value = allZeros(newValue.s)\n        this.outputs.Cout.value = newValue.cout\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        const bounds = this.bounds()\n        const { left, top, right, bottom } = bounds\n        const lowerTop = top + 2 * GRID_STEP\n\n        // inputs\n        for (const input of this.inputs.A) {\n            drawWireLineToComponent(g, input)\n        }\n        for (const input of this.inputs.B) {\n            drawWireLineToComponent(g, input)\n        }\n        for (const input of this.inputs.Op) {\n            drawWireLineToComponent(g, input)\n        }\n        drawWireLineToComponent(g, this.inputs.Mode)\n        drawWireLineToComponent(g, this.inputs.Cin)\n\n        // outputs\n        for (const output of this.outputs.S) {\n            drawWireLineToComponent(g, output)\n        }\n        drawWireLineToComponent(g, this.outputs.Z)\n        drawWireLineToComponent(g, this.outputs.V)\n        drawWireLineToComponent(g, this.outputs.Cout)\n\n        // outline\n        g.fillStyle = COLOR_BACKGROUND\n        g.lineWidth = 3\n        g.strokeStyle = ctx.borderColor\n\n        g.beginPath()\n        g.moveTo(left, top)\n        g.lineTo(right, lowerTop)\n        g.lineTo(right, bottom - 2 * GRID_STEP)\n        g.lineTo(left, bottom)\n        g.lineTo(left, this.posY + 1 * GRID_STEP)\n        g.lineTo(left + 2 * GRID_STEP, this.posY)\n        g.lineTo(left, this.posY - 1 * GRID_STEP)\n        g.closePath()\n        g.fill()\n        g.stroke()\n\n        // groups\n        this.drawGroupBox(g, this.inputs.A.group, bounds)\n        this.drawGroupBox(g, this.inputs.B.group, bounds)\n        this.drawGroupBox(g, this.outputs.S.group, bounds)\n        // special Op group\n        g.beginPath()\n        const opGroupHeight = 8\n        const opGroupLeft = this.inputs.Mode.posXInParentTransform - 2\n        const opGroupRight = this.inputs.Op[0].posXInParentTransform + 2\n        const opGroupLeftTop = top + (this.usesExtendedOpcode ? 8 : 11)\n        const opGroupRightTop = top + 18\n\n        g.moveTo(opGroupLeft, opGroupLeftTop)\n        g.lineTo(opGroupRight, opGroupRightTop)\n        g.lineTo(opGroupRight, opGroupRightTop + opGroupHeight)\n        g.lineTo(opGroupLeft, opGroupLeftTop + opGroupHeight)\n        g.closePath()\n        g.fillStyle = COLOR_GROUP_SPAN\n        g.fill()\n\n        // labels\n        ctx.inNonTransformedFrame(ctx => {\n            g.fillStyle = COLOR_COMPONENT_INNER_LABELS\n            g.font = \"11px sans-serif\"\n\n            // bottom outputs\n            const isVertical = Orientation.isVertical(this.orient)\n            const carryHOffsetF = isVertical ? 0 : 1\n            drawLabel(ctx, this.orient, \"Z\", \"s\", this.outputs.Z, bottom - 16)\n            drawLabel(ctx, this.orient, \"V\", \"s\", this.outputs.V.posXInParentTransform + carryHOffsetF * 2, bottom - 10, this.outputs.V)\n            drawLabel(ctx, this.orient, \"Cout\", \"s\", this.outputs.Cout.posXInParentTransform + carryHOffsetF * 4, bottom - 7, this.outputs.Cout)\n\n            // top inputs\n            drawLabel(ctx, this.orient, \"Cin\", \"n\", this.inputs.Cin.posXInParentTransform, top + 4, this.inputs.Cin)\n\n            g.font = \"bold 11px sans-serif\"\n            drawLabel(ctx, this.orient, \"Op\", \"n\", (opGroupLeft + opGroupRight) / 2, top + 12, this.inputs.Op)\n\n            // left inputs\n            g.font = \"bold 12px sans-serif\"\n            drawLabel(ctx, this.orient, \"A\", \"w\", left, this.inputs.A)\n            drawLabel(ctx, this.orient, \"B\", \"w\", left, this.inputs.B)\n\n            // right outputs\n            drawLabel(ctx, this.orient, \"S\", \"e\", right, this.outputs.S)\n\n            if (this._showOp) {\n                const opName = isUnknown(this.op) ? \"??\" : ALUOp.shortName(this.op)\n                const size = opName.length === 1 ? 25 : opName.length === 2 ? 17 : 13\n                g.font = `bold ${size}px sans-serif`\n                g.fillStyle = COLOR_COMPONENT_BORDER\n                g.textAlign = \"center\"\n                fillTextVAlign(g, TextVAlign.middle, opName, ...ctx.rotatePoint(this.posX + 5, this.posY))\n            }\n        })\n    }\n\n    private doSetShowOp(showOp: boolean) {\n        this._showOp = showOp\n        this.requestRedraw({ why: \"show op changed\" })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.ALU.contextMenu\n        const icon = this._showOp ? \"check\" : \"none\"\n        const toggleShowOpItem = MenuData.item(icon, s.toggleShowOp, () => {\n            this.doSetShowOp(!this._showOp)\n        })\n\n        return [\n            [\"mid\", toggleShowOpItem],\n            [\"mid\", MenuData.sep()],\n            this.makeChangeParamsContextMenuItem(\"inputs\", S.Components.Generic.contextMenu.ParamNumBits, this.numBits, \"bits\"),\n            this.makeChangeBooleanParamsContextMenuItem(s.ParamUseExtendedOpcode, this.usesExtendedOpcode, \"ext\"),\n            [\"mid\", MenuData.sep()],\n            ...this.makeForceOutputsContextMenuItem(),\n        ]\n    }\n\n}\nALUDef.impl = ALU\n\nfunction allZeros(vals: LogicValue[]): LogicValue {\n    for (const v of vals) {\n        if (isUnknown(v) || isHighImpedance(v)) {\n            return Unknown\n        }\n        if (v === true) {\n            return false\n        }\n    }\n    return true\n}\n\n\nexport function doALUOp(op: ALUOp, a: readonly LogicValue[], b: readonly LogicValue[], cin: LogicValue):\n    ALUValue {\n    const numBits = a.length\n    switch (op) {\n        // arithmetic\n        case \"A+B\": return doALUAdd(a, b, cin)\n        case \"A*2\": return doALUAdd(a, a, cin)\n        case \"A+1\": return doALUAdd(a, [true, ...ArrayFillWith(false, numBits - 1)], cin)\n        case \"A/2\": return doALUSub([...a.slice(1), a[numBits - 1]], ArrayFillWith(false, numBits), cin)\n        case \"A-1\": return doALUSub(a, [true, ...ArrayFillWith(false, numBits - 1)], cin)\n        case \"A-B\": return doALUSub(a, b, cin)\n        case \"B-A\": return doALUSub(b, a, cin)\n        case \"-A\": return doALUSub(ArrayFillWith(false, numBits), a, cin)\n\n        // logic\n        default: {\n            let cout: LogicValue = false\n            const s: LogicValue[] = (() => {\n                switch (op) {\n                    case \"A|B\": return doALUBinOp(\"or\", a, b)\n                    case \"A&B\": return doALUBinOp(\"and\", a, b)\n                    case \"A^B\": return doALUBinOp(\"xor\", a, b)\n                    case \"A|~B\": return doALUBinOp(\"or\", a, doALUNot(b))\n                    case \"A&~B\": return doALUBinOp(\"and\", a, doALUNot(b))\n                    case \"~A\": return doALUNot(a)\n                    case \"A>>\": return [...a.slice(1), cin]\n                    case \"A<<\":\n                        cout = a[a.length - 1]\n                        return [cin, ...a.slice(0, a.length - 1)]\n                }\n            })()\n            return { s, v: false, cout }\n        }\n\n    }\n}\n\nexport function doALUAdd(a: readonly LogicValue[], b: readonly LogicValue[], cin: LogicValue): ALUValue {\n    const numBits = a.length\n    const sum3bits = (a: LogicValue, b: LogicValue, c: LogicValue): [LogicValue, LogicValue] => {\n        const asNumber = (v: LogicValue) => v === true ? 1 : 0\n        const numUnset = (isUnknown(a) || isHighImpedance(a) ? 1 : 0) + (isUnknown(b) || isHighImpedance(a) ? 1 : 0) + (isUnknown(c) || isHighImpedance(a) ? 1 : 0)\n        const sum = asNumber(a) + asNumber(b) + asNumber(c)\n\n        if (numUnset === 0) {\n            // we know exactly\n            return [sum % 2 === 1, sum >= 2]\n        }\n        if (numUnset === 1 && sum >= 2) {\n            // carry will always be set\n            return [Unknown, true]\n        }\n        // At this point, could be anything\n        return [Unknown, Unknown]\n    }\n\n    const s: LogicValue[] = ArrayFillWith(Unknown, numBits)\n    const cins: LogicValue[] = ArrayFillWith(Unknown, numBits + 1)\n    cins[0] = cin\n    for (let i = 0; i < numBits; i++) {\n        const [ss, cout] = sum3bits(cins[i], a[i], b[i])\n        s[i] = ss\n        cins[i + 1] = cout\n    }\n    const cout = cins[numBits]\n    const v = !isBoolean(cout) || !isBoolean(cins[numBits - 2]) ? Unknown : cout !== cins[numBits - 1]\n    return { s, cout, v }\n}\n\nexport function doALUSub(a: readonly LogicValue[], b: readonly LogicValue[], cin: LogicValue): ALUValue {\n    const numBits = a.length\n    const s: LogicValue[] = ArrayFillWith(Unknown, numBits)\n    const toInt = (vs: readonly LogicValue[]): number | undefined => {\n        let s = 0\n        let col = 1\n        for (const v of vs) {\n            if (isUnknown(v)) {\n                return undefined\n            }\n            s += Number(v) * col\n            col *= 2\n        }\n        return s\n    }\n\n    const aInt = toInt(a)\n    const bInt = toInt(b)\n    let cout: LogicValue = Unknown\n    let v: LogicValue = Unknown\n    if (aInt !== undefined && bInt !== undefined && isBoolean(cin)) {\n        // otherwise, stick with default Unset values everywhere\n        let yInt = aInt - bInt - (cin ? 1 : 0)\n        // console.log(`${aInt} - ${bInt} = ${yInt}`)\n        // we can get anything from (max - (-min)) = 7 - (-8) = 15\n        // to (min - max) = -8 - 7 = -15\n        if (yInt < 0) {\n            yInt += Math.pow(2, numBits)\n        }\n        // now we have everything between 0 and 15\n        const yBinStr = (yInt >>> 0).toString(2).padStart(numBits, '0')\n        const lastIdx = numBits - 1\n        for (let i = 0; i < numBits; i++) {\n            s[i] = yBinStr[lastIdx - i] === '1'\n        }\n\n        cout = bInt > (aInt - (cin ? 1 : 0))\n\n        const aNeg = a[lastIdx] === true // NOT redundant comparison\n        const bNeg = b[lastIdx] === true\n        const yNeg = s[lastIdx] === true\n\n        // see https://stackoverflow.com/a/34547815/390581\n        // Signed integer overflow of the expression x-y-c (where c is again 0 or 1)\n        // occurs if and only if x and y have opposite signs, and the sign of the \n        // result is opposite to that of x (or, equivalently, the same as that of y).\n        v = aNeg !== bNeg && aNeg !== yNeg\n    }\n\n    return { s, cout, v }\n}\n\nfunction doALUNot(a: readonly LogicValue[]): LogicValue[] {\n    const not = Gate1Types.props.not.out\n    return ArrayFillUsing(i => not([a[i]]), a.length)\n}\n\nfunction doALUBinOp(op: Gate2toNType, a: readonly LogicValue[], b: readonly LogicValue[]) {\n    const func = Gate2toNTypes.props[op].out\n    return ArrayFillUsing(i => func([a[i], b[i]]), a.length)\n}", "import * as t from \"io-ts\"\nimport { S } from \"../strings\"\nimport { HighImpedance, LogicValue, RichStringEnum, Unknown } from \"../utils\"\n\nexport type GateTypeProps = {\n    includeInContextMenu: boolean\n    includeInPoseAs: boolean\n    fullShortDesc: () => [string, string | undefined, string]\n    out: (ins: LogicValue[]) => LogicValue\n}\n\nexport type GateTypes<TGateType extends string> = RichStringEnum<TGateType, GateTypeProps>\n\n\nexport const Gate1Types = RichStringEnum.withProps<GateTypeProps>()({\n    not: {\n        out: ([in_]) => (in_ === false) ? true : (in_ === true) ? false : Unknown,\n        includeInContextMenu: true, includeInPoseAs: true,\n        fullShortDesc: () => S.Components.Gate.not,\n    },\n    buf: {\n        out: ([in_]) => (in_ === true) ? true : (in_ === false) ? false : Unknown,\n        includeInContextMenu: true, includeInPoseAs: true,\n        fullShortDesc: () => S.Components.Gate.buf,\n    },\n})\nexport type Gate1Type = typeof Gate1Types.type\nexport const Gate1TypeRepr = t.keyof(Gate1Types.props)\n\n\nexport const Gate2toNTypes = RichStringEnum.withProps<GateTypeProps>()({\n    and: {\n        out: logicAnd,\n        includeInContextMenu: true, includeInPoseAs: true,\n        fullShortDesc: () => S.Components.Gate.and,\n    },\n    or: {\n        out: logicOr,\n        includeInContextMenu: true, includeInPoseAs: true,\n        fullShortDesc: () => S.Components.Gate.or,\n    },\n    xor: {\n        out: logicXor,\n        includeInContextMenu: true, includeInPoseAs: true,\n        fullShortDesc: () => S.Components.Gate.xor,\n    },\n    nand: {\n        out: ins => LogicValue.invert(logicAnd(ins)),\n        includeInContextMenu: true, includeInPoseAs: true,\n        fullShortDesc: () => S.Components.Gate.nand,\n    },\n    nor: {\n        out: ins => LogicValue.invert(logicOr(ins)),\n        includeInContextMenu: true, includeInPoseAs: true,\n        fullShortDesc: () => S.Components.Gate.nor,\n    },\n    xnor: {\n        out: ins => LogicValue.invert(logicXor(ins)),\n        includeInContextMenu: true, includeInPoseAs: true,\n        fullShortDesc: () => S.Components.Gate.xnor,\n    },\n})\n/** Gate types applicable to gates with inputs 2 to N (_not_ all gate 2 inputs) */\nexport type Gate2toNType = typeof Gate2toNTypes.type\nexport const Gate2toNTypeRepr = t.keyof(Gate2toNTypes.props)\n\n\nexport const Gate2OnlyTypes = RichStringEnum.withProps<GateTypeProps>()({\n    // less common gates\n    imply: {\n        out: ins => logicImply(ins[0], ins[1]),\n        includeInContextMenu: true, includeInPoseAs: true,\n        fullShortDesc: () => S.Components.Gate.imply,\n    },\n    rimply: {\n        out: ins => logicImply(ins[1], ins[0]),\n        includeInContextMenu: false, includeInPoseAs: true,\n        fullShortDesc: () => S.Components.Gate.rimply,\n    },\n    nimply: {\n        out: ins => LogicValue.invert(logicImply(ins[0], ins[1])),\n        includeInContextMenu: true, includeInPoseAs: true,\n        fullShortDesc: () => S.Components.Gate.nimply,\n    },\n    rnimply: {\n        out: ins => LogicValue.invert(logicImply(ins[1], ins[0])),\n        includeInContextMenu: false, includeInPoseAs: true,\n        fullShortDesc: () => S.Components.Gate.rnimply,\n    },\n\n    // observing only one input\n    txa: {\n        out: ins => ins[0],\n        includeInContextMenu: true, includeInPoseAs: false,\n        fullShortDesc: () => S.Components.Gate.txa,\n    },\n    txb: {\n        out: ins => ins[1],\n        includeInContextMenu: false, includeInPoseAs: false,\n        fullShortDesc: () => S.Components.Gate.txb,\n    },\n    txna: {\n        out: ins => LogicValue.invert(ins[0]),\n        includeInContextMenu: false, includeInPoseAs: false,\n        fullShortDesc: () => S.Components.Gate.txna,\n    },\n    txnb: {\n        out: ins => LogicValue.invert(ins[1]),\n        includeInContextMenu: false, includeInPoseAs: false,\n        fullShortDesc: () => S.Components.Gate.txnb,\n    },\n})\n/** Some special gate types applicable to gates with 2 inputs only (_not_ all gate 2 inputs) */\nexport type Gate2OnlyType = typeof Gate2OnlyTypes.type\nexport const Gate2OnlyTypeRepr = t.keyof(Gate2OnlyTypes.props)\n\n\n/** All gate types applicable to 2 or more inputs (some of them _only_ for 2 inputs) */\nexport const GateNTypes = RichStringEnum.withProps<GateTypeProps>()({ \n    ...Gate2toNTypes.props,\n    ...Gate2OnlyTypes.props,\n})\n\nexport type GateNType\n    = typeof Gate2toNTypes.type\n    | typeof Gate2OnlyTypes.type\n\nexport const GateNTypeRepr = t.union([\n    Gate2toNTypeRepr,\n    Gate2OnlyTypeRepr,\n])\n\nexport type GateType = Gate1Type | GateNType\n\n\n// Logic functions\n\nfunction logicAnd(ins: LogicValue[]): LogicValue {\n    if (ins.includes(false)) {\n        return false\n    }\n    if (ins.includes(Unknown) || ins.includes(HighImpedance)) {\n        return Unknown\n    }\n    return true\n}\n\nfunction logicOr(ins: LogicValue[]): LogicValue {\n    if (ins.includes(true)) {\n        return true\n    }\n    if (ins.includes(Unknown) || ins.includes(HighImpedance)) {\n        return Unknown\n    }\n    return false\n}\n\nfunction logicXor(ins: LogicValue[]): LogicValue {\n    let count = 0\n    for (const in1 of ins) {\n        if (in1 === true) {\n            count++\n        } else if (in1 === Unknown || in1 === HighImpedance) {\n            return Unknown\n        }\n    }\n    return count % 2 === 1\n}\n\nfunction logicImply(in0: LogicValue, in1: LogicValue): LogicValue {\n    // A => B is the same as !A || B\n    return logicOr([LogicValue.invert(in0), in1])\n}\n", "import { COLOR_COMPONENT_BORDER, TextVAlign, fillTextVAlign } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { LogicValue, Unknown, isHighImpedance, isUnknown } from \"../utils\"\nimport { ComponentBase, Repr, defineComponent } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuItems } from \"./Drawable\"\n\nexport const AdderDef =\n    defineComponent(\"adder\", {\n        idPrefix: \"adder\",\n        button: { imgWidth: 50 },\n        valueDefaults: {},\n        size: { gridWidth: 7, gridHeight: 5 },\n        makeNodes: () => {\n            const s = S.Components.Generic\n            return {\n                ins: {\n                    A: [-2, -4, \"n\", \"A\", { hasTriangle: true }],\n                    B: [2, -4, \"n\", \"B\", { hasTriangle: true }],\n                    Cin: [5, 0, \"e\", s.InputCarryInDesc, { hasTriangle: true }],\n                },\n                outs: {\n                    S: [0, 4, \"s\", s.OutputSumDesc, { hasTriangle: true }],\n                    Cout: [-5, 0, \"w\", s.OutputCarryOutDesc, { hasTriangle: true }],\n                },\n            }\n        },\n        initialValue: () => ({ s: false as LogicValue, cout: false as LogicValue }),\n    })\n\ntype AdderRepr = Repr<typeof AdderDef>\n\nexport class Adder extends ComponentBase<AdderRepr> {\n\n    public constructor(parent: DrawableParent, saved?: AdderRepr) {\n        super(parent, AdderDef, saved)\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.Adder.tooltip\n        return tooltipContent(s.title, mods(\n            div(s.desc),\n        ))\n    }\n\n    protected doRecalcValue() {\n        const a = this.inputs.A.value\n        const b = this.inputs.B.value\n        const cIn = this.inputs.Cin.value\n\n        if (isUnknown(a) || isUnknown(b) || isUnknown(cIn) || isHighImpedance(a) || isHighImpedance(b) || isHighImpedance(cIn)) {\n            return { s: Unknown, cout: Unknown }\n        }\n\n        const sum = (+a) + (+b) + (+cIn)\n        switch (sum) {\n            case 0: return { s: false, cout: false }\n            case 1: return { s: true, cout: false }\n            case 2: return { s: false, cout: true }\n            case 3: return { s: true, cout: true }\n            default:\n                console.log(\"ERROR: sum of adder is > 3\")\n                return { s: false, cout: false }\n        }\n    }\n\n    protected override propagateValue(newValue: { s: LogicValue, cout: LogicValue }) {\n        this.outputs.S.value = newValue.s\n        this.outputs.Cout.value = newValue.cout\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, () => {\n            g.fillStyle = COLOR_COMPONENT_BORDER\n            g.font = \"bold 30px sans-serif\"\n            g.textAlign = \"center\"\n            fillTextVAlign(g, TextVAlign.middle, \"+\", this.posX, this.posY - 2)\n        })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        return this.makeForceOutputsContextMenuItem()\n    }\n\n\n}\nAdderDef.impl = Adder\n", "import * as t from \"io-ts\"\nimport { COLOR_COMPONENT_BORDER, TextVAlign, fillTextVAlign } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, LogicValue, typeOrUndefined } from \"../utils\"\nimport { ALUDef, doALUAdd } from \"./ALU\"\nimport { ParametrizedComponentBase, Repr, ResolvedParams, Value, defineParametrizedComponent, groupVertical, param } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuItems } from \"./Drawable\"\n\n\nexport const AdderArrayDef =\n    defineParametrizedComponent(\"adder-array\", true, true, {\n        variantName: ({ bits }) => `adder-array-${bits}`,\n        idPrefix: \"adder\",\n        button: { imgWidth: 50 },\n        repr: {\n            bits: typeOrUndefined(t.number),\n        },\n        valueDefaults: {},\n        params: {\n            bits: param(4, [2, 4, 8, 16]),\n        },\n        validateParams: ({ bits }) => ({\n            numBits: bits,\n        }),\n        size: ({ numBits }) => ({\n            gridWidth: 4, // constant\n            gridHeight: ALUDef.size({ numBits, usesExtendedOpcode: false }).gridHeight, // mimic ALU\n        }),\n        makeNodes: ({ numBits, gridHeight }) => {\n            const inputCenterY = 5 + Math.max(0, (numBits - 8) / 2)\n            const coutY = Math.floor(gridHeight / 2) + 1\n            const cinY = -coutY\n\n            return {\n                ins: {\n                    A: groupVertical(\"w\", -3, -inputCenterY, numBits),\n                    B: groupVertical(\"w\", -3, inputCenterY, numBits),\n                    Cin: [0, cinY, \"n\"],\n                },\n                outs: {\n                    S: groupVertical(\"e\", 3, 0, numBits),\n                    Cout: [0, coutY, \"s\"],\n                },\n            }\n        },\n        initialValue: (saved, { numBits }) => ({\n            s: ArrayFillWith<LogicValue>(false, numBits),\n            cout: false as LogicValue,\n        }),\n    })\n\n\nexport type AdderArrayRepr = Repr<typeof AdderArrayDef>\nexport type AdderArrayParams = ResolvedParams<typeof AdderArrayDef>\nexport type AdderArrayValue = Value<typeof AdderArrayDef>\n\nexport class AdderArray extends ParametrizedComponentBase<AdderArrayRepr> {\n\n    public readonly numBits: number\n\n    public constructor(parent: DrawableParent, params: AdderArrayParams, saved?: AdderArrayRepr) {\n        super(parent, AdderArrayDef.with(params), saved)\n        this.numBits = params.numBits\n    }\n\n    public toJSON() {\n        // TODO check if params can be serialized automatically\n        return {\n            ...this.toJSONBase(),\n            bits: this.numBits === AdderArrayDef.aults.bits ? undefined : this.numBits,\n        }\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.AdderArray.tooltip\n        return tooltipContent(s.title.expand({ numBits: this.numBits }), mods(\n            div(s.desc), // TODO more info\n        ))\n    }\n\n    protected doRecalcValue(): AdderArrayValue {\n        const a = this.inputValues(this.inputs.A)\n        const b = this.inputValues(this.inputs.B)\n        const cin = this.inputs.Cin.value\n        return doALUAdd(a, b, cin)\n    }\n\n    protected override propagateValue(newValue: AdderArrayValue) {\n        this.outputValues(this.outputs.S, newValue.s)\n        this.outputs.Cout.value = newValue.cout\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, (ctx) => {\n            g.font = `bold 25px sans-serif`\n            g.fillStyle = COLOR_COMPONENT_BORDER\n            g.textAlign = \"center\"\n            fillTextVAlign(g, TextVAlign.middle, \"+\", ...ctx.rotatePoint(this.posX - 4, this.posY - 2))\n        })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        return [\n            this.makeChangeParamsContextMenuItem(\"inputs\", S.Components.Generic.contextMenu.ParamNumBits, this.numBits, \"bits\"),\n            ...this.makeForceOutputsContextMenuItem(true),\n        ]\n    }\n\n}\nAdderArrayDef.impl = AdderArray\n", "import * as t from \"io-ts\"\nimport { COLOR_COMPONENT_BORDER, TextVAlign, fillTextVAlign } from \"../drawutils\"\nimport { br, emptyMod, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { LogicValue, typeOrUndefined } from \"../utils\"\nimport { ComponentNameRepr, ComponentState, Repr, defineComponent } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems } from \"./Drawable\"\nimport { InputBase, InputDef } from \"./Input\"\n\nexport const ClockDef =\n    defineComponent(\"clock\", {\n        idPrefix: \"clock\",\n        button: { imgWidth: 50 },\n        repr: {\n            name: ComponentNameRepr,\n            period: t.number,\n            dutycycle: typeOrUndefined(t.number),\n            phase: typeOrUndefined(t.number),\n            showLabel: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {\n            period: 2000,\n            dutycycle: 50,\n            phase: 0,\n            showLabel: true,\n        },\n        size: { gridWidth: 2, gridHeight: 2 }, // \"overridden\" by superclass\n        makeNodes: () => ({\n            outs: {\n                // we don't strictly need a group, but we use it\n                // for compatibility with InputBase\n                Out: [[3, 0, \"e\"]],\n            },\n        }),\n        initialValue: () => [false as LogicValue],\n    })\n\nexport type ClockRepr = Repr<typeof ClockDef>\n\nexport class Clock extends InputBase<ClockRepr> {\n\n    public get numBits() { return 1 }\n    private _period: number\n    private _dutycycle: number\n    private _phase: number\n    private _showLabel: boolean\n\n    public constructor(parent: DrawableParent, saved?: ClockRepr) {\n        // 'undefined as any' is a hack to get around the fact that InputBase is parametrized\n        // and Clock is not. As long as we don't try to change nonexitent params, it's fine.\n        super(parent, [ClockDef, undefined as any], saved)\n\n        this._period = saved?.period ?? ClockDef.aults.period\n        this._dutycycle = (saved?.dutycycle !== undefined) ? saved.dutycycle % 100 : ClockDef.aults.dutycycle\n        this._phase = (saved?.phase !== undefined) ? saved.phase % this._period : ClockDef.aults.phase\n        this._showLabel = saved?.showLabel ?? ClockDef.aults.showLabel\n\n        // sets the value and schedules the next tick\n        this.tickCallback()\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            period: this._period,\n            dutycycle: (this._dutycycle === ClockDef.aults.dutycycle) ? undefined : this._dutycycle,\n            phase: (this._phase === ClockDef.aults.phase) ? undefined : this._phase,\n            showLabel: (this._showLabel === ClockDef.aults.showLabel) ? undefined : this._showLabel,\n        }\n    }\n\n    protected override toStringDetails(): string {\n        return `period=${this._period} duty=${this._dutycycle} phase=${this._phase}`\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.Clock.tooltip\n        return tooltipContent(s.title,\n            mods(s.period[0] + this._period + s.period[1], br,\n                s.dutycycle[0] + this._dutycycle + s.dutycycle[1],\n                this._phase === 0\n                    ? emptyMod\n                    : mods(br, s.phase[0] + this._phase + s.phase[1])\n            ))\n    }\n\n    private currentClockValue(logicalTime: number): [boolean, number] {\n        const myTime = logicalTime - this._phase\n        let timeOverPeriod = myTime % this._period\n        if (timeOverPeriod < 0) {\n            timeOverPeriod += this._period\n        }\n        const onDuration = this._period * this._dutycycle / 100\n        const offDuration = this._period - onDuration\n        let value: boolean\n        let timeOverLastTick: number\n        if (timeOverPeriod < onDuration) {\n            value = true\n            timeOverLastTick = timeOverPeriod\n        } else {\n            value = false\n            timeOverLastTick = timeOverPeriod - onDuration\n        }\n        const lastTick = logicalTime - timeOverLastTick\n        const nextTick = lastTick + (value ? onDuration : offDuration)\n\n        return [value, nextTick]\n    }\n\n    private tickCallback() {\n        const timeline = this.parent.editor.timeline\n        const [value, nextTick] = this.currentClockValue(timeline.logicalTime())\n        this.doSetValue([value])\n        if (this.state !== ComponentState.DEAD) {\n            const s = S.Components.Clock.timeline\n            const desc = value ? s.NextFallingEdge : s.NextRisingEdge\n            timeline.scheduleAt(nextTick, () => {\n                this.tickCallback()\n            }, desc, true)\n        }\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        super.doDraw(g, ctx)\n\n        if (!this._showLabel) {\n            return\n        }\n\n        ctx.inNonTransformedFrame(() => {\n            const w = 40\n            const h = 10\n            const offsetY = this.orient === \"s\" ? -36 : 26\n            g.strokeStyle = COLOR_COMPONENT_BORDER\n            g.lineWidth = 1\n            const left = this.posX - w / 2\n            const mid1 = left + w * this._phase / this._period\n            const mid2 = mid1 + w * this._dutycycle / 100\n            const right = this.posX + w / 2\n            const bottom = this.posY + offsetY + h / 2\n            const top = this.posY + offsetY - h / 2\n            g.beginPath()\n            g.moveTo(left, bottom)\n            g.lineTo(mid1, bottom)\n            g.lineTo(mid1, top)\n            g.lineTo(mid2, top)\n            g.lineTo(mid2, bottom)\n            g.lineTo(right, bottom)\n            g.stroke()\n\n            g.fillStyle = COLOR_COMPONENT_BORDER\n            g.font = \"10px sans-serif\"\n            const periodStr = this._period >= 1000\n                ? (this._period / 1000) + \" s\"\n                : this._period + \" ms\"\n            g.textAlign = \"center\"\n            fillTextVAlign(g, TextVAlign.middle, periodStr, this.posX, bottom + 8)\n        })\n    }\n\n    private doSetPeriod(period: number) {\n        this._period = period\n        this.requestRedraw({ why: \"period changed\", invalidateTests: true })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.Clock.contextMenu\n\n        const periodPresets: [number, string][] = [\n            [100, \"100 ms (10 Hz)\"],\n            [250, \"250 ms (4 Hz)\"],\n            [500, \"500 ms (2 Hz)\"],\n            [1000, \"1 s (1 Hz)\"],\n            [2000, \"2 s (0.5 Hz)\"],\n            [4000, \"4 s (0.25 Hz)\"],\n            [8000, \"8 s (0.125 Hz)\"],\n            [16000, \"16 s (0.0625 Hz)\"],\n        ]\n\n        let matchesSomePreset = false\n        const makeItemSetPeriod = (data: [number, string]) => {\n            const [period, desc] = data\n            const isCurrent = this._period === period\n            matchesSomePreset = matchesSomePreset || isCurrent\n            const icon = isCurrent ? \"check\" : \"none\"\n            return MenuData.item(icon, desc, () => this.doSetPeriod(period))\n        }\n\n        const presetPeriodItems = periodPresets.map(makeItemSetPeriod)\n        const customPeriodItem = MenuData.item(matchesSomePreset ? \"none\" : \"check\", s.CustomPeriod + (matchesSomePreset ? \"\u2026\" : \" (\" + this._period + \" ms, \" + Math.round(1000000 / this._period) / 1000 + \" Hz)\u2026\"), () => this.runSetPeriodDialog())\n\n        const replaceWithInputItem =\n            MenuData.item(\"replace\", s.ReplaceWithInput, () => {\n                this.replaceWithComponent(InputDef.make(this.parent, { bits: 1 }))\n            })\n\n        return [\n            ...super.makeComponentSpecificContextMenuItems(),\n            [\"mid\", MenuData.sep()],\n            [\"mid\", MenuData.submenu(\"timer\", s.Period, [...presetPeriodItems, MenuData.sep(), customPeriodItem])],\n            [\"mid\", MenuData.sep()],\n            [\"mid\", replaceWithInputItem],\n        ]\n    }\n\n    private runSetPeriodDialog() {\n        const s = S.Components.Clock.contextMenu\n        const newPeriodStr = window.prompt(s.SetPeriodMillis, String(this._period))\n        if (newPeriodStr === null || newPeriodStr.length === 0) {\n            return\n        }\n\n        const newPeriod = parseInt(newPeriodStr)\n        if (isNaN(newPeriod) || newPeriod < 1) {\n            window.alert(s.InvalidPeriod)\n            this.runSetPeriodDialog()\n            return\n        }\n\n        this.doSetPeriod(newPeriod)\n    }\n\n\n}\nClockDef.impl = Clock\n", "import * as t from \"io-ts\"\nimport { COLOR_BACKGROUND, COLOR_COMPONENT_BORDER, GRID_STEP, INPUT_OUTPUT_DIAMETER, circle, colorForLogicValue, distSquared, drawComponentName, drawValueText, drawValueTextCentered, drawWireLineToComponent, inRect, isTrivialNodeName, triangle, useCompact } from \"../drawutils\"\nimport { mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, ComponentTypeInput, HighImpedance, InputOutputValueRepr, InteractionResult, LogicValue, Mode, Unknown, reprForLogicValues, toLogicValueRepr, typeOrUndefined, valuesFromReprForInput } from \"../utils\"\nimport { ClockDef, ClockRepr } from \"./Clock\"\nimport { Component, ComponentName, ComponentNameRepr, ExtractParamDefs, ExtractParams, InstantiatedComponentDef, NodesIn, NodesOut, ParametrizedComponentBase, Repr, ResolvedParams, SomeParamCompDef, defineParametrizedComponent, groupVertical, param } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems, Orientation } from \"./Drawable\"\nimport { Node, NodeIn, NodeOut } from \"./Node\"\n\n\ntype InputBaseRepr = InputRepr | ClockRepr\n\nexport abstract class InputBase<\n    TRepr extends InputBaseRepr,\n    TParamDefs extends ExtractParamDefs<TRepr> = ExtractParamDefs<TRepr>,\n    TParams extends ExtractParams<TRepr> = ExtractParams<TRepr>\n> extends ParametrizedComponentBase<\n    TRepr,\n    LogicValue[],\n    TParamDefs,\n    TParams,\n    NodesIn<TRepr>,\n    NodesOut<TRepr>,\n    false, true\n> {\n\n    public abstract get numBits(): number\n    protected _name: ComponentName\n\n    protected constructor(parent: DrawableParent, SubclassDef: [InstantiatedComponentDef<TRepr, LogicValue[]>, SomeParamCompDef<TParamDefs>], saved?: TRepr) {\n        super(parent, SubclassDef, saved)\n        this._name = saved?.name ?? undefined\n    }\n\n    protected override toJSONBase() {\n        return {\n            ...super.toJSONBase(),\n            name: this._name,\n        }\n    }\n\n    public override isOver(x: number, y: number) {\n        if (this.numBits === 1) {\n            return distSquared(x, y, this.posX, this.posY) < (INPUT_OUTPUT_DIAMETER / 2) ** 2\n        }\n        return inRect(this.posX, this.posY, this.width, this.height, x, y)\n    }\n\n    public override get allowsForcedOutputs() {\n        return false\n    }\n\n    public get name() {\n        return this._name\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        // this never changes on its own, just upon user interaction\n        // or automatically for clocks\n        return this.value\n    }\n\n    protected override propagateValue(newValue: LogicValue[]) {\n        this.outputValues(this.outputs.Out, newValue)\n    }\n\n    protected shouldDrawBorder() {\n        return true\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        if (this.numBits === 1) {\n            this.doDrawSingle(g, ctx, this.outputs.Out[0])\n        } else {\n            this.doDrawMulti(g, ctx, this.outputs.Out)\n        }\n    }\n\n    private doDrawSingle(g: GraphicsRendering, ctx: DrawContext, output: NodeOut) {\n        drawWireLineToComponent(g, output)\n\n        const displayValue = this.parent.editor.options.hideInputColors ? Unknown : output.value\n\n        const shouldDrawBorder = this.shouldDrawBorder()\n        if (shouldDrawBorder) {\n            const drawMouseOver = ctx.isMouseOver && this.parent.mode !== Mode.STATIC\n\n            if (drawMouseOver) {\n                g.strokeStyle = ctx.borderColor\n                g.fillStyle = ctx.borderColor\n            } else {\n                g.strokeStyle = COLOR_COMPONENT_BORDER\n                g.fillStyle = COLOR_COMPONENT_BORDER\n            }\n            g.lineWidth = 3\n            g.beginPath()\n            const triangleLeft = this.posX + INPUT_OUTPUT_DIAMETER / 2 - 1\n            const triangleRight = this.posX + INPUT_OUTPUT_DIAMETER / 2 + 5\n            const triangleVOffset = 6.75\n            triangle(g,\n                triangleLeft, this.posY + triangleVOffset,\n                triangleRight, this.posY,\n                triangleLeft, this.posY - triangleVOffset,\n            )\n            g.lineWidth = 2\n            g.fill()\n            g.stroke()\n\n            g.fillStyle = colorForLogicValue(displayValue)\n            g.lineWidth = 4\n            g.beginPath()\n            circle(g, this.posX, this.posY, INPUT_OUTPUT_DIAMETER)\n            g.fill()\n            g.stroke()\n        }\n\n        ctx.inNonTransformedFrame(ctx => {\n            if (this._name !== undefined) {\n                drawComponentName(g, ctx, this._name, toLogicValueRepr(displayValue), this, false)\n            }\n            const forcedFillStyle = !shouldDrawBorder ? g.fillStyle = COLOR_COMPONENT_BORDER : undefined\n            drawValueTextCentered(g, displayValue, this, { fillStyle: forcedFillStyle })\n        })\n    }\n\n    private doDrawMulti(g: GraphicsRendering, ctx: DrawContext, outputs: NodeOut[]) {\n        const bounds = this.bounds()\n        const { left, top, width } = bounds\n        const outline = bounds.outline(g)\n\n        // background\n        g.fillStyle = COLOR_BACKGROUND\n        g.fill(outline)\n\n        // outputs\n        for (const output of outputs) {\n            drawWireLineToComponent(g, output)\n        }\n\n        const displayValues = this.parent.editor.options.hideInputColors\n            ? ArrayFillWith(Unknown, this.numBits) : this.value\n\n        // cells\n        const drawMouseOver = ctx.isMouseOver && this.parent.mode !== Mode.STATIC\n        g.strokeStyle = drawMouseOver ? ctx.borderColor : COLOR_COMPONENT_BORDER\n        g.lineWidth = 1\n        const cellHeight = useCompact(this.numBits) ? GRID_STEP : 2 * GRID_STEP\n        for (let i = 0; i < this.numBits; i++) {\n            const y = top + i * cellHeight\n            g.fillStyle = colorForLogicValue(displayValues[i])\n            g.beginPath()\n            g.rect(left, y, width, cellHeight)\n            g.fill()\n            g.stroke()\n        }\n\n        // outline\n        g.lineWidth = 3\n        g.stroke(outline)\n\n        // labels\n        ctx.inNonTransformedFrame(ctx => {\n            if (this._name !== undefined) {\n                const valueString = displayValues.map(toLogicValueRepr).reverse().join(\"\")\n                drawComponentName(g, ctx, this._name, valueString, this, false)\n            }\n\n            for (let i = 0; i < this.numBits; i++) {\n                const y = top + cellHeight / 2 + i * cellHeight\n                drawValueText(g, displayValues[i], ...ctx.rotatePoint(this.posX, y), { small: useCompact(this.numBits) })\n            }\n        })\n    }\n\n    protected override autoConnected(newLinks: [Node, Component, Node][]) {\n        if (newLinks.length !== 1) {\n            return\n        }\n\n        const [outNode, comp, inNode] = newLinks[0]\n        if (inNode instanceof NodeIn) {\n            if (inNode.prefersSpike) {\n                this.doSetIsPushButton(true) // will do nothing for clocks\n            }\n            if (this._name === undefined && !isTrivialNodeName(inNode.shortName)) {\n                this.doSetName(inNode.shortName)\n            }\n        }\n\n        if (outNode.orient !== \"e\") {\n            // should never happen, all our outputs are east\n            return\n        }\n\n        switch (Orientation.add(comp.orient, inNode.orient)) {\n            case \"w\":\n                // nothing to do\n                return\n            case \"e\":\n                this.doSetOrient(\"w\")\n                this.setPosition(this.posX + GRID_STEP * 6, this.posY, false)\n                return\n            case \"s\":\n                this.doSetOrient(\"n\")\n                this.setPosition(this.posX + GRID_STEP * 3, this.posY + GRID_STEP * 3, false)\n                return\n            case \"n\":\n                this.doSetOrient(\"s\")\n                this.setPosition(this.posX + GRID_STEP * 3, this.posY - GRID_STEP * 3, false)\n                return\n        }\n    }\n\n    public doSetIsPushButton(__isPushButton: boolean): void {\n        // overridden in normal Input, not in Clock\n    }\n\n    public doSetName(name: ComponentName) {\n        this._name = name\n        this.requestRedraw({ why: \"name changed\" })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        return [\n            [\"mid\", this.makeSetNameContextMenuItem(this._name, this.doSetName.bind(this))],\n        ]\n    }\n\n    public override keyDown(e: KeyboardEvent): void {\n        if (e.key === \"Enter\" && !e.altKey) {\n            this.runSetNameDialog(this._name, this.doSetName.bind(this))\n        } else {\n            super.keyDown(e)\n        }\n    }\n\n}\n\n\nexport const InputDef =\n    defineParametrizedComponent(ComponentTypeInput, false, true, {\n        variantName: ({ bits }) => `in-${bits}`,\n        idPrefix: \"in\",\n        button: { imgWidth: 32 },\n        repr: {\n            bits: typeOrUndefined(t.number),\n            val: typeOrUndefined(InputOutputValueRepr),\n            isPushButton: typeOrUndefined(t.boolean),\n            isConstant: typeOrUndefined(t.boolean),\n            name: ComponentNameRepr,\n        },\n        valueDefaults: {\n            isPushButton: false,\n            isConstant: false,\n        },\n        params: {\n            bits: param(1, [1, 2, 3, 4, 5, 6, 7, 8, 12, 16, 24, 32]),\n        },\n        validateParams: ({ bits }) => ({\n            numBits: bits,\n        }),\n        size: ({ numBits }) => {\n            if (numBits === 1) {\n                const d = INPUT_OUTPUT_DIAMETER / GRID_STEP\n                return { gridWidth: d, gridHeight: d }\n            }\n            return {\n                gridWidth: 2,\n                gridHeight: useCompact(numBits) ? numBits : 2 * numBits,\n            }\n        },\n        makeNodes: ({ numBits }) => ({\n            outs: {\n                Out: groupVertical(\"e\", numBits === 1 ? 3 : 2, 0, numBits, undefined, { hasTriangle: numBits !== 1 }),\n            },\n        }),\n        initialValue: (saved, { numBits }) => {\n            return valuesFromReprForInput(saved?.val, numBits)\n        },\n    })\n\nexport type InputRepr = Repr<typeof InputDef>\nexport type InputParams = ResolvedParams<typeof InputDef>\n\nexport class Input extends InputBase<InputRepr> {\n\n    public readonly numBits: number\n    private _isPushButton: boolean\n    private _isConstant: boolean\n    public isCustomComponentInput: boolean = false\n\n    public constructor(parent: DrawableParent, params: InputParams, saved?: InputRepr) {\n        super(parent, InputDef.with(params), saved)\n\n        this.numBits = params.numBits\n\n        this._isPushButton = saved?.isPushButton ?? InputDef.aults.isPushButton\n        this._isConstant = saved?.isConstant ?? InputDef.aults.isConstant\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            bits: this.numBits === InputDef.aults.bits ? undefined : this.numBits,\n            val: this.contentRepr(true),\n            isPushButton: (this._isPushButton !== InputDef.aults.isPushButton) ? this._isPushButton : undefined,\n            isConstant: (this._isConstant !== InputDef.aults.isConstant) ? this._isConstant : undefined,\n        }\n    }\n\n    public get isConstant() {\n        return this._isConstant\n    }\n\n    public contentRepr<AllowUndefined extends boolean>(undefinedIfTrivial: AllowUndefined) {\n        return reprForLogicValues(this.value, undefinedIfTrivial)\n    }\n\n    public override cursorWhenMouseover(e?: PointerEvent) {\n        const mode = this.parent.mode\n        if (mode === Mode.STATIC) {\n            // signal we can't switch it here\n            return \"not-allowed\"\n        }\n        if ((e?.ctrlKey ?? false) && mode >= Mode.CONNECT) {\n            return \"context-menu\"\n        }\n        if ((e?.altKey ?? false) && mode >= Mode.DESIGN) {\n            return \"copy\"\n        }\n\n        if (this.isCustomComponentInput) {\n            return \"grab\"\n        }\n\n        if (this._isConstant) {\n            if (mode >= Mode.DESIGN && !this.lockPos) {\n                // we can still move it\n                return \"grab\"\n            } else {\n                // no special pointer change, it's constant and static\n                return undefined\n            }\n        }\n        // we can switch it\n        return \"pointer\"\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.Input.tooltip\n        return tooltipContent(undefined, mods(s.title.expand({ numBits: this.numBits })))\n    }\n\n    public get isLinkedToSomeClock(): boolean {\n        return this.outputs._all.some(out => out.outgoingWires.some(w => w.endNode.isClock))\n    }\n\n    public get isPushButton() {\n        return this._isPushButton\n    }\n\n    protected override shouldDrawBorder() {\n        return !this._isConstant\n    }\n\n    public override pointerClicked(e: PointerEvent) {\n        let result\n        if ((result = super.pointerClicked(e)).isChange) {\n            return result\n        }\n\n        if (this.parent.mode === Mode.STATIC\n            || this._isPushButton\n            || this._isConstant) {\n            return InteractionResult.NoChange\n        }\n\n        if (this.isCustomComponentInput) {\n            this.parent.editor.showMessage(S.Components.Input.contextMenu.InputSetFromOutside)\n            return InteractionResult.NoChange\n        }\n\n        const i = this.clickedBitIndex(e)\n        if (i === -1) {\n            return InteractionResult.SimpleChange\n        }\n\n        const altKey = e.altKey // don't include event in the closure\n        const doChange = () => {\n            this.doSetValueChangingBit(i, nextValue(this.value[i], this.parent.mode, altKey))\n            return true\n        }\n\n        doChange()\n        return InteractionResult.RepeatableChange(doChange)\n    }\n\n    public override pointerDown(e: PointerEvent) {\n        this.trySetPushButtonBit(true, e)\n        return super.pointerDown(e)\n    }\n\n    public override pointerUp(e: PointerEvent) {\n        const result = super.pointerUp(e)\n        this.trySetPushButtonBit(false, e)\n        return result\n    }\n\n    private clickedBitIndex(e: PointerEvent): number {\n        const h = this.unrotatedHeight\n        const y = this.parent.editor.offsetXYForComponent(e, this)[1] - this.posY + h / 2\n        const i = Math.floor(y * this.numBits / h)\n        if (i >= 0 && i < this.numBits) {\n            return i\n        }\n        return -1\n    }\n\n    private trySetPushButtonBit(v: LogicValue, e: PointerEvent) {\n        let i\n        if (this.parent.mode === Mode.STATIC\n            || !this._isPushButton\n            || this._isConstant\n            || !this.parent.editor.eventMgr.currentSelectionEmpty()\n            || (i = this.clickedBitIndex(e)) === -1) {\n            return\n        }\n\n        if (this.isCustomComponentInput) {\n            if (v !== false) {\n                // only show message on push down\n                this.parent.editor.showMessage(S.Components.Input.contextMenu.InputSetFromOutside)\n            }\n            return\n        }\n\n        this.doSetValueChangingBit(i, v)\n    }\n\n    private doSetValueChangingBit(i: number, v: LogicValue) {\n        const newValues = [...this.value]\n        newValues[i] = v\n        this.doSetValue(newValues)\n    }\n\n    public setValue(values: LogicValue[]) {\n        if (values.length !== this.numBits) {\n            console.warn(`Expected ${this.numBits} values, got ${values.length} for input ${this.ref}`)\n            return\n        }\n        this.doSetValue(values)\n    }\n\n    public override doSetIsPushButton(isPushButton: boolean) {\n        this._isPushButton = isPushButton\n        if (isPushButton) {\n            this.doSetValue(ArrayFillWith(false, this.numBits))\n        }\n    }\n\n    private doSetIsConstant(isConstant: boolean) {\n        this._isConstant = isConstant\n        this.requestRedraw({ why: \"constant changed\" })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.Input.contextMenu\n\n        const makeItemBehaveAs = (desc: string, value: boolean) => {\n            const isCurrent = this._isPushButton === value\n            const icon = isCurrent ? \"check\" : \"none\"\n            const action = isCurrent ? () => undefined : () => this.doSetIsPushButton(value)\n            return MenuData.item(icon, desc, action)\n        }\n\n        const newItems: MenuItems = [\n            [\"mid\", makeItemBehaveAs(s.ToggleButton, false)],\n            [\"mid\", makeItemBehaveAs(s.PushButton, true)],\n            [\"mid\", MenuData.sep()],\n            this.makeChangeParamsContextMenuItem(\"outputs\", S.Components.Generic.contextMenu.ParamNumBits, this.numBits, \"bits\"),\n            [\"mid\", MenuData.sep()],\n\n        ]\n\n        if (this.numBits === 1) {\n            const makeToggleConstantItem = () => {\n                const icon = this._isConstant ? \"check\" : \"none\"\n                const action = () => this.doSetIsConstant(!this._isConstant)\n                return MenuData.item(icon, s.LockValue + ` (${toLogicValueRepr(this.value[0])})`, action)\n            }\n            const replaceWithClockItem =\n                MenuData.item(\"timer\", s.ReplaceWithClock, () => {\n                    this.replaceWithComponent(ClockDef.make(this.parent))\n                })\n\n            newItems.push(\n                [\"mid\", makeToggleConstantItem()],\n                [\"mid\", MenuData.sep()],\n                [\"mid\", replaceWithClockItem],\n                [\"mid\", MenuData.sep()],\n            )\n        }\n\n        newItems.push(...super.makeComponentSpecificContextMenuItems())\n\n        return newItems\n    }\n\n}\nInputDef.impl = Input\n\nfunction nextValue(value: LogicValue, mode: Mode, altKey: boolean): LogicValue {\n    switch (value) {\n        case true: return (mode >= Mode.FULL && altKey) ? Unknown : false\n        case false: return (mode >= Mode.FULL && altKey) ? Unknown : true\n        case Unknown: return mode >= Mode.FULL ? (altKey ? HighImpedance : false) : Unknown\n        case HighImpedance: return mode >= Mode.FULL ? (altKey ? Unknown : false) : HighImpedance\n    }\n}", "import { COLOR_COMPONENT_BORDER, TextVAlign, fillTextVAlign } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { LogicValue, Unknown, isHighImpedance, isUnknown } from \"../utils\"\nimport { ComponentBase, Repr, defineComponent } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuItems } from \"./Drawable\"\n\nexport const ComparatorDef =\n    defineComponent(\"comp\", {\n        idPrefix: \"comp\",\n        button: { imgWidth: 50 },\n        valueDefaults: {},\n        size: { gridWidth: 5, gridHeight: 7 },\n        makeNodes: () => ({\n            ins: {\n                A: [-4, 2, \"w\", \"A\", { hasTriangle: true }],\n                B: [-4, -2, \"w\", \"B\", { hasTriangle: true }],\n                E: [0, 5, \"s\", \"E\", { hasTriangle: true }],\n            },\n            outs: {\n                G: [4, 0, \"e\", \">\", { hasTriangle: true, labelName: \">\" }],\n                Eq: [0, -5, \"n\", \"=\", { hasTriangle: true, labelName: \"=\" }],\n            },\n        }),\n        initialValue: () => ({\n            g: false as LogicValue,\n            eq: false as LogicValue,\n        }),\n    })\n\ntype ComparatorRepr = Repr<typeof ComparatorDef>\n\nexport class Comparator extends ComponentBase<ComparatorRepr> {\n\n    public constructor(parent: DrawableParent, saved?: ComparatorRepr) {\n        super(parent, ComparatorDef, saved)\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.Comparator.tooltip\n        return tooltipContent(s.title, mods(\n            div(s.desc),\n        ))\n    }\n\n    protected doRecalcValue() {\n        const a = this.inputs.A.value\n        const b = this.inputs.B.value\n        const e = this.inputs.E.value\n\n        if (isUnknown(a) || isUnknown(b) || isUnknown(e) || isHighImpedance(a) || isHighImpedance(b) || isHighImpedance(e)) {\n            return { g: Unknown, eq: Unknown }\n        }\n\n        if ((+e) === 0) {\n            return { g: false, eq: false }\n        }\n\n        const g = ((+a) > (+b))\n        const eq = ((+a) === (+b))\n\n        return { g, eq }\n    }\n\n    protected override propagateValue(newValue: { g: LogicValue, eq: LogicValue }) {\n        this.outputs.G.value = newValue.g\n        this.outputs.Eq.value = newValue.eq\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, () => {\n            g.fillStyle = COLOR_COMPONENT_BORDER\n            g.font = \"bold 11px sans-serif\"\n            g.textAlign = \"center\"\n            fillTextVAlign(g, TextVAlign.middle, \"CMP\", this.posX, this.posY)\n        })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        return this.makeForceOutputsContextMenuItem()\n    }\n\n}\nComparatorDef.impl = Comparator\n", "import * as t from \"io-ts\"\nimport { COLOR_COMPONENT_BORDER, COLOR_UNKNOWN, circle, colorForLogicValue } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, LogicValue, Unknown, isHighImpedance, isUnknown, typeOrUndefined } from \"../utils\"\nimport { ParametrizedComponentBase, Repr, ResolvedParams, defineParametrizedComponent, groupVertical, param, paramBool } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuItems } from \"./Drawable\"\n\n\nexport const ControlledInverterDef =\n    defineParametrizedComponent(\"cnot-array\", true, true, {\n        variantName: ({ bits, bottom }) => `cnot-array-${bits}${bottom ? \"b\" : \"\"}`,\n        idPrefix: \"cnot\",\n        button: { imgWidth: 50 },\n        repr: {\n            bits: typeOrUndefined(t.number),\n            bottom: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {},\n        params: {\n            bits: param(4, [2, 4, 8, 16]),\n            bottom: paramBool(),\n        },\n        validateParams: ({ bits, bottom }) => ({\n            numBits: bits,\n            controlPinsAtBottom: bottom,\n        }),\n\n        size: ({ numBits }) => ({\n            gridWidth: 4,\n            gridHeight: 8 + Math.max(0, numBits - 8),\n        }),\n        makeNodes: ({ numBits, controlPinsAtBottom, gridHeight }) => ({\n            ins: {\n                In: groupVertical(\"w\", -3, 0, numBits),\n                S: [0,\n                    -(gridHeight / 2 + 1) * (controlPinsAtBottom ? -1 : 1),\n                    controlPinsAtBottom ? \"s\" : \"n\",\n                ],\n            },\n            outs: {\n                Out: groupVertical(\"e\", +3, 0, numBits),\n            },\n        }),\n        initialValue: (saved, { numBits }) => ArrayFillWith<LogicValue>(false, numBits),\n    })\n\n\nexport type ControlledInverterRepr = Repr<typeof ControlledInverterDef>\nexport type ControlledInverterParams = ResolvedParams<typeof ControlledInverterDef>\n\n\nexport class ControlledInverter extends ParametrizedComponentBase<ControlledInverterRepr> {\n\n    public readonly numBits: number\n    public readonly controlPinsAtBottom: boolean\n\n    public constructor(parent: DrawableParent, params: ControlledInverterParams, saved?: ControlledInverterRepr) {\n        super(parent, ControlledInverterDef.with(params), saved)\n        this.numBits = params.numBits\n        this.controlPinsAtBottom = params.controlPinsAtBottom\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            bits: this.numBits === ControlledInverterDef.aults.bits ? undefined : this.numBits,\n            bottom: this.controlPinsAtBottom === ControlledInverterDef.aults.bottom ? undefined : this.controlPinsAtBottom,\n        }\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.ControlledInverter.tooltip\n        return tooltipContent(s.title, mods(\n            div(s.desc)\n        ))\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        const input = this.inputValues(this.inputs.In)\n        const switch_ = this.inputs.S.value\n\n        if (isUnknown(switch_) || isHighImpedance(switch_)) {\n            return ArrayFillWith(Unknown, this.numBits)\n        }\n\n        if (!switch_) {\n            return input\n        }\n\n        return input.map(LogicValue.invert)\n    }\n\n    protected override propagateValue(newValue: LogicValue[]) {\n        this.outputValues(this.outputs.Out, newValue)\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, {\n            skipLabels: true,\n            drawInside: ({ top, bottom, left, right }) => {\n                const invert = this.inputs.S.value\n\n                g.lineWidth = 2\n                g.strokeStyle = colorForLogicValue(invert)\n                g.beginPath()\n                if (this.controlPinsAtBottom) {\n                    g.moveTo(this.posX, bottom)\n                    g.lineTo(this.posX, this.posY + 4)\n                } else {\n                    g.moveTo(this.posX, top)\n                    g.lineTo(this.posX, this.posY - 4)\n                }\n                g.stroke()\n\n                g.strokeStyle = invert === true ? COLOR_COMPONENT_BORDER : COLOR_UNKNOWN\n                g.beginPath()\n                g.moveTo(left + 12, this.posY - 8)\n                g.lineTo(right - 13, this.posY)\n                g.lineTo(left + 12, this.posY + 8)\n                g.closePath()\n                g.stroke()\n                g.beginPath()\n                circle(g, right - 10, this.posY, 5)\n                g.stroke()\n            },\n        })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.Generic.contextMenu\n        return [\n            this.makeChangeParamsContextMenuItem(\"inputs\", s.ParamNumBits, this.numBits, \"bits\"),\n            this.makeChangeBooleanParamsContextMenuItem(s.ParamControlBitAtBottom, this.controlPinsAtBottom, \"bottom\"),\n            ...this.makeForceOutputsContextMenuItem(true),\n        ]\n    }\n\n}\nControlledInverterDef.impl = ControlledInverter\n", "import * as t from \"io-ts\"\nimport { COLOR_EMPTY, COLOR_LABEL_OFF, TextVAlign, displayValuesFromArray, fillTextVAlign, formatWithRadix, useCompact } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, EdgeTrigger, LogicValue, Unknown, isUnknown, typeOrNull, typeOrUndefined } from \"../utils\"\nimport { ParametrizedComponentBase, Repr, ResolvedParams, defineParametrizedComponent, groupVertical, param } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems } from \"./Drawable\"\nimport { Flipflop, FlipflopOrLatch, makeTriggerItems } from \"./FlipflopOrLatch\"\n\n\nexport const CounterDef =\n    defineParametrizedComponent(\"counter\", true, true, {\n        variantName: ({ bits }) => `counter-${bits}`,\n        idPrefix: \"counter\",\n        button: { imgWidth: 50 },\n        repr: {\n            bits: typeOrUndefined(t.number),\n            count: typeOrUndefined(t.number),\n            trigger: typeOrUndefined(t.keyof(EdgeTrigger)),\n            displayRadix: typeOrUndefined(typeOrNull(t.number)), // undefined means default, null means no display\n        },\n        valueDefaults: {\n            trigger: EdgeTrigger.rising,\n            displayRadix: 10,\n        },\n        params: {\n            bits: param(4, [2, 3, 4, 7, 8, 16]),\n        },\n        validateParams: ({ bits }) => ({\n            numBits: bits,\n        }),\n        size: ({ numBits }) => ({\n            gridWidth: numBits <= 6 ? 5 : numBits <= 8 ? 6 : 7,\n            gridHeight: Math.max(11, 1 + (numBits + 1) * (useCompact(numBits) ? 1 : 2)),\n        }),\n        makeNodes: ({ numBits, gridWidth, gridHeight }) => {\n            const s = S.Components.Generic\n            const outX = 1 + gridWidth / 2\n            const groupQ = groupVertical(\"e\", outX, -1, numBits)\n            const lastQY = groupQ[numBits - 1][1]\n            const qyDiff = lastQY - groupQ[numBits - 2][1]\n            const clockVY = lastQY + qyDiff\n            const clearY = (gridHeight + 1) / 2\n\n            return {\n                ins: {\n                    Clock: [-outX, clockVY, \"w\", s.InputClockDesc, { isClock: true }],\n                    Clr: [0, clearY, \"s\", s.InputClearDesc, { prefersSpike: true }],\n                },\n                outs: {\n                    Q: groupQ,\n                    V: [outX, clockVY, \"e\", \"V (oVerflow)\"],\n                },\n            }\n        },\n        initialValue: (saved, { numBits }) => {\n            if (saved === undefined || saved.count === undefined) {\n                return Counter.emptyValue(numBits)\n            }\n            return [Counter.decimalToNBits(saved.count, numBits), false] as const\n        },\n    })\n\nexport type CounterRepr = Repr<typeof CounterDef>\nexport type CounterParams = ResolvedParams<typeof CounterDef>\n\nexport class Counter extends ParametrizedComponentBase<CounterRepr> {\n\n    public static emptyValue(numBits: number) {\n        return [ArrayFillWith<LogicValue>(false, numBits), false as LogicValue] as const\n    }\n\n    public static decimalToNBits(value: number, width: number): LogicValue[] {\n        const binStr = value.toString(2).padStart(width, \"0\")\n        const asBits = ArrayFillWith(false, width)\n        for (let i = 0; i < width; i++) {\n            asBits[i] = binStr[width - i - 1] === \"1\"\n        }\n        return asBits\n    }\n\n    public readonly numBits: number\n    private _trigger: EdgeTrigger\n    private _lastClock: LogicValue = Unknown\n    private _displayRadix: number | undefined\n\n    public constructor(parent: DrawableParent, params: CounterParams, saved?: CounterRepr) {\n        super(parent, CounterDef.with(params), saved)\n\n        this.numBits = params.numBits\n\n        this._trigger = saved?.trigger ?? CounterDef.aults.trigger\n        this._displayRadix = saved?.displayRadix === undefined ? CounterDef.aults.displayRadix\n            : (saved.displayRadix === null ? undefined : saved.displayRadix) // convert null in the repr to undefined\n    }\n\n    public toJSON() {\n        const [__, currentCountOrUnknown] = displayValuesFromArray(this.value[0], false)\n        const currentCount = isUnknown(currentCountOrUnknown) ? 0 : currentCountOrUnknown\n        const displayRadix = this._displayRadix === undefined ? null : this._displayRadix\n        return {\n            ...this.toJSONBase(),\n            bits: this.numBits === CounterDef.aults.bits ? undefined : this.numBits,\n            count: currentCount === 0 ? undefined : currentCount,\n            trigger: (this._trigger !== CounterDef.aults.trigger) ? this._trigger : undefined,\n            displayRadix: (displayRadix !== CounterDef.aults.displayRadix) ? displayRadix : undefined,\n        }\n    }\n\n    public get trigger() {\n        return this._trigger\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.Counter.tooltip\n        return tooltipContent(s.title, mods(\n            div(s.desc) // TODO more info\n        ))\n    }\n\n    protected doRecalcValue(): readonly [LogicValue[], LogicValue] {\n        const clear = this.inputs.Clr.value\n        if (clear === true) {\n            return Counter.emptyValue(this.numBits)\n        }\n\n        const prevClock = this._lastClock\n        const clock = this._lastClock = this.inputs.Clock.value\n        const activeOverflowValue = this._trigger === EdgeTrigger.rising ? true : false\n\n        if (Flipflop.isClockTrigger(this._trigger, prevClock, clock)) {\n            const [__, value] = displayValuesFromArray(this.value[0], false)\n            if (isUnknown(value)) {\n                return [ArrayFillWith(Unknown, this.numBits), Unknown]\n            }\n            const newValue = value + 1\n            if (newValue >= Math.pow(2, this.numBits)) {\n                return [ArrayFillWith(false, this.numBits), activeOverflowValue]\n            }\n\n            return [Counter.decimalToNBits(newValue, this.numBits), !activeOverflowValue]\n\n        } else {\n            return [this.value[0], !activeOverflowValue]\n        }\n    }\n\n    protected override propagateValue(newValue: readonly [LogicValue[], LogicValue]) {\n        const [counter, overflow] = newValue\n        this.outputValues(this.outputs.Q, counter)\n        this.outputs.V.value = overflow\n    }\n\n    protected doSetTrigger(trigger: EdgeTrigger) {\n        this._trigger = trigger\n        this.requestRedraw({ why: \"trigger changed\", invalidateTests: true })\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, (ctx, { width }) => {\n            if (this._displayRadix !== undefined) {\n                g.font = \"bold 20px sans-serif\"\n                const [__, currentCount] = displayValuesFromArray(this.value[0], false)\n                const stringRep = formatWithRadix(currentCount, this._displayRadix, this.numBits, false)\n                const labelMargin = 10\n                const valueCenter = ctx.rotatePoint(this.posX - labelMargin / 2, this.outputs.Q.group.posYInParentTransform)\n\n                g.fillStyle = COLOR_EMPTY\n                const frameWidth = width - labelMargin - 12\n                FlipflopOrLatch.drawStoredValueFrame(g, ...valueCenter, frameWidth, 28, false)\n\n                g.fillStyle = COLOR_LABEL_OFF\n                g.textAlign = \"center\"\n                fillTextVAlign(g, TextVAlign.middle, stringRep, ...valueCenter)\n            }\n        })\n    }\n\n    private doSetDisplayRadix(displayRadix: number | undefined) {\n        this._displayRadix = displayRadix\n        this.requestRedraw({ why: \"display radix changed\" })\n    }\n\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n\n        const s = S.Components.Counter.contextMenu\n        const makeItemShowRadix = (displayRadix: number | undefined, desc: string) => {\n            const icon = this._displayRadix === displayRadix ? \"check\" : \"none\"\n            const caption = s.DisplayTempl.expand({ desc })\n            const action = () => this.doSetDisplayRadix(displayRadix)\n            return MenuData.item(icon, caption, action)\n        }\n\n        return [\n            ...makeTriggerItems(this._trigger, this.doSetTrigger.bind(this)),\n            [\"mid\", MenuData.sep()],\n            [\"mid\", makeItemShowRadix(undefined, s.DisplayNone)],\n            [\"mid\", makeItemShowRadix(10, s.DisplayDecimal)],\n            [\"mid\", makeItemShowRadix(16, s.DisplayHex)],\n            [\"mid\", MenuData.sep()],\n            this.makeChangeParamsContextMenuItem(\"outputs\", S.Components.Generic.contextMenu.ParamNumBits, this.numBits, \"bits\"),\n            ...this.makeForceOutputsContextMenuItem(true),\n        ]\n    }\n\n}\nCounterDef.impl = Counter\n", "import * as t from \"io-ts\"\nimport { COLOR_BACKGROUND_INVALID, COLOR_COMPONENT_BORDER, colorForLogicValue, drawValueText } from \"../drawutils\"\nimport { S } from \"../strings\"\nimport { EdgeTrigger, LogicValue, LogicValueRepr, Unknown, toLogicValue, toLogicValueRepr, typeOrUndefined } from \"../utils\"\nimport { ComponentBase, InstantiatedComponentDef, NodesIn, NodesOut, Repr, defineAbstractComponent } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems } from \"./Drawable\"\n\n\nexport const FlipflopOrLatchDef =\n    defineAbstractComponent({\n        button: { imgWidth: 50 },\n        repr: {\n            state: typeOrUndefined(LogicValueRepr),\n            showContent: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {\n            state: false,\n            showContent: true,\n        },\n        size: { gridWidth: 5, gridHeight: 7 },\n        makeNodes: () => {\n            const s = S.Components.Generic\n            return {\n                outs: {\n                    Q: [+4, -2, \"e\", s.OutputQDesc],\n                    Q\u0305: [+4, 2, \"e\", s.OutputQBarDesc],\n                },\n            }\n        },\n        initialValue: (saved, defaults): [LogicValue, LogicValue] => {\n            if (saved === undefined) {\n                return [false, true]\n            }\n            const state = saved.state === undefined ? defaults.state : toLogicValue(saved.state)\n            return [state, LogicValue.invert(state)]\n        },\n    })\n\nexport type FlipflopOrLatchRepr = Repr<typeof FlipflopOrLatchDef>\nexport type FlipflopOrLatchValue = [LogicValue, LogicValue]\n\nexport abstract class FlipflopOrLatch<TRepr extends FlipflopOrLatchRepr> extends ComponentBase<\n    TRepr,\n    FlipflopOrLatchValue,\n    NodesIn<TRepr>,\n    NodesOut<TRepr>,\n    true, true\n> {\n\n    protected _showContent: boolean\n    protected _isInInvalidState = false\n\n    protected constructor(parent: DrawableParent, SubclassDef: InstantiatedComponentDef<TRepr, FlipflopOrLatchValue>, saved?: TRepr) {\n        super(parent, SubclassDef, saved)\n        this._showContent = saved?.showContent ?? FlipflopOrLatchDef.aults.showContent\n    }\n\n    protected override toJSONBase() {\n        const state = this.value[0]\n        return {\n            ...super.toJSONBase(),\n            state: state !== FlipflopOrLatchDef.aults.state ? toLogicValueRepr(state) : undefined,\n            showContent: (this._showContent !== FlipflopOrLatchDef.aults.showContent) ? this._showContent : undefined,\n        }\n    }\n\n    protected override propagateValue(newValue: [LogicValue, LogicValue]) {\n        this.outputs.Q.value = newValue[0]\n        this.outputs.Q\u0305.value = newValue[1]\n    }\n\n    protected doSetShowContent(showContent: boolean) {\n        this._showContent = showContent\n        this.requestRedraw({ why: \"show content changed\" })\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, {\n            background: this._isInInvalidState ? COLOR_BACKGROUND_INVALID : undefined,\n            drawLabels: () => {\n                if (this._showContent && !this.parent.editor.options.hideMemoryContent) {\n                    FlipflopOrLatch.drawStoredValue(g, this.value[0], this.posX, this.posY, 26, false)\n                }\n            },\n        })\n    }\n\n\n    public static drawStoredValueFrame(g: GraphicsRendering, x: number, y: number, width: number, height: number, swapHeightWidth: boolean) {\n        if (swapHeightWidth) {\n            [width, height] = [height, width]\n        }\n        g.strokeStyle = COLOR_COMPONENT_BORDER\n        g.lineWidth = 2\n        g.beginPath()\n        g.rect(x - width / 2, y - height / 2, width, height)\n        g.fill()\n        g.stroke()\n    }\n\n    public static drawStoredValue(g: GraphicsRendering, value: LogicValue, x: number, y: number, cellHeight: number, swapHeightWidth: boolean) {\n        g.fillStyle = colorForLogicValue(value)\n        FlipflopOrLatch.drawStoredValueFrame(g, x, y, 20, cellHeight, swapHeightWidth)\n        drawValueText(g, value, x, y, { small: cellHeight < 18 })\n    }\n\n}\n\n\n// Flip-flop base class\n\nexport const FlipflopBaseDef =\n    defineAbstractComponent({\n        button: FlipflopOrLatchDef.button,\n        repr: {\n            ...FlipflopOrLatchDef.repr,\n            trigger: typeOrUndefined(t.keyof(EdgeTrigger)),\n        },\n        valueDefaults: {\n            ...FlipflopOrLatchDef.valueDefaults,\n            trigger: EdgeTrigger.rising,\n        },\n        size: FlipflopOrLatchDef.size,\n        makeNodes: (clockYOffset: number) => {\n            const base = FlipflopOrLatchDef.makeNodes()\n            const s = S.Components.Generic\n            return {\n                ins: {\n                    Clock: [-4, clockYOffset, \"w\", s.InputClockDesc, { isClock: true }],\n                    Pre: [0, -4, \"n\", s.InputPresetDesc, { prefersSpike: true }],\n                    Clr: [0, +4, \"s\", s.InputClearDesc, { prefersSpike: true }],\n                },\n                outs: base.outs,\n            }\n        },\n        initialValue: FlipflopOrLatchDef.initialValue,\n    })\n\nexport type FlipflopBaseRepr = Repr<typeof FlipflopBaseDef>\n\nexport interface SyncComponent<State> {\n    trigger: EdgeTrigger\n    value: State\n    makeInvalidState(): State\n    makeStateFromMainValue(val: LogicValue): State\n    makeStateAfterClock(): State\n}\n\n\nexport abstract class Flipflop<\n    TRepr extends FlipflopBaseRepr,\n> extends FlipflopOrLatch<TRepr> implements SyncComponent<[LogicValue, LogicValue]> {\n\n    protected _lastClock: LogicValue = Unknown\n    protected _trigger: EdgeTrigger\n\n    protected constructor(parent: DrawableParent, SubclassDef: InstantiatedComponentDef<TRepr, FlipflopOrLatchValue>, saved?: TRepr) {\n        super(parent, SubclassDef, saved)\n        this._trigger = saved?.trigger ?? FlipflopBaseDef.aults.trigger\n    }\n\n    protected override toJSONBase() {\n        return {\n            ...super.toJSONBase(),\n            trigger: (this._trigger !== FlipflopBaseDef.aults.trigger) ? this._trigger : undefined,\n        }\n    }\n\n    public get trigger() {\n        return this._trigger\n    }\n\n    public static doRecalcValueForSyncComponent<State>(comp: SyncComponent<State>, prevClock: LogicValue, clock: LogicValue, preset: LogicValue, clear: LogicValue): { isInInvalidState: boolean, newState: State } {\n        // handle set and reset signals\n        if (preset === true) {\n            if (clear === true) {\n                return { isInInvalidState: true, newState: comp.makeInvalidState() }\n            } else {\n                // preset is true, clear is false, set output to 1\n                return { isInInvalidState: false, newState: comp.makeStateFromMainValue(true) }\n            }\n        }\n        if (clear === true) {\n            // clear is true, preset is false, set output to 0\n            return { isInInvalidState: false, newState: comp.makeStateFromMainValue(false) }\n        }\n\n        // handle normal operation\n        if (!Flipflop.isClockTrigger(comp.trigger, prevClock, clock)) {\n            return { isInInvalidState: false, newState: comp.value }\n        } else {\n            return { isInInvalidState: false, newState: comp.makeStateAfterClock() }\n        }\n    }\n\n    public static isClockTrigger(trigger: EdgeTrigger, prevClock: LogicValue, clock: LogicValue): boolean {\n        return (trigger === EdgeTrigger.rising && prevClock === false && clock === true)\n            || (trigger === EdgeTrigger.falling && prevClock === true && clock === false)\n    }\n\n    protected doRecalcValue(): [LogicValue, LogicValue] {\n        const prevClock = this._lastClock\n        const clock = this._lastClock = this.inputs.Clock.value\n        const { isInInvalidState, newState } =\n            Flipflop.doRecalcValueForSyncComponent(this, prevClock, clock,\n                this.inputs.Pre.value,\n                this.inputs.Clr.value)\n        this._isInInvalidState = isInInvalidState\n        return newState\n    }\n\n    public makeInvalidState(): [LogicValue, LogicValue] {\n        return [false, false]\n    }\n\n    public makeStateFromMainValue(val: LogicValue): [LogicValue, LogicValue] {\n        return [val, LogicValue.invert(val)]\n    }\n\n    public makeStateAfterClock(): [LogicValue, LogicValue] {\n        return this.makeStateFromMainValue(LogicValue.filterHighZ(this.doRecalcValueAfterClock()))\n    }\n\n    protected abstract doRecalcValueAfterClock(): LogicValue\n\n    protected doSetTrigger(trigger: EdgeTrigger) {\n        this._trigger = trigger\n        this.requestRedraw({ why: \"trigger changed\", invalidateTests: true })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n\n        const icon = this._showContent ? \"check\" : \"none\"\n        const toggleShowContentItem = MenuData.item(icon, S.Components.Generic.contextMenu.ShowContent,\n            () => this.doSetShowContent(!this._showContent))\n\n        return [\n            ...makeTriggerItems(this._trigger, this.doSetTrigger.bind(this)),\n            [\"mid\", MenuData.sep()],\n            [\"mid\", toggleShowContentItem],\n            ...this.makeForceOutputsContextMenuItem(true),\n        ]\n    }\n\n}\n\n\nexport function makeTriggerItems(currentTrigger: EdgeTrigger, handler: (trigger: EdgeTrigger) => void): MenuItems {\n    const s = S.Components.Generic.contextMenu\n\n    const makeTriggerItem = (trigger: EdgeTrigger, desc: string) => {\n        const isCurrent = currentTrigger === trigger\n        const icon = isCurrent ? \"check\" : \"none\"\n        const caption = s.TriggerOn + \" \" + desc\n        const action = isCurrent ? () => undefined :\n            () => handler(trigger)\n        return MenuData.item(icon, caption, action)\n    }\n\n    return [\n        [\"mid\", makeTriggerItem(EdgeTrigger.rising, s.TriggerRisingEdge)],\n        [\"mid\", makeTriggerItem(EdgeTrigger.falling, s.TriggerFallingEdge)],\n    ]\n}\n", "import * as t from \"io-ts\"\nimport { ComponentFactory } from \"../ComponentFactory\"\nimport { ComponentList } from \"../ComponentList\"\nimport { LogicEditor } from \"../LogicEditor\"\nimport { NodeManager } from \"../NodeManager\"\nimport { RecalcManager } from \"../RedrawRecalcManager\"\nimport { SVGRenderingContext } from \"../SVGRenderingContext\"\nimport { Serialization } from \"../Serialization\"\nimport { TestSuites } from \"../TestSuite\"\nimport { UIPermissions } from \"../UIPermissions\"\nimport { COLOR_COMPONENT_BORDER, TextVAlign, fillTextVAlign } from \"../drawutils\"\nimport { b, div, mods, span, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillUsing, ArrayFillWith, InteractionResult, LogicValue, isArray, isString, typeOrUndefined, validateJson } from \"../utils\"\nimport { Component, ComponentBase, ComponentRepr, NodeDesc, NodeGroupDesc, NodeInDesc, NodeOutDesc, NodeRec, defineComponent, groupHorizontal, groupVertical } from \"./Component\"\nimport { DrawContext, DrawableParent, EditTools, GraphicsRendering, MenuData, MenuItems, Orientation, Orientations } from \"./Drawable\"\nimport { Input, InputRepr } from \"./Input\"\nimport { Output, OutputRepr } from \"./Output\"\nimport { LinkManager, Wire } from \"./Wire\"\n\ntype CustomComponentNodeSpec = {\n    isIn: boolean,\n    id: string,\n    name: string,\n    orient: Orientation,\n    numBits: number,\n    sourcePos: [number, number],\n    sourceRepr: Record<string, unknown>,\n}\n\n// How custom components are identied in their type\nexport const CustomComponentPrefix = \"custom-\"\nexport const CustomComponentImageWidth = 50\nexport const CustomComponentImageHeight = 34\n\n// How custom component definitions are stored in JSON\nexport const CustomComponentDefRepr = t.type({\n    id: t.string,\n    caption: t.string,\n    circuit: t.type({\n        components: typeOrUndefined(t.record(t.string, t.record(t.string, t.unknown))),\n        wires: typeOrUndefined(t.array(Wire.Repr)),\n    }),\n})\n\nexport type CustomComponentDefRepr = t.TypeOf<typeof CustomComponentDefRepr>\ntype CircuitRepr = CustomComponentDefRepr[\"circuit\"]\n\n\nexport class CustomComponentDef {\n\n    public customId: string\n    public readonly circuit: CircuitRepr\n    public readonly insOuts: CustomComponentNodeSpec[]\n    public readonly numInputs: number\n    public readonly numOutputs: number\n    private readonly numBySide: Record<Orientation, number> = { n: 0, e: 0, s: 0, w: 0 }\n    private _caption: string\n    public gridWidth!: number\n    public gridHeight!: number\n\n    public toJSON(): CustomComponentDefRepr {\n        return {\n            id: this.customId,\n            caption: this._caption,\n            circuit: this.circuit,\n        }\n    }\n\n    public get id() {\n        return CustomComponentPrefix + this.customId\n    }\n\n    public get caption() {\n        return this._caption\n    }\n\n    public doSetCaption(caption: string) {\n        this._caption = caption\n        this.recalcSize()\n    }\n\n    public constructor(data: CustomComponentDefRepr) {\n        this.customId = data.id\n        this._caption = data.caption\n        this.circuit = data.circuit\n\n        this.insOuts = []\n        let totalIn = 0\n        let totalOut = 0\n        const components = this.circuit.components ?? {}\n        for (const [id, repr_] of Object.entries(components)) {\n            const repr = repr_ as ComponentRepr<true, true>\n            const isIn = repr.type === \"in\" && !((repr as InputRepr).isConstant ?? false)\n            const isOut = repr.type === \"out\"\n            if (isIn || isOut) {\n                const inOutRepr = repr as InputRepr | OutputRepr\n                const name = isString(inOutRepr.name) ? inOutRepr.name : (isIn ? \"In\" : \"Out\")\n                let orient = Orientations.includes(inOutRepr.orient) ? inOutRepr.orient : Orientation.default\n                orient = isIn ? Orientation.invert(orient) : orient\n                const numBits = Number(inOutRepr.bits ?? 1)\n                this.numBySide[orient] += numBits\n                const sourcePos = (isArray(inOutRepr.pos) && inOutRepr.pos.length === 2 ? inOutRepr.pos.map(Number) : [0, 0]) as [number, number]\n                this.insOuts.push({ isIn, id, name, orient, numBits, sourcePos, sourceRepr: inOutRepr })\n                delete components[id] // add them back after 2D sorting\n                if (isIn) {\n                    totalIn += numBits\n                } else {\n                    totalOut += numBits\n                }\n            }\n        }\n        sortInputsOutputs(this.insOuts)\n        for (const spec of this.insOuts) {\n            components[spec.id] = spec.sourceRepr\n        }\n\n        this.numInputs = totalIn\n        this.numOutputs = totalOut\n\n        this.recalcSize()\n    }\n\n    private recalcSize() {\n        const spacing = 2\n        const margin = 1.5\n        const minSize = 1 * this._caption.length + 2\n        this.gridWidth = Math.ceil(Math.max(minSize, (Math.max(this.numBySide.s, this.numBySide.n) - 1) * spacing + 2 * margin))\n        this.gridHeight = Math.ceil(Math.max(minSize, (Math.max(this.numBySide.e, this.numBySide.w) - 1) * spacing + 2 * margin))\n    }\n\n    // ComponentMaker interface\n    public isValid() { return true }\n    public get type() { return CustomComponentPrefix + this.customId }\n\n    public uses(type: string, alsoIndirect: false | [true, ComponentFactory]): boolean {\n        const compReprs = this.circuit.components\n        if (compReprs === undefined) {\n            return false\n        }\n        const whitelist: string[] = []\n        for (const compRepr of Object.values(compReprs)) {\n            const compType = String(compRepr.type)\n            if (compType === type) {\n                return true\n            } else if (alsoIndirect !== false && compType.startsWith(CustomComponentPrefix) && !whitelist.includes(compType)) {\n                const factory = alsoIndirect[1]\n                // maybe this other custom component uses the type\n                const customId = compType.substring(CustomComponentPrefix.length)\n                if (factory.getCustomDef(customId)?.uses(type, alsoIndirect) ?? false) {\n                    return true\n                }\n                whitelist.push(compType)\n            }\n        }\n        return false\n    }\n\n    public make(parent: DrawableParent): Component {\n        const comp = new CustomComponent(parent, this)\n        parent.components.add(comp)\n        return comp\n    }\n\n    public makeFromJSON(parent: DrawableParent, data: Record<string, unknown>): Component | undefined {\n        const validated = validateJson(data, CustomComponentRepr, \"CustomComponent\")\n        if (validated === undefined) {\n            return undefined\n        }\n        const comp = new CustomComponent(parent, this, validated)\n        parent.components.add(comp)\n        return comp\n    }\n\n    public makeButtonSVG() {\n        const width = CustomComponentImageWidth\n        const height = CustomComponentImageHeight\n        const g = new SVGRenderingContext(width, height)\n\n        // frame\n        g.rect(10, 2, 30, 30)\n        g.strokeStyle = \"currentColor\"\n        g.lineWidth = 2\n        g.stroke()\n\n        // in/out\n        const maxHeight = 24\n        const stdSep = 6\n        const drawInsOuts = (n: number, left: number, right: number) => {\n            const sep = ((n - 1) * stdSep <= maxHeight) ? stdSep : maxHeight / (n - 1)\n            const top = height / 2 - (n - 1) * sep / 2\n            for (let i = 0; i < n; i++) {\n                const y = top + i * sep\n                g.moveTo(left, y)\n                g.lineTo(right, y)\n            }\n        }\n        g.lineWidth = 1\n        const maxDrawnIO = 10\n        drawInsOuts(Math.min(maxDrawnIO, this.numInputs), 2, 10)\n        drawInsOuts(Math.min(maxDrawnIO, this.numOutputs), 40, 48)\n        g.stroke()\n\n        // caption\n        let drawCaption = this._caption\n        let shortened = false\n\n        // eslint-disable-next-line no-constant-condition\n        while (true) {\n            let fontSize = 15\n            g.font = `${fontSize}px sans-serif`\n            const textWidth = g.measureText(drawCaption).width\n            const scale = (width - 24) / textWidth\n            if (scale < 1) {\n                fontSize = Math.floor(scale * fontSize)\n                g.font = `${fontSize}px sans-serif`\n            }\n            if (fontSize >= 8) {\n                g.fillStyle = \"currentColor\"\n                g.textAlign = \"center\"\n                fillTextVAlign(g, TextVAlign.middle, drawCaption + (shortened ? \".\" : \"\"), width / 2, height / 2)\n                break\n            }\n            // else, try again with a shorter caption\n            drawCaption = drawCaption.slice(0, -1)\n            shortened = true\n        }\n\n        return g.getSvg()\n    }\n\n    // ComponentDef creation\n    public toStandardDef() {\n        return defineComponent(CustomComponentPrefix + this.customId, {\n            idPrefix: this.customId,\n            button: { imgWidth: 50 },\n            valueDefaults: {},\n            size: { gridWidth: this.gridWidth, gridHeight: this.gridHeight },\n            makeNodes: ({ gridWidth, gridHeight }) => {\n                const right = gridWidth / 2 + 1\n                const left = -right\n                const bottom = gridHeight / 2 + 1\n                const top = -bottom\n                const starts: Record<Orientation, number> = {\n                    n: this.numBySide.n - 1,\n                    e: -(this.numBySide.e - 1),\n                    s: this.numBySide.s - 1,\n                    w: -(this.numBySide.w - 1),\n                }\n                const counts: Record<Orientation, number> = { n: 0, e: 0, s: 0, w: 0 }\n                const make = (spec: CustomComponentNodeSpec): NodeDesc | NodeGroupDesc<NodeDesc> => {\n                    const { orient, numBits } = spec\n                    const [x, y] = (() => {\n                        const f = Orientation.isVertical(orient) ? -1 : 1\n                        const nextPos = starts[orient] + f * (counts[orient] + (numBits - 1) / 2) * 2\n                        switch (orient) {\n                            case \"e\": return [right, nextPos]\n                            case \"w\": return [left, nextPos]\n                            case \"n\": return [nextPos, top]\n                            case \"s\": return [nextPos, bottom]\n                        }\n                    })()\n                    counts[orient] += numBits\n                    return numBits === 1\n                        ? [x, y, orient]\n                        : Orientation.isVertical(orient)\n                            ? groupHorizontal(orient, x, y, numBits)\n                            : groupVertical(orient, x, y, numBits)\n                }\n\n                const ins: NodeRec<NodeInDesc> = {}\n                const outs: NodeRec<NodeOutDesc> = {}\n                //.sort((a, b) => a.sortIndex - b.sortIndex)\n                // console.log(sortedSpecs)\n                for (const spec of this.insOuts) {\n                    (spec.isIn ? ins : outs)[spec.name] = make(spec)\n                }\n                return { ins, outs }\n            },\n            initialValue: () => ArrayFillWith(false as LogicValue, this.numOutputs),\n        })\n    }\n}\n\nexport const CustomComponentRepr = ComponentRepr(true, true)\nexport type CustomComponentRepr = t.TypeOf<typeof CustomComponentRepr>\n\n\nexport class CustomComponent extends ComponentBase<CustomComponentRepr, LogicValue[]> implements DrawableParent {\n\n\n    /// Base public properties ///\n\n    private _customDef: CustomComponentDef\n    public get customDef() { return this._customDef }\n    public readonly numInputs: number\n    public readonly numOutputs: number\n\n\n    /// DrawableParent implementation ///\n\n    public isMainEditor(): this is LogicEditor { return false }\n    public get editor() { return this.parent.editor }\n    public get mode() { return this.parent.mode }\n\n    public readonly components = new ComponentList()\n    public readonly testSuites: TestSuites = new TestSuites(this)\n    public readonly nodeMgr = new NodeManager()\n    public readonly linkMgr: LinkManager = new LinkManager(this)\n    public readonly recalcMgr = new RecalcManager()\n\n    private _ifEditing: EditTools | undefined = undefined\n    public get ifEditing() { return this._ifEditing }\n    public stopEditingThis() { this._ifEditing = undefined }\n    public startEditingThis(tools: EditTools) { this._ifEditing = tools }\n\n\n    /// Other internals ///\n\n    private _subcircuitInputs: Input[] = []\n    private _subcircuitOutputs: Output[] = []\n\n    public constructor(parent: DrawableParent, customDef: CustomComponentDef, saved?: CustomComponentRepr) {\n        super(parent, customDef.toStandardDef(), saved)\n        this._customDef = customDef\n        this.numInputs = this.inputs._all.length\n        this.numOutputs = this.outputs._all.length\n\n        const error = Serialization.loadCircuitForCustomComponent(this, customDef.circuit)\n        if (error !== undefined) {\n            console.error(\"Failed to load custom component:\", error)\n            this.setInvalid()\n        }\n    }\n\n    /**\n     * Called by Serialization.loadCircuitOfCustomComponent after successfully loading a circuit;\n     * can be seen as the rest of the constructor. It sets up the input and output nodes of this\n     * CustomComponent according to the properties of the loaded Input/Output components.\n     */\n    public circuitDidLoad() {\n        this._subcircuitInputs.length = 0\n        this._subcircuitOutputs.length = 0\n        let iIn = 0\n        for (const comp of this.components.all()) {\n            // assume they have been kept in the right order\n            if (comp instanceof Input && !comp.isConstant) {\n                this._subcircuitInputs.push(comp)\n                comp.isCustomComponentInput = true\n                const nodes = comp.outputs._all\n                const num = nodes.length\n                if (num === 1 && comp.isLinkedToSomeClock) {\n                    this.inputs._all[iIn].isClock = true\n                }\n                for (let i = 0; i < num; i++) {\n                    const j = iIn + i\n                    if (j >= this.numInputs) {\n                        // we have more input components than actual inputs for this\n                        // custom components; this means we are restoring a saved editor\n                        // state where some input was added, so we needn't update our\n                        // input node now\n                        break\n                    }\n                    this.inputs._all[j].prefersSpike = comp.isPushButton\n                }\n                iIn += num\n            } else if (comp instanceof Output) {\n                this._subcircuitOutputs.push(comp)\n            }\n        }\n    }\n\n    public override toStringDetails() {\n        return this.customDef?.customId ?? \"\"\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    protected override jsonType() {\n        return CustomComponentPrefix + this.customDef.customId\n    }\n\n    protected override makeClone(setSpawning: boolean): CustomComponent {\n        const repr = this.toNodelessJSON()\n        const clone = new CustomComponent(this.parent, this.customDef, repr)\n        this.parent.components.add(clone)\n        if (setSpawning) {\n            clone.setSpawning()\n        }\n        return clone\n    }\n\n    public updateFromDef() {\n        // we need to recreate it to regenerate the properties from the new def\n        const newDef = this.editor.factory.getCustomDef(this._customDef.customId)\n        if (newDef === undefined) {\n            console.warn(\"New custom component definition not found, using old one, but trouble is ahead\")\n        } else {\n            this._customDef = newDef\n        }\n        this.replaceWithComponent(this.makeClone(false))\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        let bitOffset = 0\n        for (const inputComp of this._subcircuitInputs) {\n            const numBits = inputComp.numBits\n            if (bitOffset + numBits > this.numInputs) {\n                // we have more input components than actual inputs for this in the current\n                // editing state, so we just skip the rest\n                break\n            }\n            inputComp.setValue(ArrayFillUsing(i => this.inputs._all[bitOffset + i].value, numBits))\n            inputComp.propagateCurrentValue()\n            bitOffset += numBits\n        }\n        this.recalcMgr.recalcAndPropagateIfNeeded()\n\n        const outputs: LogicValue[] = []\n        for (const outputComp of this._subcircuitOutputs) {\n            outputs.push(...outputComp.value)\n        }\n        return outputs\n    }\n\n    protected override propagateValue(newValue: LogicValue[]) {\n        this.outputValues(this.outputs._all, newValue)\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.Custom.tooltip\n        return tooltipContent(mods(b(this.customDef.caption), span(s.titleSuffix)), mods(\n            div(s.desc),\n        ))\n    }\n\n\n    // TODO tooltip\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext): void {\n        super.doDrawDefault(g, ctx, () => {\n            g.font = `bold 18px sans-serif`\n            g.fillStyle = COLOR_COMPONENT_BORDER\n            g.textAlign = \"center\"\n            fillTextVAlign(g, TextVAlign.middle, this.customDef.caption, this.posX, this.posY)\n        })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.Custom.contextMenu\n\n        return [\n            ...this.makeForceOutputsContextMenuItem(),\n            [\"mid\", MenuData.item(\"connect\", s.ChangeCircuit, () => {\n                this.tryOpenEditor()\n            }, \"\u21A9\uFE0E\")],\n        ]\n    }\n\n    public override keyDown(e: KeyboardEvent): void {\n        if (e.key === \"Enter\" && !e.altKey) {\n            this.tryOpenEditor()\n        } else {\n            super.keyDown(e)\n        }\n    }\n\n    public override pointerDoubleClicked(e: PointerEvent) {\n        const result = super.pointerDoubleClicked(e)\n        if (result.isChange) {\n            return result\n        }\n        return this.tryOpenEditor()\n\n    }\n\n    private tryOpenEditor(): InteractionResult {\n        const s = S.Components.Custom.messages\n\n        let showOnly\n        if (!UIPermissions.canModifyCustomComponents(this.editor) || (showOnly = this.editor.options.showOnly) !== undefined && !showOnly.includes(this._customDef.id)) {\n            alert(s.CannotBeModified)\n            return InteractionResult.NoChange\n        }\n\n        if (!(this.editor.editorRoot instanceof LogicEditor)) {\n            alert(s.NotInMainEditor)\n            return InteractionResult.NoChange\n        }\n\n        this.editor.setEditorRoot(this)\n        this.editor.editTools.undoMgr.takeSnapshot()\n        return InteractionResult.SimpleChange\n    }\n\n}\n\n\nfunction sortInputsOutputs(insOuts: CustomComponentNodeSpec[]) {\n    const orientValue = {\n        e: 0,\n        w: 1,\n        n: 2,\n        s: 3,\n    }\n    const criterion = (spec: CustomComponentNodeSpec) => {\n        return Orientation.isVertical(spec.orient) ? -spec.sourcePos[0] : spec.sourcePos[1]\n    }\n    insOuts.sort((a, b) => {\n        return orientValue[a.orient] - orientValue[b.orient] || criterion(a) - criterion(b)\n    })\n}\n\n", "import { Component } from \"./components/Component\"\nimport { CustomComponent } from \"./components/CustomComponent\"\nimport { DrawZIndex } from \"./drawutils\"\nimport { ArrayFillUsing, isString } from \"./utils\"\n\nexport class ComponentList {\n\n    private _componentsByZIndex = ArrayFillUsing(() => [] as Component[], 3)\n    private _componentsById = new Map<string, Component>()\n\n    public *all() {\n        for (const compList of this._componentsByZIndex) {\n            for (const comp of compList) {\n                yield comp\n            }\n        }\n    }\n\n    public *allInReversedZIndexOrder() {\n        for (let i = this._componentsByZIndex.length - 1; i >= 0; i--) {\n            const compList = this._componentsByZIndex[i]\n            for (const comp of compList) {\n                yield comp\n            }\n        }\n    }\n\n    public *withZIndex(zIndex: DrawZIndex) {\n        for (const comp of this._componentsByZIndex[zIndex]) {\n            yield comp\n        }\n    }\n\n    public add(comp: Component) {\n        const z = comp.drawZIndex\n        this._componentsByZIndex[z].push(comp)\n\n        let id = comp.ref\n        let oldComp\n        if (id === undefined) {\n            id = this.generateIdFor(comp)\n            comp.doSetValidatedId(id)\n        } else if ((oldComp = this._componentsById.get(id)) !== undefined) {\n            console.error(`Component with id '${id}' already exists and will be renamed`)\n            const idForOldComp = this.generateIdFor(oldComp)\n            oldComp.doSetValidatedId(idForOldComp)\n            this._componentsById.set(idForOldComp, oldComp)\n        }\n        this._componentsById.set(id, comp)\n    }\n\n    public contains(type: string): boolean {\n        for (const comp of this.all()) {\n            if (comp.def.type === type) {\n                return true\n            }\n        }\n        return false\n    }\n\n    public updateCustomComponents(type: string) {\n        for (const comp of [...this.all()]) {\n            if (comp.def.type === type && comp instanceof CustomComponent) {\n                comp.updateFromDef()\n            }\n        }\n    }\n\n    public changeIdOf(comp: Component, newId: string) {\n        // We must make sure that this new id is not already used before calling\n        const oldId = comp.ref\n        if (oldId !== undefined) {\n            const deleted = this._componentsById.delete(oldId)\n            if (!deleted) {\n                console.warn(`Component with id '${oldId}' not found`)\n            }\n        }\n        if (this._componentsById.has(newId)) {\n            throw new Error(`Component with id '${newId}' already exists`)\n        }\n        comp.doSetValidatedId(newId)\n        this._componentsById.set(newId, comp)\n    }\n\n    public regenerateIdOf(comp: Component) {\n        const newId = this.generateIdFor(comp)\n        this.changeIdOf(comp, newId)\n    }\n\n    public swapIdsOf(comp1: Component, comp2: Component) {\n        const id1 = comp1.ref\n        const id2 = comp2.ref\n        if (id1 === undefined || id2 === undefined) {\n            throw new Error(\"Cannot swap ids of components without ids\")\n        }\n        comp1.doSetValidatedId(id2)\n        comp2.doSetValidatedId(id1)\n        this._componentsById.set(id1, comp2)\n        this._componentsById.set(id2, comp1)\n    }\n\n    public get(id: string): Component | undefined {\n        return this._componentsById.get(id)\n    }\n\n    public looksLikeAutoGeneratedId(comp: Component): boolean {\n        const ref = comp.ref\n        if (ref === undefined) {\n            return false\n        }\n        const prefix = ComponentList.idPrefixFor(comp)\n        if (!ref.startsWith(prefix)) {\n            return false\n        }\n        const suffix = ref.slice(prefix.length)\n        if (isNaN(Number(suffix))) {\n            return false\n        }\n        return true\n    }\n\n    private generateIdFor(comp: Component): string {\n        const prefix = ComponentList.idPrefixFor(comp)\n        let i = 0\n        let id\n        while (this._componentsById.has(id = `${prefix}${i}`)) {\n            i++\n        }\n        return id\n    }\n\n    private static idPrefixFor(comp: Component) {\n        const prefixFromDef = comp.def.idPrefix\n        return isString(prefixFromDef) ? prefixFromDef : prefixFromDef(comp)\n    }\n\n    public tryDelete(comp: Component): boolean {\n        return this.tryDeleteWhere(c => c === comp, true).length > 0\n    }\n\n    public tryDeleteWhere(cond: (e: Component) => boolean, onlyOne: boolean): Component[] {\n        const deletedComps: Component[] = []\n\n        // delete components\n        outer:\n        for (const compList of this._componentsByZIndex) {\n            for (let i = 0; i < compList.length; i++) {\n                const comp = compList[i]\n                if (cond(comp)) {\n                    comp.destroy()\n                    compList.splice(i, 1)\n                    deletedComps.push(comp)\n                    if (onlyOne) {\n                        break outer\n                    }\n                }\n            }\n        }\n\n        // delete ids\n        for (const comp of deletedComps) {\n            const id = comp.ref\n            if (id === undefined) {\n                console.warn(\"Removing component without id\")\n            } else if (!this._componentsById.has(id)) {\n                console.warn(`Removing component with id '${id}' but no component with that id exists`)\n            } else {\n                this._componentsById.delete(id)\n            }\n        }\n\n        // remove anchors\n        for (const comp of deletedComps) {\n            for (const anchored of comp.anchoredDrawables) {\n                anchored.anchor = undefined\n            }\n        }\n\n        return deletedComps\n    }\n\n    public clearAll() {\n        for (const compList of this._componentsByZIndex) {\n            compList.length = 0\n        }\n        this._componentsById.clear()\n    }\n\n}\n", "import { Component } from \"./components/Component\"\nimport { Node } from \"./components/Node\"\n\nexport type NodeMapping = Map<number, number>\n\nexport class NodeManager {\n\n    private _lastGivenNodeID = -1\n    private _usedIDs = new Set<number>()\n    private _allLiveNodes: Node[] = []\n    private _currentMapping: NodeMapping | undefined = undefined\n\n    public getFreeId(): number {\n        while (this._usedIDs.has(++this._lastGivenNodeID)) {\n            // empty block, condition does the increment\n        }\n        this._usedIDs.add(this._lastGivenNodeID)\n        return this._lastGivenNodeID\n    }\n\n    public getFreeIdFrom(sourceId: number): number {\n        if (!this._usedIDs.has(sourceId)) {\n            this._usedIDs.add(sourceId)\n            return sourceId\n        }\n\n        if (this._currentMapping !== undefined) {\n            const newId = this.getFreeId()\n            this._currentMapping.set(sourceId, newId)\n            return newId\n        } else {\n            console.error(`Loaded node with id ${sourceId}, which is already taken, with no NodeMapping being built`)\n            return sourceId\n        }\n    }\n\n    public addLiveNode(node: Node) {\n        if (!this._usedIDs.has(node.id)) {\n            console.error(`Inserting live node with unreserved id ${node.id}`)\n        }\n        this._allLiveNodes[node.id] = node\n    }\n\n    public removeLiveNode(node: Node) {\n        delete this._allLiveNodes[node.id]\n        this._usedIDs.delete(node.id)\n    }\n\n    public clearAll() {\n        this._allLiveNodes.length = 0\n        this._usedIDs.clear()\n        this._lastGivenNodeID = -1\n        this._currentMapping = undefined\n    }\n\n    public findNode(id: number, mapping: NodeMapping): Node | undefined {\n        const mappedId = mapping.get(id) ?? id\n        return this._allLiveNodes[mappedId]\n    }\n\n    public recordMappingWhile(f: () => void): NodeMapping {\n        if (this._currentMapping !== undefined) {\n            console.warn(\"NodeManager.recordMappingWhile called while already recording a mapping\")\n        }\n        this._currentMapping = new Map()\n        f()\n        const mapping = this._currentMapping\n        this._currentMapping = undefined\n        // console.log(`${mapping.size} node mappings were recorded`)\n        return mapping\n    }\n\n    public tryConnectNodesOf(comp: Component) {\n        const linkMgr = comp.parent.linkMgr\n        const addedConnections: [Node, Component, Node][] = []\n        for (const node of comp.allNodes()) {\n            if (node.acceptsMoreConnections) {\n                const nodeX = node.posX\n                const nodeY = node.posY\n                const component = node.component\n                for (const other of this._allLiveNodes) {\n                    if (other !== undefined && other.component !== component && other.acceptsMoreConnections) {\n                        if (other.posX === nodeX && other.posY === nodeY) {\n                            // the wire manager will take care of determining whether\n                            // they can actually be connected or not\n                            linkMgr.startDraggingWireFrom(node)\n                            const wire = linkMgr.stopDraggingWireOn(other)\n                            if (wire !== undefined) {\n                                addedConnections.push([node, other.component, other])\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return addedConnections\n    }\n\n}\n", "import { Component } from \"./components/Component\"\nimport { Drawable } from \"./components/Drawable\"\nimport { Dict } from \"./utils\"\n\nexport type RedrawRequest = {\n    why: string\n    component?: Drawable\n    invalidateMask?: boolean\n    invalidateTests?: boolean\n    isPropagation?: boolean\n}\n\nexport class RedrawManager {\n\n    private _canvasRedrawReasons: Dict<unknown[]> = {}\n    private _maskWasInvalidated = false\n    private _testsInvalidationReasons: Array<[string, Drawable | null]> = []\n    private _isPropagating = false\n    private _isEmpty = true\n\n    public requestRedraw(req: RedrawRequest) {\n        const compObj = req.component ?? null\n        const compList = this._canvasRedrawReasons[req.why]\n        if (compList === undefined) {\n            this._canvasRedrawReasons[req.why] = [compObj]\n        } else {\n            compList.push(compObj)\n        }\n        if (req.invalidateMask ?? false) {\n            this._maskWasInvalidated = true\n        }\n        if (req.invalidateTests ?? false) {\n            this._testsInvalidationReasons.push([req.why, compObj])\n        }\n        if (req.isPropagation ?? false) {\n            this._isPropagating = true\n        }\n        this._isEmpty = false\n    }\n\n    public getReasonsAndClear(): { getReasons: () => string, redrawMask: boolean, invalidateTests: boolean } | undefined {\n        if (this._isEmpty) {\n            return undefined\n        }\n\n        const redrawReasons = this._canvasRedrawReasons\n        const getReasons = () => {\n            const reasonParts: string[] = []\n            for (const reason of Object.keys(redrawReasons)) {\n                reasonParts.push(reason)\n                const linkedComps = redrawReasons[reason]!\n                reasonParts.push(\" (\", String(linkedComps.length), \"\u00D7)\", \": \")\n                for (const comp of linkedComps) {\n                    if (comp !== null) {\n                        const compAny = comp as any\n                        reasonParts.push(compAny.constructor?.name ?? \"Component\")\n                        if (compAny.type !== undefined) {\n                            reasonParts.push(\"_\", compAny.type)\n                        }\n                        if (compAny.name !== undefined) {\n                            reasonParts.push(\"('\", compAny.name, \"')\")\n                        }\n                        reasonParts.push(\"; \")\n                    }\n                }\n                reasonParts.pop()\n                reasonParts.push(\"\\n    \")\n            }\n            reasonParts.pop()\n            return reasonParts.join(\"\")\n        }\n\n        const redrawMask = this._maskWasInvalidated\n        const invalidateTests = this._testsInvalidationReasons.length > 0\n        // if (invalidateTests) {\n        //     console.log(\"Invalidated tests because:\")\n        //     for (const [reason, comp] of this._testsInvalidationReasons) {\n        //         console.log(\"  \", reason, \" \u2013 \", comp)\n        //     }\n        // }\n\n        this._canvasRedrawReasons = {}\n        this._isPropagating = false\n        this._maskWasInvalidated = false\n        this._testsInvalidationReasons.length = 0\n        this._isEmpty = true\n        return { getReasons, redrawMask, invalidateTests }\n    }\n\n    public hasReasons(): boolean {\n        return !this._isEmpty\n    }\n\n    public isAnyValuePropagating(): boolean {\n        return this._isPropagating\n    }\n}\n\n\nexport class RecalcManager {\n\n    private _propagateQueue: Array<Component> = []\n    private _recalcQueue: Array<[Component, force: boolean]> = []\n    public debug = false\n\n    public enqueueForPropagate(comp: Component) {\n        this._propagateQueue.push(comp)\n        this.log(\"Enqueued for propagate: \" + comp)\n    }\n\n    public enqueueForRecalc(comp: Component, forcePropagate: boolean) {\n        this._recalcQueue.push([comp, forcePropagate])\n        this.log(\"Enqueued for recalc: \" + comp)\n    }\n\n    public queueIsEmpty(): boolean {\n        return this._propagateQueue.length === 0 && this._recalcQueue.length === 0\n    }\n\n    public recalcAndPropagateIfNeeded(): boolean {\n        if (this.queueIsEmpty()) {\n            return false\n        }\n        this.recalcAndPropagate()\n        return true\n    }\n\n    private recalcAndPropagate() {\n        // We proceed as follows: first, we propagate (from input nodes to components)\n        // all pending values. This marks some components as needing recalc, probably, and\n        // doing all propagation beforehand allows to wait with recalc until all values are\n        // propagated. Then, we recalc all components that need it, and then we loop until\n        // no new propagation/recalc is needed. We may need several loops if propagation\n        // times are set to 0, and we break out of the loop after a certain number of rounds\n        // to avoid infinite loops (e.g., a NOT gate looping back to itself)\n\n        let round = 0\n        const roundLimit = 1000\n        do {\n            round++\n            if (round >= roundLimit) {\n                console.warn(`ERROR: Circular dependency; suspending updates after ${roundLimit} recalc/propagate rounds`)\n                for (const comp of [...this._propagateQueue, ...this._recalcQueue.map((r) => r[0])]) {\n                    comp.setInvalid()\n                }\n                this._propagateQueue = []\n                this._recalcQueue = []\n                break\n            }\n\n            this.log(`Recalc/propagate round ${round}: ${this._propagateQueue.length} propagate, ${this._recalcQueue.length} recalc.`)\n\n            const propagateQueue = this._propagateQueue\n            this._propagateQueue = []\n            this.log(`  PROPAG (${propagateQueue.length}) \u2013 ` + propagateQueue.map((c) => c.toString()).join(\"; \"))\n            for (const comp of propagateQueue) {\n                try {\n                    comp.propagateCurrentValue()\n                } catch (e) {\n                    console.error(\"Error while propagating value of \" + comp, e)\n                    comp.setInvalid()\n                }\n            }\n\n            const recalcQueue = this._recalcQueue\n            this._recalcQueue = []\n            this.log(`  RECALC (${recalcQueue.length}) \u2013 ` + recalcQueue.map((c) => c.toString()).join(\"; \"))\n            for (const [comp, forcePropagate] of recalcQueue) {\n                try {\n                    comp.recalcValue(forcePropagate)\n                } catch (e) {\n                    console.error(\"Error while recalculating value of \" + comp, e)\n                    comp.setInvalid()\n                }\n            }\n\n        } while (!this.queueIsEmpty())\n\n        this.log(`Recalc/propagate done in ${round} rounds.`)\n    }\n\n    private log(msg: string) {\n        if (this.debug) {\n            console.log(msg)\n        }\n    }\n\n}\n", "/**\n * This is a TypeScript port of canvas2svg a.k.a svgcanvas\n *\n * Original by https://github.com/gliffy/canvas2svg\n * Updated by https://github.com/zenozeng/svgcanvas\n * Improved by https://github.com/aha-app/svgcanvas\n *\n *  Licensed under the MIT license:\n *  http://www.opensource.org/licenses/mit-license.php\n */\n\nimport { isString } from \"./utils\"\n\nexport type ContextOptions = {\n    width: number\n    height: number\n    enableMirroring: boolean\n    document: Document\n    ctx: CanvasRenderingContext2D\n    metadata: string | undefined\n}\n\nexport class SVGRenderingContext {\n\n    // basic properties\n    public readonly width: number\n    public readonly height: number\n    public readonly enableMirroring: boolean\n    public readonly canvas: SVGRenderingContext\n\n    // mirrored canvas properties\n    public strokeStyle: string = \"#000000\"\n    public fillStyle: string = \"#000000\"\n    public lineCap: string = \"butt\"\n    public lineJoin: string = \"miter\"\n    public miterLimit: number = 10\n    public lineWidth: number = 1\n    public globalAlpha: number = 1\n    public font: string = \"10px sans-serif\"\n    public shadowColor: string = \"#000000\"\n    public shadowOffsetX: number = 0\n    public shadowOffsetY: number = 0\n    public shadowBlur: number = 0\n    public textAlign: string = \"start\"\n    public textBaseline: string = \"alphabetic\"\n    public lineDash: string | null = null\n    public lineDashOffset: number = 0\n    // extra\n    public fontUnderline: string = \"\"\n    public fontHref: string | undefined\n\n    // internal properties\n    private readonly _document: Document\n    private readonly _helperCanvas: HTMLCanvasElement | undefined\n    private readonly _g: CanvasRenderingContext2D\n    private readonly _svg: SVGSVGElement\n    private readonly _defs: SVGDefsElement\n    private readonly _styleStack: Record<string, string>[]\n    private readonly _groupStack: SVGElement[] = []\n    private readonly _ids: Record<string, unknown>\n    private readonly _transformMatrixStack: DOMMatrix[] = []\n    // current state\n    private _currentElement: SVGElement\n    private _currentPath: Path2DSVG = new Path2DSVG(this)\n    public _transformMatrix: DOMMatrix = new DOMMatrix()\n\n    public constructor(options?: Partial<ContextOptions>)\n    public constructor(width: number, height: number)\n\n    public constructor(optionsOrWidth?: Partial<ContextOptions> | number, height?: number) {\n\n        // keep support for this way of calling Context: new Context(width, height)\n        let options: Partial<ContextOptions>\n        if (height !== undefined) {\n            options = { width: optionsOrWidth as number, height }\n        } else if (optionsOrWidth !== undefined) {\n            options = optionsOrWidth as Partial<ContextOptions>\n        } else {\n            options = {}\n        }\n\n        // setup options\n        this.width = options.width ?? 500\n        this.height = options.height ?? 500\n        this.enableMirroring = options.enableMirroring ?? false\n\n        this.canvas = this   // point back to this instance!\n        this._document = options.document ?? document\n\n        // allow passing in an existing context to wrap around\n        // if a context is passed in, we know a canvas already exist\n        if (options.ctx) {\n            this._g = options.ctx\n        } else {\n            this._helperCanvas = this._document.createElement(\"canvas\")\n            this._g = this._helperCanvas.getContext(\"2d\")!\n        }\n\n        this._styleStack = [this._getStyleState()]\n\n        // the root svg element\n        this._svg = this._document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\")\n        this._svg.setAttribute(\"version\", \"1.1\")\n        this._svg.setAttribute(\"xmlns\", \"http://www.w3.org/2000/svg\")\n        this._svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\")\n        this._svg.setAttribute(\"width\", String(this.width))\n        this._svg.setAttribute(\"height\", String(this.height))\n\n        // make sure we don't generate the same ids in defs\n        this._ids = {}\n\n        if (options.metadata !== undefined) {\n            const metadata = this._document.createElementNS(\"http://www.w3.org/2000/svg\", \"metadata\")\n            const textNode = this._document.createTextNode(options.metadata)\n            metadata.appendChild(textNode)\n            this._svg.appendChild(metadata)\n        }\n\n        // defs tag\n        this._defs = this._document.createElementNS(\"http://www.w3.org/2000/svg\", \"defs\")\n        this._svg.appendChild(this._defs)\n\n        // also add a group child. the svg element can't use the transform attribute\n        this._currentElement = this._document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\")\n        this._svg.appendChild(this._currentElement)\n\n        // init transformation matrix\n        this.resetTransform()\n    }\n\n\n    /// PRIVATE HELPERS\n\n    public _createElement<K extends keyof SVGElementTagNameMap>(elementName: K, properties?: Record<string, string | number>, resetFill = false): SVGElementTagNameMap[K] {\n        const element = this._document.createElementNS(\"http://www.w3.org/2000/svg\", elementName)\n        if (resetFill) {\n            // if fill or stroke is not specified, the svg element should not display. By default SVG's fill is black.\n            element.setAttribute(\"fill\", \"none\")\n            element.setAttribute(\"stroke\", \"none\")\n        }\n        if (properties !== undefined) {\n            for (const [key, value] of Object.entries(properties)) {\n                element.setAttribute(key, String(value))\n            }\n        }\n        return element\n    }\n\n    /**\n     * Will return the closest group or svg node. May return the current element.\n     */\n    private _closestGroupOrSvg(node?: SVGElement | null): SVGElement {\n        node = node ?? this._currentElement\n        if (node.nodeName === \"g\" || node.nodeName === \"svg\") {\n            return node\n        } else {\n            return this._closestGroupOrSvg(node.parentNode as SVGElement | null)\n        }\n    }\n\n    /**\n     * Applies styles on restore\n     */\n    private _applyStyleState(styleState: Record<string, string>) {\n        for (const [key, value] of Object.entries(styleState)) {\n            (this as any)[key] = value\n        }\n    }\n\n    /**\n     * Gets the current style state\n     */\n    private _getStyleState() {\n        const styleState: Record<string, string> = {}\n        for (const key of Object.keys(STYLES)) {\n            styleState[key] = (this as any)[key]\n        }\n        return styleState\n    }\n\n    private _applyTransformation(element: SVGElement, matrix?: DOMMatrix) {\n        // See https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/transform\n        const { a, b, c, d, e, f } = matrix ?? this.getTransform()\n        if (a === 1 && b === 0 && c === 0 && d === 1 && e === 0 && f === 0) {\n            // if is identity, do nothing\n            return\n        }\n        element.setAttribute('transform', `matrix(${a} ${b} ${c} ${d} ${e} ${f})`)\n    }\n\n    /**\n     * Apples the current styles to the current SVG element. On \"ctx.fill\" or \"ctx.stroke\"\n     */\n    private _applyStyleToElement(elem: SVGElement, type: \"fill\" | \"stroke\") {\n        for (const [key, style] of Object.entries(STYLES)) {\n            let value = (this as any)[key]\n            if (\"apply\" in style && style.apply) {\n                // is this a gradient or pattern?\n                if (value instanceof CanvasPatternSVG) {\n                    // copy over defs\n                    for (const node of value._ctx._defs.children) {\n                        const id = node.getAttribute(\"id\")!\n                        this._ids[id] = id\n                        this._defs.appendChild(node)\n                    }\n                    elem.setAttribute(style.apply, `url(#${value.patternElem.getAttribute(\"id\")})`)\n                }\n                else if (value instanceof CanvasGradientSVG) {\n                    // gradient\n                    elem.setAttribute(style.apply, `url(#${value.gradientElem.getAttribute(\"id\")})`)\n                } else if (style.apply.indexOf(type) !== -1 && style.svg !== value) {\n                    if ((style.svgAttr === \"stroke\" || style.svgAttr === \"fill\") && value.indexOf(\"rgba\") !== -1) {\n                        // separate alpha value, since illustrator can't handle it\n                        const regex = /rgba\\(\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d?\\.?\\d*)\\s*\\)/gi\n                        const matches = regex.exec(value)!\n                        elem.setAttribute(style.svgAttr, `rgb(${matches[1]},${matches[2]},${matches[3]})`)\n                        // should take globalAlpha here\n                        const opacity = parseFloat(matches[4]) * this.globalAlpha\n                        elem.setAttribute(style.svgAttr + \"-opacity\", String(opacity))\n                    } else {\n                        let attr = style.svgAttr\n                        if (key === 'globalAlpha') {\n                            attr = type + '-' + style.svgAttr\n                            if (elem.getAttribute(attr) !== null) {\n                                // fill-opacity or stroke-opacity has already been set by stroke or fill.\n                                continue\n                            }\n                        } else if (key === 'lineWidth') {\n                            const scale = this._getTransformScale()\n                            value = value * Math.max(scale.x, scale.y)\n                        }\n                        // otherwise only update attribute if right type, and not svg default\n                        elem.setAttribute(attr, value)\n                    }\n                }\n            }\n        }\n    }\n\n\n    /// SVG ACCESS\n\n    /**\n     * Returns the serialized value of the svg so far\n     * @param fixNamedEntities - Standalone SVG doesn't support named entities, which document.createTextNode encodes. If true, we attempt to find all named entities and encode it as a numeric entity.\n     * @return serialized svg\n     */\n    public getSerializedSvg(fixNamedEntities = false): string {\n        let serialized = new XMLSerializer().serializeToString(this._svg)\n\n        // IE search for a duplicate xmnls because they didn't implement setAttributeNS correctly\n        const xmlns = /xmlns=\"http:\\/\\/www\\.w3\\.org\\/2000\\/svg\".+xmlns=\"http:\\/\\/www\\.w3\\.org\\/2000\\/svg/gi\n        if (xmlns.test(serialized)) {\n            serialized = serialized.replace('xmlns=\"http://www.w3.org/2000/svg', 'xmlns:xlink=\"http://www.w3.org/1999/xlink')\n        }\n\n        if (fixNamedEntities) {\n            for (const [key, value] of Object.entries(namedEntities)) {\n                const regexp = new RegExp(key, \"gi\")\n                if (regexp.test(serialized)) {\n                    serialized = serialized.replace(regexp, value)\n                }\n            }\n        }\n\n        return serialized\n    }\n\n    public getSvg(): SVGSVGElement {\n        return this._svg\n    }\n\n\n    /// CONTEXT SAVE/RESTORE and GROUPS\n\n    public beginGroup(className: string | undefined) {\n        const group = this._createElement(\"g\")\n        if (className !== undefined) {\n            group.setAttribute(\"class\", className)\n        }\n        const parent = this._closestGroupOrSvg()\n        this._groupStack.push(parent)\n        parent.appendChild(group)\n        this._currentElement = group\n    }\n\n    public endGroup() {\n        this._currentElement = this._groupStack.pop() ?? this._svg.children[1] as SVGElement\n    }\n\n    /**\n     * Saves the current state by creating a group tag\n     */\n    public save() {\n        this.beginGroup(undefined)\n        this._styleStack.push(this._getStyleState())\n        this._transformMatrixStack.push(this.getTransform())\n    }\n\n    /**\n     * Sets current element to parent\n     */\n    public restore() {\n        this.endGroup()\n        this._applyStyleState(this._styleStack.pop()!)\n        this.setTransform(this._transformMatrixStack.pop()!)\n    }\n\n\n    /// PATH API\n\n    private _createPathElement(): SVGPathElement {\n        const path = this._createElement(\"path\", {}, true)\n        const parent = this._closestGroupOrSvg()\n        parent.appendChild(path)\n        return path\n    }\n\n    public beginPath() {\n        // https://html.spec.whatwg.org/multipage/scripting.html#current-default-path\n        this._currentPath = new Path2DSVG(this)\n    }\n\n    public closePath() {\n        this._currentPath.closePath()\n    }\n\n    public moveTo(x: number, y: number) {\n        this._currentPath.moveTo(x, y)\n    }\n\n    public lineTo(x: number, y: number) {\n        this._currentPath.lineTo(x, y)\n    }\n\n    public rect(x: number, y: number, width: number, height: number) {\n        this._currentPath.rect(x, y, width, height)\n    }\n\n    public bezierCurveTo(cp1x: number, cp1y: number, cp2x: number, cp2y: number, x: number, y: number) {\n        this._currentPath.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y)\n    }\n\n    public quadraticCurveTo(cpx: number, cpy: number, x: number, y: number) {\n        this._currentPath.quadraticCurveTo(cpx, cpy, x, y)\n    }\n\n    public arc(x: number, y: number, radius: number, startAngle: number, endAngle: number, counterClockwise: boolean = false) {\n        this._currentPath.arc(x, y, radius, startAngle, endAngle, counterClockwise)\n    }\n\n    public arcTo(x1: number, y1: number, x2: number, y2: number, radius: number) {\n        this._currentPath.arcTo(x1, y1, x2, y2, radius)\n    }\n\n    public ellipse(x: number, y: number, radiusX: number, radiusY: number, rotation: number, startAngle: number, endAngle: number, counterClockwise = false) {\n        this._currentPath.ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, counterClockwise)\n    }\n\n\n    /// STROKE/FILL\n\n    public stroke(path2d?: Path2D) {\n        this._strokeOrFill(\"stroke\", path2d)\n    }\n\n    public fill(path2d?: Path2D) {\n        this._strokeOrFill(\"fill\", path2d)\n    }\n\n    private _strokeOrFill(action: \"stroke\" | \"fill\", path2d?: Path2D) {\n        let path: Path2DSVG\n\n        if (path2d) {\n            if (!(path2d instanceof Path2DSVG)) {\n                throw new Error(\"Path2D is not a Path2DSVG\")\n            }\n            path = path2d\n        } else {\n            path = this._currentPath\n        }\n\n        const pathElement = this._createPathElement()\n        this._applyStyleToElement(pathElement, action)\n        pathElement.setAttribute(\"paint-order\", \"fill stroke markers\")\n        pathElement.setAttribute(\"d\", path.d)\n        // if (path2d) {\n        //     this._applyTransformation(pathElement)\n        // }\n    }\n\n    public fillRect(x: number, y: number, width: number, height: number) {\n        const { a, b, c, d, e, f } = this.getTransform()\n        if (a === 1 && b === 0 && c === 0 && d === 1 && e === 0 && f === 0) {\n            // clear entire canvas\n            if (x === 0 && y === 0 && width === this.width && height === this.height) {\n                this._clearCanvas()\n            }\n        }\n        const rect = this._createElement(\"rect\", {\n            x: x,\n            y: y,\n            width: width,\n            height: height,\n        }, true)\n        const parent = this._closestGroupOrSvg()\n        parent.appendChild(rect)\n        this._currentElement = rect\n        this._applyTransformation(rect)\n        this._applyStyleToElement(this._currentElement, \"fill\")\n    }\n\n    public strokeRect(x: number, y: number, width: number, height: number) {\n        const rect = this._createElement(\"rect\", {\n            x: x,\n            y: y,\n            width: width,\n            height: height,\n        }, true)\n        const parent = this._closestGroupOrSvg()\n        parent.appendChild(rect)\n        this._currentElement = rect\n        this._applyTransformation(rect)\n        this._applyStyleToElement(this._currentElement, \"stroke\")\n    }\n\n    /**\n     * Clear the entire canvas by replacing the root group\n     */\n    private _clearCanvas() {\n        const rootGroup = this._svg.children[1]\n        this._svg.removeChild(rootGroup)\n        this._currentElement = this._document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\")\n        this._svg.appendChild(this._currentElement)\n        // reset groupStack as all the child group nodes are all removed.\n        this._groupStack.length = 0\n    }\n\n    /**\n     * \"Clears\" a canvas by just drawing a white rectangle in the current group.\n     */\n    public clearRect(x: number, y: number, width: number, height: number) {\n        const { a, b, c, d, e, f } = this.getTransform()\n        if (a === 1 && b === 0 && c === 0 && d === 1 && e === 0 && f === 0 && x === 0 && y === 0 && width === this.width && height === this.height) {\n            this._clearCanvas()\n            return\n        }\n        const parent = this._closestGroupOrSvg()\n        const rect = this._createElement(\"rect\", {\n            x: x,\n            y: y,\n            width: width,\n            height: height,\n            fill: \"#FFFFFF\",\n        }, true)\n        this._applyTransformation(rect)\n        parent.appendChild(rect)\n    }\n\n    public setLineDash(dashArray?: number[]) {\n        if (dashArray && dashArray.length > 0) {\n            this.lineDash = dashArray.join(\",\")\n        } else {\n            this.lineDash = null\n        }\n    }\n\n    public getLineDash(): number[] {\n        if (this.lineDash === null) {\n            return []\n        }\n        return this.lineDash.split(\",\").map(s => parseFloat(s))\n    }\n\n    public clip(fillRule?: string) {\n        const group = this._closestGroupOrSvg()\n        const clipPath = this._createElement(\"clipPath\")\n        const id = randomString(this._ids)\n\n        const pathElement = this._createPathElement()\n        pathElement.setAttribute(\"d\", this._currentPath.d)\n        // this._applyTransformation(pathElement);\n\n        clipPath.setAttribute(\"id\", id)\n\n        if (fillRule !== undefined) {\n            clipPath.setAttribute(\"clip-rule\", fillRule)\n        }\n\n        clipPath.appendChild(pathElement)\n\n        this._defs.appendChild(clipPath)\n\n        // set the clip path to this group\n        group.setAttribute(\"clip-path\", `url(#${id})`)\n\n        this._currentElement = group\n    }\n\n    /**\n     * Draws a canvas, image or mock context to this canvas.\n     * http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage\n     */\n    public drawImage() {\n        // convert arguments to a real array\n        // eslint-disable-next-line prefer-rest-params\n        const args = Array.prototype.slice.call(arguments)\n        let image: any = args[0]\n        let dx: number, dy: number, dw: number, dh: number, sx = 0, sy = 0, sw: number, sh: number\n\n        if (args.length === 3) {\n            dx = args[1]\n            dy = args[2]\n            sw = image.width\n            sh = image.height\n            dw = sw\n            dh = sh\n        } else if (args.length === 5) {\n            dx = args[1]\n            dy = args[2]\n            dw = args[3]\n            dh = args[4]\n            sw = image.width\n            sh = image.height\n        } else if (args.length === 9) {\n            sx = args[1]\n            sy = args[2]\n            sw = args[3]\n            sh = args[4]\n            dx = args[5]\n            dy = args[6]\n            dw = args[7]\n            dh = args[8]\n        } else {\n            throw new Error(\"Invalid number of arguments passed to drawImage: \" + arguments.length)\n        }\n\n        const parent = this._closestGroupOrSvg()\n        const matrix = this.getTransform().translate(dx, dy)\n        if (image instanceof SVGRenderingContext) {\n            // canvas2svg mock canvas context. In the future we may want to clone nodes instead.\n            // also I'm currently ignoring dw, dh, sw, sh, sx, sy for a mock context.\n            const svg = image.getSvg().cloneNode(true) as SVGSVGElement\n            if (svg.childNodes.length > 1) {\n                const defs = svg.childNodes[0]\n                while (defs.childNodes.length) {\n                    const id = (defs.childNodes[0] as Element).getAttribute(\"id\")!\n                    this._ids[id] = id\n                    this._defs.appendChild(defs.childNodes[0])\n                }\n                const group = svg.children[1] as SVGElement\n                if (group !== undefined) {\n                    this._applyTransformation(group, matrix)\n                    parent.appendChild(group)\n                }\n            }\n        } else if (image.nodeName === \"CANVAS\" || image.nodeName === \"IMG\") {\n            // canvas or image\n            const svgImage = this._createElement(\"image\")\n            svgImage.setAttribute(\"width\", String(dw))\n            svgImage.setAttribute(\"height\", String(dh))\n            svgImage.setAttribute(\"preserveAspectRatio\", \"none\")\n\n            if (sx || sy || sw !== image.width || sh !== image.height) {\n                // crop the image using a temporary canvas\n                const canvas = this._document.createElement(\"canvas\")\n                canvas.width = dw\n                canvas.height = dh\n                const context = canvas.getContext(\"2d\")!\n                context.drawImage(image, sx, sy, sw, sh, 0, 0, dw, dh)\n                image = canvas\n            }\n            this._applyTransformation(svgImage, matrix)\n            svgImage.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"xlink:href\",\n                image.nodeName === \"CANVAS\" ? image.toDataURL() : image.getAttribute(\"src\"))\n            parent.appendChild(svgImage)\n        }\n    }\n\n\n    /// TEXT\n\n    /**\n     * Fills or strokes text\n     */\n    private _applyText(text: string, x: number, y: number, action: \"fill\" | \"stroke\") {\n        const el = document.createElement(\"span\")\n        el.setAttribute(\"style\", 'font:' + this.font)\n\n        const style = el.style\n        const parent = this._closestGroupOrSvg()\n        // eslint-disable-next-line no-restricted-syntax\n        const valign = getDominantBaseline(this.textBaseline)\n        const textElement = this._createElement(\"text\", {\n            \"font-family\": style.fontFamily,\n            \"font-size\": style.fontSize,\n            \"font-style\": style.fontStyle,\n            \"font-weight\": style.fontWeight,\n\n            // canvas doesn't support underline natively, but we do :)\n            \"text-decoration\": this.fontUnderline,\n            \"x\": x,\n            \"y\": y,\n            \"text-anchor\": getTextAnchor(this.textAlign),\n            \"dominant-baseline\": valign,\n        }, true)\n\n        textElement.appendChild(this._document.createTextNode(text))\n        this._currentElement = textElement\n        this._applyTransformation(textElement)\n        this._applyStyleToElement(this._currentElement, action)\n\n        if (this.fontHref !== undefined) {\n            const a = this._createElement(\"a\")\n            // canvas doesn't natively support linking, but we do :)\n            a.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"xlink:href\", this.fontHref)\n            a.appendChild(textElement)\n            parent.appendChild(a)\n        } else {\n            parent.appendChild(textElement)\n        }\n    }\n\n    public fillText(text: string, x: number, y: number) {\n        this._applyText(text, x, y, \"fill\")\n    }\n\n    public strokeText(text: string, x: number, y: number) {\n        this._applyText(text, x, y, \"stroke\")\n    }\n\n    public measureText(text: string): TextMetrics {\n        this._g.font = this.font\n        return this._g.measureText(text)\n    }\n\n\n    /// PATHS, GRADIENTS, PATTERNS\n\n    public createPath(arg?: string | Path2DSVG): Path2D {\n        // we still return Path2D even if we are using Path2DSVG\n        // for compatibility with other the std lib\n        return new Path2DSVG(this, arg) as unknown as Path2D\n    }\n\n    /**\n     * Adds a linear gradient to a defs tag.\n     * Returns a canvas gradient object that has a reference to it's parent def\n     */\n    public createLinearGradient(x1: number, y1: number, x2: number, y2: number) {\n        const grad = this._createElement(\"linearGradient\", {\n            id: randomString(this._ids),\n            x1: x1 + \"px\",\n            x2: x2 + \"px\",\n            y1: y1 + \"px\",\n            y2: y2 + \"px\",\n            \"gradientUnits\": \"userSpaceOnUse\",\n        }, false)\n        this._defs.appendChild(grad)\n        return new CanvasGradientSVG(grad, this)\n    }\n\n    /**\n     * Adds a radial gradient to a defs tag.\n     * Returns a canvas gradient object that has a reference to it's parent def\n     */\n    public createRadialGradient(x0: number, y0: number, r0: number, x1: number, y1: number, r1: number) {\n        const grad = this._createElement(\"radialGradient\", {\n            id: randomString(this._ids),\n            cx: x1 + \"px\",\n            cy: y1 + \"px\",\n            r: r1 + \"px\",\n            fx: x0 + \"px\",\n            fy: y0 + \"px\",\n            \"gradientUnits\": \"userSpaceOnUse\",\n        }, false)\n        this._defs.appendChild(grad)\n        return new CanvasGradientSVG(grad, this)\n\n    }\n\n    public createPattern(image: HTMLCanvasElement | HTMLImageElement | SVGRenderingContext, __repetition: unknown) {\n        const pattern = this._document.createElementNS(\"http://www.w3.org/2000/svg\", \"pattern\")\n        const id = randomString(this._ids)\n        pattern.setAttribute(\"id\", id)\n        pattern.setAttribute(\"width\", String(image.width))\n        pattern.setAttribute(\"height\", String(image.height))\n        // We want the pattern sizing to be absolute, and not relative\n        // https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Patterns\n        // https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/patternUnits\n        pattern.setAttribute(\"patternUnits\", \"userSpaceOnUse\")\n\n        if (\"nodeName\" in image && (image.nodeName === \"CANVAS\" || image.nodeName === \"IMG\")) {\n            const img = this._document.createElementNS(\"http://www.w3.org/2000/svg\", \"image\")\n            img.setAttribute(\"width\", String(image.width))\n            img.setAttribute(\"height\", String(image.height))\n            img.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"xlink:href\",\n                image.nodeName === \"CANVAS\" ? (image as HTMLCanvasElement).toDataURL() : image.getAttribute(\"src\")!)\n            pattern.appendChild(img)\n            this._defs.appendChild(pattern)\n        } else if (image instanceof SVGRenderingContext) {\n            pattern.appendChild(image._svg.children[1])\n            this._defs.appendChild(pattern)\n        }\n        return new CanvasPatternSVG(pattern, this)\n    }\n\n\n    /// TRANFORM\n\n    public setTransform(matrix: DOMMatrixReadOnly): void\n    public setTransform(a: number, b: number, c: number, d: number, e: number, f: number): void\n\n    public setTransform(am: DOMMatrixReadOnly | number, b?: number, c?: number, d?: number, e?: number, f?: number) {\n        if (b === undefined) {\n            const m = am as DOMMatrixReadOnly\n            this._transformMatrix = new DOMMatrix([m.a, m.b, m.c, m.d, m.e, m.f])\n        } else {\n            const a = am as number\n            this._transformMatrix = new DOMMatrix([a, b, c!, d!, e!, f!])\n        }\n    }\n\n    public getTransform() {\n        const { a, b, c, d, e, f } = this._transformMatrix\n        return new DOMMatrix([a, b, c, d, e, f])\n    }\n\n    public resetTransform() {\n        this.setTransform(1, 0, 0, 1, 0, 0)\n    }\n\n    public transform(a: number, b: number, c: number, d: number, e: number, f: number) {\n        const matrix = this.getTransform().multiply(new DOMMatrix([a, b, c, d, e, f]))\n        this.setTransform(matrix)\n    }\n\n    public scale(x: number, y: number) {\n        if (y === undefined) {\n            y = x\n        }\n        if (isNaN(x) || isNaN(y) || !isFinite(x) || !isFinite(y)) {\n            return\n        }\n        const matrix = this.getTransform().scale(x, y)\n        this.setTransform(matrix)\n    }\n\n    public rotate(angle: number) {\n        const matrix = this.getTransform().multiply(new DOMMatrix([\n            Math.cos(angle),\n            Math.sin(angle),\n            -Math.sin(angle),\n            Math.cos(angle),\n            0,\n            0,\n        ]))\n        this.setTransform(matrix)\n    }\n\n    public translate(x: number, y: number) {\n        const matrix = this.getTransform().translate(x, y)\n        this.setTransform(matrix)\n    }\n\n    public _matrixTransform(x: number, y: number): [number, number] {\n        const { a, b, c, d, e, f } = this._transformMatrix\n        const x1 = a * x + c * y + e\n        const y1 = b * x + d * y + f\n        return [x1, y1]\n    }\n\n    /**\n     * @returns The scale component of the transform matrix as {x,y}.\n     */\n    public _getTransformScale() {\n        return {\n            x: Math.hypot(this._transformMatrix.a, this._transformMatrix.b),\n            y: Math.hypot(this._transformMatrix.c, this._transformMatrix.d),\n        }\n    }\n\n    /**\n     * @returns The rotation component of the transform matrix in radians.\n     */\n    public _getTransformRotation() {\n        return Math.atan2(this._transformMatrix.b, this._transformMatrix.a)\n    }\n}\n\n\nclass Path2DSVG {\n\n    public readonly g: SVGRenderingContext\n    private _parts: string[]\n    private _hasMoved: boolean\n    private _posX: number | undefined = undefined\n    private _posY: number | undefined = undefined\n\n    public constructor(g: SVGRenderingContext, path?: string | Path2DSVG) {\n        this.g = g\n        if (path === undefined) {\n            this._parts = []\n            this._hasMoved = false\n        } else if (isString(path)) {\n            this._parts = [path]\n            this._hasMoved = path.indexOf(\"M\") >= 0\n        } else {\n            this._parts = [...path._parts]\n            this._hasMoved = this._parts.some(path => path.indexOf(\"M\") >= 0)\n        }\n    }\n\n    public get d() {\n        return this._parts.join(\" \")\n    }\n\n    public addPath(path: string, transform?: DOMMatrix2DInit) {\n        if (transform) {\n            console.error(\"transform argument to addPath is not supported\")\n        }\n        this._parts.push(path)\n        this._hasMoved ||= path.indexOf(\"M\") >= 0\n    }\n\n    public closePath() {\n        this.addPath(\"Z\")\n    }\n\n    public moveTo(x: number, y: number) {\n        // creates a new subpath with the given point\n        this._posX = x\n        this._posY = y\n        const [tx, ty] = this.g._matrixTransform(x, y)\n        this.addPath(`M ${tx} ${ty}`)\n    }\n\n    public lineTo(x: number, y: number) {\n        this._posX = x\n        this._posY = y\n        const cmd = this._hasMoved ? \"L\" : \"M\"\n        const [tx, ty] = this.g._matrixTransform(x, y)\n        this.addPath(`${cmd} ${tx} ${ty}`)\n    }\n\n    public bezierCurveTo(cp1x: number, cp1y: number, cp2x: number, cp2y: number, x: number, y: number) {\n        this._posX = x\n        this._posY = y\n        const g = this.g\n        const [tcp1x, tcp1y] = g._matrixTransform(cp1x, cp1y)\n        const [tcp2x, tcp2y] = g._matrixTransform(cp2x, cp2y)\n        const [tx, ty] = g._matrixTransform(x, y)\n        this.addPath(`C ${tcp1x} ${tcp1y} ${tcp2x} ${tcp2y} ${tx} ${ty}`)\n    }\n\n    public quadraticCurveTo(cpx: number, cpy: number, x: number, y: number) {\n        this._posX = x\n        this._posY = y\n        const g = this.g\n        const [tcpx, tcpy] = g._matrixTransform(cpx, cpy)\n        const [tx, ty] = g._matrixTransform(x, y)\n        this.addPath(`Q ${tcpx} ${tcpy} ${tx} ${ty}`)\n    }\n\n    public rect(x: number, y: number, width: number, height: number) {\n        this.moveTo(x, y)\n        this.lineTo(x + width, y)\n        this.lineTo(x + width, y + height)\n        this.lineTo(x, y + height)\n        this.closePath()\n    }\n\n    public arc(\n        x: number,\n        y: number,\n        radius: number,\n        startAngle: number,\n        endAngle: number,\n        counterClockwise = false\n    ) {\n        // in canvas no circle is drawn if no angle is provided.\n        if (startAngle === endAngle) {\n            return\n        }\n\n        const g = this.g\n        startAngle = startAngle % (2 * Math.PI)\n        endAngle = endAngle % (2 * Math.PI)\n        if (startAngle === endAngle) {\n            // circle time! subtract some of the angle so svg is happy (svg elliptical arc can't draw a full circle)\n            endAngle =\n                (endAngle + 2 * Math.PI - 0.001 * (counterClockwise ? -1 : 1)) %\n                (2 * Math.PI)\n        }\n        const endX = x + radius * Math.cos(endAngle)\n        const endY = y + radius * Math.sin(endAngle)\n        const startX = x + radius * Math.cos(startAngle)\n        const startY = y + radius * Math.sin(startAngle)\n        const sweepFlag = counterClockwise ? 0 : 1\n        let largeArcFlag = 0\n        let diff = endAngle - startAngle\n\n        // https://github.com/gliffy/canvas2svg/issues/4\n        if (diff < 0) {\n            diff += 2 * Math.PI\n        }\n\n        if (counterClockwise) {\n            largeArcFlag = diff > Math.PI ? 0 : 1\n        } else {\n            largeArcFlag = diff > Math.PI ? 1 : 0\n        }\n\n        const scaleX = Math.hypot(g._transformMatrix.a, g._transformMatrix.b)\n        const scaleY = Math.hypot(g._transformMatrix.c, g._transformMatrix.d)\n\n        this.lineTo(startX, startY)\n        const [endx, endy] = g._matrixTransform(endX, endY)\n        this.addPath(`A ${radius * scaleX} ${radius * scaleY} ${0} ${largeArcFlag} ${sweepFlag} ${endx} ${endy}`)\n\n        this._posX = x\n        this._posY = y\n    }\n\n    public arcTo(x1: number, y1: number, x2: number, y2: number, radius: number) {\n        // Based on Webkit implementation from\n        // https://github.com/WebKit/webkit/blob/main/Source/WebCore/platform/graphics/cairo/PathCairo.cpp\n        // See also http://www.w3.org/TR/2015/WD-2dcontext-20150514/#dom-context-2d-arcto\n\n        // Let the point (x0, y0) be the last point in the subpath.\n        const x0 = this._posX\n        const y0 = this._posY\n\n        // First ensure there is a subpath for (x1, y1).\n        if (x0 === undefined || y0 === undefined) {\n            return\n        }\n\n        // Negative values for radius must cause the implementation to throw an IndexSizeError exception.\n        if (radius < 0) {\n            throw new Error(\n                \"IndexSizeError: The radius provided (\" + radius + \") is negative.\"\n            )\n        }\n\n        // If the point (x0, y0) is equal to the point (x1, y1),\n        // or if the point (x1, y1) is equal to the point (x2, y2),\n        // or if the radius radius is zero,\n        // then the method must add the point (x1, y1) to the subpath,\n        // and connect that point to the previous point (x0, y0) by a straight line.\n        if ((x0 === x1 && y0 === y1) || (x1 === x2 && y1 === y2) || radius === 0) {\n            this.lineTo(x1, y1)\n            return\n        }\n\n        const p1p0 = [x0 - x1, y0 - y1]\n        const p1p2 = [x2 - x1, y2 - y1]\n        const p1p0_length = Math.hypot(p1p0[0], p1p0[1])\n        const p1p2_length = Math.hypot(p1p2[0], p1p2[1])\n        const cos_phi = (p1p0[0] * p1p2[0] + p1p0[1] * p1p2[1]) / (p1p0_length * p1p2_length)\n        // all points on a line logic\n        if (cos_phi === -1) {\n            this.lineTo(x1, y1)\n            return\n        }\n        if (cos_phi === 1) {\n            // add infinite far away point\n            const max_length = 65535\n            const factor_max = max_length / p1p0_length\n            const ep = [x0 + factor_max * p1p0[0], y0 + factor_max * p1p0[1]]\n            this.lineTo(ep[0], ep[1])\n            return\n        }\n\n        const tangent = radius / Math.tan(Math.acos(cos_phi) / 2)\n        const factor_p1p0 = tangent / p1p0_length\n        const t_p1p0 = [x1 + factor_p1p0 * p1p0[0], y1 + factor_p1p0 * p1p0[1]]\n\n        let orth_p1p0 = [p1p0[1], -p1p0[0]]\n        const orth_p1p0_length = Math.hypot(orth_p1p0[0], orth_p1p0[1])\n        const factor_ra = radius / orth_p1p0_length\n\n        // angle between orth_p1p0 and p1p2 to get the right vector orthographic to p1p0\n        const cos_alpha = (orth_p1p0[0] * p1p2[0] + orth_p1p0[1] * p1p2[1]) / (orth_p1p0_length * p1p2_length)\n        if (cos_alpha < 0) {\n            orth_p1p0 = [-orth_p1p0[0], -orth_p1p0[1]]\n        }\n\n        const p = [t_p1p0[0] + factor_ra * orth_p1p0[0], t_p1p0[1] + factor_ra * orth_p1p0[1]]\n\n        // calculate angles for addArc\n        orth_p1p0 = [-orth_p1p0[0], -orth_p1p0[1]]\n        let sa = Math.acos(orth_p1p0[0] / orth_p1p0_length)\n        if (orth_p1p0[1] < 0) {\n            sa = 2 * Math.PI - sa\n        }\n\n        // anticlockwise logic\n        let anticlockwise = false\n\n        const factor_p1p2 = tangent / p1p2_length\n        const t_p1p2 = [x1 + factor_p1p2 * p1p2[0], y1 + factor_p1p2 * p1p2[1]]\n        const orth_p1p2 = [t_p1p2[0] - p[0], t_p1p2[1] - p[1]]\n        const orth_p1p2_length = Math.hypot(orth_p1p2[0], orth_p1p2[1])\n        let ea = Math.acos(orth_p1p2[0] / orth_p1p2_length)\n        if (orth_p1p2[1] < 0) {\n            ea = 2 * Math.PI - ea\n        }\n        if (sa > ea && sa - ea < Math.PI) { anticlockwise = true }\n        if (sa < ea && ea - sa > Math.PI) { anticlockwise = true }\n\n        this.lineTo(t_p1p0[0], t_p1p0[1])\n        this.arc(p[0], p[1], radius, sa, ea, anticlockwise)\n    }\n\n    public ellipse(\n        x: number,\n        y: number,\n        radiusX: number,\n        radiusY: number,\n        rotation: number,\n        startAngle: number,\n        endAngle: number,\n        counterClockwise = false\n    ) {\n        if (startAngle === endAngle) {\n            return\n        }\n\n        const g = this.g;\n        [x, y] = g._matrixTransform(x, y)\n        const scale = g._getTransformScale()\n        radiusX = radiusX * scale.x\n        radiusY = radiusY * scale.y\n        rotation = rotation + g._getTransformRotation()\n\n        startAngle = startAngle % (2 * Math.PI)\n        endAngle = endAngle % (2 * Math.PI)\n        if (startAngle === endAngle) {\n            endAngle =\n                (endAngle + 2 * Math.PI - 0.001 * (counterClockwise ? -1 : 1)) %\n                (2 * Math.PI)\n        }\n        const endX = x +\n            Math.cos(-rotation) * radiusX * Math.cos(endAngle) +\n            Math.sin(-rotation) * radiusY * Math.sin(endAngle)\n        const endY = y -\n            Math.sin(-rotation) * radiusX * Math.cos(endAngle) +\n            Math.cos(-rotation) * radiusY * Math.sin(endAngle)\n        const startX = x +\n            Math.cos(-rotation) * radiusX * Math.cos(startAngle) +\n            Math.sin(-rotation) * radiusY * Math.sin(startAngle)\n        const startY = y -\n            Math.sin(-rotation) * radiusX * Math.cos(startAngle) +\n            Math.cos(-rotation) * radiusY * Math.sin(startAngle)\n        const sweepFlag = counterClockwise ? 0 : 1\n        let largeArcFlag = 0\n        let diff = endAngle - startAngle\n\n        if (diff < 0) {\n            diff += 2 * Math.PI\n        }\n\n        if (counterClockwise) {\n            largeArcFlag = diff > Math.PI ? 0 : 1\n        } else {\n            largeArcFlag = diff > Math.PI ? 1 : 0\n        }\n\n        // Transform is already applied, so temporarily remove since lineTo\n        // will apply it again.\n        const currentTransform = g._transformMatrix\n        g.resetTransform()\n        this.lineTo(startX, startY)\n        g._transformMatrix = currentTransform\n\n        this.addPath(`A ${radiusX} ${radiusY} ${rotation * (180 / Math.PI)} ${largeArcFlag} ${sweepFlag} ${endX} ${endY}`)\n        this._posX = endX\n        this._posY = endY\n    }\n}\n\n\nclass CanvasGradientSVG implements CanvasGradient {\n\n    public constructor(\n        public readonly gradientElem: SVGGradientElement,\n        private readonly _ctx: SVGRenderingContext,\n    ) { }\n\n    public addColorStop(offset: number, color: string) {\n        const stop = this._ctx._createElement(\"stop\")\n        stop.setAttribute(\"offset\", String(offset))\n        if (color.indexOf(\"rgba\") !== -1) {\n            // separate alpha value, since webkit can't handle it\n            const regex = /rgba\\(\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d?\\.?\\d*)\\s*\\)/gi\n            const matches = regex.exec(color)\n            if (matches) {\n                stop.setAttribute(\"stop-color\", `rgb(${matches[1]},${matches[2]},${matches[3]})`)\n                stop.setAttribute(\"stop-opacity\", matches[4])\n            } else {\n                stop.setAttribute(\"stop-color\", color)\n            }\n        } else {\n            stop.setAttribute(\"stop-color\", color)\n        }\n        this.gradientElem.appendChild(stop)\n    }\n}\n\n\nclass CanvasPatternSVG {\n    public constructor(\n        public readonly patternElem: SVGPatternElement,\n        public readonly _ctx: SVGRenderingContext,\n    ) { }\n}\n\n\n/// HELPER FUNCTIONS\n\nfunction randomString(holder?: Record<string, unknown>) {\n    if (!holder) {\n        throw new Error(\"cannot create a random attribute name for an undefined object\")\n    }\n    const chars = \"ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz\"\n    let randomstring = \"\"\n    do {\n        randomstring = \"\"\n        for (let i = 0; i < 12; i++) {\n            randomstring += chars[Math.floor(Math.random() * chars.length)]\n        }\n    } while (holder[randomstring] !== undefined)\n    return randomstring\n}\n\n// Some basic mappings for attributes and default values.\nconst STYLES = {\n    \"strokeStyle\": {\n        svgAttr: \"stroke\",\n        svg: \"none\",\n        apply: \"stroke\",\n    },\n    \"fillStyle\": {\n        svgAttr: \"fill\",\n        svg: null, // svg default is black, but we need to special case this to handle canvas stroke without fill\n        apply: \"fill\",\n    },\n    \"lineCap\": {\n        svgAttr: \"stroke-linecap\",\n        svg: \"butt\",\n        apply: \"stroke\",\n    },\n    \"lineJoin\": {\n        svgAttr: \"stroke-linejoin\",\n        svg: \"miter\",\n        apply: \"stroke\",\n    },\n    \"miterLimit\": {\n        svgAttr: \"stroke-miterlimit\",\n        svg: 4,\n        apply: \"stroke\",\n    },\n    \"lineWidth\": {\n        svgAttr: \"stroke-width\",\n        svg: 1,\n        apply: \"stroke\",\n    },\n    \"globalAlpha\": {\n        svgAttr: \"opacity\",\n        svg: 1,\n        apply: \"fill stroke\",\n    },\n    \"lineDash\": {\n        svgAttr: \"stroke-dasharray\",\n        svg: null,\n        apply: \"stroke\",\n    },\n} satisfies Record<string, {\n    svgAttr?: string, // corresponding svg attribute\n    svg?: string | number | null,       // svg default\n    apply?: string,    // apply on stroke() or fill()\n}>\n\n\nconst _textAnchorMapping: Record<string, string> = {\n    left: \"start\",\n    right: \"end\",\n    center: \"middle\",\n    start: \"start\",\n    end: \"end\",\n}\nfunction getTextAnchor(textAlign: string) {\n    return _textAnchorMapping[textAlign] ?? _textAnchorMapping.start\n}\n\nconst _dominantBaselineMapping: Record<string, string> = {\n    alphabetic: \"alphabetic\",\n    hanging: \"hanging\",\n    top: \"text-before-edge\",\n    bottom: \"text-after-edge\",\n    middle: \"central\", // neither central nor middle are correct work in Illustrator\n}\nfunction getDominantBaseline(textBaseline: string) {\n    // eslint-disable-next-line no-restricted-syntax\n    return _dominantBaselineMapping[textBaseline] ?? _dominantBaselineMapping.alphabetic\n}\n\n\nfunction createNamedToNumberedLookup(itemsStr: string, radix?: number) {\n    const lookup: Record<string, string> = {}\n    const items = itemsStr.split(',')\n    radix = radix ?? 10\n    // Map from named to numbered entities.\n    for (let i = 0; i < items.length; i += 2) {\n        const entity = '&' + items[i + 1] + ';'\n        const base10 = parseInt(items[i], radix)\n        lookup[entity] = '&#' + base10 + ';'\n    }\n    // FF and IE need to create a regex from hex values ie &nbsp; == \\xa0\n    lookup[\"\\\\xa0\"] = '&#160;'\n    return lookup\n}\n\n// Unpack entities lookup where the numbers are in radix 32 to reduce the size\n// entity mapping courtesy of tinymce\nconst namedEntities = createNamedToNumberedLookup(\n    '50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,' +\n    '5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,' +\n    '5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,' +\n    '5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,' +\n    '68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,' +\n    '6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,' +\n    '6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,' +\n    '75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,' +\n    '7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,' +\n    '7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,' +\n    'sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,' +\n    'st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,' +\n    't9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,' +\n    'tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,' +\n    'u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,' +\n    '81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,' +\n    '8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,' +\n    '8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,' +\n    '8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,' +\n    '8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,' +\n    'nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,' +\n    'rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,' +\n    'Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,' +\n    '80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,' +\n    '811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro', 32)\n", "import * as t from \"io-ts\"\nimport { COLOR_BACKGROUND, COLOR_COMPONENT_BORDER, GRID_STEP, INPUT_OUTPUT_DIAMETER, circle, colorForLogicValue, distSquared, drawComponentName, drawValueText, drawValueTextCentered, drawWireLineToComponent, isTrivialNodeName, triangle, useCompact } from \"../drawutils\"\nimport { mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, ComponentTypeOutput, LogicValue, Mode, Unknown, reprForLogicValues, toLogicValueRepr, typeOrUndefined } from \"../utils\"\nimport { Component, ComponentName, ComponentNameRepr, ParametrizedComponentBase, Repr, ResolvedParams, defineParametrizedComponent, groupVertical } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems, Orientation } from \"./Drawable\"\nimport { InputDef } from \"./Input\"\nimport { Node, NodeIn, NodeOut } from \"./Node\"\n\n\nexport const OutputDef =\n    defineParametrizedComponent(ComponentTypeOutput, true, false, {\n        variantName: ({ bits }) => `out-${bits}`,\n        idPrefix: \"out\",\n        button: { imgWidth: 32 },\n        repr: {\n            bits: typeOrUndefined(t.number),\n            name: ComponentNameRepr,\n        },\n        valueDefaults: {},\n        params: InputDef.paramDefs,\n        validateParams: ({ bits }) => ({\n            numBits: bits,\n        }),\n        size: ({ numBits }) => {\n            if (numBits === 1) {\n                const d = INPUT_OUTPUT_DIAMETER / GRID_STEP\n                return { gridWidth: d, gridHeight: d }\n            }\n            return {\n                gridWidth: 2,\n                gridHeight: useCompact(numBits) ? numBits : 2 * numBits,\n            }\n        },\n        makeNodes: ({ numBits }) => ({\n            ins: {\n                In: groupVertical(\"w\", numBits === 1 ? -3 : -2, 0, numBits, undefined, { hasTriangle: numBits !== 1 }),\n            },\n        }),\n        initialValue: (saved, { numBits }) => ArrayFillWith<LogicValue>(false, numBits),\n    })\n\nexport type OutputRepr = Repr<typeof OutputDef>\nexport type OutputParams = ResolvedParams<typeof OutputDef>\n\n\nexport class Output extends ParametrizedComponentBase<OutputRepr> {\n\n    public readonly numBits: number\n    private _name: ComponentName\n\n    public constructor(parent: DrawableParent, params: OutputParams, saved?: OutputRepr) {\n        super(parent, OutputDef.with(params), saved)\n\n        this.numBits = params.numBits\n\n        this._name = saved?.name ?? undefined\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            bits: this.numBits === OutputDef.aults.bits ? undefined : this.numBits,\n            name: this._name,\n        }\n    }\n\n    public override isOver(x: number, y: number) {\n        if (this.numBits === 1) {\n            return this.parent.mode >= Mode.CONNECT && distSquared(x, y, this.posX, this.posY) < (INPUT_OUTPUT_DIAMETER / 2) ** 2\n        }\n        return super.isOver(x, y)\n    }\n\n    public get name() {\n        return this._name\n    }\n\n    public contentRepr<AllowUndefined extends boolean>(undefinedIfTrivial: AllowUndefined) {\n        return reprForLogicValues(this.value, undefinedIfTrivial)\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.Output.tooltip\n        return tooltipContent(undefined, mods(s.title.expand({ numBits: this.numBits })))\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        return this.inputValues(this.inputs.In)\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        if (this.numBits === 1) {\n            this.doDrawSingle(g, ctx, this.inputs.In[0])\n        } else {\n            this.doDrawMulti(g, ctx, this.inputs.In)\n        }\n    }\n\n    private doDrawSingle(g: GraphicsRendering, ctx: DrawContext, input: NodeIn) {\n        drawWireLineToComponent(g, input)\n\n        g.strokeStyle = ctx.borderColor\n        g.fillStyle = ctx.borderColor\n        g.beginPath()\n        triangle(g,\n            this.posX - INPUT_OUTPUT_DIAMETER / 2 - 5, this.posY - 5,\n            this.posX - INPUT_OUTPUT_DIAMETER / 2 - 5, this.posY + 5,\n            this.posX - INPUT_OUTPUT_DIAMETER / 2 - 1, this.posY,\n        )\n        g.lineWidth = 2\n        g.fill()\n        g.stroke()\n\n        const valueToShow = this.parent.editor.options.hideOutputColors ? Unknown : input.value\n        g.fillStyle = colorForLogicValue(valueToShow)\n        g.lineWidth = 4\n        g.beginPath()\n        circle(g, this.posX, this.posY, INPUT_OUTPUT_DIAMETER)\n        g.fill()\n        g.stroke()\n\n        ctx.inNonTransformedFrame(ctx => {\n            if (this._name !== undefined) {\n                drawComponentName(g, ctx, this._name, toLogicValueRepr(valueToShow), this, true)\n            }\n            drawValueTextCentered(g, valueToShow, this)\n        })\n    }\n\n    private doDrawMulti(g: GraphicsRendering, ctx: DrawContext, inputs: NodeIn[]) {\n        const bounds = this.bounds()\n        const { left, top, width } = bounds\n        const outline = bounds.outline(g)\n\n        // background\n        g.fillStyle = COLOR_BACKGROUND\n        g.fill(outline)\n\n        // inputs\n        for (const input of inputs) {\n            drawWireLineToComponent(g, input)\n        }\n\n        const displayValues = this.parent.editor.options.hideOutputColors ? ArrayFillWith(Unknown, this.numBits) : this.value\n\n        // cells\n        const drawMouseOver = ctx.isMouseOver && this.parent.mode !== Mode.STATIC\n        g.strokeStyle = drawMouseOver ? ctx.borderColor : COLOR_COMPONENT_BORDER\n        g.lineWidth = 1\n        const cellHeight = useCompact(this.numBits) ? GRID_STEP : 2 * GRID_STEP\n        for (let i = 0; i < this.numBits; i++) {\n            const y = top + i * cellHeight\n            g.fillStyle = colorForLogicValue(displayValues[i])\n            g.beginPath()\n            g.rect(left, y, width, cellHeight)\n            g.fill()\n            g.stroke()\n        }\n\n        // outline\n        g.lineWidth = 3\n        g.stroke(outline)\n\n        // labels\n        ctx.inNonTransformedFrame(ctx => {\n            if (this._name !== undefined) {\n                const valueString = displayValues.map(toLogicValueRepr).reverse().join(\"\")\n                drawComponentName(g, ctx, this._name, valueString, this, true)\n            }\n\n            for (let i = 0; i < this.numBits; i++) {\n                const y = top + cellHeight / 2 + i * cellHeight\n                drawValueText(g, displayValues[i], ...ctx.rotatePoint(this.posX, y), { small: useCompact(this.numBits) })\n            }\n        })\n    }\n\n    protected override autoConnected(newLinks: [Node, Component, Node][]) {\n        if (newLinks.length !== 1) {\n            return\n        }\n\n        const [inNode, comp, outNode] = newLinks[0]\n        if (outNode instanceof NodeOut) {\n            let group\n            if ((group = outNode.group) !== undefined && group.nodes.length === 1 && !isTrivialNodeName(group.name)) {\n                this.doSetName(group.name)\n            } else if (this._name === undefined && !isTrivialNodeName(outNode.shortName)) {\n                this.doSetName(outNode.shortName)\n            }\n        }\n\n        if (inNode.orient !== \"w\") {\n            // should never happen, all our inputs are west\n            return\n        }\n\n        switch (Orientation.add(comp.orient, outNode.orient)) {\n            case \"e\":\n                // nothing to do\n                return\n            case \"w\":\n                this.doSetOrient(\"w\")\n                this.setPosition(this.posX - GRID_STEP * 6, this.posY, false)\n                return\n            case \"s\":\n                this.doSetOrient(\"s\")\n                this.setPosition(this.posX - GRID_STEP * 3, this.posY + GRID_STEP * 3, false)\n                return\n            case \"n\":\n                this.doSetOrient(\"n\")\n                this.setPosition(this.posX - GRID_STEP * 3, this.posY - GRID_STEP * 3, false)\n                return\n        }\n    }\n\n    public doSetName(name: ComponentName) {\n        this._name = name\n        this.requestRedraw({ why: \"name changed\" })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n\n        return [\n            [\"mid\", this.makeSetNameContextMenuItem(this._name, this.doSetName.bind(this))],\n            [\"mid\", MenuData.sep()],\n            this.makeChangeParamsContextMenuItem(\"inputs\", S.Components.Generic.contextMenu.ParamNumBits, this.numBits, \"bits\"),\n        ]\n    }\n\n    public override keyDown(e: KeyboardEvent): void {\n        if (e.key === \"Enter\" && !e.altKey) {\n            this.runSetNameDialog(this._name, this.doSetName.bind(this))\n        } else {\n            super.keyDown(e)\n        }\n    }\n}\nOutputDef.impl = Output\n", "import * as t from \"io-ts\"\nimport { COLOR_COMPONENT_BORDER, TextVAlign, displayValuesFromArray, fillTextVAlign } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, LogicValue, Unknown, isUnknown, typeOrUndefined } from \"../utils\"\nimport { ParametrizedComponentBase, Repr, ResolvedParams, defineParametrizedComponent, groupVertical, param } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems } from \"./Drawable\"\n\n\nexport const DecoderDef =\n    defineParametrizedComponent(\"dec\", true, true, {\n        variantName: ({ bits }) => `dec-${bits}`,\n        idPrefix: \"dec\",\n        button: { imgWidth: 50 },\n        repr: {\n            bits: typeOrUndefined(t.number),\n        },\n        valueDefaults: {},\n        params: {\n            bits: param(2, [2, 3, 4, 5]),\n        },\n        validateParams: ({ bits }) => ({\n            numFrom: bits,\n            numTo: 2 ** bits,\n        }),\n        size: ({ numTo }) => ({\n            gridWidth: 4,\n            gridHeight: Math.max(8, 1 + numTo),\n        }),\n        makeNodes: ({ numFrom, numTo }) => ({\n            ins: {\n                In: groupVertical(\"w\", -3, 0, numFrom),\n            },\n            outs: {\n                Out: groupVertical(\"e\", 3, 0, numTo),\n            },\n        }),\n        initialValue: (saved, { numTo }) => ArrayFillWith<LogicValue>(false, numTo),\n    })\n\nexport type DecoderRepr = Repr<typeof DecoderDef>\nexport type DecoderParams = ResolvedParams<typeof DecoderDef>\n\nexport class Decoder extends ParametrizedComponentBase<DecoderRepr> {\n\n    public readonly numFrom: number\n    public readonly numTo: number\n\n    public constructor(parent: DrawableParent, params: DecoderParams, saved?: DecoderRepr) {\n        super(parent, DecoderDef.with(params), saved)\n        this.numFrom = params.numFrom\n        this.numTo = params.numTo\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            bits: this.numFrom === DecoderDef.aults.bits ? undefined : this.numFrom,\n        }\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.Decoder.tooltip\n        return tooltipContent(s.title, mods(\n            div(s.desc.expand({ numFrom: this.numFrom, numTo: this.numTo, n: this.currentAddr() }))\n        ))\n    }\n\n    public currentAddr() {\n        const addrArr = this.inputValues(this.inputs.In)\n        return displayValuesFromArray(addrArr, false)[1]\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        const addr = this.currentAddr()\n        if (isUnknown(addr)) {\n            return ArrayFillWith<LogicValue>(Unknown, this.numTo)\n        }\n\n        const output = ArrayFillWith<LogicValue>(false, this.numTo)\n        output[addr] = true\n        return output\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, {\n            skipLabels: true,\n            drawLabels: () => {\n                g.font = `bold 14px sans-serif`\n                g.fillStyle = COLOR_COMPONENT_BORDER\n                g.textAlign = \"center\"\n                fillTextVAlign(g, TextVAlign.middle, \"Dec.\", this.posX, this.posY)\n            },\n        })\n    }\n\n    protected override propagateValue(newValue: LogicValue[]) {\n        this.outputValues(this.outputs.Out, newValue)\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.Generic.contextMenu\n        return [\n            this.makeChangeParamsContextMenuItem(\"outputs\", s.ParamNumBits, this.numFrom, \"bits\"),\n            [\"mid\", MenuData.sep()],\n            ...this.makeForceOutputsContextMenuItem(),\n        ]\n    }\n\n}\nDecoderDef.impl = Decoder\n", "import { COLOR_COMPONENT_INNER_LABELS, displayValuesFromArray, drawLabel } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { FixedArray, FixedArrayFillWith, LogicValue, Unknown, isUnknown } from \"../utils\"\nimport { ComponentBase, Repr, defineComponent, group } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuItems } from \"./Drawable\"\n\nexport const Decoder16SegDef =\n    defineComponent(\"dec-16seg\", {\n        idPrefix: \"dec\",\n        button: { imgWidth: 50 },\n        valueDefaults: {},\n        size: { gridWidth: 4, gridHeight: 10 },\n        makeNodes: () => ({\n            ins: {\n                In: group(\"w\", [\n                    [-3, -3],\n                    [-3, -2],\n                    [-3, -1],\n                    [-3, 0],\n                    [-3, +1],\n                    [-3, +2],\n                    [-3, +3],\n                ]),\n            },\n            outs: {\n                Out: group(\"e\", [\n                    [+4, -4, \"a1\"],\n                    [+3, -3.5, \"a2\"],\n                    [+4, -3, \"b\"],\n                    [+3, -2.5, \"c\"],\n                    [+4, -2, \"d2\"],\n                    [+3, -1.5, \"d1\"],\n                    [+4, -1, \"e\"],\n                    [+3, -0.5, \"f\"],\n                    [+4, 0, \"g1\"],\n                    [+3, 0.5, \"g2\"],\n                    [+4, +1, \"h\"],\n                    [+3, +1.5, \"i\"],\n                    [+4, +2, \"j\"],\n                    [+3, +2.5, \"k\"],\n                    [+4, +3, \"l\"],\n                    [+3, +3.5, \"m\"],\n                    [+4, +4, \"p\"],\n                ]),\n            },\n        }),\n        initialValue: () => FixedArrayFillWith(false as LogicValue, 17),\n    })\n\n\ntype Decoder16SegRepr = Repr<typeof Decoder16SegDef>\n\nexport class Decoder16Seg extends ComponentBase<Decoder16SegRepr> {\n\n    public constructor(parent: DrawableParent, saved?: Decoder16SegRepr) {\n        super(parent, Decoder16SegDef, saved)\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    public override makeTooltip() {\n        return tooltipContent(undefined, mods(\n            div(S.Components.Decoder16Seg.tooltip) // TODO better tooltip\n        ))\n    }\n\n    protected doRecalcValue(): FixedArray<LogicValue, 17> {\n        const input = this.inputValues(this.inputs.In)\n        const [__, value] = displayValuesFromArray(input, false)\n\n        let output: FixedArray<LogicValue, 17>\n        if (isUnknown(value)) {\n            output = FixedArrayFillWith(Unknown, 17)\n        } else if (value < 32) {\n            // control chars\n            output = FixedArrayFillWith(false, 17)\n        } else {\n            const line = DECODER_MAPPING[value - 32]\n            output = FixedArrayFillWith(false, 17)\n            for (let i = 0; i < line.length; i++) {\n                output[i] = line.charAt(i) === \"1\"\n            }\n        }\n\n        return output\n    }\n\n    protected override propagateValue(newValue: LogicValue[]) {\n        this.outputValues(this.outputs.Out, newValue)\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, {\n            skipLabels: true,\n            drawInside: bounds => {\n                this.drawGroupBox(g, this.inputs.In.group, bounds)\n            },\n            drawLabels: (ctx, { left, right }) => {\n                g.fillStyle = COLOR_COMPONENT_INNER_LABELS\n                g.font = \"bold 11px sans-serif\"\n\n                drawLabel(ctx, this.orient, \"C\", \"w\", left, this.inputs.In)\n\n                g.font = \"7px sans-serif\"\n                this.outputs._all.forEach(output => {\n                    drawLabel(ctx, this.orient, output.shortName, \"e\", right, output)\n                })\n            },\n        })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        return this.makeForceOutputsContextMenuItem()\n    }\n\n}\nDecoder16SegDef.impl = Decoder16Seg\n\n\n// Taken and modified from https://github.com/dmadison/LED-Segment-ASCII\nconst DECODER_MAPPING = [ // starts at space, which is 32\n    \"00000000000000000\", /* (space) */\n    \"00110000000000001\", /* ! */\n    \"00100000000100000\", /* \" */\n    \"00111100110100100\", /* # */\n    \"11011101110100100\", /* $ */\n    \"10011001110111100\", /* % */\n    \"10001110101100010\", /* & */\n    \"00000000000100000\", /* ' */\n    \"00000000000010010\", /* ( */\n    \"00000000001001000\", /* ) */\n    \"00000000111111110\", /* * */\n    \"00000000110100100\", /* + */\n    \"00000000000001000\", /* , */\n    \"00000000110000000\", /* - */\n    \"00000000000000001\", /* . */\n    \"00000000000011000\", /* / */\n    \"11111111000011000\", /* 0 */\n    \"00110000000010000\", /* 1 */\n    \"11101110110000000\", /* 2 */\n    \"11111100010000000\", /* 3 */\n    \"00110001110000000\", /* 4 */\n    \"11001101100000010\", /* 5 */\n    \"11011111110000000\", /* 6 */\n    \"11110000000000000\", /* 7 */\n    \"11111111110000000\", /* 8 */\n    \"11111101110000000\", /* 9 */\n    \"00000000000100100\", /* : */\n    \"00000000000101000\", /* ; */\n    \"00000000100010010\", /* < */\n    \"00001100110000000\", /* = */\n    \"00000000011001000\", /* > */\n    \"11100000010000101\", /* ? */\n    \"11101111010100000\", /* @ */\n    \"11110011110000000\", /* A */\n    \"11111100010100100\", /* B */\n    \"11001111000000000\", /* C */\n    \"11111100000100100\", /* D */\n    \"11001111100000000\", /* E */\n    \"11000011100000000\", /* F */\n    \"11011111010000000\", /* G */\n    \"00110011110000000\", /* H */\n    \"11001100000100100\", /* I */\n    \"00111110000000000\", /* J */\n    \"00000011100010010\", /* K */\n    \"00001111000000000\", /* L */\n    \"00110011001010000\", /* M */\n    \"00110011001000010\", /* N */\n    \"11111111000000000\", /* O */\n    \"11100011110000000\", /* P */\n    \"11111111000000010\", /* Q */\n    \"11100011110000010\", /* R */\n    \"11011101110000000\", /* S */\n    \"11000000000100100\", /* T */\n    \"00111111000000000\", /* U */\n    \"00000011000011000\", /* V */\n    \"00110011000001010\", /* W */\n    \"00000000001011010\", /* X */\n    \"00111101110000000\", /* Y */\n    \"11001100000011000\", /* Z */\n    \"01001000000100100\", /* [ */\n    \"00000000001000010\", /* \\ */\n    \"10000100000100100\", /* ] */\n    \"00000000000001010\", /* ^ */\n    \"00001100000000000\", /* _ */\n    \"00000000001000000\", /* ` */\n    \"00001110100000100\", /* a */\n    \"00000111100000100\", /* b */\n    \"00000110100000000\", /* c */\n    \"00000110100100100\", /* d */\n    \"00000110100001000\", /* e */\n    \"10000011100000000\", /* f */\n    \"10000101100100100\", /* g */\n    \"00000011100000100\", /* h */\n    \"00000000000000100\", /* i */\n    \"00000100000100100\", /* j */\n    \"00000000000110110\", /* k */\n    \"00000000000100100\", /* l */\n    \"00010010110000100\", /* m */\n    \"00000010100000100\", /* n */\n    \"00000110100000100\", /* o */\n    \"10000011100100000\", /* p */\n    \"10000001100100100\", /* q */\n    \"00000010100000000\", /* r */\n    \"10000101100000100\", /* s */\n    \"00000111100000000\", /* t */\n    \"00000110000000100\", /* u */\n    \"00000010000001000\", /* v */\n    \"00010010000001010\", /* w */\n    \"00000000001011010\", /* x */\n    \"00000101100100100\", /* y */\n    \"00000100100001000\", /* z */\n    \"01001000100100100\", /* { */\n    \"00000000000100100\", /* | */\n    \"10000100010100100\", /* } */\n    \"00000000110011000\", /* ~ */\n    \"00000000000000000\", /* (del) */\n]\n", "import { displayValuesFromArray } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { FixedArray, FixedArrayFillWith, LogicValue, Unknown, isUnknown } from \"../utils\"\nimport { ComponentBase, Repr, defineComponent, group } from \"./Component\"\nimport { DrawableParent, MenuItems } from \"./Drawable\"\n\nexport const Decoder7SegDef =\n    defineComponent(\"dec-7seg\", {\n        idPrefix: \"dec\",\n        button: { imgWidth: 50 },\n        valueDefaults: {},\n        size: { gridWidth: 4, gridHeight: 8 },\n        makeNodes: () => ({\n            ins: {\n                In: group(\"w\", [\n                    [-3, -3, \"A\"],\n                    [-3, -1, \"B\"],\n                    [-3, +1, \"C\"],\n                    [-3, +3, \"D\"],\n                ]),\n            },\n            outs: {\n                Out: group(\"e\", [\n                    [+3, -3, \"a\"],\n                    [+3, -2, \"b\"],\n                    [+3, -1, \"c\"],\n                    [+3, 0, \"d\"],\n                    [+3, +1, \"e\"],\n                    [+3, +2, \"f\"],\n                    [+3, +3, \"g\"],\n                ]),\n            },\n        }),\n        initialValue: () => FixedArrayFillWith(false as LogicValue, 7),\n    })\n\ntype Decoder7SegRepr = Repr<typeof Decoder7SegDef>\n\nexport class Decoder7Seg extends ComponentBase<Decoder7SegRepr> {\n\n    public constructor(parent: DrawableParent, saved?: Decoder7SegRepr) {\n        super(parent, Decoder7SegDef, saved)\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    public override makeTooltip() {\n        return tooltipContent(undefined, mods(\n            div(S.Components.Decoder7Seg.tooltip) // TODO better info\n        ))\n    }\n\n    protected doRecalcValue(): FixedArray<LogicValue, 7> {\n        const input = this.inputValues(this.inputs.In)\n        const [__, value] = displayValuesFromArray(input, false)\n\n        let output\n        if (isUnknown(value)) {\n            output = FixedArrayFillWith(Unknown, 7)\n        } else {\n            output = ((): FixedArray<LogicValue, 7> => {\n                switch (value) {\n                    case 0: return [true, true, true, true, true, true, false]\n                    case 1: return [false, true, true, false, false, false, false]\n                    case 2: return [true, true, false, true, true, false, true]\n                    case 3: return [true, true, true, true, false, false, true]\n                    case 4: return [false, true, true, false, false, true, true]\n                    case 5: return [true, false, true, true, false, true, true]\n                    case 6: return [true, false, true, true, true, true, true]\n                    case 7: return [true, true, true, false, false, false, false]\n                    case 8: return [true, true, true, true, true, true, true]\n                    case 9: return [true, true, true, true, false, true, true]\n                    case 10: return [true, true, true, false, true, true, true]\n                    case 11: return [false, false, true, true, true, true, true]\n                    case 12: return [true, false, false, true, true, true, false]\n                    case 13: return [false, true, true, true, true, false, true]\n                    case 14: return [true, false, false, true, true, true, true]\n                    case 15: return [true, false, false, false, true, true, true]\n                    default: return FixedArrayFillWith(Unknown, 7)\n                }\n            })()\n        }\n\n        return output\n    }\n\n    protected override propagateValue(newValue: FixedArray<LogicValue, 7>) {\n        this.outputValues(this.outputs.Out, newValue)\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        return this.makeForceOutputsContextMenuItem()\n    }\n\n}\nDecoder7SegDef.impl = Decoder7Seg\n", "import { displayValuesFromArray } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { FixedArray, FixedArrayFillWith, LogicValue, Unknown, isUnknown } from \"../utils\"\nimport { ComponentBase, Repr, defineComponent, group, groupVertical } from \"./Component\"\nimport { DrawableParent, MenuItems } from \"./Drawable\"\n\n\nexport const DecoderBCD4Def =\n    defineComponent(\"dec-bcd4\", {\n        idPrefix: \"bcd\",\n        button: { imgWidth: 50 },\n        valueDefaults: {},\n        size: { gridWidth: 5, gridHeight: 10 },\n        makeNodes: () => ({\n            ins: {\n                In: group(\"w\", [\n                    [-4, -3, \"A\"],\n                    [-4, -1, \"B\"],\n                    [-4, +1, \"C\"],\n                    [-4, +3, \"D\"],\n                ]),\n            },\n            outs: {\n                Out: groupVertical(\"e\", 4, 0, 5, 2),\n            },\n        }),\n        initialValue: () => FixedArrayFillWith(false as LogicValue, 5),\n    })\n\ntype DecoderBCD4Repr = Repr<typeof DecoderBCD4Def>\n\nexport class DecoderBCD4 extends ComponentBase<DecoderBCD4Repr> {\n\n    public constructor(parent: DrawableParent, saved?: DecoderBCD4Repr) {\n        super(parent, DecoderBCD4Def, saved)\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    public override makeTooltip() {\n        return tooltipContent(undefined, mods(\n            div(S.Components.DecoderBCD4.tooltip)\n        ))\n    }\n\n    protected doRecalcValue(): FixedArray<LogicValue, 5> {\n        const input = this.inputValues(this.inputs.In)\n        const [__, value] = displayValuesFromArray(input, false)\n\n        let output\n        if (isUnknown(value)) {\n            output = FixedArrayFillWith(Unknown, 5)\n        } else {\n            output = ((): FixedArray<LogicValue, 5> => {\n                switch (value) {\n                    case 0: return [false, false, false, false, false]\n                    case 1: return [false, false, false, false, true]\n                    case 2: return [false, false, false, true, false]\n                    case 3: return [false, false, false, true, true]\n                    case 4: return [false, false, true, false, false]\n                    case 5: return [false, false, true, false, true]\n                    case 6: return [false, false, true, true, false]\n                    case 7: return [false, false, true, true, true]\n                    case 8: return [false, true, false, false, false]\n                    case 9: return [false, true, false, false, true]\n                    case 10: return [true, false, false, false, false]\n                    case 11: return [true, false, false, false, true]\n                    case 12: return [true, false, false, true, false]\n                    case 13: return [true, false, false, true, true]\n                    case 14: return [true, false, true, false, false]\n                    case 15: return [true, false, true, false, true]\n                    default: return FixedArrayFillWith(Unknown, 5)\n                }\n            })()\n        }\n\n        return output\n    }\n\n    protected override propagateValue(newValue: LogicValue[]) {\n        this.outputValues(this.outputs.Out, newValue, true)\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        return this.makeForceOutputsContextMenuItem()\n    }\n\n}\nDecoderBCD4Def.impl = DecoderBCD4\n", "import * as t from \"io-ts\"\nimport { COLOR_BACKGROUND, displayValuesFromArray, drawWireLineToComponent, strokeWireOutlineAndSingleValue, useCompact } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { IconName } from \"../images\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, HighImpedance, LogicValue, Unknown, isUnknown, typeOrUndefined } from \"../utils\"\nimport { ParametrizedComponentBase, Repr, ResolvedParams, defineParametrizedComponent, groupHorizontal, groupVertical, groupVerticalMulti, param, paramBool } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems } from \"./Drawable\"\nimport { WireStyles } from \"./Wire\"\n\n\nexport const DemuxDef =\n    defineParametrizedComponent(\"demux\", true, true, {\n        variantName: ({ from, to, bottom }) => `demux-${from}to${to}${bottom ? \"b\" : \"\"}`,\n        idPrefix: \"demux\",\n        button: { imgWidth: 50 },\n        repr: {\n            from: typeOrUndefined(t.number),\n            to: typeOrUndefined(t.number),\n            bottom: typeOrUndefined(t.boolean),\n            showWiring: typeOrUndefined(t.boolean),\n            disconnectedAsHighZ: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {\n            showWiring: true,\n            disconnectedAsHighZ: false,\n        },\n        params: {\n            from: param(2, [1, 2, 4, 8, 16]),\n            to: param(4),\n            bottom: paramBool(),\n        },\n        validateParams: ({ from, to, bottom }) => {\n            // reference is 'from'; 'to' is clamped to be between 2*from and 16*from\n            const numTo = Math.min(16 * from, Math.max(2 * from, to))\n            const numGroups = Math.ceil(numTo / from)\n            const numSel = Math.ceil(Math.log2(numGroups))\n            return { numFrom: from, numTo, numGroups, numSel, controlPinsAtBottom: bottom }\n        },\n        size: ({ numFrom, numTo, numGroups, numSel }) => {\n            const gridWidth = 2 * numSel\n            const spacing = useCompact(numFrom === 1 ? numTo : numFrom) ? 1 : 2\n            const addByGroupSep = numFrom > 1 ? 1 : 0\n            const numLeftSlots = numTo + (numGroups - 1) * addByGroupSep\n            const gridHeight = spacing * numLeftSlots\n            return { gridWidth, gridHeight }\n        },\n        makeNodes: ({ numFrom, numGroups, numSel, controlPinsAtBottom }) => {\n            const outX = 1 + numSel\n            const inX = -outX\n\n            const groupOfOutputs = groupVerticalMulti(\"e\", outX, 0, numGroups, numFrom)\n            const firstInputY = groupOfOutputs[0][0][1]\n            const lastGroup = groupOfOutputs[groupOfOutputs.length - 1]\n            const lastInputY = lastGroup[lastGroup.length - 1][1]\n            const selY = controlPinsAtBottom ? lastInputY + 2 : firstInputY - 2\n\n            return {\n                ins: {\n                    In: groupVertical(\"w\", inX, 0, numFrom),\n                    S: groupHorizontal(controlPinsAtBottom ? \"s\" : \"n\", 0, selY, numSel, undefined, { leadLength: 35 }),\n                },\n                outs: {\n                    Z: groupOfOutputs,\n                },\n            }\n        },\n        initialValue: (saved, { numTo }) => ArrayFillWith<LogicValue>(false, numTo),\n    })\n\n\nexport type DemuxRepr = Repr<typeof DemuxDef>\nexport type DemuxParams = ResolvedParams<typeof DemuxDef>\n\nexport class Demux extends ParametrizedComponentBase<DemuxRepr> {\n\n    public readonly numFrom: number\n    public readonly numSel: number\n    public readonly numGroups: number\n    public readonly numTo: number\n    public readonly controlPinsAtBottom: boolean\n    private _showWiring: boolean\n    private _disconnectedAsHighZ: boolean\n\n    public constructor(parent: DrawableParent, params: DemuxParams, saved?: DemuxRepr) {\n        super(parent, DemuxDef.with(params), saved)\n\n        this.numFrom = params.numFrom\n        this.numTo = params.numTo\n        this.numGroups = params.numGroups\n        this.numSel = params.numSel\n        this.controlPinsAtBottom = params.controlPinsAtBottom\n\n        this._showWiring = saved?.showWiring ?? DemuxDef.aults.showWiring\n        this._disconnectedAsHighZ = saved?.disconnectedAsHighZ ?? DemuxDef.aults.disconnectedAsHighZ\n    }\n\n    public override toJSON() {\n        return {\n            ...super.toJSONBase(),\n            from: this.numFrom,\n            to: this.numTo,\n            bottom: this.controlPinsAtBottom === DemuxDef.aults.bottom ? undefined : this.controlPinsAtBottom,\n            showWiring: (this._showWiring !== DemuxDef.aults.showWiring) ? this._showWiring : undefined,\n            disconnectedAsHighZ: (this._disconnectedAsHighZ !== DemuxDef.aults.disconnectedAsHighZ) ? this._disconnectedAsHighZ : undefined,\n        }\n    }\n\n    public override makeTooltip() {\n        return tooltipContent(undefined, mods(\n            div(S.Components.Demux.tooltip.expand({ from: this.numFrom, to: this.numTo })) // TODO better tooltip\n        ))\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        const sels = this.inputValues(this.inputs.S)\n        const sel = displayValuesFromArray(sels, false)[1]\n\n        if (isUnknown(sel)) {\n            return ArrayFillWith(Unknown, this.numTo)\n        }\n\n        const values: Array<LogicValue> = []\n        const disconnected = this._disconnectedAsHighZ ? HighImpedance : false\n        for (let g = 0; g < this.numGroups; g++) {\n            if (g === sel) {\n                const inputs = this.inputValues(this.inputs.In)\n                for (const input of inputs) {\n                    values.push(input)\n                }\n            } else {\n                for (let i = 0; i < this.numFrom; i++) {\n                    values.push(disconnected)\n                }\n            }\n        }\n\n        return values\n    }\n\n    protected override propagateValue(newValues: LogicValue[]) {\n        this.outputValues(this.outputs._all, newValues)\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        const { top, left, bottom, right } = this.bounds()\n        const dy = (right - left) / 3\n\n        // inputs\n        for (const input of this.inputs.In) {\n            drawWireLineToComponent(g, input)\n        }\n\n        // selectors\n        for (const sel of this.inputs.S) {\n            drawWireLineToComponent(g, sel)\n        }\n\n\n        // outputs\n        for (const outputGroup of this.outputs.Z) {\n            for (const output of outputGroup) {\n                drawWireLineToComponent(g, output)\n            }\n        }\n\n        // background\n        const outline = g.createPath()\n        outline.moveTo(left, top + dy)\n        outline.lineTo(right, top)\n        outline.lineTo(right, bottom)\n        outline.lineTo(left, bottom - dy)\n        outline.closePath()\n        g.fillStyle = COLOR_BACKGROUND\n        g.fill(outline)\n\n        // wiring\n        if (this._showWiring) {\n            const neutral = this.parent.editor.options.hideWireColors\n            const sels = this.inputValues(this.inputs.S)\n            const sel = displayValuesFromArray(sels, false)[1]\n            if (!isUnknown(sel)) {\n                const selectedOutputs = this.outputs.Z[sel]\n                const anchorDiffX = (right - left) / 3\n                const wireStyle = this.parent.editor.options.wireStyle\n                const wireStyleBezier = wireStyle === WireStyles.bezier || wireStyle === WireStyles.auto\n                const timeFraction = ctx.drawParams.drawTimeAnimationFraction\n\n                for (let i = 0; i < this.inputs.In.length; i++) {\n                    g.beginPath()\n                    const fromNode = this.inputs.In[i]\n                    const fromY = fromNode.posYInParentTransform\n                    const toY = selectedOutputs[i].posYInParentTransform\n                    g.moveTo(left + 1, fromY)\n                    if (!wireStyleBezier) {\n                        g.lineTo(left + 3, fromY)\n                        g.lineTo(right - 3, toY)\n                        g.lineTo(right - 1, toY)\n                    } else {\n                        g.bezierCurveTo(\n                            left + anchorDiffX, fromY, // anchor left\n                            right - anchorDiffX, toY, // anchor right\n                            right - 1, toY,\n                        )\n                    }\n                    strokeWireOutlineAndSingleValue(g, this.inputs.In[i].value, fromNode.color, neutral, timeFraction)\n                }\n            }\n        }\n\n        // outline\n        g.lineWidth = 3\n        g.strokeStyle = ctx.borderColor\n        g.stroke(outline)\n\n    }\n\n    private doSetShowWiring(showWiring: boolean) {\n        this._showWiring = showWiring\n        this.requestRedraw({ why: \"show wiring changed\" })\n    }\n\n    private doSetDisconnectedAsHighZ(disconnectedAsHighZ: boolean) {\n        this._disconnectedAsHighZ = disconnectedAsHighZ\n        this.setNeedsRecalc()\n    }\n\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n\n        const s = S.Components.MuxDemux.contextMenu\n        let icon: IconName = this._showWiring ? \"check\" : \"none\"\n        const toggleShowWiringItem = MenuData.item(icon, s.ShowWiring, () => {\n            this.doSetShowWiring(!this._showWiring)\n        })\n\n        icon = this._disconnectedAsHighZ ? \"check\" : \"none\"\n        const toggleUseHighZItem = MenuData.item(icon, s.UseZForDisconnected, () => {\n            this.doSetDisconnectedAsHighZ(!this._disconnectedAsHighZ)\n        })\n\n        return [\n            this.makeChangeParamsContextMenuItem(\"inputs\", s.ParamNumFrom, this.numFrom, \"from\"),\n            this.makeChangeParamsContextMenuItem(\"outputs\", s.ParamNumTo, this.numTo, \"to\", [2, 4, 8, 16].map(x => x * this.numFrom)),\n            [\"mid\", MenuData.sep()],\n            this.makeChangeBooleanParamsContextMenuItem(this.numSel === 1 ? S.Components.Generic.contextMenu.ParamControlBitAtBottom : S.Components.Generic.contextMenu.ParamControlBitsAtBottom, this.controlPinsAtBottom, \"bottom\"),\n            [\"mid\", toggleShowWiringItem],\n            [\"mid\", toggleUseHighZItem],\n            ...this.makeForceOutputsContextMenuItem(true),\n        ]\n    }\n\n}\nDemuxDef.impl = Demux\n", "import * as t from \"io-ts\"\nimport { COLOR_UNKNOWN, ColorString, TextVAlign, colorCompsRGB, colorForFraction, displayValuesFromArray, fillTextVAlign, formatWithRadix, useCompact } from \"../drawutils\"\nimport { b, div, emptyMod, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { InteractionResult, Mode, Unknown, isUnknown, typeOrUndefined } from \"../utils\"\nimport { ComponentName, ComponentNameRepr, ParametrizedComponentBase, Repr, ResolvedParams, defineParametrizedComponent, groupVertical, param } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems, Orientation } from \"./Drawable\"\n\nexport const DisplayDef =\n    defineParametrizedComponent(\"display\", true, false, {\n        variantName: ({ bits }) => `display-${bits}`,\n        idPrefix: \"disp\",\n        button: { imgWidth: 32 },\n        repr: {\n            bits: typeOrUndefined(t.number),\n            name: ComponentNameRepr,\n            radix: typeOrUndefined(t.number),\n            showAsUnknown: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {\n            radix: 10,\n            showAsUnknown: false,\n        },\n        params: {\n            bits: param(4, [3, 4, 8, 16]),\n        },\n        validateParams: ({ bits }) => ({\n            numBits: bits,\n        }),\n        size: ({ numBits }) => ({\n            gridWidth: 2 + Math.ceil(numBits / 2),\n            gridHeight: useCompact(numBits) ? numBits : 2 * numBits,\n        }),\n        makeNodes: ({ numBits, gridWidth }) => {\n            const inX = -gridWidth / 2 - 1\n            return {\n                ins: {\n                    In: groupVertical(\"w\", inX, 0, numBits),\n                },\n            }\n        },\n        initialValue: (saved, { numBits }): [string, number | Unknown] =>\n            [repeatString(\"0\", numBits), 0],\n    })\n\n\nexport type DisplayRepr = Repr<typeof DisplayDef>\nexport type DisplayParams = ResolvedParams<typeof DisplayDef>\n\n\nexport class Display extends ParametrizedComponentBase<DisplayRepr> {\n\n    public readonly numBits: number\n    private _name: ComponentName\n    private _radix: number\n    private _showAsUnknown: boolean\n\n    public constructor(parent: DrawableParent, params: DisplayParams, saved?: DisplayRepr) {\n        super(parent, DisplayDef.with(params), saved)\n\n        this.numBits = params.numBits\n\n        this._name = saved?.name ?? undefined\n        this._radix = saved?.radix ?? DisplayDef.aults.radix\n        this._showAsUnknown = saved?.showAsUnknown ?? DisplayDef.aults.showAsUnknown\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            bits: this.numBits === DisplayDef.aults.bits ? undefined : this.numBits,\n            name: this._name,\n            radix: this._radix === DisplayDef.aults.radix ? undefined : this._radix,\n            showAsUnknown: this._showAsUnknown === DisplayDef.aults.showAsUnknown ? undefined : this._showAsUnknown,\n        }\n    }\n\n    private get showAsUnknown() {\n        return this._showAsUnknown || this.parent.editor.options.hideOutputColors\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.Display.tooltip\n        const radixStr = (() => {\n            switch (this._radix) {\n                case 2: return s.RadixBinary\n                case 10: return s.RadixDecimal\n                case -10: return s.RadixSignedDecimal\n                case 16: return s.RadixHexadecimal\n                default: return s.RadixGeneric.expand({ radix: this._radix })\n            }\n        })()\n        const [binaryStringRep, value] = this.value\n\n        const sParams = { numBits: this.numBits, radixStr }\n        return tooltipContent(s.title.expand(sParams), mods(\n            div(s.desc[0].expand(sParams) + \" \", b(binaryStringRep), s.desc[1]),\n            !isUnknown(value) || this.showAsUnknown\n                ? emptyMod\n                : div(s.CurrentlyUndefined)\n        ))\n    }\n\n    protected doRecalcValue() {\n        return displayValuesFromArray(this.inputValues(this.inputs.In), false)\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        const [binaryStringRep, value] = this.value\n        const maxValue = (1 << this.inputs.In.length) - 1\n        const background = isUnknown(value) || this.showAsUnknown ? COLOR_UNKNOWN : colorForFraction(value / maxValue)\n\n        this.doDrawDefault(g, ctx, {\n            background,\n            skipLabels: true,\n            componentName: [this._name, true, value],\n            drawLabels: (ctx, { width, height }) => {\n                const isVertical = Orientation.isVertical(this.orient)\n                const backColorComps = colorCompsRGB(background)\n                const textColor = ColorString(backColorComps[0] + backColorComps[1] + backColorComps[2] > 3 * 127 ? 0 : 0xFF)\n                g.fillStyle = textColor\n\n                g.textAlign = \"center\"\n\n                if (!this.showAsUnknown) {\n                    const [hasSpaces, spacedStringRep] = insertSpaces(binaryStringRep, this._radix)\n                    g.font = `${hasSpaces ? 9 : 10}px sans-serif`\n                    fillTextVAlign(g, TextVAlign.middle, spacedStringRep, this.posX, this.posY + (isVertical ? -width / 2 + 7 : -height / 2 + 8))\n                }\n\n                const mainSize = this.numBits === 4 && this._radix === 8 ? 16 : 18\n                g.font = `bold ${mainSize}px sans-serif`\n\n                const stringRep = this.showAsUnknown ? Unknown\n                    : formatWithRadix(value, this._radix, this.numBits)\n                fillTextVAlign(g, TextVAlign.middle, stringRep, this.posX, this.posY + (isVertical ? 6 : 0))\n            },\n        })\n    }\n\n\n    public override pointerDoubleClicked(e: PointerEvent) {\n        const superChange = super.pointerDoubleClicked(e)\n        if (superChange.isChange) {\n            return superChange // already handled\n        }\n        const mode = this.parent.mode\n        if (mode >= Mode.FULL && e.altKey) {\n            this.doSetShowAsUnknown(!this._showAsUnknown)\n            return InteractionResult.SimpleChange\n        } else if (mode >= Mode.DESIGN) {\n            this.doSetRadix(this._radix === 10 ? 16 : 10)\n            return InteractionResult.SimpleChange\n        }\n        return InteractionResult.NoChange\n    }\n\n    private doSetName(name: ComponentName) {\n        this._name = name\n        this.requestRedraw({ why: \"name changed\" })\n    }\n\n    private doSetShowAsUnknown(showAsUnknown: boolean) {\n        this._showAsUnknown = showAsUnknown\n        this.requestRedraw({ why: \"display as unknown changed\" })\n    }\n\n    private doSetRadix(radix: number) {\n        this._radix = radix\n        this.requestRedraw({ why: \"radix changed\" })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n\n        const s = S.Components.Display.contextMenu\n        const makeItemShowAs = (desc: string, handler: () => void, isCurrent: boolean,) => {\n            const icon = isCurrent ? \"check\" : \"none\"\n            const caption = s.DisplayAs + \" \" + desc\n            const action = isCurrent ? () => undefined : handler\n            return MenuData.item(icon, caption, action)\n        }\n\n        const makeItemShowRadix = (radix: number, desc: string) => {\n            return makeItemShowAs(desc, () => {\n                if (this._showAsUnknown) {\n                    this.doSetShowAsUnknown(false)\n                }\n                this.doSetRadix(radix)\n            }, !this._showAsUnknown && this._radix === radix)\n        }\n\n        return [\n            [\"mid\", makeItemShowRadix(10, s.DisplayAsDecimal)],\n            [\"mid\", makeItemShowRadix(-10, s.DisplayAsSignedDecimal)],\n            [\"mid\", makeItemShowRadix(8, s.DisplayAsOctal)],\n            [\"mid\", makeItemShowRadix(16, s.DisplayAsHexadecimal)],\n            [\"mid\", makeItemShowAs(s.DisplayAsUnknown, () => this.doSetShowAsUnknown(!this._showAsUnknown), this._showAsUnknown)],\n            [\"mid\", MenuData.sep()],\n            this.makeChangeParamsContextMenuItem(\"inputs\", S.Components.Generic.contextMenu.ParamNumBits, this.numBits, \"bits\"),\n            [\"mid\", MenuData.sep()],\n            [\"mid\", this.makeSetNameContextMenuItem(this._name, this.doSetName.bind(this))],\n        ]\n    }\n\n    public override keyDown(e: KeyboardEvent): void {\n        if (e.key === \"Enter\" && !e.altKey) {\n            this.runSetNameDialog(this._name, this.doSetName.bind(this))\n        } else {\n            super.keyDown(e)\n        }\n    }\n\n}\nDisplayDef.impl = Display\n\nfunction repeatString(s: string, n: number) {\n    let result = \"\"\n    for (let i = 0; i < n; i++) {\n        result += s\n    }\n    return result\n}\n\nfunction insertSpaces(binaryStringRep: string, radix: number): [boolean, string] {\n    let n = -1\n    if (radix === 16) {\n        n = 4\n    } else if (radix === 8) {\n        n = 3\n    }\n    if (n < 0) {\n        return [false, binaryStringRep]\n    }\n    const re = new RegExp(`(.{${n}})`, \"g\")\n    const spaced = reverseString(reverseString(binaryStringRep).replace(re, \"$1 \"))\n    return [true, spaced]\n}\n\nfunction reverseString(str: string) {\n    return str.split(\"\").reverse().join(\"\")\n}", "import * as t from \"io-ts\"\nimport { COLOR_OFF_BACKGROUND } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, LogicValue, toLogicValueRepr, typeOrUndefined } from \"../utils\"\nimport { ComponentNameRepr, Repr, defineComponent, group } from \"./Component\"\nimport { DisplayBarBase, LedColors, ledColorForLogicValue } from \"./DisplayBar\"\nimport { DrawContext, DrawableParent, GraphicsRendering } from \"./Drawable\"\n\n\nexport const Display16SegDef =\n    defineComponent(\"16seg\", {\n        idPrefix: \"16seg\",\n        button: { imgWidth: 32 },\n        repr: {\n            color: typeOrUndefined(t.keyof(LedColors, \"LedColor\")),\n            transparent: typeOrUndefined(t.boolean),\n            name: ComponentNameRepr,\n        },\n        valueDefaults: {},\n        size: { gridWidth: 8, gridHeight: 10 },\n        makeNodes: () => ({\n            ins: {\n                In: group(\"w\", [\n                    [-5, -4, \"a1\"],\n                    [-6, -3.5, \"a2\"],\n                    [-5, -3, \"b\"],\n                    [-6, -2.5, \"c\"],\n                    [-5, -2, \"d2\"],\n                    [-6, -1.5, \"d1\"],\n                    [-5, -1, \"e\"],\n                    [-6, -0.5, \"f\"],\n                    [-5, 0, \"g1\"],\n                    [-6, 0.5, \"g2\"],\n                    [-5, +1, \"h\"],\n                    [-6, +1.5, \"i\"],\n                    [-5, +2, \"j\"],\n                    [-6, +2.5, \"k\"],\n                    [-5, +3, \"l\"],\n                    [-6, +3.5, \"m\"],\n                    [-5, +4, \"p\"],\n                ]),\n            },\n        }),\n        initialValue: () => ArrayFillWith<LogicValue>(false, 17),\n    })\n\nexport type Display16SegRepr = Repr<typeof Display16SegDef>\n\nexport class Display16Seg extends DisplayBarBase<Display16SegRepr, LogicValue[]> {\n\n    public constructor(parent: DrawableParent, saved?: Display16SegRepr) {\n        super(parent, Display16SegDef, true, saved)\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    public override makeTooltip() {\n        return tooltipContent(undefined, mods(\n            div(S.Components.Display16Seg.tooltip),\n        ))\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        return this.inputValues(this.inputs.In)\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, {\n            labelSize: 7,\n            componentName: [this._name, true, () => this.value.map(toLogicValueRepr).reverse().join(\"\")],\n            drawInside: ({ left, right, top, bottom }) => {\n                const [a1, a2, b, c, d2, d1, e, f, g1, g2, h, i, j, k, l, m, p] = this.value\n\n                const vMargin = 10\n                const strokeHalfWidth = 3\n                const drawLeft = left + 18\n                const drawRight = right - 10\n                const drawCenterX = (drawLeft + drawRight) / 2\n                const drawTop = top + vMargin\n                const drawBottom = bottom - vMargin\n\n                const doFill = (v: LogicValue) => {\n                    if (!this._transparent || v !== false) {\n                        g.fillStyle = ledColorForLogicValue(v, this._color)\n                        g.fill()\n                    }\n                }\n\n                const drawH = (v: LogicValue, xLeft: number, xRight: number, y: number) => {\n                    g.beginPath()\n                    g.moveTo(xLeft, y)\n                    g.lineTo(xLeft + strokeHalfWidth, y - strokeHalfWidth)\n                    g.lineTo(xRight - strokeHalfWidth, y - strokeHalfWidth)\n                    g.lineTo(xRight, y)\n                    g.lineTo(xRight - strokeHalfWidth, y + strokeHalfWidth)\n                    g.lineTo(xLeft + strokeHalfWidth, y + strokeHalfWidth)\n                    g.closePath()\n                    g.stroke()\n                    doFill(v)\n                }\n\n                const drawV = (v: LogicValue, x: number, yTop: number, yBottom: number) => {\n                    g.beginPath()\n                    g.moveTo(x, yTop)\n                    g.lineTo(x + strokeHalfWidth, yTop + strokeHalfWidth)\n                    g.lineTo(x + strokeHalfWidth, yBottom - strokeHalfWidth)\n                    g.lineTo(x, yBottom)\n                    g.lineTo(x - strokeHalfWidth, yBottom - strokeHalfWidth)\n                    g.lineTo(x - strokeHalfWidth, yTop + strokeHalfWidth)\n                    g.closePath()\n                    g.stroke()\n                    doFill(v)\n                }\n\n                const dx = strokeHalfWidth * 1.41\n                const dy = strokeHalfWidth * 1.41\n\n                const drawBackslash = (v: LogicValue, xLeft: number, yTop: number, xRight: number, yBottom: number) => {\n                    g.beginPath()\n                    g.moveTo(xLeft, yTop)\n                    g.lineTo(xLeft + dx, yTop)\n                    g.lineTo(xRight, yBottom - dy)\n                    g.lineTo(xRight, yBottom)\n                    g.lineTo(xRight - dx, yBottom)\n                    g.lineTo(xLeft, yTop + dy)\n                    g.closePath()\n                    g.stroke()\n                    doFill(v)\n                }\n\n                const drawSlash = (v: LogicValue, xLeft: number, yBottom: number, xRight: number, yTop: number) => {\n                    g.beginPath()\n                    g.moveTo(xLeft, yBottom)\n                    g.lineTo(xLeft, yBottom - dy)\n                    g.lineTo(xRight - dx, yTop)\n                    g.lineTo(xRight, yTop)\n                    g.lineTo(xRight, yTop + dy)\n                    g.lineTo(xLeft + dx, yBottom)\n                    g.closePath()\n                    g.stroke()\n                    doFill(v)\n                }\n\n                g.strokeStyle = COLOR_OFF_BACKGROUND\n                g.lineWidth = 1\n                drawH(a1, drawLeft + strokeHalfWidth, drawCenterX, drawTop + strokeHalfWidth)\n                drawH(a2, drawCenterX, drawRight - strokeHalfWidth, drawTop + strokeHalfWidth)\n                drawV(b, drawRight - strokeHalfWidth, drawTop + strokeHalfWidth, this.posY)\n                drawV(c, drawRight - strokeHalfWidth, this.posY, drawBottom - strokeHalfWidth)\n                drawH(d1, drawLeft + strokeHalfWidth, drawCenterX, drawBottom - strokeHalfWidth)\n                drawH(d2, drawCenterX, drawRight - strokeHalfWidth, drawBottom - strokeHalfWidth)\n                drawV(e, drawLeft + strokeHalfWidth, this.posY, drawBottom - strokeHalfWidth)\n                drawV(f, drawLeft + strokeHalfWidth, drawTop + strokeHalfWidth, this.posY)\n                drawH(g1, drawLeft + strokeHalfWidth, drawCenterX, this.posY)\n                drawH(g2, drawCenterX, drawRight - strokeHalfWidth, this.posY)\n                drawV(i, drawCenterX, drawTop + strokeHalfWidth, this.posY)\n                drawV(l, drawCenterX, this.posY, drawBottom - strokeHalfWidth)\n                const slashTop = drawTop + strokeHalfWidth + strokeHalfWidth\n                const slashBottom = drawBottom - strokeHalfWidth - strokeHalfWidth\n                drawBackslash(h, drawLeft + strokeHalfWidth + strokeHalfWidth, slashTop, drawCenterX - strokeHalfWidth, this.posY - strokeHalfWidth)\n                drawSlash(j, drawCenterX + strokeHalfWidth, this.posY - strokeHalfWidth, drawRight - strokeHalfWidth - strokeHalfWidth, slashTop)\n                drawSlash(k, drawLeft + strokeHalfWidth + strokeHalfWidth, slashBottom, drawCenterX - strokeHalfWidth, this.posY + strokeHalfWidth)\n                drawBackslash(m, drawCenterX + strokeHalfWidth, this.posY + strokeHalfWidth, drawRight - strokeHalfWidth - strokeHalfWidth, slashBottom)\n\n                g.beginPath()\n                const radius = 1.3 * strokeHalfWidth\n                g.arc(right - 8, bottom - 7 - radius / 2, radius, 0, 2 * Math.PI)\n                g.stroke()\n                doFill(p)\n            },\n        })\n    }\n\n}\nDisplay16SegDef.impl = Display16Seg\n", "import * as t from \"io-ts\"\nimport { COLOR_HIGH_IMPEDANCE, COLOR_LED_ON, COLOR_TRANSPARENT, COLOR_UNKNOWN, COLOR_WIRE_BORDER, GRID_STEP, pxToGrid } from \"../drawutils\"\nimport { Modifier, asValue, mods, span, style, title, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { HighImpedance, InteractionResult, LogicValue, Unknown, isHighImpedance, isUnknown, toLogicValueRepr, typeOrUndefined } from \"../utils\"\nimport { ComponentBase, ComponentName, ComponentNameRepr, InstantiatedComponentDef, NodesIn, NodesOut, Repr, defineComponent } from \"./Component\"\nimport { Display16SegRepr } from \"./Display16Seg\"\nimport { Display7SegRepr } from \"./Display7Seg\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems } from \"./Drawable\"\n\n\n\nexport const LedColors = {\n    green: null,\n    red: null,\n    yellow: null,\n} as const\n\nexport type LedColor = keyof typeof LedColors\n\nexport const DisplayBarTypes = {\n    v: null,\n    h: null,\n    px: null,\n    PX: null,\n} as const\n\ntype DisplayBarType = keyof typeof DisplayBarTypes\n\n\nexport function ledColorForLogicValue(v: LogicValue, onColor: LedColor) {\n    return isUnknown(v) ? COLOR_UNKNOWN :\n        isHighImpedance(v) ? COLOR_HIGH_IMPEDANCE :\n            v ? COLOR_LED_ON[onColor] : COLOR_WIRE_BORDER\n}\n\ntype DisplayBarBaseRepr = DisplayBarRepr | Display7SegRepr | Display16SegRepr\n\nexport abstract class DisplayBarBase<TRepr extends DisplayBarBaseRepr, TValue> extends ComponentBase<\n    TRepr,\n    TValue,\n    NodesIn<TRepr>,\n    NodesOut<TRepr>,\n    true, false\n> {\n\n    private readonly transparentDefault: boolean\n    protected _color: LedColor\n    protected _transparent: boolean\n    protected _name: ComponentName\n\n    protected constructor(parent: DrawableParent, SubclassDef: InstantiatedComponentDef<TRepr, TValue>, transparentDefault: boolean, saved?: TRepr) {\n        super(parent, SubclassDef, saved)\n        this.transparentDefault = transparentDefault\n\n        this._color = saved?.color ?? DisplayBarDef.aults.color\n        this._transparent = saved?.transparent ?? transparentDefault\n        this._name = saved?.name ?? undefined\n    }\n\n    public override toJSONBase() {\n        return {\n            ...super.toJSONBase(),\n            color: this._color === DisplayBarDef.aults.color ? undefined : this._color,\n            transparent: this._transparent === this.transparentDefault ? undefined : this._transparent,\n            name: this._name,\n        }\n    }\n\n    private doSetName(name: ComponentName) {\n        this._name = name\n        this.requestRedraw({ why: \"name changed\" })\n    }\n\n    private doSetColor(color: LedColor) {\n        this._color = color\n        this.requestRedraw({ why: \"color changed\" })\n    }\n\n    private doSetTransparent(transparent: boolean) {\n        this._transparent = transparent\n        this.requestRedraw({ why: \"transparent changed\" })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.DisplayBar.contextMenu\n\n        const makeItemUseColor = (desc: string, color: LedColor) => {\n            const isCurrent = this._color === color\n            const icon = isCurrent ? \"check\" : \"none\"\n            const action = isCurrent ? () => undefined : () => this.doSetColor(color)\n            const cssColor = COLOR_LED_ON[color]\n            return MenuData.item(icon, span(title(desc), style(`display: inline-block; width: 140px; height: 16px; background-color: ${cssColor}; margin-right: 8px`)), action)\n        }\n\n        const itemTransparent = MenuData.item(\n            this._transparent ? \"check\" : \"none\",\n            s.TransparentWhenOff,\n            () => this.doSetTransparent(!this._transparent)\n        )\n\n        return [\n            [\"mid\", MenuData.submenu(\"palette\", s.Color, [\n                makeItemUseColor(s.ColorGreen, \"green\"),\n                makeItemUseColor(s.ColorRed, \"red\"),\n                makeItemUseColor(s.ColorYellow, \"yellow\"),\n                MenuData.sep(),\n                itemTransparent,\n            ])],\n            [\"mid\", this.makeSetNameContextMenuItem(this._name, this.doSetName.bind(this))],\n        ]\n    }\n\n    public override keyDown(e: KeyboardEvent): void {\n        if (e.key === \"Enter\" && !e.altKey) {\n            this.runSetNameDialog(this._name, this.doSetName.bind(this))\n        } else {\n            super.keyDown(e)\n        }\n    }\n\n}\n\n\n\nexport const DisplayBarDef =\n    defineComponent(\"bar\", {\n        idPrefix: \"bar\",\n        button: { imgWidth: 32 },\n        repr: {\n            display: t.keyof(DisplayBarTypes, \"OutputBarType\"),\n            color: typeOrUndefined(t.keyof(LedColors, \"LedColor\")),\n            transparent: typeOrUndefined(t.boolean),\n            name: ComponentNameRepr,\n        },\n        valueDefaults: {\n            display: \"h\" as DisplayBarType,\n            color: \"green\" as LedColor,\n            transparent: true,\n        },\n        size: { gridWidth: 1, gridHeight: 1 }, // overridden\n        makeNodes: () => ({\n            ins: {\n                I: [0, 0, \"w\"],\n            },\n        }),\n        initialValue: () => false as LogicValue,\n    })\n\nexport type DisplayBarRepr = Repr<typeof DisplayBarDef>\n\nexport class DisplayBar extends DisplayBarBase<DisplayBarRepr, LogicValue> {\n\n    private _display!: DisplayBarType\n\n    public constructor(parent: DrawableParent, saved?: DisplayBarRepr) {\n        super(parent, DisplayBarDef, false, saved)\n\n        this.doSetDisplay(saved?.display ?? DisplayBarDef.aults.display)\n    }\n\n    public toJSON() {\n        return {\n            ...super.toJSONBase(),\n            display: this._display,\n        }\n    }\n\n    public override get unrotatedWidth() {\n        return this.getWidthAndHeight()[0]\n    }\n\n    public override get unrotatedHeight() {\n        return this.getWidthAndHeight()[1]\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.DisplayBar.tooltip\n        const expl: Modifier = (() => {\n            switch (this.value) {\n                case Unknown: return s.ValueUnknown\n                case HighImpedance: return s.ValueUnknown\n                case true: return mods(s.Value1[0], asValue(this.value), s.Value1[1])\n                case false: return mods(s.Value0[0], asValue(this.value), s.Value0[1])\n            }\n        })()\n        return tooltipContent(s.title, expl)\n    }\n\n    public get display() {\n        return this._display\n    }\n\n    protected doRecalcValue(): LogicValue {\n        return this.inputs.I.value\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        const valueToShow = this.parent.editor.options.hideOutputColors ? Unknown : this.value\n        const background = this._transparent && valueToShow === false\n            ? COLOR_TRANSPARENT\n            : ledColorForLogicValue(valueToShow, this._color)\n\n        this.doDrawDefault(g, ctx, {\n            background,\n            skipLabels: true,\n            componentName: [this._name, true, toLogicValueRepr(valueToShow)],\n        })\n    }\n\n    public getWidthAndHeight() {\n        const w = 10\n        const h = 2\n        switch (this._display ?? DisplayBarDef.aults.display) {\n            case \"h\":\n                return [w * GRID_STEP, h * GRID_STEP] as const\n            case \"v\":\n                return [h * GRID_STEP, w * GRID_STEP] as const\n            case \"px\":\n                return [h * GRID_STEP, h * GRID_STEP] as const\n            case \"PX\":\n                return [w * GRID_STEP, w * GRID_STEP] as const\n        }\n    }\n\n    public override pointerDoubleClicked(e: PointerEvent) {\n        const superChange = super.pointerDoubleClicked(e)\n        if (superChange.isChange) {\n            return superChange // already handled\n        }\n        this.doSetDisplay((() => {\n            switch (this.display) {\n                case \"h\":\n                    return \"v\"\n                case \"v\":\n                    return \"px\"\n                case \"px\":\n                    return \"PX\"\n                case \"PX\":\n                    return \"h\"\n            }\n        })())\n        return InteractionResult.SimpleChange\n    }\n\n    private doSetDisplay(newDisplay: DisplayBarType) {\n        this._display = newDisplay\n        this.updateInputOffsetX()\n        this.requestRedraw({ why: \"display mode changed\", invalidateMask: true })\n    }\n\n    private updateInputOffsetX() {\n        const width = this.getWidthAndHeight()[0]\n        const input = this.inputs.I\n        input.gridOffsetX = -pxToGrid(width / 2) - 1\n        input.updateLeadLength()\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.DisplayBar.contextMenu\n\n        const makeItemShowAs = (desc: string, display: DisplayBarType) => {\n            const isCurrent = this._display === display\n            const icon = isCurrent ? \"check\" : \"none\"\n            const action = isCurrent ? () => undefined : () => { this.doSetDisplay(display) }\n            return MenuData.item(icon, desc, action)\n        }\n\n        return [\n            [\"mid\", MenuData.submenu(\"eye\", s.Display, [\n                makeItemShowAs(s.DisplayVerticalBar, \"v\"),\n                makeItemShowAs(s.DisplayHorizontalBar, \"h\"),\n                makeItemShowAs(s.DisplaySmallSquare, \"px\"),\n                makeItemShowAs(s.DisplayLargeSquare, \"PX\"),\n                MenuData.sep(),\n                MenuData.text(s.DisplayChangeDesc),\n            ])],\n            ...super.makeComponentSpecificContextMenuItems(),\n        ]\n    }\n\n\n}\nDisplayBarDef.impl = DisplayBar\n", "import * as t from \"io-ts\"\nimport { COLOR_OFF_BACKGROUND } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, LogicValue, toLogicValueRepr, typeOrUndefined } from \"../utils\"\nimport { ComponentNameRepr, Repr, defineComponent, group } from \"./Component\"\nimport { DisplayBarBase, LedColors, ledColorForLogicValue } from \"./DisplayBar\"\nimport { DrawContext, DrawableParent, GraphicsRendering } from \"./Drawable\"\n\n\nexport const Display7SegDef =\n    defineComponent(\"7seg\", {\n        idPrefix: \"7seg\",\n        button: { imgWidth: 32 },\n        repr: {\n            color: typeOrUndefined(t.keyof(LedColors, \"LedColor\")),\n            transparent: typeOrUndefined(t.boolean),\n            name: ComponentNameRepr,\n        },\n        valueDefaults: {},\n        size: { gridWidth: 8, gridHeight: 10 },\n        makeNodes: () => ({\n            ins: {\n                In: group(\"w\", [\n                    [-5, -4, \"a\"],\n                    [-5, -3, \"b\"],\n                    [-5, -2, \"c\"],\n                    [-5, -1, \"d\"],\n                    [-5, 0, \"e\"],\n                    [-5, +1, \"f\"],\n                    [-5, +2, \"g\"],\n                    [-5, +4, \"p\"],\n                ]),\n            },\n        }),\n        initialValue: () => ArrayFillWith<LogicValue>(false, 8),\n    })\n\n\nexport type Display7SegRepr = Repr<typeof Display7SegDef>\n\nexport class Display7Seg extends DisplayBarBase<Display7SegRepr, LogicValue[]> {\n\n    public constructor(parent: DrawableParent, saved?: Display7SegRepr) {\n        super(parent, Display7SegDef, true, saved)\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    public override makeTooltip() {\n        return tooltipContent(undefined, mods(\n            div(S.Components.Display7Seg.tooltip)\n        ))\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        return this.inputValues(this.inputs.In)\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, {\n            labelSize: 9,\n            componentName: [this._name, true, () => this.value.map(toLogicValueRepr).reverse().join(\"\")],\n            drawInside: ({ left, right, top, bottom }) => {\n                const [a, b, c, d, e, f, gg, p] = this.value\n\n                const hMargin = 20\n                const vMargin = 10\n                const strokeHalfWidth = 4\n                const drawLeft = left + hMargin\n                const drawRight = right - hMargin\n                const drawTop = top + vMargin\n                const drawBottom = bottom - vMargin\n\n                const doFill = (v: LogicValue) => {\n                    if (!this._transparent || v !== false) {\n                        g.fillStyle = ledColorForLogicValue(v, this._color)\n                        g.fill()\n                    }\n                }\n\n                const drawH = (v: LogicValue, y: number) => {\n                    g.beginPath()\n                    g.moveTo(drawLeft + strokeHalfWidth, y)\n                    g.lineTo(drawLeft + strokeHalfWidth + strokeHalfWidth, y - strokeHalfWidth)\n                    g.lineTo(drawRight - strokeHalfWidth - strokeHalfWidth, y - strokeHalfWidth)\n                    g.lineTo(drawRight - strokeHalfWidth, y)\n                    g.lineTo(drawRight - strokeHalfWidth - strokeHalfWidth, y + strokeHalfWidth)\n                    g.lineTo(drawLeft + strokeHalfWidth + strokeHalfWidth, y + strokeHalfWidth)\n                    g.closePath()\n                    g.stroke()\n                    doFill(v)\n                }\n\n                const drawV = (v: LogicValue, x: number, yTop: number, yBottom: number) => {\n                    g.beginPath()\n                    g.moveTo(x, yTop)\n                    g.lineTo(x + strokeHalfWidth, yTop + strokeHalfWidth)\n                    g.lineTo(x + strokeHalfWidth, yBottom - strokeHalfWidth)\n                    g.lineTo(x, yBottom)\n                    g.lineTo(x - strokeHalfWidth, yBottom - strokeHalfWidth)\n                    g.lineTo(x - strokeHalfWidth, yTop + strokeHalfWidth)\n                    g.closePath()\n                    g.stroke()\n                    doFill(v)\n                }\n\n                g.strokeStyle = COLOR_OFF_BACKGROUND\n                g.lineWidth = 1\n                drawH(a, drawTop + strokeHalfWidth)\n                drawV(b, drawRight - strokeHalfWidth, drawTop + strokeHalfWidth, this.posY)\n                drawV(c, drawRight - strokeHalfWidth, this.posY, drawBottom - strokeHalfWidth)\n                drawH(d, drawBottom - strokeHalfWidth)\n                drawV(e, drawLeft + strokeHalfWidth, this.posY, drawBottom - strokeHalfWidth)\n                drawV(f, drawLeft + strokeHalfWidth, drawTop + strokeHalfWidth, this.posY)\n                drawH(gg, this.posY)\n\n                g.beginPath()\n                const radius = 1.3 * strokeHalfWidth\n                g.arc(right - hMargin / 2, bottom - vMargin - radius / 2, radius, 0, 2 * Math.PI)\n                g.stroke()\n                doFill(p)\n            },\n        })\n    }\n\n}\nDisplay7SegDef.impl = Display7Seg\n", "import * as t from \"io-ts\"\nimport { COLOR_COMPONENT_BORDER, COLOR_UNKNOWN, TextVAlign, displayValuesFromArray, fillTextVAlign, formatWithRadix } from \"../drawutils\"\nimport { b, div, emptyMod, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { InteractionResult, Mode, isUnknown, typeOrUndefined } from \"../utils\"\nimport { ComponentBase, ComponentName, ComponentNameRepr, Repr, defineComponent, groupVertical } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems, Orientation } from \"./Drawable\"\n\n\nexport const DisplayAsciiDef =\n    defineComponent(\"ascii\", {\n        idPrefix: \"disp\",\n        button: { imgWidth: 32 },\n        repr: {\n            name: ComponentNameRepr,\n            additionalReprRadix: typeOrUndefined(t.number),\n            showAsUnknown: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {},\n        size: { gridWidth: 4, gridHeight: 8 },\n        makeNodes: () => ({\n            ins: {\n                Z: groupVertical(\"w\", -3, 0, 7),\n            },\n        }),\n        initialValue: (): [string, number | \"?\"] => [\"0000000\", 0],\n    })\n\nexport type DisplayAsciiRepr = Repr<typeof DisplayAsciiDef>\n\nexport class DisplayAscii extends ComponentBase<DisplayAsciiRepr> {\n\n    private _name: ComponentName\n    private _additionalReprRadix: number | undefined\n    private _showAsUnknown: boolean\n\n    public constructor(parent: DrawableParent, saved?: DisplayAsciiRepr) {\n        super(parent, DisplayAsciiDef, saved)\n        this._name = saved?.name ?? undefined\n        this._additionalReprRadix = saved?.additionalReprRadix ?? undefined\n        this._showAsUnknown = saved?.showAsUnknown ?? false\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            name: this._name,\n            additionalReprRadix: this._additionalReprRadix,\n            showAsUnknown: (this._showAsUnknown) ? true : undefined,\n        }\n    }\n\n    private get showAsUnknown() {\n        return this._showAsUnknown || this.parent.editor.options.hideOutputColors\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.DisplayAscii.tooltip\n        const [binaryStringRep, value] = this.value\n\n        return tooltipContent(s.title, mods(\n            div(s.desc[0], b(binaryStringRep), s.desc[1]),\n            this.showAsUnknown\n                ? emptyMod\n                : isUnknown(value)\n                    ? div(s.CurrentlyUndefined)\n                    : mods(s.CurrentlyThisCharacter + \" \", b(\"\" + value),\n                        (value < 32)\n                            ? s.WhichIsNotPrintable\n                            : mods(\", \u2018\", b(String.fromCharCode(value)), \"\u2019.\")\n                    )\n        ))\n    }\n\n    protected doRecalcValue() {\n        const values = this.inputValues(this.inputs.Z)\n        return displayValuesFromArray(values, false)\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        const [binaryStringRep, value] = this.value\n        let mainText: string\n        let mainTextFont: string\n        let mainTextStyle = COLOR_COMPONENT_BORDER\n        if (isUnknown(value) || this.showAsUnknown) {\n            mainTextFont = \"bold 18px sans-serif\"\n            if (this.showAsUnknown) {\n                mainTextStyle = COLOR_UNKNOWN\n            }\n            mainText = \"?\"\n        } else {\n            mainText = DisplayAscii.numberToAscii(value)\n            if (value < 32) {\n                // non-printable\n                mainTextFont = \"16px sans-serif\"\n            } else {\n                mainTextFont = \"bold 18px sans-serif\"\n            }\n        }\n\n        this.doDrawDefault(g, ctx, {\n            skipLabels: true,\n            componentName: [this._name, true, mainText],\n            drawLabels: (ctx, { width, height }) => {\n                const isVertical = Orientation.isVertical(this.orient)\n                const hasAdditionalRepresentation = this._additionalReprRadix !== undefined\n                let mainTextPosY = this.posY + (isVertical ? 4 : 0)\n\n                g.font = \"9px sans-serif\"\n                g.fillStyle = COLOR_COMPONENT_BORDER\n\n                if (!this.showAsUnknown) {\n                    if (isVertical && hasAdditionalRepresentation) {\n                        // upper left corner\n                        g.textAlign = \"start\"\n                        fillTextVAlign(g, TextVAlign.middle, binaryStringRep, this.posX - height / 2 + 3, this.posY - width / 2 + 8)\n                        g.textAlign = \"center\"\n                    } else {\n                        // upper center\n                        g.textAlign = \"center\"\n                        fillTextVAlign(g, TextVAlign.middle, binaryStringRep, this.posX, this.posY + (isVertical ? -width / 2 + 8 : -height / 2 + 10))\n                    }\n\n                    if (hasAdditionalRepresentation) {\n                        const additionalRepr = formatWithRadix(value, this._additionalReprRadix ?? 10, 7)\n                        g.font = \"bold 11px sans-serif\"\n                        if (isVertical) {\n                            // upper right\n                            g.textAlign = \"end\"\n                            fillTextVAlign(g, TextVAlign.middle, additionalRepr, this.posX + height / 2 - 3, this.posY - width / 2 + 9)\n                            g.textAlign = \"center\"\n                        } else {\n                            // center, below bin repr\n                            fillTextVAlign(g, TextVAlign.middle, additionalRepr, this.posX, this.posY - height / 2 + 22)\n                            mainTextPosY += 8 // shift main repr a bit\n                        }\n                    }\n                }\n\n                g.font = mainTextFont\n                g.fillStyle = mainTextStyle\n                fillTextVAlign(g, TextVAlign.middle, mainText, this.posX, mainTextPosY)\n            },\n        })\n    }\n\n    public static numberToAscii(n: number): string {\n        if (n < 32) {\n            // non-printable\n            return \"\\\\\" + n\n        }\n        return String.fromCharCode(n)\n    }\n\n    public override pointerDoubleClicked(e: PointerEvent) {\n        const superChange = super.pointerDoubleClicked(e)\n        if (superChange.isChange) {\n            return superChange // already handled\n        }\n        const mode = this.parent.mode\n        if (mode >= Mode.FULL && e.altKey) {\n            this.doSetShowAsUnknown(!this._showAsUnknown)\n            return InteractionResult.SimpleChange\n        } else if (mode >= Mode.DESIGN) {\n            this.doSetAdditionalDisplayRadix((() => {\n                switch (this._additionalReprRadix) {\n                    case undefined: return 10\n                    case 10: return 16\n                    case 16: return undefined\n                    default: return undefined\n                }\n            })())\n            return InteractionResult.SimpleChange\n        }\n        return InteractionResult.NoChange\n    }\n\n    private doSetName(name: ComponentName) {\n        this._name = name\n        this.requestRedraw({ why: \"name changed\" })\n    }\n\n    private doSetShowAsUnknown(showAsUnknown: boolean) {\n        this._showAsUnknown = showAsUnknown\n        this.requestRedraw({ why: \"display as unknown changed\" })\n    }\n\n    private doSetAdditionalDisplayRadix(additionalReprRadix: number | undefined) {\n        this._additionalReprRadix = additionalReprRadix\n        this.requestRedraw({ why: \"additional display radix changed\" })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n\n        const s = S.Components.DisplayAscii.contextMenu\n\n        const makeItemShowAs = (desc: string, handler: () => void, isCurrent: boolean,) => {\n            const icon = isCurrent ? \"check\" : \"none\"\n            return MenuData.item(icon, desc, handler)\n        }\n\n        const makeItemShowRadix = (radix: number | undefined, desc: string) => {\n            return makeItemShowAs(desc,\n                () => this.doSetAdditionalDisplayRadix(radix),\n                this._additionalReprRadix === radix\n            )\n        }\n\n        return [\n            [\"mid\", MenuData.submenu(\"eye\", s.AdditionalDisplay, [\n                makeItemShowRadix(undefined, s.DisplayNone),\n                makeItemShowRadix(10, s.DisplayDecimal),\n                makeItemShowRadix(16, s.DisplayHex),\n                MenuData.sep(),\n                MenuData.text(s.ChangeDisplayDesc),\n            ])],\n            [\"mid\", makeItemShowAs(S.Components.Generic.contextMenu.ShowAsUnknown, () => this.doSetShowAsUnknown(!this._showAsUnknown), this._showAsUnknown)],\n            [\"mid\", MenuData.sep()],\n            [\"mid\", this.makeSetNameContextMenuItem(this._name, this.doSetName.bind(this))],\n        ]\n    }\n\n\n    public override keyDown(e: KeyboardEvent): void {\n        if (e.key === \"Enter\" && !e.altKey) {\n            this.runSetNameDialog(this._name, this.doSetName.bind(this))\n        } else {\n            super.keyDown(e)\n        }\n    }\n\n}\nDisplayAsciiDef.impl = DisplayAscii\n", "import { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { LogicValue } from \"../utils\"\nimport { Repr, defineComponent } from \"./Component\"\nimport { DrawableParent } from \"./Drawable\"\nimport { Flipflop, FlipflopBaseDef } from \"./FlipflopOrLatch\"\n\n\nexport const FlipflopDDef =\n    defineComponent(\"ff-d\", {\n        idPrefix: \"ff\",\n        ...FlipflopBaseDef,\n        makeNodes: () => {\n            const base = FlipflopBaseDef.makeNodes(2)\n            const s = S.Components.Generic\n            return {\n                ins: {\n                    ...base.ins,\n                    D: [-4, -2, \"w\", s.InputDataDesc],\n                },\n                outs: base.outs,\n            }\n        },\n    })\n\ntype FlipflopDRepr = Repr<typeof FlipflopDDef>\n\nexport class FlipflopD extends Flipflop<FlipflopDRepr> {\n\n    public constructor(parent: DrawableParent, saved?: FlipflopDRepr) {\n        super(parent, FlipflopDDef, saved)\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.FlipflopD.tooltip\n        return tooltipContent(s.title, mods(\n            div(s.desc) // TODO more info\n        ))\n    }\n\n    protected doRecalcValueAfterClock(): LogicValue {\n        return LogicValue.filterHighZ(this.inputs.D.value)\n    }\n\n}\nFlipflopDDef.impl = FlipflopD\n", "import { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { LogicValue } from \"../utils\"\nimport { Repr, defineComponent } from \"./Component\"\nimport { DrawableParent } from \"./Drawable\"\nimport { Flipflop, FlipflopBaseDef } from \"./FlipflopOrLatch\"\n\n\nexport const FlipflopJKDef =\n    defineComponent(\"ff-jk\", {\n        idPrefix: \"ff\",\n        ...FlipflopBaseDef,\n        makeNodes: () => {\n            const base = FlipflopBaseDef.makeNodes(0)\n            const s = S.Components.FlipflopJK\n            return {\n                ins: {\n                    ...base.ins,\n                    J: [-4, -2, \"w\", s.InputJDesc],\n                    K: [-4, 2, \"w\", s.InputKDesc],\n                },\n                outs: base.outs,\n            }\n        },\n    })\n\ntype FlipflopJKRepr = Repr<typeof FlipflopJKDef>\n\nexport class FlipflopJK extends Flipflop<FlipflopJKRepr> {\n\n    public constructor(parent: DrawableParent, saved?: FlipflopJKRepr) {\n        super(parent, FlipflopJKDef, saved)\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.FlipflopJK.tooltip\n        return tooltipContent(s.title, mods(\n            div(s.desc) // TODO more info\n        ))\n    }\n\n    protected doRecalcValueAfterClock(): LogicValue {\n        const j = this.inputs.J.value\n        const k = this.inputs.K.value\n        const q = this.outputs.Q.value\n\n        if (j === true) {\n            if (k === true) {\n                return LogicValue.invert(q)\n            } else {\n                return true\n            }\n        }\n        if (k === true) {\n            return false\n        } else {\n            return q\n        }\n    }\n\n}\nFlipflopJKDef.impl = FlipflopJK\n", "import { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { LogicValue, Unknown, isHighImpedance, isUnknown } from \"../utils\"\nimport { Repr, defineComponent } from \"./Component\"\nimport { DrawableParent } from \"./Drawable\"\nimport { Flipflop, FlipflopBaseDef } from \"./FlipflopOrLatch\"\n\n\nexport const FlipflopTDef =\n    defineComponent(\"ff-t\", {\n        idPrefix: \"ff\",\n        ...FlipflopBaseDef,\n        makeNodes: () => {\n            const base = FlipflopBaseDef.makeNodes(2)\n            const s = S.Components.FlipflopT\n            return {\n                ins: {\n                    ...base.ins,\n                    T: [-4, -2, \"w\", s.InputTDesc],\n                },\n                outs: base.outs,\n            }\n        },\n    })\n\ntype FlipflopTRepr = Repr<typeof FlipflopTDef>\n\nexport class FlipflopT extends Flipflop<FlipflopTRepr> {\n\n    public constructor(parent: DrawableParent, saved?: FlipflopTRepr) {\n        super(parent, FlipflopTDef, saved)\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.FlipflopT.tooltip\n        return tooltipContent(s.title, mods(\n            div(s.desc) // TODO more info\n        ))\n    }\n\n    protected doRecalcValueAfterClock(): LogicValue {\n        const t = this.inputs.T.value\n        if (isUnknown(t) || isHighImpedance(t)) {\n            return Unknown\n        }\n        const q = this.outputs.Q.value\n        return t ? LogicValue.invert(q) : q\n    }\n\n}\nFlipflopTDef.impl = FlipflopT\n", "import * as t from \"io-ts\"\nimport { COLOR_BACKGROUND, COLOR_COMPONENT_BORDER, COLOR_DARK_RED, COLOR_GATE_NAMES, COLOR_MOUSE_OVER, COLOR_UNKNOWN, ColorString, GRID_STEP, PATTERN_STRIPED_GRAY, TextVAlign, circle, drawWireLineToComponent, fillTextVAlign, useCompact } from \"../drawutils\"\nimport { Modifier, ModifierObject, asValue, b, cls, div, emptyMod, mods, table, tbody, td, th, thead, tooltipContent, tr } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillUsing, Expand, InteractionResult, LogicValue, Mode, RichStringEnum, Unknown, deepArrayEquals, isUnknown, typeOrUndefined } from \"../utils\"\nimport { ExtractParamDefs, ExtractParams, InstantiatedComponentDef, NodesIn, NodesOut, ParametrizedComponentBase, Repr, ResolvedParams, SomeParamCompDef, defineParametrizedComponent, groupVertical, param } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItem, MenuItems } from \"./Drawable\"\nimport { Gate1Type, Gate1TypeRepr, Gate1Types, Gate2OnlyTypes, Gate2toNTypes, GateNType, GateNTypeRepr, GateNTypes, GateTypes } from \"./GateTypes\"\n\ntype GateRepr = Gate1Repr | GateNRepr\n\nconst LEAD_LENGTH_NORMAL = 20\nconst LEAD_LENGTH_OR_STYLE = 25\n\nexport abstract class GateBase<\n    TRepr extends GateRepr,\n    TGateType extends TRepr[\"poseAs\"] & string = TRepr[\"poseAs\"] & string,\n    TParamDefs extends ExtractParamDefs<TRepr> = ExtractParamDefs<TRepr>\n> extends ParametrizedComponentBase<\n    TRepr,\n    LogicValue,\n    TParamDefs,\n    ExtractParams<TRepr>,\n    NodesIn<TRepr>,\n    NodesOut<TRepr>,\n    true, true\n> {\n\n    public abstract get numBits(): number\n    private _type: TGateType\n    private _poseAs: TGateType | undefined\n    private _showAsUnknown: boolean\n\n    protected constructor(parent: DrawableParent, SubclassDef: [InstantiatedComponentDef<TRepr, LogicValue>, SomeParamCompDef<TParamDefs>], type: TGateType, saved?: TRepr) {\n        super(parent, SubclassDef, saved)\n\n        this._type = type\n        // this.updateLeadsFor(type) // done in subclass after it can set numBits\n        this._poseAs = saved?.poseAs as TGateType ?? undefined\n        this._showAsUnknown = saved?.showAsUnknown ?? false\n    }\n\n    protected override toJSONBase() {\n        return {\n            ...super.toJSONBase(),\n            showAsUnknown: (this._showAsUnknown) ? true : undefined,\n            poseAs: this._poseAs,\n        }\n    }\n\n    protected override jsonType() {\n        return this._type\n    }\n\n    protected abstract gateTypes(numBits: number): GateTypes<TGateType>\n\n    public get type(): TGateType {\n        return this._type\n    }\n\n    protected doSetType(newType: TGateType) {\n        this._type = newType\n        this.updateLeadsFor(newType)\n        for (const input of this.inputs.In) {\n            input.incomingWire?.invalidateWirePath()\n        }\n        this.setNeedsRecalc()\n        this.requestRedraw({ why: \"gate type changed\", invalidateTests: true })\n    }\n\n    protected updateLeadsFor(type: TGateType) {\n        const isOrStyle = type === \"or\" || type === \"nor\" || type === \"imply\" || type === \"rimply\"\n        const leadLength = isOrStyle ? LEAD_LENGTH_OR_STYLE : LEAD_LENGTH_NORMAL\n        const ins = this.inputs.In\n        ins.forEach(node => node.updateLeadLength(leadLength))\n        // very empirical way to make the gates look better\n        if (isOrStyle) {\n            const numBits = this.numBits\n            if (numBits >= 6 || numBits === 4) {\n                // shorter first and last\n                ins[0].updateLeadLength(leadLength - 3)\n                ins[numBits - 1].updateLeadLength(leadLength - 3)\n                if (numBits >= 8) {\n                    // shorter on edge of gate\n                    const numCoveredByGate = 6\n                    const iTopGate = (numBits - numCoveredByGate) / 2\n                    const iBottomGate = iTopGate + numCoveredByGate - 1\n                    ins[iTopGate].updateLeadLength(leadLength - 3)\n                    ins[iBottomGate].updateLeadLength(leadLength - 3)\n                    if (numBits >= 24) {\n                        // shorter on arms' ends\n                        ins[1].updateLeadLength(leadLength - 2)\n                        ins[numBits - 2].updateLeadLength(leadLength - 2)\n                        // above gate\n                        ins[iTopGate - 1].updateLeadLength(leadLength - 2)\n                        ins[iTopGate - 2].updateLeadLength(leadLength - 2)\n                        // below gate\n                        ins[iBottomGate + 1].updateLeadLength(leadLength - 2)\n                        ins[iBottomGate + 2].updateLeadLength(leadLength - 2)\n                    }\n                }\n            }\n        }\n\n    }\n\n    public get poseAs() {\n        return this._poseAs\n    }\n\n    public set poseAs(newPoseAs: TGateType | undefined) {\n        if (newPoseAs !== this._poseAs) {\n            this._poseAs = newPoseAs\n            this.requestRedraw({ why: \"gate display changed\" })\n        }\n    }\n\n    public get showAsUnknown() {\n        return this._showAsUnknown\n    }\n\n    private doSetShowAsUnknown(newUnknown: boolean) {\n        this._showAsUnknown = newUnknown\n        this.requestRedraw({ why: \"display as unknown changed\" })\n    }\n\n    protected override toStringDetails(): string {\n        return this.type\n    }\n\n    protected doRecalcValue(): LogicValue {\n        const inputs = this.inputValues(this.inputs.In)\n        const logicFunc = this.gateTypes(this.numBits).props[this.type].out\n        return logicFunc(inputs)\n    }\n\n    protected override propagateValue(newValue: LogicValue) {\n        this.outputs.Out.value = newValue\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.Gate.tooltip\n        if (this.showAsUnknown) {\n            return div(s.UnknownGate)\n        }\n\n        const myIns = this.inputValues(this.inputs.In)\n        const myOut = this.value\n\n        const gateProps = this.gateTypes(this.numBits).props[this.type]\n\n        const genTruthTableData = () => {\n            const header =\n                this.numBits === 1 ? [s.Input] :\n                    ArrayFillUsing(i => s.Input + \" \" + (i + 1), this.numBits)\n            header.push(s.Output)\n            const rows: TruthTableRowData[] = []\n            for (const ins of valueCombinations(this.numBits)) {\n                const matchesCurrent = deepArrayEquals(myIns, ins)\n                const out = gateProps.out(ins)\n                ins.push(out)\n                rows.push({ matchesCurrent, cells: ins })\n            }\n            return [header, rows] as const\n        }\n\n        const nodeOut = this.outputs.Out.value\n        const desc = nodeOut === myOut\n            ? s.CurrentlyDelivers\n            : s.ShouldCurrentlyDeliver\n\n        const gateIsUnspecified = myIns.includes(Unknown)\n        const explanation = gateIsUnspecified\n            ? mods(desc + \" \" + s.UndeterminedOutputBecauseInputUnknown)\n            : mods(desc + \" \" + s.ThisOutput + \" \", asValue(myOut), \" \" + s.BecauseInputIs + \" \", ...myIns.map(asValue))\n\n        const fullShortDesc = gateProps.fullShortDesc()\n        const header = (() => {\n            switch (this.type) {\n                case \"not\": return mods(s.Inverter[0], b(S.Components.Gate.not[0]), s.Inverter[1])\n                case \"buf\": return mods(s.Buffer[0], b(S.Components.Gate.buf[0]), s.Buffer[1])\n                default: return s.GateTitle(b(fullShortDesc[0]))\n            }\n        })()\n\n        const explanationAndTable = this.numBits <= 4 ?\n            mods(explanation, \", \" + s.AccordingToTruthTable, div(makeTruthTable(genTruthTableData())))\n            : mods(explanation, \".\")\n\n        return makeGateTooltip(this.numBits,\n            header,\n            fullShortDesc[2],\n            explanationAndTable,\n        )\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        const gateType = this._showAsUnknown\n            ? Unknown\n            : this.poseAs ?? this.type\n        this.drawGate(g, gateType, gateType !== this.type && !this._showAsUnknown, ctx)\n    }\n\n    private drawGate(g: GraphicsRendering, type: TGateType | Unknown, isFake: boolean, ctx: DrawContext) {\n        const numBits = this.numBits\n        const output = this.outputs.Out\n\n        const { top, left, bottom, right, height } = this.bounds()\n        const drawArms = numBits >= 4 && numBits !== 5\n        const armsOffset = GRID_STEP / (useCompact(numBits) ? 2 : 1)\n        const armsTop = this.inputs.In[0].posYInParentTransform - armsOffset\n        const armsBottom = this.inputs.In[numBits - 1].posYInParentTransform + armsOffset\n        const pi2 = Math.PI / 2\n        let nameDeltaX = 0\n\n        const drawInversionCircle = (x: number, y: number) => {\n            g.beginPath()\n            circle(g, x, y, 8)\n            g.fillStyle = COLOR_BACKGROUND\n            g.fill()\n            g.stroke()\n        }\n\n        const showAsFake = isFake && this.parent.mode >= Mode.FULL\n        const gateBorderColor: ColorString = ctx.isMouseOver ? COLOR_MOUSE_OVER : (showAsFake ? COLOR_DARK_RED : COLOR_COMPONENT_BORDER)\n        const gateFill = showAsFake ? PATTERN_STRIPED_GRAY : COLOR_BACKGROUND\n\n        // inputs and output\n        for (let i = 0; i < numBits; i++) {\n            drawWireLineToComponent(g, this.inputs.In[i])\n        }\n        drawWireLineToComponent(g, output)\n\n        // prepare main fill\n        g.lineWidth = 3\n        g.strokeStyle = gateBorderColor\n        g.fillStyle = gateFill\n\n        switch (type) {\n            case \"not\":\n            case \"buf\": {\n                g.beginPath()\n                g.moveTo(left, top)\n                g.lineTo(right, this.posY)\n                g.lineTo(left, bottom)\n                g.closePath()\n                g.fill()\n                g.stroke()\n                if (type === \"not\") {\n                    drawInversionCircle(right + 5, this.posY)\n                }\n                nameDeltaX = -7\n                break\n            }\n\n            case \"and\":\n            case \"nand\":\n            case \"nimply\":\n            case \"rnimply\": {\n                const arcBeginX = right - height / 2\n                g.beginPath()\n                g.moveTo(arcBeginX, bottom)\n                g.lineTo(left, bottom)\n                g.lineTo(left, top)\n                g.lineTo(arcBeginX, top)\n                g.arc(arcBeginX, this.posY, height / 2, -pi2, pi2)\n                g.closePath()\n                g.fill()\n                g.lineWidth = 1\n                g.stroke()\n                g.strokeStyle = gateBorderColor\n                g.lineWidth = 3\n                g.stroke()\n                g.beginPath()\n                if (type.startsWith(\"nand\")) {\n                    drawInversionCircle(right + 5, this.posY)\n                }\n                if (type === \"nimply\") {\n                    drawInversionCircle(left - 5, this.posY + GRID_STEP)\n                } else if (type === \"rnimply\") {\n                    drawInversionCircle(left - 5, this.posY - GRID_STEP)\n                }\n                nameDeltaX = -2\n                if (drawArms) {\n                    g.moveTo(left, armsTop)\n                    g.lineTo(left, armsBottom)\n                    g.stroke()\n                }\n                break\n            }\n\n            case \"or\":\n            case \"nor\":\n            case \"xor\":\n            case \"xnor\":\n            case \"imply\":\n            case \"rimply\": {\n                const leftCurve = 12\n                g.beginPath()\n                g.moveTo(this.posX - 15, top)\n                g.bezierCurveTo(this.posX + 10, top, right - 5, this.posY - 8,\n                    right, this.posY)\n                g.bezierCurveTo(right - 5, this.posY + 8, this.posX + 10, bottom,\n                    left, bottom)\n                g.quadraticCurveTo(left + leftCurve, this.posY, left, top)\n                g.closePath()\n                g.fill()\n                g.stroke()\n\n                const armsHeight = armsBottom - bottom\n                const armsCurvature = Math.min(leftCurve, armsHeight / 4)\n                if (drawArms) {\n                    g.beginPath()\n                    g.moveTo(left, bottom)\n                    g.quadraticCurveTo(left + armsCurvature, bottom + armsHeight / 2, left, armsBottom)\n                    g.moveTo(left, top)\n                    g.quadraticCurveTo(left + armsCurvature, top - armsHeight / 2, left, armsTop)\n                    g.stroke()\n                }\n\n                if (type.startsWith(\"nor\") || type.startsWith(\"xnor\")) {\n                    drawInversionCircle(right + 5, this.posY)\n                }\n                if (type === \"imply\") {\n                    drawInversionCircle(left - 2, this.posY - GRID_STEP)\n                } else if (type === \"rimply\") {\n                    drawInversionCircle(left - 2, this.posY + GRID_STEP)\n                }\n                if (type.startsWith(\"x\")) {\n                    g.lineWidth = 3\n                    const leftXorCurve = (delta: number) => {\n                        g.beginPath()\n                        if (drawArms) {\n                            g.moveTo(left - delta, armsBottom)\n                            g.quadraticCurveTo(left + armsCurvature - delta, bottom + armsHeight / 2, left - delta, bottom)\n                            g.quadraticCurveTo(left + leftCurve - delta, this.posY, left - delta, top)\n                            g.quadraticCurveTo(left + armsCurvature - delta, top - armsHeight / 2, left - delta, armsTop)\n                        } else {\n                            // simple\n                            g.moveTo(left - delta, bottom)\n                            g.quadraticCurveTo(left + leftCurve - delta, this.posY, left - delta, top)\n                        }\n                    }\n\n                    // clear the \"middle\"\n                    leftXorCurve(3)\n                    g.strokeStyle = COLOR_BACKGROUND\n                    g.stroke()\n\n                    // left additional line for x gates\n                    leftXorCurve(6)\n                    g.strokeStyle = gateBorderColor\n                    g.stroke()\n                }\n                nameDeltaX = 1\n                break\n            }\n\n            case \"txa\":\n            case \"txna\": {\n                g.beginPath()\n                g.moveTo(left, bottom)\n                g.lineTo(left, top)\n                g.lineTo(right, this.posY + 0.5)\n                g.lineTo(left + 2, this.posY + 0.5)\n                g.fill()\n                g.stroke()\n                if (type === \"txna\") {\n                    drawInversionCircle(left - 5, this.posY - GRID_STEP)\n                }\n                break\n            }\n\n            case \"txb\":\n            case \"txnb\": {\n                g.beginPath()\n                g.moveTo(left, top)\n                g.lineTo(left, bottom)\n                g.lineTo(right, this.posY - 0.5)\n                g.lineTo(left + 2, this.posY - 0.5)\n                g.fill()\n                g.stroke()\n                if (type === \"txnb\") {\n                    drawInversionCircle(left - 5, this.posY + GRID_STEP)\n                }\n                break\n            }\n\n            case \"?\": {\n                const gateRightSquare = left + (bottom - top)\n                g.strokeStyle = ctx.isMouseOver ? COLOR_MOUSE_OVER : COLOR_UNKNOWN\n                g.beginPath()\n                g.moveTo(left, top)\n                g.lineTo(gateRightSquare, top)\n                g.lineTo(gateRightSquare, bottom)\n                g.lineTo(left, bottom)\n                g.closePath()\n                g.fill()\n                g.stroke()\n                if (drawArms) {\n                    g.moveTo(left, armsTop)\n                    g.lineTo(left, armsBottom)\n                    g.stroke()\n                }\n                g.lineWidth = 0\n\n                ctx.inNonTransformedFrame(() => {\n                    g.fillStyle = COLOR_UNKNOWN\n                    g.textAlign = \"center\"\n                    g.font = \"bold 20px sans-serif\"\n                    fillTextVAlign(g, TextVAlign.middle, '?', (left + gateRightSquare) / 2, this.posY)\n                })\n                break\n            }\n        }\n\n        if (this.parent.editor.options.showGateTypes && !isUnknown(type)) {\n            const gateShortName = this.gateTypes(this.numBits).props[type].fullShortDesc()[1]\n            if (gateShortName !== undefined) {\n                g.fillStyle = COLOR_GATE_NAMES\n                g.font = \"bold 13px sans-serif\"\n                const oldTransform = g.getTransform()\n                g.translate(this.posX + nameDeltaX, this.posY)\n                g.scale(0.65, 1)\n                g.textAlign = \"center\"\n                fillTextVAlign(g, TextVAlign.middle, gateShortName, 0, 0)\n                g.setTransform(oldTransform)\n            }\n        }\n    }\n\n    public override pointerDoubleClicked(e: PointerEvent) {\n        if (this.parent.mode >= Mode.FULL && e.altKey) {\n            this.doSetShowAsUnknown(!this._showAsUnknown)\n            return InteractionResult.SimpleChange\n        }\n        return super.pointerDoubleClicked(e)\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const items: MenuItems = []\n        const adminMode = this.parent.mode >= Mode.FULL\n\n        if (!this._showAsUnknown || adminMode) {\n            const replaceBy = this.makeReplaceByMenuItem()\n            if (replaceBy !== undefined) {\n                items.push(\n                    [\"start\", replaceBy]\n                )\n            }\n        }\n        if (adminMode) {\n            items.push(\n                [\"mid\", this.makePoseAsMenuItem()],\n                ...this.makeForceOutputsContextMenuItem()\n            )\n        }\n        return items\n    }\n\n    private makeReplaceByMenuItem(): MenuItem | undefined {\n        const gateTypes = this.gateTypes(this.numBits)\n        const s = S.Components.Gate.contextMenu\n        const otherTypes = gateTypes.values\n            .filter(t => t !== this._type && gateTypes.props[t].includeInContextMenu)\n            .filter(t => this.parent.editor.allowGateType(t))\n        if (otherTypes.length === 0) {\n            return undefined\n        }\n        return MenuData.submenu(\"replace\", s.ReplaceBy, [\n            ...otherTypes.map(newType => {\n                const gateProps = gateTypes.props[newType]\n                return MenuData.item(undefined, s.GateTempl.expand({ type: gateProps.fullShortDesc()[0] }), () => {\n                    const oldType = this._type\n                    this.doSetType(newType)\n                    const ref = this.ref\n                    if (ref !== undefined && ref.startsWith(oldType)) {\n                        // change the id to match the new type\n                        this.parent.components.regenerateIdOf(this)\n                    }\n                })\n            }),\n            MenuData.sep(),\n            MenuData.text(s.VariantChangeDesc),\n        ])\n    }\n\n    private makePoseAsMenuItem(): MenuItem {\n        const gateTypes = this.gateTypes(this.numBits)\n        const s = S.Components.Gate.contextMenu\n        const otherTypes = gateTypes.values.filter(t => t !== this._type && gateTypes.props[t].includeInPoseAs)\n        const currentShowAsUnknown = this._showAsUnknown\n        const currentPoseAs = this.poseAs\n        return MenuData.submenu(\"questioncircled\", s.ShowAs, [\n            MenuData.item(!currentShowAsUnknown && currentPoseAs === undefined ? \"check\" : \"none\",\n                s.NormalGateTempl.expand({ type: gateTypes.props[this._type].fullShortDesc()[0] }), () => {\n                    this.poseAs = undefined\n                    this.doSetShowAsUnknown(false)\n                }),\n            MenuData.item(currentShowAsUnknown ? \"check\" : \"none\",\n                s.UnknownGate, () => {\n                    this.poseAs = undefined\n                    this.doSetShowAsUnknown(true)\n                }),\n            MenuData.sep(),\n            ...otherTypes.map(newType => {\n                const gateProps = gateTypes.props[newType]\n                return MenuData.item(!currentShowAsUnknown && newType === currentPoseAs ? \"check\" : \"none\",\n                    s.GateTempl.expand({ type: gateProps.fullShortDesc()[0] }), () => {\n                        this.doSetShowAsUnknown(false)\n                        this.poseAs = newType\n                    })\n            }),\n        ])\n    }\n\n}\n\nexport function validateGateType<TGateType extends string>(GateTypes: RichStringEnum<string, any>, typeFromParam: TGateType, typeFromJson: string | undefined, defaultFromDef: TGateType, jsonTypeSuffix?: string): TGateType {\n    let typeToValidate\n    if (typeFromJson === undefined) {\n        typeToValidate = typeFromParam\n    } else {\n        if (jsonTypeSuffix !== undefined && typeFromJson.endsWith(jsonTypeSuffix)) {\n            typeToValidate = typeFromJson.slice(0, -jsonTypeSuffix.length)\n        } else {\n            typeToValidate = typeFromJson\n        }\n    }\n    if (!GateTypes.includes(typeToValidate)) {\n        console.error(`Invalid gate type: '${typeToValidate}'`)\n        return defaultFromDef\n    }\n    return typeToValidate as TGateType\n}\n\n\nexport const GateTypePrefix = \"gate\"\n\n\nexport const Gate1Def =\n    defineParametrizedComponent(GateTypePrefix + \"1\", true, true, {\n        variantName: ({ type }) =>\n            // return array thus overriding default component id\n            [type],\n        button: { imgWidth: 50 },\n        repr: {\n            // type not part of specific repr, using normal type field\n            poseAs: typeOrUndefined(Gate1TypeRepr),\n            showAsUnknown: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {},\n        params: {\n            type: param(\"not\" as Gate1Type),\n        },\n        validateParams: ({ type: paramType }, jsonType, defaults) => {\n            const type = validateGateType(Gate1Types, paramType, jsonType, defaults.type.defaultValue)\n            return { type }\n        },\n        idPrefix: ({ type }) => type,\n        size: () => ({\n            gridWidth: 4,\n            gridHeight: 4,\n        }),\n        makeNodes: () => ({\n            ins: { In: [[-4, 0, \"w\", { leadLength: 20 }]] },\n            outs: { Out: [+4, 0, \"e\", { leadLength: 20 }] },\n        }),\n        initialValue: () => false as LogicValue,\n    })\n\nexport type Gate1Repr = Expand<Repr<typeof Gate1Def>>\nexport type Gate1Params = ResolvedParams<typeof Gate1Def>\n\n\nexport class Gate1 extends GateBase<Gate1Repr> {\n\n    public get numBits() { return 1 }\n\n    public constructor(parent: DrawableParent, params: Gate1Params, saved?: Gate1Repr) {\n        super(parent, Gate1Def.with(params), params.type, saved)\n    }\n\n    protected gateTypes() { return Gate1Types }\n\n    public toJSON(): Gate1Repr {\n        return super.toJSONBase()\n    }\n\n    public override pointerDoubleClicked(e: PointerEvent) {\n        const superChange = super.pointerDoubleClicked(e)\n        if (superChange.isChange) {\n            return superChange // already handled\n        }\n        if (this.parent.mode >= Mode.DESIGN) {\n            this.doSetType(this.type === \"buf\" ? \"not\" : \"buf\")\n            return InteractionResult.SimpleChange\n        }\n        return InteractionResult.NoChange\n    }\n\n}\nGate1Def.impl = Gate1\n\n\n\nexport const GateNDef =\n    defineParametrizedComponent(GateTypePrefix + \"\", true, true, {\n        variantName: ({ type, bits }) =>\n            // return array thus overriding default component id\n            [type, `${type}-${bits}`],\n        button: { imgWidth: 50 },\n        repr: {\n            // type not part of specific repr, using normal type field\n            poseAs: typeOrUndefined(GateNTypeRepr),\n            showAsUnknown: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {},\n        params: {\n            bits: param(2, [2, 3, 4, 5, 6, 7, 8, 12, 16, 24, 32]),\n            type: param(\"and\" as GateNType),\n        },\n        validateParams: ({ type: paramType, bits }, jsonType, defaults) => {\n            const type = validateGateType((bits > 2) ? Gate2toNTypes : GateNTypes, paramType, jsonType, defaults.type.defaultValue)\n            return { type, numBits: bits }\n        },\n        idPrefix: ({ type }) => type,\n        size: ({ numBits }) => {\n            const tall = numBits !== 2 && numBits !== 4 && numBits !== 6\n            return {\n                gridWidth: 4,\n                gridHeight: tall ? 5 : 4,\n            }\n        },\n        makeNodes: ({ numBits }) => {\n            const leadLength = 20\n            return {\n                ins: {\n                    In: groupVertical(\"w\", -4, 0, numBits, undefined, { leadLength }),\n                },\n                outs: {\n                    Out: [4, 0, \"e\", { leadLength }],\n                },\n            }\n        },\n        initialValue: () => false as LogicValue,\n    })\n\nexport type GateNRepr = Repr<typeof GateNDef>\nexport type GateNParams = ResolvedParams<typeof GateNDef>\n\nexport class GateN extends GateBase<GateNRepr> {\n\n    public readonly numBits: number\n\n    public constructor(parent: DrawableParent, params: GateNParams, saved?: GateNRepr) {\n        super(parent, GateNDef.with(params), params.type, saved)\n        this.numBits = params.numBits\n        this.updateLeadsFor(params.type)\n    }\n\n    protected gateTypes(numBits: number) {\n        return (numBits > 2 ? Gate2toNTypes : GateNTypes) as any\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            bits: this.numBits !== GateNDef.aults.bits ? this.numBits : undefined,\n        }\n    }\n\n    public override pointerDoubleClicked(e: PointerEvent) {\n        const superChange = super.pointerDoubleClicked(e)\n        if (superChange.isChange) {\n            return superChange // already handled\n        }\n        if (this.parent.mode >= Mode.DESIGN) {\n            // switch to IMPLY / NIMPLY variant\n            const newType = (() => {\n                switch (this.type) {\n                    case \"imply\": return \"rimply\"\n                    case \"rimply\": return \"imply\"\n\n                    case \"nimply\": return \"rnimply\"\n                    case \"rnimply\": return \"nimply\"\n\n                    case \"txa\": return \"txb\"\n                    case \"txb\": return \"txna\"\n                    case \"txna\": return \"txnb\"\n                    case \"txnb\": return \"txa\"\n\n                    default: return undefined\n                }\n            })()\n            if (newType !== undefined) {\n                this.doSetType(newType)\n                return InteractionResult.SimpleChange\n            }\n        }\n        return InteractionResult.NoChange\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.Generic.contextMenu\n\n        const changeBitsItems: MenuItems = Gate2OnlyTypes.includes(this.type) ? [] : [\n            this.makeChangeParamsContextMenuItem(\"inputs\", s.ParamNumInputs, this.numBits, \"bits\"),\n            [\"mid\", MenuData.sep()],\n        ]\n\n        return [\n            ...changeBitsItems,\n            ...super.makeComponentSpecificContextMenuItems(),\n        ]\n    }\n\n}\nGateNDef.impl = GateN\n\n\n\n// Truth table generation helpers\n\nfunction* valueCombinations(n: number) {\n    let curr = 0\n    const max = 1 << n\n    while (curr < max) {\n        const binString = curr.toString(2).padStart(n, \"0\")\n        const valueArray = binString.split(\"\").reverse().map(v => (v === \"1\") as LogicValue)\n        yield valueArray\n        curr++\n    }\n}\n\ntype TruthTableRowData = { matchesCurrent: boolean, cells: LogicValue[] }\nfunction makeTruthTable([header, rows]: readonly [string[], TruthTableRowData[]]) {\n    const htmlRows = rows.map(({ matchesCurrent, cells }) =>\n        tr(matchesCurrent ? cls(\"current\") : emptyMod, ...cells.map(v => td(asValue(v))))\n    )\n    return table(cls(\"truth-table\"),\n        thead(tr(...header.map(title =>\n            th(title))\n        )),\n        tbody(...htmlRows)\n    )\n}\nfunction makeGateTooltip(numBits: number, title: Modifier, description: Modifier, explanationAndTable: Modifier): ModifierObject {\n    const numBitsDisplay = Math.min(4, numBits)\n    const maxWidth = 200 + (Math.max(0, numBitsDisplay - 2)) * 50\n    return tooltipContent(title, mods(div(description), div(explanationAndTable)), maxWidth)\n}\n", "import * as t from \"io-ts\"\nimport { circle, COLOR_COMPONENT_BORDER, COLOR_UNKNOWN, fillTextVAlign, GRID_STEP, TextVAlign } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillUsing, ArrayFillWith, LogicValue, Mode, typeOrUndefined } from \"../utils\"\nimport { AdderArrayDef } from \"./AdderArray\"\nimport { defineParametrizedComponent, groupVertical, param, ParametrizedComponentBase, Repr, ResolvedParams } from \"./Component\"\nimport { DrawableParent, DrawContext, GraphicsRendering, MenuData, MenuItems } from \"./Drawable\"\nimport { GateTypePrefix, validateGateType } from \"./Gate\"\nimport { GateNType, GateNTypes } from \"./GateTypes\"\n\n\nexport const GateArrayDef =\n    defineParametrizedComponent(GateTypePrefix + \"-array\", true, true, {\n        variantName: ({ type, bits }) =>\n            // return array thus overriding default component id\n            [`gate-array`, `${type}-array`, `${type}-array-${bits}`],\n        idPrefix: \"array\",\n        button: { imgWidth: 50 },\n        repr: {\n            // type not part of specific repr, using normal type field\n            bits: typeOrUndefined(t.number),\n            showAsUnknown: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {\n            showAsUnknown: false,\n        },\n        params: {\n            bits: param(4, [2, 4, 8, 16]),\n            type: param(\"and\" as GateNType, GateNTypes.values),\n        },\n        validateParams: ({ type: paramType, bits }, jsonType, defaults) => {\n            const type = validateGateType(GateNTypes, paramType, jsonType, defaults.type.defaultValue, \"-array\")\n            return { type, numBits: bits }\n        },\n        size: AdderArrayDef.size,\n        makeNodes: ({ numBits }) => {\n            const inputCenterY = 5 + Math.max(0, (numBits - 8) / 2)\n            return {\n                ins: {\n                    A: groupVertical(\"w\", -3, -inputCenterY, numBits),\n                    B: groupVertical(\"w\", -3, inputCenterY, numBits),\n                },\n                outs: {\n                    S: groupVertical(\"e\", 3, 0, numBits),\n                },\n            }\n        },\n        initialValue: (saved, { numBits }) => ArrayFillWith<LogicValue>(false, numBits),\n    })\n\n\nexport type GateArrayRepr = Repr<typeof GateArrayDef>\nexport type GateArrayParams = ResolvedParams<typeof GateArrayDef>\n\nexport class GateArray extends ParametrizedComponentBase<GateArrayRepr> {\n\n    public readonly numBits: number\n    private _type: GateNType\n    private _showAsUnknown: boolean\n\n    public constructor(parent: DrawableParent, params: GateArrayParams, saved?: GateArrayRepr) {\n        super(parent, GateArrayDef.with(params), saved)\n\n        this.numBits = params.numBits\n        this._type = params.type\n        this._showAsUnknown = saved?.showAsUnknown ?? GateArrayDef.aults.showAsUnknown\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            bits: this.numBits === GateArrayDef.aults.bits ? undefined : this.numBits,\n            showAsUnknown: this._showAsUnknown === GateArrayDef.aults.showAsUnknown ? undefined : this._showAsUnknown,\n        }\n    }\n\n    protected override jsonType(): string {\n        return `${this._type}-array`\n    }\n\n    public get type() {\n        return this._type\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.GateArray.tooltip\n        const opDesc = S.Components.Gate[this._type][0]\n        return tooltipContent(s.title, mods(\n            div(s.desc.expand({ op: opDesc })),\n        ))\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        const out = GateNTypes.props[this._type].out\n        const a = this.inputValues(this.inputs.A)\n        const b = this.inputValues(this.inputs.B)\n        return ArrayFillUsing(i => out([a[i], b[i]]), this.numBits)\n    }\n\n    protected override propagateValue(newValue: LogicValue[]) {\n        this.outputValues(this.outputs.S, newValue)\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, {\n            skipLabels: true,\n            drawInside: ({ left, right }) => {\n                if (this._showAsUnknown) {\n                    ctx.inNonTransformedFrame(() => {\n                        g.fillStyle = COLOR_UNKNOWN\n                        g.font = \"bold 20px sans-serif\"\n                        g.textAlign = \"center\"\n                        fillTextVAlign(g, TextVAlign.middle, '?', this.posX, this.posY)\n                    })\n                } else {\n                    // draw gate type\n                    g.lineWidth = 2\n                    g.strokeStyle = COLOR_COMPONENT_BORDER\n                    g.beginPath()\n\n                    const top = this.posY - GRID_STEP\n                    const bottom = this.posY + GRID_STEP\n                    let gateLeft = left + 10\n                    const gateRight = right - 10\n                    const pi2 = Math.PI / 2\n                    const type = this._type\n\n                    const drawRightCircle = () => {\n                        g.beginPath()\n                        circle(g, gateRight + 3, this.posY, 5)\n                        g.stroke()\n                    }\n                    const drawLeftCircle = (up: boolean) => {\n                        g.beginPath()\n                        circle(g, gateLeft - 3, this.posY - (up ? 1 : -1) * 4, 5)\n                        g.stroke()\n                    }\n\n                    switch (type) {\n                        case \"and\":\n                        case \"nand\":\n                        case \"nimply\":\n                        case \"rnimply\": {\n                            g.moveTo(this.posX, bottom)\n                            g.lineTo(gateLeft, bottom)\n                            g.lineTo(gateLeft, top)\n                            g.lineTo(this.posX, top)\n                            g.arc(this.posX, this.posY, GRID_STEP, -pi2, pi2)\n                            g.closePath()\n                            g.stroke()\n                            g.beginPath()\n                            if (type.startsWith(\"nand\")) {\n                                drawRightCircle()\n                            }\n                            if (type === \"nimply\") {\n                                drawLeftCircle(false)\n                            } else if (type === \"rnimply\") {\n                                drawLeftCircle(true)\n                            }\n                            break\n                        }\n\n                        case \"or\":\n                        case \"nor\":\n                        case \"xor\":\n                        case \"xnor\":\n                        case \"imply\":\n                        case \"rimply\": {\n                            g.beginPath()\n                            g.moveTo(gateLeft, top)\n                            g.lineTo(this.posX - 5, top)\n                            g.bezierCurveTo(this.posX + 2, top, gateRight - 5, this.posY - 8,\n                                gateRight, this.posY)\n                            g.bezierCurveTo(gateRight - 5, this.posY + 8, this.posX + 2, bottom,\n                                this.posX - 5, bottom)\n                            g.lineTo(gateLeft, bottom)\n                            g.quadraticCurveTo(this.posX - 4, this.posY, gateLeft, top)\n                            g.closePath()\n                            g.stroke()\n                            const savedGateLeft = gateLeft\n                            gateLeft += 2\n                            if (type.startsWith(\"nor\") || type.startsWith(\"xnor\")) {\n                                drawRightCircle()\n                            }\n                            if (type === \"imply\") {\n                                drawLeftCircle(true)\n                            } else if (type === \"rimply\") {\n                                drawLeftCircle(false)\n                            }\n                            if (type.startsWith(\"x\")) {\n                                g.beginPath()\n                                g.moveTo(savedGateLeft - 4, bottom)\n                                g.quadraticCurveTo(this.posX - 8, this.posY, savedGateLeft - 4, top)\n                                g.stroke()\n                            }\n                            break\n                        }\n\n                        case \"txa\":\n                        case \"txna\": {\n                            g.beginPath()\n                            g.moveTo(gateLeft, bottom)\n                            g.lineTo(gateLeft, top)\n                            g.lineTo(gateRight, this.posY)\n                            g.lineTo(gateLeft + 2, this.posY)\n                            g.stroke()\n                            if (type === \"txna\") {\n                                drawLeftCircle(true)\n                            }\n                            break\n                        }\n\n                        case \"txb\":\n                        case \"txnb\": {\n                            g.beginPath()\n                            g.moveTo(gateLeft, top)\n                            g.lineTo(gateLeft, bottom)\n                            g.lineTo(gateRight, this.posY)\n                            g.lineTo(gateLeft + 2, this.posY)\n                            g.stroke()\n                            if (type === \"txnb\") {\n                                drawLeftCircle(false)\n                            }\n                            break\n                        }\n                    }\n                }\n            },\n        })\n    }\n\n    private doSetType(newSubtype: GateNType) {\n        this._type = newSubtype\n        this.setNeedsRecalc()\n        this.requestRedraw({ why: \"quad gate type changed\", invalidateTests: true })\n    }\n\n    private doSetShowAsUnknown(showAsUnknown: boolean) {\n        this._showAsUnknown = showAsUnknown\n        this.requestRedraw({ why: \"display as unknown changed\" })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.GateArray.contextMenu\n\n        const typeItems: MenuData = []\n        const subtypes = ([\"and\", \"or\", \"xor\", \"nand\", \"nor\", \"xnor\", \"-\", \"imply\", \"rimply\", \"nimply\", \"rnimply\"] as const)\n            .filter(t => this.parent.editor.allowGateType(t))\n\n        if (subtypes.length !== 0) {\n            // remove leading or trailing \"-\" if present\n            if (subtypes[0] === \"-\") {\n                subtypes.shift()\n            } else if (subtypes[subtypes.length - 1] === \"-\") {\n                subtypes.pop()\n            }\n\n            for (const subtype of subtypes) {\n                if (subtype === \"-\") {\n                    typeItems.push(MenuData.sep())\n                } else {\n                    const icon = this._type === subtype ? \"check\" : \"none\"\n                    typeItems.push(MenuData.item(icon, subtype.toUpperCase(), () => {\n                        this.doSetType(subtype)\n                    }))\n                }\n            }\n        }\n\n        const items: MenuItems = []\n\n        if (typeItems.length >= 2) {\n            // 2 because a choice of 1 is just a direct item\n            items.push([\"mid\", MenuData.submenu(\"settings\", s.Type, typeItems)])\n        }\n\n        if (this.parent.mode >= Mode.FULL) {\n            const showAsUnknownItem = MenuData.item(this._showAsUnknown ? \"check\" : \"none\", s.ShowAsUnknown, () => {\n                this.doSetShowAsUnknown(!this._showAsUnknown)\n            })\n\n            items.push(\n                [\"mid\", showAsUnknownItem],\n            )\n        }\n\n        items.push(\n            [\"mid\", MenuData.sep()],\n            this.makeChangeParamsContextMenuItem(\"inputs\", S.Components.Generic.contextMenu.ParamNumBits, this.numBits, \"bits\"),\n            ...this.makeForceOutputsContextMenuItem(true)\n        )\n\n        return items\n    }\n\n}\nGateArrayDef.impl = GateArray\n", "import { COLOR_COMPONENT_BORDER, TextVAlign, fillTextVAlign } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { LogicValue, Unknown, isHighImpedance, isUnknown } from \"../utils\"\nimport { ComponentBase, Repr, defineComponent } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuItems } from \"./Drawable\"\n\n\nexport const HalfAdderDef =\n    defineComponent(\"halfadder\", {\n        idPrefix: \"hadder\",\n        button: { imgWidth: 50 },\n        valueDefaults: {},\n        size: { gridWidth: 4, gridHeight: 6 },\n        makeNodes: () => {\n            const s = S.Components.Generic\n            return {\n                ins: {\n                    A: [-4, -2, \"w\", \"A\", { hasTriangle: true }],\n                    B: [-4, 2, \"w\", \"B\", { hasTriangle: true }],\n                },\n                outs: {\n                    S: [4, -2, \"e\", s.OutputSumDesc, { hasTriangle: true }],\n                    C: [4, 2, \"e\", s.OutputCarryDesc, { hasTriangle: true }],\n                },\n            }\n        },\n        initialValue: () => ({ s: false as LogicValue, c: false as LogicValue }),\n    })\n\ntype HalfAdderRepr = Repr<typeof HalfAdderDef>\n\nexport class HalfAdder extends ComponentBase<HalfAdderRepr> {\n\n    public constructor(parent: DrawableParent, saved?: HalfAdderRepr) {\n        super(parent, HalfAdderDef, saved)\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.HalfAdder.tooltip\n        return tooltipContent(s.title, mods(\n            div(s.desc)\n        ))\n    }\n\n    protected doRecalcValue() {\n        const a = this.inputs.A.value\n        const b = this.inputs.B.value\n\n        if (isUnknown(a) || isUnknown(b) || isHighImpedance(a) || isHighImpedance(b)) {\n            return { s: Unknown, c: Unknown }\n        }\n\n        const sum = (+a) + (+b)\n        switch (sum) {\n            case 0: return { s: false, c: false }\n            case 1: return { s: true, c: false }\n            case 2: return { s: false, c: true }\n            default:\n                console.log(\"ERROR: sum of halfadder is > 2\")\n                return { s: false, c: false }\n        }\n    }\n\n    protected override propagateValue(newValue: { s: LogicValue, c: LogicValue }) {\n        this.outputs.S.value = newValue.s\n        this.outputs.C.value = newValue.c\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, () => {\n            g.fillStyle = COLOR_COMPONENT_BORDER\n            g.font = \"26px sans-serif\"\n            g.textAlign = \"center\"\n            fillTextVAlign(g, TextVAlign.middle, \"+\", this.posX, this.posY - 2)\n        })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        return this.makeForceOutputsContextMenuItem()\n    }\n\n}\nHalfAdderDef.impl = HalfAdder\n", "import * as t from \"io-ts\"\nimport { COLOR_COMPONENT_BORDER, DrawZIndex, FONT_LABEL_DEFAULT, GRID_STEP, TextVAlign, fillTextVAlign } from \"../drawutils\"\nimport { S } from \"../strings\"\nimport { InteractionResult, typeOrUndefined } from \"../utils\"\nimport { ComponentBase, Repr, defineComponent } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems } from \"./Drawable\"\n\nexport const LabelDef =\n    defineComponent(\"label\", {\n        idPrefix: \"label\",\n        button: { imgWidth: 32 },\n        repr: {\n            text: t.string,\n            // align: typeOrUndefined(t.string), \n            font: typeOrUndefined(t.string),\n        },\n        valueDefaults: {\n            text: \"Label\",\n            // align: \"center\" as const,\n            font: FONT_LABEL_DEFAULT,\n        },\n        size: { gridWidth: 4, gridHeight: 2 }, // overridden\n        makeNodes: () => ({}),\n    })\n\nexport type LabelRepr = Repr<typeof LabelDef>\n\nexport class Label extends ComponentBase<LabelRepr> {\n\n    private _text: string\n    // private _align: CanvasTextAlign // causes issues with mouseovers and stuff\n    private _font: string\n    private _cachedTextMetrics: TextMetrics | undefined = undefined\n\n    public constructor(parent: DrawableParent, saved?: LabelRepr) {\n        super(parent, LabelDef, saved)\n        this._text = saved?.text ?? LabelDef.aults.text\n        // this._align = (saved?.align as CanvasTextAlign) ?? LabelStringDefaults.align\n        this._font = saved?.font ?? LabelDef.aults.font\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            text: this._text,\n            // align: this._align === LabelStringDefaults.align ? undefined : this._align,\n            font: this._font === LabelDef.aults.font ? undefined : this._font,\n        }\n    }\n\n    public override get unrotatedWidth() {\n        return this._cachedTextMetrics?.width ?? GRID_STEP * this._text.length\n    }\n\n    public override get unrotatedHeight() {\n        const metrics = this._cachedTextMetrics\n        if (metrics === undefined) {\n            return 2 * GRID_STEP\n        }\n        return metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent\n    }\n\n    public get text() {\n        return this._text\n    }\n\n    protected doRecalcValue(): undefined {\n        return undefined\n    }\n\n    public override get drawZIndex(): DrawZIndex {\n        return DrawZIndex.Overlay\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        g.font = this._font\n        g.lineWidth = 3\n\n        if (ctx.isMouseOver) {\n            if (this._cachedTextMetrics === undefined) {\n                this._cachedTextMetrics = g.measureText(this._text)\n            }\n            const width = this.unrotatedWidth\n            const height = this.unrotatedHeight\n            g.strokeStyle = ctx.borderColor\n            g.beginPath()\n            g.rect(this.posX - width / 2, this.posY - height / 2, width, height)\n            g.stroke()\n        }\n\n        g.fillStyle = COLOR_COMPONENT_BORDER\n        g.textAlign = \"center\"\n        fillTextVAlign(g, TextVAlign.middle, this._text, this.posX, this.posY)\n    }\n\n    private doSetText(text: string) {\n        this._text = text\n        this._cachedTextMetrics = undefined\n        this.requestRedraw({ why: \"text changed\", invalidateMask: true })\n    }\n\n    private doSetFont(font: string) {\n        this._font = font\n        this._cachedTextMetrics = undefined\n        this.requestRedraw({ why: \"font changed\", invalidateMask: true })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.Label.contextMenu\n        const setTextItem = MenuData.item(\"pen\", s.ChangeText, this.runSetTextDialog.bind(this), \"\u21A9\uFE0E\")\n\n        const setFontItem = MenuData.item(\"font\", s.Font, () => {\n            this.runSetFontDialog(this._font, LabelDef.aults.font, this.doSetFont.bind(this))\n        })\n\n        return [\n            [\"mid\", setTextItem],\n            [\"mid\", setFontItem],\n        ]\n    }\n\n    private runSetTextDialog(): InteractionResult {\n        const promptReturnValue = window.prompt(S.Components.Label.contextMenu.ChangeTextPrompt, this._text)\n        if (promptReturnValue !== null) {\n            // OK button pressed\n            const newText = promptReturnValue.length === 0 ? LabelDef.aults.text : promptReturnValue\n            this.doSetText(newText)\n            return InteractionResult.SimpleChange\n        }\n        return InteractionResult.NoChange\n    }\n\n    public override keyDown(e: KeyboardEvent): void {\n        if (e.key === \"Enter\" && !e.altKey) {\n            this.runSetTextDialog()\n        } else {\n            super.keyDown(e)\n        }\n    }\n\n    public override pointerDoubleClicked(e: PointerEvent) {\n        const superChange = super.pointerDoubleClicked(e)\n        if (superChange.isChange) {\n            return superChange // already handled\n        }\n        return this.runSetTextDialog()\n    }\n\n}\nLabelDef.impl = Label\n", "import { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { LogicValue } from \"../utils\"\nimport { Repr, defineComponent } from \"./Component\"\nimport { DrawableParent, MenuData, MenuItems } from \"./Drawable\"\nimport { FlipflopOrLatch, FlipflopOrLatchDef } from \"./FlipflopOrLatch\"\n\n\nexport const LatchSRDef =\n    defineComponent(\"latch-sr\", {\n        idPrefix: \"latch\",\n        ...FlipflopOrLatchDef,\n        makeNodes: () => {\n            const base = FlipflopOrLatchDef.makeNodes()\n            const s = S.Components.Generic\n            return {\n                ins: {\n                    S: [-4, -2, \"w\", s.InputSetDesc, { prefersSpike: true }],\n                    R: [-4, 2, \"w\", s.InputResetDesc, { prefersSpike: true }],\n                },\n                outs: base.outs,\n            }\n        },\n    })\n\ntype LatchSRRepr = Repr<typeof LatchSRDef>\n\nexport class LatchSR extends FlipflopOrLatch<LatchSRRepr> {\n\n    public constructor(parent: DrawableParent, saved?: LatchSRRepr) {\n        super(parent, LatchSRDef, saved)\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.LatchSR.tooltip\n        return tooltipContent(s.title, mods(\n            div(s.desc) // TODO more info\n        ))\n    }\n\n    protected doRecalcValue(): [LogicValue, LogicValue] {\n        const s = this.inputs.S.value\n        const r = this.inputs.R.value\n\n        // assume this state is valid\n        this._isInInvalidState = false\n\n        // handle set and reset signals\n        if (s === true) {\n            if (r === true) {\n                this._isInInvalidState = true\n                return [false, false]\n            } else {\n                // set is true, reset is false, set output to 1\n                return [true, false]\n            }\n        }\n        if (r === true) {\n            // set is false, reset is true, set output to 0\n            return [false, true]\n        }\n\n        // no change\n        const q = this.outputs.Q.value\n        return [q, LogicValue.invert(q)]\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const icon = this._showContent ? \"check\" : \"none\"\n        const toggleShowContentItem = MenuData.item(icon, S.Components.Generic.contextMenu.ShowContent, () => {\n            this.doSetShowContent(!this._showContent)\n        })\n\n        return [\n            [\"mid\", toggleShowContentItem],\n            ...this.makeForceOutputsContextMenuItem(true),\n        ]\n    }\n\n}\nLatchSRDef.impl = LatchSR\n", "import * as t from \"io-ts\"\nimport { COLOR_BACKGROUND, displayValuesFromArray, drawWireLineToComponent, strokeWireOutlineAndSingleValue, useCompact } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, LogicValue, Unknown, isUnknown, typeOrUndefined } from \"../utils\"\nimport { ParametrizedComponentBase, Repr, ResolvedParams, defineParametrizedComponent, groupHorizontal, groupVertical, groupVerticalMulti, param, paramBool } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems } from \"./Drawable\"\nimport { WireStyles } from \"./Wire\"\n\n\nexport const MuxDef =\n    defineParametrizedComponent(\"mux\", true, true, {\n        variantName: ({ from, to, bottom }) => `mux-${from}to${to}${bottom ? \"b\" : \"\"}`,\n        idPrefix: \"mux\",\n        button: { imgWidth: 50 },\n        repr: {\n            from: typeOrUndefined(t.number),\n            to: typeOrUndefined(t.number),\n            bottom: typeOrUndefined(t.boolean),\n            showWiring: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {\n            showWiring: true,\n        },\n        params: {\n            to: param(2, [1, 2, 4, 8, 16]),\n            from: param(4),\n            bottom: paramBool(),\n        },\n        validateParams: ({ from, to, bottom }) => {\n            // reference is 'to'; 'from' is clamped to be between 2*to and 16*to\n            const numFrom = Math.min(16 * to, Math.max(2 * to, from))\n            const numGroups = Math.ceil(numFrom / to)\n            const numSel = Math.ceil(Math.log2(numGroups))\n            return { numFrom, numTo: to, numGroups, numSel, controlPinsAtBottom: bottom }\n        },\n        size: ({ numFrom, numTo, numGroups, numSel }) => {\n            const gridWidth = 2 * numSel\n            const spacing = useCompact(numTo === 1 ? numFrom : numTo) ? 1 : 2\n            const addByGroupSep = numTo > 1 ? 1 : 0\n            const numLeftSlots = numFrom + (numGroups - 1) * addByGroupSep\n            const gridHeight = 1 + spacing * numLeftSlots\n            return { gridWidth, gridHeight }\n        },\n        makeNodes: ({ numTo, numGroups, numSel, controlPinsAtBottom }) => {\n            const outX = 1 + numSel\n            const inX = -outX\n\n            const groupOfInputs = groupVerticalMulti(\"w\", inX, 0, numGroups, numTo)\n            const firstInputY = groupOfInputs[0][0][1]\n            const lastGroup = groupOfInputs[groupOfInputs.length - 1]\n            const lastInputY = lastGroup[lastGroup.length - 1][1]\n            const selY = controlPinsAtBottom ? lastInputY + 2 : firstInputY - 2\n\n            return {\n                ins: {\n                    I: groupOfInputs,\n                    S: groupHorizontal(controlPinsAtBottom ? \"s\" : \"n\", 0, selY, numSel, undefined, { leadLength: 35 }),\n                },\n                outs: {\n                    Z: groupVertical(\"e\", outX, 0, numTo),\n                },\n            }\n        },\n        initialValue: (saved, { numTo }) => ArrayFillWith<LogicValue>(false, numTo),\n    })\n\n\nexport type MuxRepr = Repr<typeof MuxDef>\nexport type MuxParams = ResolvedParams<typeof MuxDef>\n\nexport class Mux extends ParametrizedComponentBase<MuxRepr> {\n\n    public readonly numFrom: number\n    public readonly numTo: number\n    public readonly numGroups: number\n    public readonly numSel: number\n    public readonly controlPinsAtBottom: boolean\n    private _showWiring: boolean\n\n    public constructor(parent: DrawableParent, params: MuxParams, saved?: MuxRepr) {\n        super(parent, MuxDef.with(params), saved)\n\n        this.numFrom = params.numFrom\n        this.numTo = params.numTo\n        this.numGroups = params.numGroups\n        this.numSel = params.numSel\n        this.controlPinsAtBottom = params.controlPinsAtBottom\n\n        this._showWiring = saved?.showWiring ?? MuxDef.aults.showWiring\n    }\n\n    public override toJSON() {\n        return {\n            ...super.toJSONBase(),\n            from: this.numFrom,\n            to: this.numTo,\n            bottom: this.controlPinsAtBottom === MuxDef.aults.bottom ? undefined : this.controlPinsAtBottom,\n            showWiring: (this._showWiring !== MuxDef.aults.showWiring) ? this._showWiring : undefined,\n        }\n    }\n\n    public override makeTooltip() {\n        return tooltipContent(undefined, mods(\n            div(S.Components.Mux.tooltip.expand({ from: this.numFrom, to: this.numTo }))\n        ))\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        const sels = this.inputValues(this.inputs.S)\n        const sel = displayValuesFromArray(sels, false)[1]\n\n        if (isUnknown(sel)) {\n            return ArrayFillWith(Unknown, this.numTo)\n        }\n        return this.inputValues(this.inputs.I[sel])\n    }\n\n    protected override propagateValue(newValues: LogicValue[]) {\n        this.outputValues(this.outputs.Z, newValues)\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        const { top, left, bottom, right } = this.bounds()\n        const dy = (right - left) / 3\n\n        // inputs\n        for (const inputGroup of this.inputs.I) {\n            for (const input of inputGroup) {\n                drawWireLineToComponent(g, input)\n            }\n        }\n\n        // selectors\n        for (const sel of this.inputs.S) {\n            drawWireLineToComponent(g, sel)\n        }\n\n        // outputs\n        for (const output of this.outputs.Z) {\n            drawWireLineToComponent(g, output)\n        }\n\n        // background\n        g.fillStyle = COLOR_BACKGROUND\n        const outline = g.createPath()\n        outline.moveTo(left, top)\n        outline.lineTo(right, top + dy)\n        outline.lineTo(right, bottom - dy)\n        outline.lineTo(left, bottom)\n        outline.closePath()\n        g.fill(outline)\n\n        // wiring\n        if (this._showWiring) {\n            const sels = this.inputValues(this.inputs.S)\n            const sel = displayValuesFromArray(sels, false)[1]\n            if (!isUnknown(sel)) {\n                const neutral = this.parent.editor.options.hideWireColors\n                const selectedInputs = this.inputs.I[sel]\n                const anchorDiffX = (right - left) / 3\n                const wireStyle = this.parent.editor.options.wireStyle\n                const wireStyleBezier = wireStyle === WireStyles.bezier || wireStyle === WireStyles.auto\n                const timeFraction = ctx.drawParams.drawTimeAnimationFraction\n\n                for (let i = 0; i < selectedInputs.length; i++) {\n                    this.parent.editor.options.wireStyle\n                    g.beginPath()\n                    const fromY = selectedInputs[i].posYInParentTransform\n                    const toNode = this.outputs.Z[i]\n                    const toY = toNode.posYInParentTransform\n                    g.moveTo(left + 1, fromY)\n                    if (!wireStyleBezier) {\n                        g.lineTo(left + 3, fromY)\n                        g.lineTo(right - 3, toY)\n                        g.lineTo(right - 1, toY)\n                    } else {\n                        g.bezierCurveTo(\n                            left + anchorDiffX, fromY, // anchor left\n                            right - anchorDiffX, toY, // anchor right\n                            right - 1, toY,\n                        )\n                    }\n                    strokeWireOutlineAndSingleValue(g, selectedInputs[i].value, toNode.color, neutral, timeFraction)\n                }\n            }\n        }\n\n        // outline\n        g.lineWidth = 3\n        g.strokeStyle = ctx.borderColor\n        g.stroke(outline)\n\n    }\n\n    private doSetShowWiring(showWiring: boolean) {\n        this._showWiring = showWiring\n        this.requestRedraw({ why: \"show wiring changed\" })\n    }\n\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.MuxDemux.contextMenu\n        const icon = this._showWiring ? \"check\" : \"none\"\n        const toggleShowWiringItem = MenuData.item(icon, s.ShowWiring, () => {\n            this.doSetShowWiring(!this._showWiring)\n        })\n\n        return [\n            this.makeChangeParamsContextMenuItem(\"outputs\", s.ParamNumTo, this.numTo, \"to\"),\n            this.makeChangeParamsContextMenuItem(\"inputs\", s.ParamNumFrom, this.numFrom, \"from\", [2, 4, 8, 16].map(x => x * this.numTo)),\n            [\"mid\", MenuData.sep()],\n            this.makeChangeBooleanParamsContextMenuItem(this.numSel === 1 ? S.Components.Generic.contextMenu.ParamControlBitAtBottom : S.Components.Generic.contextMenu.ParamControlBitsAtBottom, this.controlPinsAtBottom, \"bottom\"),\n            [\"mid\", toggleShowWiringItem],\n            ...this.makeForceOutputsContextMenuItem(true),\n        ]\n    }\n\n}\nMuxDef.impl = Mux", "import * as t from \"io-ts\"\nimport { COLORCOMPS_UNKNOWN, displayValuesFromArray, useCompact } from \"../drawutils\"\nimport { mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { Mode, isUnknown, typeOrUndefined } from \"../utils\"\nimport { ParametrizedComponentBase, Repr, ResolvedParams, defineParametrizedComponent, groupHorizontal, groupVertical, param, paramBool } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems } from \"./Drawable\"\n\n\nexport const PixelDef =\n    defineParametrizedComponent(\"pixel\", true, true, {\n        variantName: ({ bits, gray, touch }) => `pixel${gray ? \"-gray\" : \"\"}${touch ? \"-touch\" : \"\"}-${bits}`,\n        idPrefix: \"pixel\",\n        button: { imgWidth: 32 },\n        repr: {\n            full: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {\n            full: true,\n        },\n        params: {\n            bits: param(2, [1, 2, 4, 8]),\n            touch: paramBool(),\n            gray: paramBool(),\n        },\n        validateParams: ({ bits, touch, gray }) => ({\n            numBits: bits,\n            isTouch: touch,\n            isGray: gray,\n        }),\n        size: ({ numBits }) => {\n            const size = useCompact(numBits) ? numBits : 2 * numBits\n            return {\n                gridWidth: size,\n                gridHeight: size,\n            }\n        },\n        makeNodes: ({ numBits, isGray, isTouch, gridWidth }) => {\n            const offset = gridWidth / 2 + 1\n            return {\n                ins: {\n                    R: isGray ? undefined : groupHorizontal(\"n\", 0, -offset, numBits),\n                    G: groupVertical(\"w\", -offset, 0, numBits),\n                    B: isGray ? undefined : groupHorizontal(\"s\", 0, offset, numBits),\n                },\n                outs: {\n                    T: !isTouch ? undefined : [offset, 0, \"e\"],\n                },\n            }\n        },\n        initialValue: (): PixelValue => ({ color: COLORCOMPS_UNKNOWN, pressed: false }),\n    })\n\ntype PixelValue = { color: [number, number, number], pressed: boolean }\nexport type PixelRepr = Repr<typeof PixelDef>\nexport type PixelParams = ResolvedParams<typeof PixelDef>\n\n\nexport class Pixel extends ParametrizedComponentBase<PixelRepr> {\n\n    public readonly numBits: number\n    public readonly isGray: boolean\n    public readonly isTouch: boolean\n    private _full: boolean\n\n    public constructor(parent: DrawableParent, params: PixelParams, saved?: PixelRepr) {\n        super(parent, PixelDef.with(params), saved)\n\n        this.numBits = params.numBits\n        this.isGray = params.isGray\n        this.isTouch = params.isTouch\n\n        this._full = params.numBits === 1 ? true : (saved?.full ?? PixelDef.aults.full)\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            bits: this.numBits === PixelDef.aults.bits ? undefined : this.numBits,\n            gray: this.isGray === PixelDef.aults.gray ? undefined : this.isGray,\n            touch: this.isTouch === PixelDef.aults.touch ? undefined : this.isTouch,\n            full: this._full === PixelDef.aults.full ? undefined : this._full,\n        }\n    }\n\n    public override isOver(x: number, y: number): boolean {\n        if (!this.isTouch) {\n            return super.isOver(x, y)\n        }\n        // we are touch, so we can always be over it\n        return this._isOverThisRect(x, y)\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.Pixel\n        return tooltipContent(undefined, mods(s.tooltip))\n    }\n\n    protected doRecalcValue(): PixelValue {\n        const { pressed } = this.value\n        const [___, grayOrGreen] = displayValuesFromArray(this.inputValues(this.inputs.G), false)\n        let color: [number, number, number]\n        if (isUnknown(grayOrGreen)) {\n            color = COLORCOMPS_UNKNOWN\n        } else {\n            if (this.isGray) {\n                color = [grayOrGreen, grayOrGreen, grayOrGreen]\n            } else {\n                const [__, red] = displayValuesFromArray(this.inputValues(this.inputs.R), false)\n                const [____, blue] = displayValuesFromArray(this.inputValues(this.inputs.B), true)\n                if (isUnknown(red) || isUnknown(blue)) {\n                    color = COLORCOMPS_UNKNOWN\n                } else {\n                    color = [red, grayOrGreen, blue]\n                }\n            }\n        }\n        return { color, pressed }\n    }\n\n\n    private doSetValueWithPressed(pressed: boolean) {\n        const { color } = this.value\n        this.doSetValue({ color, pressed })\n    }\n\n    protected override propagateValue(newValue: PixelValue) {\n        if (\"T\" in this.outputs) {\n            this.outputs.T.value = newValue.pressed\n        }\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        super.doDrawDefault(g, ctx)\n\n        const [r_, g_, b_] = this.value.color\n        const maxVal = (1 << this.numBits) - 1\n        const colorComp = (c: number) => Math.round(c / maxVal * 255)\n        const outerColor = `rgba(${colorComp(r_)}, ${colorComp(g_)}, ${colorComp(b_)}, 0.5)`\n        const innerColor = `rgb(${colorComp(r_)}, ${colorComp(g_)}, ${colorComp(b_)})`\n\n        const bounds = this.bounds()\n        const { width, height } = bounds\n\n        let padding = 1\n        if (!this._full && this.numBits > 1) {\n            g.fillStyle = outerColor\n            g.fillRect(this.posX - width / 2 + padding, this.posY - height / 2 + padding, width - padding * 2, height - padding * 2)\n            padding = 10\n        }\n        g.fillStyle = innerColor\n        g.fillRect(this.posX - width / 2 + padding, this.posY - height / 2 + padding, width - padding * 2, height - padding * 2)\n    }\n\n    private doSetFull(full: boolean) {\n        if (this._full === full) {\n            return\n        }\n        this._full = full\n        this.requestRedraw({ why: \"pixel full changed\" })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.Pixel.contextMenu\n\n        const toggleFullItems: MenuItems = this.numBits === 1 ? [] : [\n            [\"mid\", MenuData.item(this._full ? \"check\" : \"none\", s.Full, () => this.doSetFull(!this._full))],\n        ]\n\n        return [\n            this.makeChangeBooleanParamsContextMenuItem(s.ParamGrayscale, this.isGray, \"gray\"),\n            this.makeChangeParamsContextMenuItem(\"inputs\", s.ParamNumBits, this.numBits, \"bits\"),\n            [\"mid\", MenuData.sep()],\n            this.makeChangeBooleanParamsContextMenuItem(s.ParamTouch, this.isTouch, \"touch\"),\n            ...toggleFullItems,\n        ]\n    }\n\n    public override pointerDown(e: PointerEvent) {\n        if (this.isTouch) {\n            this.doSetValueWithPressed(true)\n        }\n        return super.pointerDown(e)\n    }\n\n    public override pointerUp(e: PointerEvent) {\n        const result = super.pointerUp(e)\n        if (this.isTouch) {\n            this.doSetValueWithPressed(false)\n        }\n        return result\n    }\n\n    public override cursorWhenMouseover(e?: PointerEvent): string | undefined {\n        const superCursor = super.cursorWhenMouseover(e)\n        if (this.isTouch && (superCursor === \"grab\" || superCursor === undefined) && this.parent.mode >= Mode.TRYOUT) {\n            // we can switch it\n            return \"pointer\"\n        }\n        return superCursor\n    }\n\n}\nPixelDef.impl = Pixel\n", "import * as t from \"io-ts\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, EdgeTrigger, LogicValue, Unknown, isUnknown, typeOrUndefined } from \"../utils\"\nimport { Repr, ResolvedParams, defineParametrizedComponent, groupVertical } from \"./Component\"\nimport { DrawableParent, MenuData } from \"./Drawable\"\nimport { Flipflop, makeTriggerItems } from \"./FlipflopOrLatch\"\nimport { ROMRAMBase, ROMRAMDef, ROMRAMValue } from \"./ROM\"\n\n\nexport const RAMDef =\n    defineParametrizedComponent(\"ram\", true, true, {\n        variantName: ({ bits, lines }) => `ram-${lines}x${bits}`,\n        idPrefix: \"ram\",\n        ...ROMRAMDef,\n        repr: {\n            ...ROMRAMDef.repr,\n            trigger: typeOrUndefined(t.keyof(EdgeTrigger)),\n        },\n        valueDefaults: {\n            ...ROMRAMDef.valueDefaults,\n            trigger: EdgeTrigger.rising,\n        },\n        makeNodes: (params, defaults) => {\n            const base = ROMRAMDef.makeNodes(params, defaults)\n            const { numDataBits, gridHeight } = params\n            const bottomOffset = Math.ceil((gridHeight + 1) / 2)\n            const clockYOffset = bottomOffset - 2\n            const s = S.Components.Generic\n\n            return {\n                ins: {\n                    Clock: [-7, clockYOffset, \"w\", s.InputClockDesc, { isClock: true }],\n                    WE: [-2, bottomOffset, \"s\", s.InputWriteEnableDesc],\n                    Clr: [+2, bottomOffset, \"s\", s.InputClearDesc, { prefersSpike: true }],\n                    D: groupVertical(\"w\", -7, 0, numDataBits),\n                    Addr: base.ins.Addr,\n                },\n                outs: base.outs,\n            }\n        },\n    })\n\n\nexport type RAMRepr = Repr<typeof RAMDef>\nexport type RAMParams = ResolvedParams<typeof RAMDef>\n\n\nexport class RAM extends ROMRAMBase<RAMRepr> {\n\n    private _trigger: EdgeTrigger = RAMDef.aults.trigger\n    private _lastClock: LogicValue = Unknown\n\n    public constructor(parent: DrawableParent, params: RAMParams, saved?: RAMRepr) {\n        super(parent, RAMDef, params, saved)\n\n        this._trigger = saved?.trigger ?? RAMDef.aults.trigger\n    }\n\n    public toJSON() {\n        return {\n            ...super.toJSONBase(),\n            trigger: (this._trigger !== RAMDef.aults.trigger) ? this._trigger : undefined,\n        }\n    }\n\n    protected get moduleName() {\n        return \"RAM\"\n    }\n\n    public get trigger() {\n        return this._trigger\n    }\n\n    protected doSetTrigger(trigger: EdgeTrigger) {\n        this._trigger = trigger\n        this.requestRedraw({ why: \"trigger changed\", invalidateTests: true })\n    }\n\n    protected doRecalcValue(): ROMRAMValue {\n        const clear = this.inputs.Clr.value\n        const numWords = this.numWords\n        if (clear === true) {\n            // clear is true, preset is false, set output to 0\n            return RAM.valueFilledWith(false, numWords, this.numDataBits)\n        }\n\n        // first, determine output\n        const addr = this.currentAddress()\n\n        const prevClock = this._lastClock\n        const clock = this._lastClock = this.inputs.Clock.value\n\n        // handle normal operation\n        const oldState = this.value\n        const we = this.inputs.WE.value\n        if (we !== true || !Flipflop.isClockTrigger(this.trigger, prevClock, clock)) {\n            // nothing to write, just update output\n            const out = isUnknown(addr) ? ArrayFillWith(Unknown, this.numDataBits) : oldState.mem[addr]\n            return { mem: oldState.mem, out }\n        }\n\n        // we write\n        if (isUnknown(addr)) {\n            return RAM.valueFilledWith(Unknown, numWords, this.numDataBits)\n        }\n\n        // build new state\n        const newData = this.inputValues(this.inputs.D).map(LogicValue.filterHighZ)\n        const newState: LogicValue[][] = new Array(numWords)\n        for (let i = 0; i < numWords; i++) {\n            if (i === addr) {\n                newState[i] = newData\n            } else {\n                newState[i] = oldState.mem[i]\n            }\n        }\n        return { mem: newState, out: newData }\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.RAM.tooltip\n        return tooltipContent(s.title, mods(\n            div(s.desc.expand({ numWords: this.numWords, numDataBits: this.numDataBits }))\n            // TODO more info\n        ))\n    }\n\n    protected override() {\n        return [\n            ...makeTriggerItems(this._trigger, this.doSetTrigger.bind(this)),\n\n            [\"mid\", MenuData.sep()],\n        ]\n    }\n\n}\nRAMDef.impl = RAM\n", "import { saveAs } from 'file-saver'\nimport * as t from \"io-ts\"\nimport { COLOR_COMPONENT_BORDER, COLOR_EMPTY, TextVAlign, colorForLogicValue, displayValuesFromArray, fillTextVAlign, formatWithRadix, strokeSingleLine } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, InteractionResult, LogicValue, Unknown, allBooleans, binaryStringRepr, hexStringRepr, isAllZeros, isArray, isUnknown, typeOrUndefined, valuesFromBinaryOrHexRepr } from \"../utils\"\nimport { ParametrizedComponentBase, Repr, ResolvedParams, defineAbstractParametrizedComponent, defineParametrizedComponent, groupHorizontal, groupVertical, param } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItem, MenuItemPlacement, MenuItems, Orientation } from \"./Drawable\"\nimport { RAM, RAMDef } from \"./RAM\"\n\n\nexport const ROMRAMDef =\n    defineAbstractParametrizedComponent({\n        button: { imgWidth: 50 },\n        repr: {\n            bits: typeOrUndefined(t.number),\n            lines: typeOrUndefined(t.number),\n            showContent: typeOrUndefined(t.boolean),\n            displayRadix: typeOrUndefined(t.number),\n            content: typeOrUndefined(t.union([t.string, t.array(t.string)])),\n        },\n        valueDefaults: {\n            showContent: true,\n            displayRadix: undefined as number | undefined,\n        },\n        params: {\n            bits: param(4, [4, 8, 16, 24, 32]),\n            lines: param(16, [4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048]),\n        },\n        validateParams: ({ bits, lines }) => {\n            const numAddressBits = Math.ceil(Math.log2(lines))\n            const numWords = Math.pow(2, numAddressBits)\n            return { numDataBits: bits, numAddressBits, numWords }\n        },\n        size: ({ numWords, numDataBits }) => ({\n            gridWidth: 11, // always wide enough even for 256 lines\n            gridHeight: Math.max(numWords <= 16 ? 16 : 22, numDataBits + 4),\n        }),\n        makeNodes: ({ numDataBits, numAddressBits, gridHeight }) => {\n            const addrTopOffset = -Math.ceil((gridHeight + 1) / 2)\n\n            return {\n                ins: {\n                    Addr: groupHorizontal(\"n\", 0, addrTopOffset, numAddressBits),\n                },\n                outs: {\n                    Q: groupVertical(\"e\", 7, 0, numDataBits),\n                },\n            }\n        },\n        initialValue: (saved, { numDataBits, numWords }) => {\n            if (saved === undefined || saved.content === undefined) {\n                return ROMRAMBase.defaultValue(numWords, numDataBits)\n            }\n            const mem = ROMRAMBase.contentsFromString(saved.content, numDataBits, numWords)\n            const out = [...mem[0]]\n            return { mem, out }\n        },\n    })\n\n\nexport type ROMRAMRepr = Repr<typeof ROMRAMDef>\nexport type ROMRAMParams = ResolvedParams<typeof ROMRAMDef>\n\nexport type ROMRAMValue = {\n    mem: LogicValue[][]\n    out: LogicValue[]\n}\n\n\nexport abstract class ROMRAMBase<TRepr extends ROMRAMRepr> extends ParametrizedComponentBase<TRepr, ROMRAMValue> {\n\n    public static defaultValue(numWords: number, numDataBits: number) {\n        return ROMRAMBase.valueFilledWith(false, numWords, numDataBits)\n    }\n\n    public static valueFilledWith(v: LogicValue, numWords: number, numDataBits: number): ROMRAMValue {\n        const mem: LogicValue[][] = new Array(numWords)\n        for (let i = 0; i < numWords; i++) {\n            mem[i] = ArrayFillWith(v, numDataBits)\n        }\n        const out = ArrayFillWith(v, numDataBits)\n        return { mem, out }\n    }\n\n    public static contentsFromString(stringRep: string | string[], numDataBits: number, numWords: number) {\n        const splitContent = isArray(stringRep) ? stringRep : stringRep.split(/\\s+/)\n        const mem: LogicValue[][] = new Array(numWords)\n        for (let i = 0; i < numWords; i++) {\n            const row = i >= splitContent.length\n                ? ArrayFillWith(false, numDataBits)\n                : valuesFromBinaryOrHexRepr(splitContent[i], numDataBits)\n            mem[i] = row\n        }\n        return mem\n    }\n\n    public readonly numDataBits: number\n    public readonly numAddressBits: number\n    public readonly numWords: number\n    private _showContent: boolean\n    private _displayRadix: number | undefined\n\n    public constructor(parent: DrawableParent, SubclassDef: typeof RAMDef | typeof ROMDef, params: ROMRAMParams, saved?: TRepr) {\n        super(parent, SubclassDef.with(params) as any /* TODO */, saved)\n\n        this.numDataBits = params.numDataBits\n        this.numAddressBits = params.numAddressBits\n        this.numWords = params.numWords\n\n        this._showContent = saved?.showContent ?? (!this.canShowContent() ? false : RAMDef.aults.showContent)\n        this._displayRadix = saved?.displayRadix ?? RAMDef.aults.displayRadix\n    }\n\n    public override toJSONBase() {\n        return {\n            ...super.toJSONBase(),\n            bits: this.numDataBits === RAMDef.aults.bits ? undefined : this.numDataBits,\n            lines: this.numWords === RAMDef.aults.lines ? undefined : this.numWords,\n            showContent: (!this.canShowContent()) ? undefined : (this._showContent !== RAMDef.aults.showContent) ? this._showContent : undefined,\n            displayRadix: this._displayRadix !== RAMDef.aults.displayRadix ? this._displayRadix : undefined,\n            content: this.contentRepr(\" \", true),\n        }\n    }\n\n    private contentRepr<TrimEnd extends boolean>(delim: string, trimEnd: TrimEnd)\n        : string | (TrimEnd extends false ? never : undefined) {\n        const cells: string[] = []\n        const useHex = this.numDataBits >= 8\n        const hexWidth = Math.ceil(this.numDataBits / 4)\n        for (let addr = 0; addr < this.numWords; addr++) {\n            const word = this.value.mem[addr]\n            const wordRepr = useHex && allBooleans(word) ? hexStringRepr(word, hexWidth) : binaryStringRepr(word)\n            cells.push(wordRepr)\n        }\n        if (trimEnd) {\n            let numToSkip = 0\n            for (let addr = this.numWords - 1; addr >= 0; addr--) {\n                if (isAllZeros(cells[addr])) {\n                    numToSkip++\n                } else {\n                    break\n                }\n            }\n            if (numToSkip > 0) {\n                // remove last numToSkip cells\n                cells.splice(this.numWords - numToSkip, numToSkip)\n            }\n        }\n        const result: string | undefined = cells.length === 0 ? undefined : cells.join(delim)\n        return result as any\n    }\n\n    protected currentAddress(): number | Unknown {\n        const addrBits = this.inputValues(this.inputs.Addr)\n        const [__, addr] = displayValuesFromArray(addrBits, false)\n        return addr\n    }\n\n    protected override propagateValue(newValue: ROMRAMValue) {\n        this.outputValues(this.outputs.Q, newValue.out)\n    }\n\n    private canShowContent() {\n        return this.numWords <= 64 && this.numDataBits <= 16\n    }\n\n    protected doSetShowContent(showContent: boolean) {\n        this._showContent = showContent\n        this.requestRedraw({ why: \"show content changed\" })\n    }\n\n    protected abstract get moduleName(): string\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, (ctx, { width, height }) => {\n\n            const mem = this.value.mem\n            const addr = this.currentAddress()\n            let contentBottom, labelCenter\n\n            if (!this._showContent || !this.canShowContent() || this.parent.editor.options.hideMemoryContent) {\n                g.font = `bold 18px sans-serif`\n                g.fillStyle = COLOR_COMPONENT_BORDER\n                g.textAlign = \"center\"\n                fillTextVAlign(g, TextVAlign.middle, this.moduleName, this.posX, this.posY - 6)\n                g.font = `11px sans-serif`\n                const numWordsStr = this.numWords >= 1024 ? `${this.numWords / 1024}k` : this.numWords.toString()\n                fillTextVAlign(g, TextVAlign.middle, `${numWordsStr} \u00D7 ${this.numDataBits} bits`, this.posX, this.posY + 12)\n                labelCenter = this.posX\n                contentBottom = this.posY + 25\n            } else {\n                const isVertical = Orientation.isVertical(this.orient)\n                const canUseTwoCols = isVertical\n                const addressedContentHeight = this._displayRadix !== undefined ? 12 : 0\n                const contentCenterY = this.posY - addressedContentHeight / 2\n                const [availWidth, availHeight] = !isVertical\n                    ? [width - 42, height - 30 - addressedContentHeight]\n                    : [height - 66, width - 30 - addressedContentHeight]\n                const arrowWidth = 10\n\n                let useTwoCols = false\n                let cellHeight = Math.floor((availHeight - addressedContentHeight) * 2 / this.numWords) / 2\n                if (cellHeight <= 2 && canUseTwoCols) {\n                    useTwoCols = true\n                    cellHeight = Math.floor((availHeight - addressedContentHeight) * 4 / this.numWords) / 2\n                }\n                if (!useTwoCols) {\n                    const cellWidth = Math.floor((availWidth - arrowWidth) * 2 / this.numDataBits) / 2\n                    labelCenter = this.posX + 3\n                    contentBottom = drawMemoryCells(g, mem, this.numDataBits, addr, 0, this.numWords, labelCenter, contentCenterY, cellWidth, cellHeight)\n                } else {\n                    const cellWidth = Math.floor((availWidth / 2 - 2 * arrowWidth) * 2 / this.numDataBits) / 2\n                    labelCenter = this.posX\n                    contentBottom = drawMemoryCells(g, mem, this.numDataBits, addr, 0, this.numWords / 2, this.posX + 2 - 38, contentCenterY, cellWidth, cellHeight)\n                    drawMemoryCells(g, mem, this.numDataBits, addr, this.numWords / 2, this.numWords, this.posX + 2 + 38, contentCenterY, cellWidth, cellHeight)\n                }\n            }\n\n            if (this._displayRadix !== undefined) {\n                const word = isUnknown(addr) ? Unknown : displayValuesFromArray(mem[addr], false)[1]\n                const repr = formatWithRadix(word, this._displayRadix, this.numDataBits, true)\n                g.fillStyle = COLOR_COMPONENT_BORDER\n                g.textAlign = \"center\"\n                fillTextVAlign(g, TextVAlign.top, `${repr}`, labelCenter, contentBottom + 3)\n            }\n        })\n    }\n\n    private doSetDisplayRadix(additionalReprRadix: number | undefined) {\n        this._displayRadix = additionalReprRadix\n        this.requestRedraw({ why: \"additional display radix changed\" })\n    }\n\n    private doSetMem(mem: LogicValue[][]) {\n        const addr = this.currentAddress()\n        const out = isUnknown(addr) ? ArrayFillWith(Unknown, this.numDataBits) : mem[addr]\n        this.doSetValue({ mem, out }, true)\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.RAM.contextMenu\n        const sg = S.Components.Generic.contextMenu\n        const ss = S.Components.Display.contextMenu\n\n        const makeItemShowRadix = (radix: number | undefined, desc: string) => {\n            const icon = this._displayRadix === radix ? \"check\" : \"none\"\n            return MenuData.item(icon, desc, () => this.doSetDisplayRadix(radix))\n        }\n\n        const editContentItem: [MenuItemPlacement, MenuItem] =\n            [\"mid\", MenuData.item(\"memcontent\", s.EditContent, () => {\n                const current = this.contentRepr(\" \", false)\n                const promptReturnValue = window.prompt(s.EditContentPrompt, current)\n                if (promptReturnValue !== null) {\n                    this.doSetMem(RAM.contentsFromString(promptReturnValue, this.numDataBits, this.numWords))\n                }\n            })]\n\n        const saveContentItem: [MenuItemPlacement, MenuItem] =\n            [\"mid\", MenuData.item(\"download\", s.SaveContent, () => {\n                const blob = new Blob([this.contentRepr(\"\\n\", false)], { type: \"text/plain\" })\n                const filename = this.parent.editor.documentDisplayName + \".\" + (this.ref ?? this.moduleName.toLowerCase()) + \"-content.txt\"\n                saveAs(blob, filename)\n            })]\n\n        const loadContentItem: [MenuItemPlacement, MenuItem] =\n            [\"mid\", MenuData.item(\"open\", s.LoadContent, () => {\n                this.parent.editor.runFileChooser(\"text/plain\", async file => {\n                    const content = await file.text()\n                    this.doSetMem(RAM.contentsFromString(content, this.numDataBits, this.numWords))\n                })\n            })]\n\n        const swapROMRAMItem: [MenuItemPlacement, MenuItem] =\n            [\"mid\", MenuData.item(\"replace\", s.SwapROMRAM, () => {\n                const isROM = this instanceof ROM\n                const repr = this.toNodelessJSON();\n                (repr as any).type = isROM ? \"ram\" : \"rom\"\n                const otherDef = isROM ? RAMDef : ROMDef\n                const newComp = otherDef.makeFromJSON(this.parent, repr)\n                if (newComp === undefined) {\n                    console.warn(\"Could not swap ROM/RAM from repr:\", repr)\n                    return InteractionResult.NoChange\n                }\n                this.replaceWithComponent(newComp)\n                return InteractionResult.SimpleChange\n            })]\n\n        const additionalDisplayItems: [MenuItemPlacement, MenuItem] =\n            [\"mid\", MenuData.submenu(\"eye\", s.SelectedDataDisplay, [\n                makeItemShowRadix(undefined, ss.DisplayNone),\n                MenuData.sep(),\n                makeItemShowRadix(2, ss.DisplayAsBinary),\n                makeItemShowRadix(16, ss.DisplayAsHexadecimal),\n                makeItemShowRadix(10, ss.DisplayAsDecimal),\n                makeItemShowRadix(-10, ss.DisplayAsSignedDecimal),\n                makeItemShowRadix(8, ss.DisplayAsOctal),\n            ])]\n\n\n        const icon = this._showContent ? \"check\" : \"none\"\n        const toggleShowContentItems: MenuItems =\n            !this.canShowContent() ? [] : [\n                [\"mid\", MenuData.item(icon, sg.ShowContent,\n                    () => this.doSetShowContent(!this._showContent))],\n            ]\n\n        return [\n            ...this.makeSpecificROMRAMItems(),\n            additionalDisplayItems,\n            ...toggleShowContentItems,\n            [\"mid\", MenuData.sep()],\n            editContentItem,\n            saveContentItem,\n            loadContentItem,\n            [\"mid\", MenuData.sep()],\n            swapROMRAMItem,\n            [\"mid\", MenuData.sep()],\n            this.makeChangeParamsContextMenuItem(\"memlines\", sg.ParamNumWords, this.numWords, \"lines\"),\n            this.makeChangeParamsContextMenuItem(\"outputs\", S.Components.Generic.contextMenu.ParamNumBits, this.numDataBits, \"bits\"),\n            ...this.makeForceOutputsContextMenuItem(true),\n        ]\n    }\n\n    protected makeSpecificROMRAMItems(): MenuItems {\n        return []\n    }\n\n}\n\n\nfunction drawMemoryCells(g: GraphicsRendering, mem: LogicValue[][], numDataBits: number, addr: number | Unknown, start: number, end: number, centerX: number, centerY: number, cellWidth: number, cellHeight: number): number {\n    const numCellsToDraw = end - start\n    const contentTop = centerY - numCellsToDraw / 2 * cellHeight\n    const contentLeft = centerX - numDataBits / 2 * cellWidth\n    const contentRight = contentLeft + numDataBits * cellWidth\n    const contentBottom = contentTop + numCellsToDraw * cellHeight\n\n    // by default, paint everything as zero\n    g.fillStyle = COLOR_EMPTY\n    g.fillRect(contentLeft, contentTop, contentRight - contentLeft, contentBottom - contentTop)\n\n    for (let i = start; i < end; i++) {\n        for (let j = 0; j < numDataBits; j++) {\n            const v = mem[i][numDataBits - j - 1]\n            if (v !== false) {\n                g.fillStyle = colorForLogicValue(v)\n                g.fillRect(contentLeft + j * cellWidth, contentTop + i * cellHeight, cellWidth, cellHeight)\n            }\n        }\n    }\n\n    g.strokeStyle = COLOR_COMPONENT_BORDER\n    g.lineWidth = 0.5\n    for (let i = 1; i < numCellsToDraw; i++) {\n        const y = contentTop + i * cellHeight\n        strokeSingleLine(g, contentLeft, y, contentRight, y)\n    }\n    for (let j = 1; j < numDataBits; j++) {\n        const x = contentLeft + j * cellWidth\n        strokeSingleLine(g, x, contentTop, x, contentBottom)\n    }\n    const borderLineWidth = 2\n    g.lineWidth = borderLineWidth\n    g.strokeRect(contentLeft - borderLineWidth / 2, contentTop - borderLineWidth / 2, contentRight - contentLeft + borderLineWidth, contentBottom - contentTop + borderLineWidth)\n    if (!isUnknown(addr) && addr >= start && addr < end) {\n        const arrowY = contentTop + (addr - start) * cellHeight + cellHeight / 2\n        const arrowRight = contentLeft - 3\n        const arrowWidth = 8\n        const arrowHalfHeight = 3\n        g.beginPath()\n        g.moveTo(arrowRight, arrowY)\n        g.lineTo(arrowRight - arrowWidth, arrowY + arrowHalfHeight)\n        g.lineTo(arrowRight - arrowWidth + 2, arrowY)\n        g.lineTo(arrowRight - arrowWidth, arrowY - arrowHalfHeight)\n        g.closePath()\n        g.fillStyle = COLOR_COMPONENT_BORDER\n        g.fill()\n    }\n\n    return contentBottom\n}\n\n\n\nexport const ROMDef =\n    defineParametrizedComponent(\"rom\", true, true, {\n        variantName: ({ bits, lines }) => `rom-${lines}x${bits}`,\n        idPrefix: \"rom\",\n        ...ROMRAMDef,\n    })\n\nexport type ROMRepr = Repr<typeof ROMDef>\n\nexport class ROM extends ROMRAMBase<ROMRepr> {\n\n    public constructor(parent: DrawableParent, params: ROMRAMParams, saved?: ROMRepr) {\n        super(parent, ROMDef, params, saved)\n    }\n\n    public toJSON() {\n        return super.toJSONBase()\n    }\n\n    protected get moduleName() {\n        return \"ROM\"\n    }\n\n    protected doRecalcValue(): ROMRAMValue {\n        const { mem } = this.value\n        const addr = this.currentAddress()\n        const out = isUnknown(addr) ? ArrayFillWith(Unknown, this.numDataBits) : mem[addr]\n        return { mem, out }\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.ROM.tooltip\n        return tooltipContent(s.title, mods(\n            div(s.desc.expand({ numWords: this.numWords, numDataBits: this.numDataBits }))\n            // TODO more info\n        ))\n    }\n\n}\nROMDef.impl = ROM\n", "import * as t from \"io-ts\"\nimport { COLOR_COMPONENT_INNER_LABELS, displayValuesFromArray, drawLabel, useCompact } from \"../drawutils\"\nimport { tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillUsing, ArrayFillWith, EdgeTrigger, LogicValue, Unknown, typeOrUndefined } from \"../utils\"\nimport { ComponentName, ComponentNameRepr, ParametrizedComponentBase, Repr, ResolvedParams, defineParametrizedComponent, groupVertical, param } from \"./Component\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems, Orientation } from \"./Drawable\"\nimport { Flipflop, FlipflopOrLatch } from \"./FlipflopOrLatch\"\nimport { RegisterBase } from \"./Register\"\n\n\nexport const RandomDef =\n    defineParametrizedComponent(\"rand\", true, true, {\n        variantName: ({ bits }) => `rand-${bits}`,\n        idPrefix: \"rand\",\n        button: { imgWidth: 32 },\n        repr: {\n            bits: typeOrUndefined(t.number),\n            prob1: typeOrUndefined(t.number),\n            showProb: typeOrUndefined(t.boolean),\n            trigger: typeOrUndefined(t.keyof(EdgeTrigger)),\n            name: ComponentNameRepr,\n        },\n        valueDefaults: {\n            prob1: 0.5,\n            showProb: false,\n            trigger: EdgeTrigger.rising,\n        },\n        params: {\n            bits: param(1, [1, 2, 3, 4, 7, 8, 16]),\n        },\n        validateParams: ({ bits }) => ({\n            numBits: bits,\n        }),\n        size: ({ numBits }) => ({\n            gridWidth: 4,\n            gridHeight: 4 + (useCompact(numBits) ? numBits / 2 : numBits) * 2,\n        }),\n        makeNodes: ({ numBits, gridHeight }) => {\n            const s = S.Components.Generic\n            const clockY = gridHeight / 2 - 1\n            return {\n                ins: {\n                    Clock: [-3, clockY, \"w\", s.InputClockDesc, { isClock: true }],\n                },\n                outs: {\n                    Out: groupVertical(\"e\", 3, 0, numBits),\n                },\n            }\n        },\n        initialValue: (saved, { numBits }) => ArrayFillWith<LogicValue>(false, numBits),\n    })\n\nexport type RandomRepr = Repr<typeof RandomDef>\nexport type RandomParams = ResolvedParams<typeof RandomDef>\n\n\nexport class Random extends ParametrizedComponentBase<RandomRepr> {\n\n    public readonly numBits: number\n    private _prob1: number\n    private _showProb: boolean\n    private _lastClock: LogicValue = Unknown\n    private _trigger: EdgeTrigger\n    private _name: ComponentName\n\n    public constructor(parent: DrawableParent, params: RandomParams, saved?: RandomRepr) {\n        super(parent, RandomDef.with(params), saved)\n\n        this.numBits = params.numBits\n\n        this._prob1 = saved?.prob1 !== undefined\n            ? Math.max(0, Math.min(1, saved.prob1)) : RandomDef.aults.prob1\n        this._showProb = saved?.showProb ?? RandomDef.aults.showProb\n        this._trigger = saved?.trigger ?? RandomDef.aults.trigger\n        this._name = saved?.name ?? undefined\n    }\n\n    public override toJSON() {\n        return {\n            ...super.toJSONBase(),\n            bits: this.numBits === RandomDef.aults.bits ? undefined : this.numBits,\n            name: this._name,\n            prob1: (this._prob1 !== RandomDef.aults.prob1) ? this._prob1 : undefined,\n            showProb: (this._showProb !== RandomDef.aults.showProb) ? this._showProb : undefined,\n            trigger: (this._trigger !== RandomDef.aults.trigger) ? this._trigger : undefined,\n        }\n    }\n\n    public override get allowsForcedOutputs() {\n        return false\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.Random.tooltip\n        return tooltipContent(s.title,\n            s.desc[0] + this._prob1 + s.desc[1]\n        )\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        const prevClock = this._lastClock\n        const clock = this._lastClock = this.inputs.Clock.value\n        if (!Flipflop.isClockTrigger(this._trigger, prevClock, clock)) {\n            // no change\n            return this.value\n        }\n        const randBool = () => {\n            return Math.random() < this._prob1\n        }\n        return ArrayFillUsing(randBool, this.numBits)\n    }\n\n    protected override propagateValue(newValue: LogicValue[]) {\n        this.outputValues(this.outputs.Out, newValue)\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        const outputValues = this.value\n\n        this.doDrawDefault(g, ctx, {\n            componentName: [this._name, false, () => displayValuesFromArray(outputValues, false)[1]],\n            skipLabels: true,\n            drawLabels: (ctx, { top }) => {\n                if (this.numBits === 1) {\n                    const output = this.outputs.Out[0]\n                    FlipflopOrLatch.drawStoredValue(g, output.value, ...ctx.rotatePoint(this.posX, output.posYInParentTransform), 26, false)\n                } else {\n                    RegisterBase.drawStoredValues(g, ctx, this.outputs.Out, this.posX, Orientation.isVertical(this.orient))\n                }\n\n                if (this._showProb) {\n                    const isVertical = Orientation.isVertical(this.orient)\n\n                    g.fillStyle = COLOR_COMPONENT_INNER_LABELS\n                    g.font = \"9px sans-serif\"\n                    const probTextLastPart = String(Math.round(this._prob1 * 100) / 100).substring(1)\n                    const probTextParts = [\"P(1)\", \"=\", probTextLastPart]\n                    if (isVertical) {\n                        let currentOffset = -10\n                        let offset = Math.abs(currentOffset)\n                        if (this.orient === \"s\") {\n                            currentOffset = -currentOffset\n                            offset = -offset\n                        }\n                        for (const part of probTextParts) {\n                            drawLabel(ctx, this.orient, part, \"n\", this.posX - currentOffset, top - 1, undefined)\n                            currentOffset += offset\n                        }\n                    } else {\n                        const probText = probTextParts.join(\"\u202F\")\n                        drawLabel(ctx, this.orient, probText, \"n\", this.posX, top, undefined)\n                    }\n                }\n            },\n        })\n    }\n\n    private doSetName(name: ComponentName) {\n        this._name = name\n        this.requestRedraw({ why: \"name changed\" })\n    }\n\n    private doSetShowProb(showProb: boolean) {\n        this._showProb = showProb\n        this.requestRedraw({ why: \"show probability changed\" })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.Random.contextMenu\n        const icon = this._showProb ? \"check\" : \"none\"\n        const toggleShowProbItem = MenuData.item(icon, s.ShowProb,\n            () => this.doSetShowProb(!this._showProb))\n\n        return [\n            [\"mid\", toggleShowProbItem],\n            [\"mid\", MenuData.sep()],\n            this.makeChangeParamsContextMenuItem(\"inputs\", S.Components.Generic.contextMenu.ParamNumBits, this.numBits, \"bits\"),\n            [\"mid\", MenuData.sep()],\n            [\"mid\", this.makeSetNameContextMenuItem(this._name, this.doSetName.bind(this))],\n        ]\n    }\n\n\n    public override keyDown(e: KeyboardEvent): void {\n        if (e.key === \"Enter\" && !e.altKey) {\n            this.runSetNameDialog(this._name, this.doSetName.bind(this))\n        } else {\n            super.keyDown(e)\n        }\n    }\n\n}\nRandomDef.impl = Random\n", "import * as t from \"io-ts\"\nimport { COLOR_COMPONENT_BORDER, GRID_STEP, TextVAlign, displayValuesFromArray, fillTextVAlign, useCompact } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, EdgeTrigger, LogicValue, Unknown, allBooleans, binaryStringRepr, hexStringRepr, isAllZeros, isHighImpedance, isUnknown, typeOrUndefined, valuesFromBinaryOrHexRepr } from \"../utils\"\nimport { ExtractParamDefs, ExtractParams, NodesIn, NodesOut, ParametrizedComponentBase, ReadonlyGroupedNodeArray, Repr, ResolvedParams, defineAbstractParametrizedComponent, defineParametrizedComponent, groupVertical, param, paramBool } from \"./Component\"\nimport { Counter } from \"./Counter\"\nimport { DrawContext, DrawContextExt, DrawableParent, GraphicsRendering, MenuData, MenuItems, Orientation } from \"./Drawable\"\nimport { Flipflop, FlipflopOrLatch, makeTriggerItems } from \"./FlipflopOrLatch\"\nimport { NodeOut } from \"./Node\"\nimport { type ShiftRegisterDef } from \"./ShiftRegister\"\n\n\nexport const RegisterBaseDef =\n    defineAbstractParametrizedComponent({\n        button: { imgWidth: 50 },\n        repr: {\n            bits: typeOrUndefined(t.number),\n            showContent: typeOrUndefined(t.boolean),\n            trigger: typeOrUndefined(t.keyof(EdgeTrigger)),\n            content: typeOrUndefined(t.string),\n        },\n        valueDefaults: {\n            showContent: true,\n            trigger: EdgeTrigger.rising,\n        },\n        params: {\n            bits: param(4, [2, 4, 8, 16]),\n        },\n        validateParams: ({ bits }) => ({\n            numBits: bits,\n        }),\n        size: ({ numBits }) => ({\n            gridWidth: 7,\n            gridHeight: numBits === 2 ? 11 : Math.max(15, 5 + numBits),\n        }),\n        makeNodes: ({ numBits, gridHeight }) => {\n            const bottomOffset = (gridHeight + 1) / 2\n            const clockYOffset = bottomOffset - 2\n            const topOffset = -bottomOffset\n            const s = S.Components.Generic\n\n            return {\n                ins: {\n                    Clock: [-5, clockYOffset, \"w\", s.InputClockDesc, { isClock: true }],\n                    Pre: [0, topOffset, \"n\", s.InputPresetDesc, { prefersSpike: true }],\n                    Clr: [0, bottomOffset, \"s\", s.InputClearDesc, { prefersSpike: true }],\n                },\n                outs: {\n                    Q: groupVertical(\"e\", 5, 0, numBits),\n                },\n            }\n        },\n        initialValue: (saved, { numBits }) => {\n            let content\n            if (saved === undefined || (content = saved.content) === undefined) {\n                return ArrayFillWith(false, numBits)\n            }\n            return valuesFromBinaryOrHexRepr(content, numBits)\n        },\n    })\n\nexport type RegisterBaseRepr = Repr<typeof RegisterBaseDef>\nexport type RegisterBaseParams = ResolvedParams<typeof RegisterBaseDef>\n\nexport abstract class RegisterBase<\n    TRepr extends RegisterBaseRepr,\n    TParamDefs extends ExtractParamDefs<TRepr> = ExtractParamDefs<TRepr>,\n> extends ParametrizedComponentBase<\n    TRepr,\n    LogicValue[],\n    TParamDefs,\n    ExtractParams<TRepr>,\n    NodesIn<TRepr>,\n    NodesOut<TRepr>,\n    true, true\n> {\n\n    public readonly numBits: number\n    protected _showContent: boolean\n    protected _trigger: EdgeTrigger\n    protected _isInInvalidState = false\n    protected _lastClock: LogicValue = Unknown\n\n    protected constructor(parent: DrawableParent, SubclassDef: typeof RegisterDef | typeof ShiftRegisterDef, params: RegisterBaseParams, saved?: TRepr) {\n        super(parent, SubclassDef.with(params as any) as any /* TODO */, saved)\n\n        this.numBits = params.numBits\n\n        this._showContent = saved?.showContent ?? RegisterDef.aults.showContent\n        this._trigger = saved?.trigger ?? RegisterDef.aults.trigger\n    }\n\n    protected override toJSONBase() {\n        return {\n            bits: this.numBits === RegisterDef.aults.bits ? undefined : this.numBits,\n            ...super.toJSONBase(),\n            showContent: (this._showContent !== RegisterDef.aults.showContent) ? this._showContent : undefined,\n            trigger: (this._trigger !== RegisterDef.aults.trigger) ? this._trigger : undefined,\n            content: this.contentRepr(true),\n        }\n    }\n\n    public contentRepr<AllowUndefined extends boolean>(undefinedIfTrivial: AllowUndefined)\n        : string | (AllowUndefined extends false ? never : undefined) {\n        const content = this.value\n        const hexWidth = Math.ceil(this.numBits / 4)\n        const repr = allBooleans(content) ? hexStringRepr(content, hexWidth) : binaryStringRepr(content)\n        return undefinedIfTrivial && isAllZeros(repr) ? undefined as any : repr\n    }\n\n    public get trigger() {\n        return this._trigger\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        const prevClock = this._lastClock\n        const clock = this._lastClock = this.inputs.Clock.value\n        const { isInInvalidState, newState } =\n            Flipflop.doRecalcValueForSyncComponent(this, prevClock, clock,\n                this.inputs.Pre.value,\n                this.inputs.Clr.value)\n        this._isInInvalidState = isInInvalidState\n        return newState\n    }\n\n    public makeInvalidState(): LogicValue[] {\n        return ArrayFillWith(false, this.numBits)\n    }\n\n    public makeStateFromMainValue(val: LogicValue): LogicValue[] {\n        return ArrayFillWith(val, this.numBits)\n    }\n\n    public abstract makeStateAfterClock(): LogicValue[]\n\n    protected override propagateValue(newValue: LogicValue[]) {\n        this.outputValues(this.outputs.Q, newValue)\n    }\n\n    protected doSetShowContent(showContent: boolean) {\n        this._showContent = showContent\n        this.requestRedraw({ why: \"show content changed\" })\n    }\n\n    protected doSetTrigger(trigger: EdgeTrigger) {\n        this._trigger = trigger\n        this.requestRedraw({ why: \"trigger changed\", invalidateTests: true })\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, (ctx) => {\n            if (this._showContent && !this.parent.editor.options.hideMemoryContent) {\n                RegisterBase.drawStoredValues(g, ctx, this.outputs.Q, this.posX, Orientation.isVertical(this.orient))\n            } else {\n                this.doDrawGenericCaption(g)\n            }\n        })\n    }\n\n    public static drawStoredValues(g: GraphicsRendering, ctx: DrawContextExt, outputs: ReadonlyGroupedNodeArray<NodeOut>, posX: number, swapHeightWidth: boolean) {\n        const cellHeight = useCompact(outputs.length) ? GRID_STEP : 2 * GRID_STEP\n        for (const output of outputs) {\n            FlipflopOrLatch.drawStoredValue(g, output.value, ...ctx.rotatePoint(posX, output.posYInParentTransform), cellHeight, swapHeightWidth)\n        }\n    }\n\n    protected abstract doDrawGenericCaption(g: GraphicsRendering): void\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.Generic.contextMenu\n        const icon = this._showContent ? \"check\" : \"none\"\n        const toggleShowContentItem = MenuData.item(icon, s.ShowContent,\n            () => this.doSetShowContent(!this._showContent))\n\n        return [\n            this.makeChangeParamsContextMenuItem(\"outputs\", s.ParamNumBits, this.numBits, \"bits\"),\n            ...this.makeRegisterSpecificContextMenuItems(),\n            [\"mid\", MenuData.sep()],\n            ...makeTriggerItems(this._trigger, this.doSetTrigger.bind(this)),\n            [\"mid\", MenuData.sep()],\n            [\"mid\", toggleShowContentItem],\n            ...this.makeForceOutputsContextMenuItem(true),\n        ]\n    }\n\n    protected makeRegisterSpecificContextMenuItems(): MenuItems {\n        return []\n    }\n\n}\n\nexport const RegisterDef =\n    defineParametrizedComponent(\"reg\", true, true, {\n        variantName: ({ bits }) => `reg-${bits}`,\n        idPrefix: \"reg\",\n        ...RegisterBaseDef,\n        repr: {\n            ...RegisterBaseDef.repr,\n            inc: typeOrUndefined(t.boolean),\n            saturating: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {\n            ...RegisterBaseDef.valueDefaults,\n            saturating: false,\n        },\n        params: {\n            bits: RegisterBaseDef.params.bits,\n            inc: paramBool(),\n        },\n        validateParams: ({ bits, inc }) => ({\n            numBits: bits,\n            hasIncDec: inc,\n        }),\n        makeNodes: (params, defaults) => {\n            const base = RegisterBaseDef.makeNodes(params, defaults)\n            const baseClear = base.ins.Clr\n            const bottomOffset = base.ins.Clr[1]\n            return {\n                ins: {\n                    ...base.ins,\n                    D: groupVertical(\"w\", -5, 0, params.numBits),\n                    ...(!params.hasIncDec ? {} : {\n                        Clr: [2, bottomOffset, \"s\", baseClear[3], baseClear[4]], // move Clr to the right\n                        Inc: [-2, bottomOffset, \"s\"],\n                        Dec: [0, bottomOffset, \"s\"],\n                    }),\n                },\n                outs: base.outs,\n            }\n        },\n    })\n\nexport type RegisterRepr = Repr<typeof RegisterDef>\nexport type RegisterParams = ResolvedParams<typeof RegisterDef>\n\nexport class Register extends RegisterBase<RegisterRepr> {\n\n    public readonly hasIncDec: boolean\n    private _saturating: boolean\n\n    public constructor(parent: DrawableParent, params: RegisterParams, saved?: RegisterRepr) {\n        super(parent, RegisterDef, params, saved)\n        this.hasIncDec = params.hasIncDec\n\n        this._saturating = this.hasIncDec && (saved?.saturating ?? RegisterDef.aults.saturating)\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            inc: this.hasIncDec === RegisterDef.aults.inc ? undefined : this.hasIncDec,\n            saturating: this._saturating === RegisterDef.aults.saturating ? undefined : this._saturating,\n        }\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.Register.tooltip\n\n        return tooltipContent(s.title, mods(\n            div(s.desc.expand({ numBits: this.numBits })) // TODO more info\n        ))\n    }\n\n    public makeStateAfterClock(): LogicValue[] {\n        const inc = this.inputs.Inc?.value ?? false\n        const dec = this.inputs.Dec?.value ?? false\n        if (isUnknown(inc) || isUnknown(dec) || isHighImpedance(inc) || isHighImpedance(dec)) {\n            return ArrayFillWith(false, this.numBits)\n        }\n        if (inc || dec) {\n            if (inc && dec) {\n                // no change\n                return this.value\n            }\n\n            // inc or dec\n            const [__, val] = displayValuesFromArray(this.value, false)\n            if (isUnknown(val)) {\n                return ArrayFillWith(Unknown, this.numBits)\n            }\n\n            let newVal: number\n            if (inc) {\n                // increment\n                newVal = val + 1\n                if (newVal >= 2 ** this.numBits) {\n                    if (this._saturating) {\n                        return ArrayFillWith(true, this.numBits)\n                    }\n                    return ArrayFillWith(false, this.numBits)\n                }\n            } else {\n                // decrement\n                newVal = val - 1\n                if (newVal < 0) {\n                    if (this._saturating) {\n                        return ArrayFillWith(false, this.numBits)\n                    }\n                    return ArrayFillWith(true, this.numBits)\n                }\n            }\n            return Counter.decimalToNBits(newVal, this.numBits)\n        }\n\n        // else, just a regular load from D\n        return this.inputValues(this.inputs.D).map(LogicValue.filterHighZ)\n    }\n\n    protected override doDrawGenericCaption(g: GraphicsRendering) {\n        g.font = `bold 15px sans-serif`\n        g.fillStyle = COLOR_COMPONENT_BORDER\n        g.textAlign = \"center\"\n        fillTextVAlign(g, TextVAlign.middle, \"Reg.\", this.posX, this.posY - 8)\n        g.font = `11px sans-serif`\n        fillTextVAlign(g, TextVAlign.middle, `${this.numBits} bits`, this.posX, this.posY + 10)\n    }\n\n    private doSetSaturating(saturating: boolean) {\n        this._saturating = saturating\n        this.requestRedraw({ why: \"saturating changed\", invalidateTests: true })\n    }\n\n    protected override makeRegisterSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.Register.contextMenu\n\n        const toggleSaturatingItem: MenuItems = !this.hasIncDec ? [] : [\n            [\"mid\", MenuData.item(\n                this._saturating ? \"check\" : \"none\",\n                s.Saturating,\n                () => this.doSetSaturating(!this._saturating)\n            )],\n        ]\n\n        return [\n            this.makeChangeBooleanParamsContextMenuItem(s.ParamHasIncDec, this.hasIncDec, \"inc\"),\n            ...toggleSaturatingItem,\n        ]\n    }\n\n}\nRegisterDef.impl = Register\n", "import * as t from \"io-ts\"\nimport { COLOR_COMPONENT_BORDER, COLOR_RECTANGLE_BACKGROUND, COLOR_RECTANGLE_BORDER, DrawZIndex, FONT_LABEL_DEFAULT, GRID_STEP, TextVAlign, fillTextVAlign } from \"../drawutils\"\nimport { span, style, title } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { InteractionResult, typeOrUndefined } from \"../utils\"\nimport { ComponentBase, Repr, defineComponent } from \"./Component\"\nimport { DrawContext, Drawable, DrawableParent, DrawableWithPosition, GraphicsRendering, MenuData, MenuItems } from \"./Drawable\"\n\nexport const RectangleColor = {\n    grey: \"grey\",\n    red: \"red\",\n    blue: \"blue\",\n    yellow: \"yellow\",\n    green: \"green\",\n    turquoise: \"turquoise\",\n} as const\n\nexport type RectangleColor = keyof typeof RectangleColor\n\nexport const CaptionPosition = {\n    n: \"n\",\n    ne: \"ne\",\n    e: \"e\",\n    se: \"se\",\n    s: \"s\",\n    sw: \"sw\",\n    w: \"w\",\n    nw: \"nw\",\n    c: \"c\",\n} as const\n\nexport type CaptionPosition = keyof typeof CaptionPosition\n\nexport const RectangleDef =\n    defineComponent(\"rect\", {\n        idPrefix: \"rect\",\n        button: { imgWidth: 32 },\n        repr: {\n            w: t.number,\n            h: t.number,\n            color: typeOrUndefined(t.keyof(RectangleColor)),\n            strokeWidth: typeOrUndefined(t.number),\n            noFill: typeOrUndefined(t.boolean),\n            rounded: typeOrUndefined(t.boolean),\n            caption: typeOrUndefined(t.string),\n            captionPos: typeOrUndefined(t.keyof(CaptionPosition)),\n            captionInside: typeOrUndefined(t.boolean),\n            font: typeOrUndefined(t.string),\n        },\n        valueDefaults: {\n            width: 10 * GRID_STEP,\n            height: 10 * GRID_STEP,\n            color: RectangleColor.yellow,\n            strokeWidth: 2,\n            noFill: false,\n            rounded: false,\n            caption: undefined as string | undefined,\n            captionPos: CaptionPosition.n,\n            captionInside: false,\n            font: FONT_LABEL_DEFAULT,\n        },\n        size: { gridWidth: 10, gridHeight: 10 },\n        makeNodes: () => ({}),\n    })\n\nexport type RectangleRepr = Repr<typeof RectangleDef>\n\nexport class Rectangle extends ComponentBase<RectangleRepr> {\n\n    private _w: number\n    private _h: number\n    private _color: RectangleColor\n    private _strokeWidth: number\n    private _noFill: boolean\n    private _rounded: boolean\n    private _caption: string | undefined\n    private _captionPos: CaptionPosition\n    private _captionInside: boolean\n    private _font: string\n\n    public constructor(parent: DrawableParent, saved?: RectangleRepr) {\n        super(parent, RectangleDef, saved)\n        this._w = saved?.w ?? RectangleDef.aults.width\n        this._h = saved?.h ?? RectangleDef.aults.height\n        this._color = saved?.color ?? RectangleDef.aults.color\n        this._strokeWidth = saved?.strokeWidth ?? RectangleDef.aults.strokeWidth\n        this._noFill = saved?.noFill ?? RectangleDef.aults.noFill\n        this._rounded = saved?.rounded ?? RectangleDef.aults.rounded\n        this._caption = saved?.caption ?? RectangleDef.aults.caption\n        this._captionPos = saved?.captionPos ?? RectangleDef.aults.captionPos\n        this._captionInside = saved?.captionInside ?? RectangleDef.aults.captionInside\n        this._font = saved?.font ?? RectangleDef.aults.font\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            w: this._w,\n            h: this._h,\n            color: this._color,\n            strokeWidth: this._strokeWidth,\n            noFill: this._noFill === RectangleDef.aults.noFill ? undefined : this._noFill,\n            rounded: this._rounded === RectangleDef.aults.rounded ? undefined : this._rounded,\n            caption: this._caption === RectangleDef.aults.caption ? undefined : this._caption,\n            captionPos: this._captionPos === RectangleDef.aults.captionPos ? undefined : this._captionPos,\n            captionInside: this._captionInside === RectangleDef.aults.captionInside ? undefined : this._captionInside,\n            font: this._font === RectangleDef.aults.font ? undefined : this._font,\n        }\n    }\n\n    public override canRotate() {\n        return false\n    }\n\n    public override get unrotatedWidth() {\n        return this._w\n    }\n\n    public override get unrotatedHeight() {\n        return this._h\n    }\n\n    protected doRecalcValue(): undefined {\n        return undefined\n    }\n\n    public override get drawZIndex(): DrawZIndex {\n        return DrawZIndex.Background\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        const width = this._w\n        const height = this._h\n        const left = this.posX - width / 2\n        const top = this.posY - height / 2\n\n        g.beginPath()\n        if (this._rounded) {\n            const r = 3 * this._strokeWidth\n            g.moveTo(left + r, top)\n            g.lineTo(left + width - r, top)\n            g.quadraticCurveTo(left + width, top, left + width, top + r)\n            g.lineTo(left + width, top + height - r)\n            g.quadraticCurveTo(left + width, top + height, left + width - r, top + height)\n            g.lineTo(left + r, top + height)\n            g.quadraticCurveTo(left, top + height, left, top + height - r)\n            g.lineTo(left, top + r)\n            g.quadraticCurveTo(left, top, left + r, top)\n        } else {\n            g.rect(left, top, width, height)\n        }\n        g.closePath()\n\n        if (!this._noFill) {\n            g.fillStyle = COLOR_RECTANGLE_BACKGROUND[this._color]\n            g.fill()\n        }\n\n        if (this._caption !== undefined) {\n            g.fillStyle = COLOR_COMPONENT_BORDER\n            g.font = this._font\n\n            const metrics = g.measureText(this._caption)\n            const offsetV = (metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent + this._strokeWidth) / 2 + 2\n            const margin = 2\n            const offsetH = (metrics.width + this._strokeWidth) / 2 + margin\n\n            const captionY = (() => {\n                switch (this._captionPos) {\n                    case \"c\":\n                    case \"w\":\n                    case \"e\":\n                        return this.posY\n                    case \"n\":\n                    case \"nw\":\n                    case \"ne\":\n                        return this.posY - this.height / 2 + (this._captionInside ? 1 : -1) * offsetV\n                    case \"s\":\n                    case \"se\":\n                    case \"sw\":\n                        return this.posY + this.height / 2 + (this._captionInside ? -1 : 1) * offsetV\n                }\n            })()\n\n            const captionX = (() => {\n                switch (this._captionPos) {\n                    case \"c\":\n                    case \"n\":\n                    case \"s\":\n                        return this.posX\n\n                    case \"w\":\n                        return this.posX - this.width / 2 + (this._captionInside ? 1 : -1) * offsetH\n                    case \"nw\":\n                    case \"sw\":\n                        return this.posX - this.width / 2 + offsetH - (this._captionInside ? 0 : 1) * (margin + this._strokeWidth)\n\n                    case \"e\":\n                        return this.posX + this.width / 2 + (this._captionInside ? -1 : 1) * offsetH\n                    case \"ne\":\n                    case \"se\":\n                        return this.posX + this.width / 2 - offsetH + (this._captionInside ? 0 : 1) * (margin + this._strokeWidth)\n                }\n            })()\n\n            g.textAlign = \"center\"\n            fillTextVAlign(g, TextVAlign.middle, this._caption, captionX, captionY)\n        }\n\n        if (ctx.isMouseOver) {\n            g.lineWidth = Math.max(3, this._strokeWidth)\n            g.strokeStyle = ctx.borderColor\n            g.stroke()\n        } else if (this._strokeWidth > 0) {\n            g.lineWidth = this._strokeWidth\n            g.strokeStyle = COLOR_RECTANGLE_BORDER[this._color]\n            g.stroke()\n        }\n    }\n\n    private doSetColor(color: RectangleColor) {\n        this._color = color\n        this.requestRedraw({ why: \"color changed\" })\n    }\n\n    private doSetStrokeWidth(strokeWidth: number) {\n        this._strokeWidth = strokeWidth\n        this.requestRedraw({ why: \"stroke width changed\", invalidateMask: true })\n    }\n\n    private doSetCaption(caption: string | undefined) {\n        this._caption = caption\n        this.requestRedraw({ why: \"caption changed\" })\n    }\n\n    private doSetCaptionPos(captionPos: CaptionPosition) {\n        this._captionPos = captionPos\n        this.requestRedraw({ why: \"caption position changed\" })\n    }\n\n    private doSetFont(font: string) {\n        this._font = font\n        this.requestRedraw({ why: \"font changed\" })\n    }\n\n    private makeCurrentSizeString() {\n        return `${this._w} \u00D7 ${this._h}`\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.Rectangle.contextMenu\n        const currentSizeStr = this.makeCurrentSizeString()\n        const setSizeItem = MenuData.item(\"dimensions\", s.Size + ` (${currentSizeStr})\u2026`, () => this.runSetSizeDialog(currentSizeStr))\n\n        const makeSetStrokeWidthItem = (strokeWidth: number, desc: string) => {\n            const isCurrent = this._strokeWidth === strokeWidth\n            const icon = isCurrent ? \"check\" : \"none\"\n            return MenuData.item(icon, desc, () => this.doSetStrokeWidth(strokeWidth))\n        }\n\n        const makeItemUseColor = (desc: string, color: RectangleColor) => {\n            const isCurrent = this._color === color\n            const icon = isCurrent ? \"check\" : \"none\"\n            const action = isCurrent ? () => undefined : () => this.doSetColor(color)\n            if (color !== undefined) {\n                const fillColorProp = this._noFill ? \"\" : `background-color: ${COLOR_RECTANGLE_BACKGROUND[color]}; `\n                const roundedProp = !this._rounded ? \"\" : \"border-radius: 4px; \"\n                const borderColor = COLOR_RECTANGLE_BORDER[color]\n                return MenuData.item(icon, span(title(desc), style(`display: inline-block; width: 140px; height: 18px; ${fillColorProp}${roundedProp}margin-right: 8px; border: 2px solid ${borderColor}`)), action)\n            } else {\n                return MenuData.item(icon, desc, action)\n            }\n        }\n\n        const toggleRoundedItem = MenuData.item(this._rounded ? \"check\" : \"none\", s.Rounded, () => {\n            this._rounded = !this._rounded\n            this.requestRedraw({ why: \"rounded changed\" })\n        })\n\n        const toggleNoFillItem = MenuData.item(!this._noFill ? \"check\" : \"none\", s.WithBackgroundColor, () => {\n            this._noFill = !this._noFill\n            this.requestRedraw({ why: \"nofill changed\" })\n        })\n\n        const setCaptionItemName = this._caption !== undefined ? s.ChangeTitle : s.SetTitle\n        const setCaptionItem = MenuData.item(\"pen\", setCaptionItemName, () => this.runSetCaptionDialog(), \"\u21A9\uFE0E\")\n\n        const makeItemSetPlacement = (desc: string, placement: CaptionPosition) => {\n            const isCurrent = this._captionPos === placement\n            const icon = isCurrent ? \"check\" : \"none\"\n            const action = isCurrent ? () => undefined : () => this.doSetCaptionPos(placement)\n            return MenuData.item(icon, desc, action)\n        }\n\n        const toggleCaptionInsideItems = this._captionPos === \"c\" ? [] : [\n            MenuData.item(this._captionInside ? \"check\" : \"none\", s.InsideFrame, () => {\n                this._captionInside = !this._captionInside\n                this.requestRedraw({ why: \"caption inside changed\" })\n            }),\n            MenuData.sep(),\n        ]\n\n        const setFontItem = MenuData.item(\"font\", s.Font, () => {\n            this.runSetFontDialog(this._font, RectangleDef.aults.font, this.doSetFont.bind(this))\n        })\n\n        return [\n            [\"mid\", setSizeItem],\n            [\"mid\", MenuData.submenu(\"palette\", s.Color, [\n                toggleNoFillItem,\n                MenuData.sep(),\n                makeItemUseColor(s.ColorYellow, RectangleColor.yellow),\n                makeItemUseColor(s.ColorRed, RectangleColor.red),\n                makeItemUseColor(s.ColorGreen, RectangleColor.green),\n                makeItemUseColor(s.ColorBlue, RectangleColor.blue),\n                makeItemUseColor(s.ColorTurquoise, RectangleColor.turquoise),\n                makeItemUseColor(s.ColorGrey, RectangleColor.grey),\n            ])],\n            [\"mid\", MenuData.submenu(\"strokewidth\", s.Border, [\n                makeSetStrokeWidthItem(0, s.BorderNone),\n                MenuData.sep(),\n                makeSetStrokeWidthItem(1, s.Border1px),\n                makeSetStrokeWidthItem(2, s.Border2px),\n                makeSetStrokeWidthItem(3, s.Border3px),\n                makeSetStrokeWidthItem(5, s.Border5px),\n                makeSetStrokeWidthItem(10, s.Border10px),\n            ])],\n            [\"mid\", toggleRoundedItem],\n            [\"mid\", MenuData.sep()],\n            [\"mid\", setCaptionItem],\n            [\"mid\", setFontItem],\n            [\"mid\", MenuData.submenu(\"placement\", s.TitlePlacement, [\n                ...toggleCaptionInsideItems,\n                makeItemSetPlacement(s.PlacementTop, CaptionPosition.n),\n                makeItemSetPlacement(s.PlacementTopLeft, CaptionPosition.nw),\n                makeItemSetPlacement(s.PlacementTopRight, CaptionPosition.ne),\n                makeItemSetPlacement(s.PlacementBottom, CaptionPosition.s),\n                makeItemSetPlacement(s.PlacementBottomLeft, CaptionPosition.sw),\n                makeItemSetPlacement(s.PlacementBottomRight, CaptionPosition.se),\n                makeItemSetPlacement(s.PlacementLeft, CaptionPosition.w),\n                makeItemSetPlacement(s.PlacementRight, CaptionPosition.e),\n                makeItemSetPlacement(s.PlacementCenter, CaptionPosition.c),\n            ])],\n        ]\n    }\n\n    private runSetSizeDialog(currentSizeStr: string) {\n        const promptReturnValue = window.prompt(S.Components.Rectangle.contextMenu.SizePrompt, currentSizeStr)\n        if (promptReturnValue !== null) {\n            let match\n            if ((match = /^(?<w>\\d*)((\\s+|( *[\u00D7x,;] *))(?<h>\\d*))?$/.exec(promptReturnValue)) !== null) {\n                const parse = (s: string | undefined, dflt: number) => {\n                    if (s === undefined) {\n                        return dflt\n                    }\n                    const n = parseInt(s)\n                    if (isNaN(n) || n <= 0) {\n                        return dflt\n                    }\n                    return n\n                }\n                const w = parse(match.groups?.w, this._w)\n                const h = parse(match.groups?.h, this._h)\n                this.doSetDimensions(w, h)\n            }\n        }\n    }\n\n    private doSetDimensions(w: number, h: number) {\n        this._w = w\n        this._h = h\n        this.requestRedraw({ why: \"size changed\", invalidateMask: true })\n    }\n\n    public wrapContents(selectedComps: Set<Drawable>) {\n        if (selectedComps.size === 0) {\n            return\n        }\n\n        let left = Number.POSITIVE_INFINITY\n        let top = Number.POSITIVE_INFINITY\n        let right = Number.NEGATIVE_INFINITY\n        let bottom = Number.NEGATIVE_INFINITY\n        for (const comp of selectedComps) {\n            if (comp instanceof DrawableWithPosition) {\n                left = Math.min(left, comp.posX - comp.width / 2)\n                top = Math.min(top, comp.posY - comp.height / 2)\n                right = Math.max(right, comp.posX + comp.width / 2)\n                bottom = Math.max(bottom, comp.posY + comp.height / 2)\n            }\n        }\n\n        const tryX = (left + right) / 2\n        const tryY = (top + bottom) / 2\n        const [x, y] = this.trySetPosition(tryX, tryY, true) ?? [tryX, tryY]\n\n        left = Math.floor((left + Math.max(0, tryX - x)) / GRID_STEP) * GRID_STEP\n        top = Math.floor((top + Math.max(0, tryY - y)) / GRID_STEP) * GRID_STEP\n        right = Math.ceil((right + Math.max(0, x - tryX)) / GRID_STEP) * GRID_STEP\n        bottom = Math.ceil((bottom + Math.max(0, y - tryY)) / GRID_STEP) * GRID_STEP\n        const w = right - left + 4 * GRID_STEP\n        const h = bottom - top + 4 * GRID_STEP\n        this.doSetDimensions(w, h)\n    }\n\n    private runSetCaptionDialog() {\n        const promptReturnValue = window.prompt(S.Components.Rectangle.contextMenu.SetTitlePrompt, this._caption)\n        if (promptReturnValue !== null) {\n            // OK button pressed\n            const newCaption = promptReturnValue.length === 0 ? undefined : promptReturnValue\n            this.doSetCaption(newCaption)\n        }\n    }\n\n    public override pointerDoubleClicked(__e: PointerEvent): InteractionResult {\n        // TODO: implement dragging for resizing the rectangle\n        // don't call super, which would rotate the rectangle, this is useless here\n        this.runSetSizeDialog(this.makeCurrentSizeString())\n        return InteractionResult.SimpleChange\n    }\n\n    public override keyDown(e: KeyboardEvent): void {\n        if (e.key === \"Enter\" && !e.altKey) {\n            this.runSetCaptionDialog()\n        } else {\n            super.keyDown(e)\n        }\n    }\n\n}\nRectangleDef.impl = Rectangle\n", "import * as t from \"io-ts\"\nimport JSON5 from \"json5\"\nimport { COLOR_COMPONENT_BORDER, COLOR_COMPONENT_INNER_LABELS, TextVAlign, displayValuesFromArray, fillTextVAlign } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { EdgeTrigger, LogicValue, RichStringEnum, Unknown, isUnknown, repeatString, toLogicValueRepr, typeOrUndefined } from \"../utils\"\nimport { ComponentBase, Repr, defineComponent } from \"./Component\"\nimport { DisplayAscii } from \"./DisplayAscii\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuData, MenuItems } from \"./Drawable\"\nimport { Flipflop, makeTriggerItems } from \"./FlipflopOrLatch\"\n\n\nexport const ShiftDisplayDecoders_ = {\n    \"raw\": { decodeWidth: 1, maxDisplayWidth: 16, decode: (v: number) => v.toString() },\n    \"octal\": { decodeWidth: 3, maxDisplayWidth: 16, decode: (v: number) => v.toString() },\n    \"hex\": { decodeWidth: 4, maxDisplayWidth: 16, decode: (v: number) => v.toString(16).toUpperCase() },\n    \"ascii\": { decodeWidth: 7, maxDisplayWidth: 12, decode: (v: number) => DisplayAscii.numberToAscii(v) },\n    \"ascii8\": { decodeWidth: 8, maxDisplayWidth: 12, decode: (v: number) => DisplayAscii.numberToAscii(v & 0x7F) },\n    \"uint4\": { decodeWidth: 4, maxDisplayWidth: 8, decode: (v: number) => v.toString() },\n    \"int4\": { decodeWidth: 4, maxDisplayWidth: 8, decode: (v: number) => (v > 7 ? v - 16 : v).toString() },\n    \"uint8\": { decodeWidth: 8, maxDisplayWidth: 4, decode: (v: number) => v.toString() },\n    \"int8\": { decodeWidth: 8, maxDisplayWidth: 4, decode: (v: number) => (v > 127 ? v - 256 : v).toString() },\n    \"uint16\": { decodeWidth: 16, maxDisplayWidth: 1, decode: (v: number) => v.toString() },\n    \"int16\": { decodeWidth: 16, maxDisplayWidth: 1, decode: (v: number) => (v > 32767 ? v - 65536 : v).toString() },\n} as const\n\ntype ShiftDisplayDecoderProps = {\n    decodeWidth: number,\n    maxDisplayWidth: number,\n    decode: (n: number) => string,\n}\n\nexport const ShiftDisplayDecoders =\n    RichStringEnum.withProps<ShiftDisplayDecoderProps>()(ShiftDisplayDecoders_)\n\nexport type ShiftBufferDecoder = keyof typeof ShiftDisplayDecoders_\n\n\nexport const ShiftDisplayDef =\n    defineComponent(\"shift-display\", {\n        idPrefix: \"shiftdisp\",\n        button: { imgWidth: 50 },\n        repr: {\n            state: typeOrUndefined(t.string),\n            decodeAs: typeOrUndefined(t.keyof(ShiftDisplayDecoders_)),\n            groupEvery: typeOrUndefined(t.number),\n            maxItems: typeOrUndefined(t.number),\n            trigger: typeOrUndefined(t.keyof(EdgeTrigger)),\n        },\n        valueDefaults: {\n            decodeAs: \"raw\" as ShiftBufferDecoder,\n            trigger: EdgeTrigger.rising,\n        },\n        size: { gridWidth: 25, gridHeight: 5 },\n        makeNodes: () => {\n            const s = S.Components.Generic\n            return {\n                ins: {\n                    Clock: [-14, +1, \"w\", s.InputClockDesc, { isClock: true }],\n                    Clr: [-10, +3, \"s\", s.InputClearDesc, { prefersSpike: true }],\n                    D: [-14, -1, \"w\", s.InputDataDesc],\n                },\n            }\n        },\n        initialValue: saved => {\n            if (saved === undefined || saved.state === undefined) {\n                return { incoming: [], decoded: [] }\n            }\n            const incoming: LogicValue[] = []\n            for (let i = 0; i < saved.state.length; i++) {\n                const c = saved.state.charAt(i)\n                if (c === '1') {\n                    incoming.push(true)\n                } else if (c === '0') {\n                    incoming.push(false)\n                } else {\n                    incoming.push(Unknown)\n                }\n            }\n            return { incoming, decoded: [] }\n        },\n    })\n\ntype ShiftDisplayRepr = Repr<typeof ShiftDisplayDef>\n\ntype ShiftDisplayState = {\n    incoming: LogicValue[]\n    decoded: [string, LogicValue[]][]\n}\n\nexport class ShiftDisplay extends ComponentBase<ShiftDisplayRepr, ShiftDisplayState> {\n\n    protected _decodeAs: ShiftBufferDecoder\n    protected _groupEvery: number | undefined\n    protected _maxItems: number | undefined\n    protected _trigger: EdgeTrigger\n    protected _lastClock: LogicValue = Unknown\n\n    public constructor(parent: DrawableParent, saved?: ShiftDisplayRepr) {\n        super(parent, ShiftDisplayDef, saved)\n\n        this._decodeAs = saved?.decodeAs ?? ShiftDisplayDef.aults.decodeAs\n        this._groupEvery = saved?.groupEvery ?? undefined\n        this._maxItems = saved?.maxItems ?? undefined\n        this._trigger = saved?.trigger ?? ShiftDisplayDef.aults.trigger\n\n        this.redecodeAll()\n    }\n\n    public toJSON() {\n        const stateArray = allBitsOf(this.value).map(b => toLogicValueRepr(b))\n        return {\n            ...this.toJSONBase(),\n            state: stateArray.length === 0 ? undefined : stateArray.join(\"\"),\n            decodeAs: (this._decodeAs !== ShiftDisplayDef.aults.decodeAs) ? this._decodeAs : undefined,\n            groupEvery: this._groupEvery,\n            maxItems: this._maxItems,\n            trigger: (this._trigger !== ShiftDisplayDef.aults.trigger) ? this._trigger : undefined,\n        }\n    }\n\n    public get trigger() {\n        return this._trigger\n    }\n\n    public override makeTooltip() {\n        return tooltipContent(S.Components.ShiftDisplay.tooltip, mods(\n            div(JSON5.stringify(this.value)) // TODO more info\n        ))\n    }\n\n    protected doRecalcValue(): ShiftDisplayState {\n        if (this.inputs.Clr.value === true) {\n            return { incoming: [], decoded: [] }\n        }\n        const prevClock = this._lastClock\n        const clock = this._lastClock = this.inputs.Clock.value\n        const oldValue = this.value\n\n        if (Flipflop.isClockTrigger(this._trigger, prevClock, clock)) {\n            const newBit = this.inputs.D.value\n            const decoder = ShiftDisplayDecoders.props[this._decodeAs]\n            const maxItems = this._maxItems ?? decoder.maxDisplayWidth\n            return ShiftDisplay.valueByAddingNewBit(newBit, oldValue, decoder, maxItems)\n        }\n        return oldValue\n    }\n\n    private static valueByAddingNewBit(newBit: LogicValue, oldValue: ShiftDisplayState, decoder: ShiftDisplayDecoderProps, maxItems: number): ShiftDisplayState {\n        const newIncoming = [newBit, ...oldValue.incoming]\n        if (newIncoming.length < decoder.decodeWidth) {\n            return { incoming: newIncoming, decoded: oldValue.decoded }\n        }\n        const valAsInt = displayValuesFromArray(newIncoming, true)[1]\n        const decoded = isUnknown(valAsInt) ? Unknown : decoder.decode(valAsInt)\n        const newDecoded: ShiftDisplayState[\"decoded\"] = [[decoded, newIncoming], ...oldValue.decoded]\n        if (newDecoded.length > maxItems) {\n            newDecoded.splice(maxItems, newDecoded.length - maxItems)\n        }\n        return { incoming: [], decoded: newDecoded }\n    }\n\n\n    protected doSetTrigger(trigger: EdgeTrigger) {\n        this._trigger = trigger\n        this.requestRedraw({ why: \"trigger changed\", invalidateTests: true })\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, {\n            drawInside: () => {\n                const drawContents = () => {\n                    const text = this.makeRepresentationString()\n                    let toDraw\n                    if (text === undefined) {\n                        g.fillStyle = COLOR_COMPONENT_INNER_LABELS\n                        g.font = \"15px sans-serif\"\n                        toDraw = S.Components.ShiftDisplay.EmptyCaption\n                    } else {\n                        g.fillStyle = COLOR_COMPONENT_BORDER\n                        g.font = \"bold 16px sans-serif\"\n                        toDraw = text\n                    }\n                    fillTextVAlign(g, TextVAlign.middle, toDraw, this.posX, this.posY)\n                }\n\n                g.textAlign = \"center\"\n                if (this.orient === \"w\") {\n                    // avoid text upside down\n                    ctx.inNonTransformedFrame(drawContents)\n                } else {\n                    drawContents()\n                }\n            },\n        })\n    }\n\n    private makeRepresentationString() {\n        const { incoming, decoded } = this.value\n        if (incoming.length === 0 && decoded.length === 0) {\n            return undefined\n        }\n\n        const decodeAs = this._decodeAs\n        const decoder = ShiftDisplayDecoders.props[decodeAs]\n        const toPad = decoder.decodeWidth - incoming.length\n        const padding = repeatString(\"_\u202F\", toPad)\n        const undecodedStr = padding + displayValuesFromArray(incoming, true)[0]\n\n        const sep = decodeAs.includes(\"int\") ? \" \" : \"\"\n\n        let fullDecodedStr\n        if (decoded.length === 0) {\n            fullDecodedStr = \"\u2026\"\n        } else {\n            const groupEvery = this._groupEvery ?? 0\n            if (groupEvery < 2) {\n                fullDecodedStr = decoded.map(v => v[0]).join(sep)\n            } else {\n                const offset = groupEvery - (decoded.length % groupEvery)\n                const decodedParts: string[] = []\n                for (let i = 0; i < decoded.length; i++) {\n                    if (i !== 0) {\n                        if ((i + offset) % groupEvery === 0) {\n                            decodedParts.push(sep + \" \")\n                        } else {\n                            decodedParts.push(sep)\n                        }\n                    }\n                    decodedParts.push(decoded[i][0])\n                }\n                fullDecodedStr = decodedParts.join(\"\")\n            }\n            if (decodeAs === \"hex\") {\n                fullDecodedStr = \"0x\" + (groupEvery < 2 ? \"\" : \" \") + fullDecodedStr\n            } else if (decodeAs === \"octal\") {\n                fullDecodedStr = \"0o\" + (groupEvery < 2 ? \"\" : \" \") + fullDecodedStr\n            }\n        }\n\n        if (decodeAs === \"raw\") {\n            return fullDecodedStr\n        }\n        return undecodedStr + \" \u279F \" + fullDecodedStr\n    }\n\n    private redecodeAll() {\n        const decoder = ShiftDisplayDecoders.props[this._decodeAs]\n        const allBits = allBitsOf(this.value)\n        const maxItems = this._maxItems ?? decoder.maxDisplayWidth\n        let value: ShiftDisplayState = { incoming: [], decoded: [] }\n        for (const newBit of allBits.reverse()) {\n            value = ShiftDisplay.valueByAddingNewBit(newBit, value, decoder, maxItems)\n        }\n        this.doSetValue(value)\n    }\n\n    private doSetDecodeAs(decodeAs: ShiftBufferDecoder) {\n        this._decodeAs = decodeAs\n        this.redecodeAll() // will call requestRedraw\n    }\n\n    private doSetGroupEvery(groupEvery: number | undefined) {\n        this._groupEvery = groupEvery\n        this.requestRedraw({ why: \"grouping changed\" })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n\n        const s = S.Components.ShiftDisplay.contextMenu\n        const makeItemDecodeAs = (decoder: ShiftBufferDecoder, desc: string) => {\n            const isCurrent = this._decodeAs === decoder\n            const icon = isCurrent ? \"check\" : \"none\"\n            return MenuData.item(icon, desc, () => this.doSetDecodeAs(decoder))\n        }\n\n        const makeItemGroupEvery = (groupEvery: number | undefined, desc: string) => {\n            const isCurrent = this._groupEvery === groupEvery\n            const icon = isCurrent ? \"check\" : \"none\"\n            return MenuData.item(icon, desc, () => this.doSetGroupEvery(groupEvery))\n        }\n\n        return [\n            ...makeTriggerItems(this._trigger, this.doSetTrigger.bind(this)),\n            [\"mid\", MenuData.sep()],\n            [\"mid\", MenuData.submenu(\"eye\", s.Decoding, [\n                makeItemDecodeAs(\"raw\", s.DecodingNone),\n                makeItemDecodeAs(\"octal\", s.DecodingOctal),\n                makeItemDecodeAs(\"hex\", s.DecodingHex),\n                makeItemDecodeAs(\"ascii\", s.DecodingAscii7),\n                makeItemDecodeAs(\"ascii8\", s.DecodingAscii8),\n                makeItemDecodeAs(\"uint4\", s.DecodingUint4),\n                makeItemDecodeAs(\"int4\", s.DecodingInt4),\n                makeItemDecodeAs(\"uint8\", s.DecodingUint8),\n                makeItemDecodeAs(\"int8\", s.DecodingInt8),\n                makeItemDecodeAs(\"uint16\", s.DecodingUint16),\n                makeItemDecodeAs(\"int16\", s.DecodingInt16),\n                MenuData.sep(),\n                MenuData.text(s.DecodingChangeWarning),\n            ])],\n            [\"mid\", MenuData.submenu(\"regroup\", s.Grouping, [\n                makeItemGroupEvery(undefined, s.GroupingNone),\n                MenuData.sep(),\n                makeItemGroupEvery(2, s.GroupBy.expand({ n: 2 })),\n                makeItemGroupEvery(3, s.GroupBy.expand({ n: 3 })),\n                makeItemGroupEvery(4, s.GroupBy.expand({ n: 4 })),\n                makeItemGroupEvery(7, s.GroupBy.expand({ n: 7 })),\n                makeItemGroupEvery(8, s.GroupBy.expand({ n: 8 })),\n                makeItemGroupEvery(16, s.GroupBy.expand({ n: 16 })),\n            ])],\n        ]\n    }\n}\nShiftDisplayDef.impl = ShiftDisplay\n\nfunction allBitsOf({ incoming, decoded }: ShiftDisplayState): LogicValue[] {\n    const allBits = [...incoming]\n    for (const [__stringRep, bits] of decoded) {\n        allBits.push(...bits)\n    }\n    return allBits\n}\n", "import { COLOR_COMPONENT_BORDER, TextVAlign, fillTextVAlign } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { LogicValue, Unknown, isHighImpedance, isUnknown } from \"../utils\"\nimport { Repr, ResolvedParams, defineParametrizedComponent } from \"./Component\"\nimport { DrawableParent, GraphicsRendering } from \"./Drawable\"\nimport { RegisterBase, RegisterBaseDef } from \"./Register\"\n\nexport const ShiftRegisterDef =\n    defineParametrizedComponent(\"shift-reg\", true, true, {\n        variantName: ({ bits }) => `shift-reg-${bits}`,\n        idPrefix: \"reg\",\n        ...RegisterBaseDef,\n        makeNodes: (params, defaults) => {\n            const base = RegisterBaseDef.makeNodes(params, defaults)\n            const lrYOffset = base.ins.Clock[1] - 2\n            return {\n                ins: {\n                    ...base.ins,\n                    D: [-5, 0, \"w\"],\n                    L\u0305R: [-5, lrYOffset, \"w\"],\n                },\n                outs: base.outs,\n            }\n        },\n    })\n\nexport type ShiftRegisterRepr = Repr<typeof ShiftRegisterDef>\nexport type ShiftRegisterParams = ResolvedParams<typeof ShiftRegisterDef>\n\nexport class ShiftRegister extends RegisterBase<ShiftRegisterRepr> {\n\n    public constructor(parent: DrawableParent, params: ShiftRegisterParams, saved?: ShiftRegisterRepr) {\n        super(parent, ShiftRegisterDef, params, saved)\n    }\n\n    public toJSON() {\n        return this.toJSONBase()\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.ShiftRegister.tooltip\n\n        // TODO add explanation of shift register direction\n        return tooltipContent(s.title, mods(\n            div(s.desc.expand({ numBits: this.numBits })) // TODO more info egenrically from register\n        ))\n    }\n\n    public makeStateAfterClock(): LogicValue[] {\n        const dirIsRight = this.inputs.L\u0305R.value\n        if (isUnknown(dirIsRight) || isHighImpedance(dirIsRight)) {\n            return this.makeStateFromMainValue(Unknown)\n        }\n        const d = LogicValue.filterHighZ(this.inputs.D.value)\n        const current = this.value\n        const next = dirIsRight ? [...current.slice(1), d] : [d, ...current.slice(0, -1)]\n        return next\n    }\n\n    protected override doDrawGenericCaption(g: GraphicsRendering) {\n        g.font = `bold 13px sans-serif`\n        g.fillStyle = COLOR_COMPONENT_BORDER\n        g.textAlign = \"center\"\n        fillTextVAlign(g, TextVAlign.middle, \"Shift R.\", this.posX, this.posY - 8)\n        g.font = `11px sans-serif`\n        fillTextVAlign(g, TextVAlign.middle, `${this.numBits} bits`, this.posX, this.posY + 10)\n    }\n\n}\nShiftRegisterDef.impl = ShiftRegister", "import * as t from \"io-ts\"\nimport { COLOR_BACKGROUND, COLOR_COMPONENT_BORDER, COLOR_MOUSE_OVER, drawWireLineToComponent, GRID_STEP } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { HighImpedance, isHighImpedance, isUnknown, LogicValue, typeOrUndefined, Unknown } from \"../utils\"\nimport { defineParametrizedComponent, paramBool, ParametrizedComponentBase, Repr, ResolvedParams } from \"./Component\"\nimport { DrawableParent, DrawContext, GraphicsRendering, MenuItems } from \"./Drawable\"\n\nexport const TristateBufferDef =\n    defineParametrizedComponent(\"tristate\", true, true, {\n        variantName: ({ bottom }) => `tristate${bottom ? \"b\" : \"\"}`,\n        idPrefix: \"tristate\",\n        button: { imgWidth: 50 },\n        repr: {\n            bottom: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {},\n        params: {\n            bottom: paramBool(),\n        },\n        validateParams: ({ bottom }) => {\n            return { controlPinsAtBottom: bottom }\n        },\n        size: () => ({ gridWidth: 4, gridHeight: 4 }),\n        makeNodes: ({ controlPinsAtBottom }) => ({\n            ins: {\n                In: [-4, 0, \"w\", { leadLength: 20 }],\n                E: [0,\n                    controlPinsAtBottom ? 3 : -3,\n                    controlPinsAtBottom ? \"s\" : \"n\",\n                    \"E (Enable)\", { leadLength: 20 },\n                ],\n            },\n            outs: {\n                Out: [+4, 0, \"e\", { leadLength: 20 }],\n            },\n        }),\n        initialValue: () => HighImpedance as LogicValue,\n    })\n\ntype TristateBufferRepr = Repr<typeof TristateBufferDef>\ntype TristateBufferParams = ResolvedParams<typeof TristateBufferDef>\n\nexport class TristateBuffer extends ParametrizedComponentBase<TristateBufferRepr> {\n\n    public readonly controlPinsAtBottom: boolean\n\n    public constructor(parent: DrawableParent, params: TristateBufferParams, saved?: TristateBufferRepr) {\n        super(parent, TristateBufferDef.with(params), saved)\n\n        this.controlPinsAtBottom = params.controlPinsAtBottom\n    }\n\n    public toJSON() {\n        return {\n            ... this.toJSONBase(),\n            bottom: this.controlPinsAtBottom === TristateBufferDef.aults.bottom ? undefined : this.controlPinsAtBottom,\n        }\n    }\n\n    public override makeTooltip() {\n        return tooltipContent(undefined, mods(\n            div(S.Components.TristateBuffer.tooltip) // TODO\n        ))\n    }\n\n    protected doRecalcValue(): LogicValue {\n        const en = this.inputs.E.value\n        if (isUnknown(en) || isHighImpedance(en)) {\n            return Unknown\n        }\n        if (!en) {\n            return HighImpedance\n        }\n        const i = this.inputs.In.value\n        if (isHighImpedance(i)) {\n            return Unknown\n        }\n        return i\n    }\n\n    protected override propagateValue(newValue: LogicValue) {\n        this.outputs.Out.value = newValue\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n\n        drawWireLineToComponent(g, this.inputs.In)\n        drawWireLineToComponent(g, this.inputs.E)\n        drawWireLineToComponent(g, this.outputs.Out)\n\n        const { top, bottom } = this.bounds()\n        const gateWidth = (2 * Math.max(2, this.inputs._all.length)) * GRID_STEP\n        const gateLeft = this.posX - gateWidth / 2\n        const gateRight = this.posX + gateWidth / 2\n        g.fillStyle = COLOR_BACKGROUND\n        g.strokeStyle = ctx.isMouseOver ? COLOR_MOUSE_OVER : COLOR_COMPONENT_BORDER\n        g.lineWidth = 3\n\n        g.beginPath()\n        g.moveTo(gateLeft, top)\n        g.lineTo(gateRight, this.posY)\n        g.lineTo(gateLeft, bottom)\n        g.closePath()\n        g.stroke()\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        return [\n            this.makeChangeBooleanParamsContextMenuItem(S.Components.Generic.contextMenu.ParamControlBitAtBottom, this.controlPinsAtBottom, \"bottom\"),\n        ]\n    }\n\n}\nTristateBufferDef.impl = TristateBuffer\n", "import * as t from \"io-ts\"\nimport { COLOR_COMPONENT_BORDER, colorForLogicValue } from \"../drawutils\"\nimport { div, mods, tooltipContent } from \"../htmlgen\"\nimport { S } from \"../strings\"\nimport { ArrayFillWith, HighImpedance, LogicValue, Unknown, isHighImpedance, isUnknown, typeOrUndefined } from \"../utils\"\nimport { ParametrizedComponentBase, Repr, ResolvedParams, defineParametrizedComponent, groupVertical, param, paramBool } from \"./Component\"\nimport { ControlledInverterDef } from \"./ControlledInverter\"\nimport { DrawContext, DrawableParent, GraphicsRendering, MenuItems } from \"./Drawable\"\n\n\nexport const TristateBufferArrayDef =\n    defineParametrizedComponent(\"tristate-array\", true, true, {\n        variantName: ({ bits, bottom }) => `tristate-array-${bits}${bottom ? \"b\" : \"\"}`,\n        idPrefix: \"tristate\",\n        button: { imgWidth: 50 },\n        repr: {\n            bits: typeOrUndefined(t.number),\n            bottom: typeOrUndefined(t.boolean),\n        },\n        valueDefaults: {},\n        params: {\n            bits: param(4, [2, 4, 8, 16]),\n            bottom: paramBool(),\n        },\n        validateParams: ({ bits, bottom }) => ({\n            numBits: bits,\n            controlPinsAtBottom: bottom,\n        }),\n        size: ControlledInverterDef.size,\n        makeNodes: ({ numBits, controlPinsAtBottom, gridHeight }) => ({\n            ins: {\n                In: groupVertical(\"w\", -3, 0, numBits),\n                E: [0,\n                    -(gridHeight / 2 + 1) * (controlPinsAtBottom ? -1 : 1),\n                    controlPinsAtBottom ? \"s\" : \"n\",\n                    \"E (Enable)\",\n                ],\n            },\n            outs: {\n                Out: groupVertical(\"e\", 3, 0, numBits),\n            },\n        }),\n        initialValue: (saved, { numBits }) => ArrayFillWith<LogicValue>(HighImpedance, numBits),\n    })\n\n\nexport type TristateBufferArrayRepr = Repr<typeof TristateBufferArrayDef>\nexport type TristateBufferArrayParams = ResolvedParams<typeof TristateBufferArrayDef>\n\nexport class TristateBufferArray extends ParametrizedComponentBase<TristateBufferArrayRepr> {\n\n    public readonly numBits: number\n    public readonly controlPinsAtBottom: boolean\n\n    public constructor(parent: DrawableParent, params: TristateBufferArrayParams, saved?: TristateBufferArrayRepr) {\n        super(parent, TristateBufferArrayDef.with(params), saved)\n        this.numBits = params.numBits\n        this.controlPinsAtBottom = params.controlPinsAtBottom\n    }\n\n    public toJSON() {\n        return {\n            ...this.toJSONBase(),\n            bits: this.numBits === TristateBufferArrayDef.aults.bits ? undefined : this.numBits,\n            bottom: this.controlPinsAtBottom === TristateBufferArrayDef.aults.bottom ? undefined : this.controlPinsAtBottom,\n        }\n    }\n\n    public override makeTooltip() {\n        const s = S.Components.TristateBufferArray.tooltip\n        return tooltipContent(s.title, mods(\n            div(s.desc)\n        ))\n    }\n\n    protected doRecalcValue(): LogicValue[] {\n        const enable = this.inputs.E.value\n\n        if (isUnknown(enable) || isHighImpedance(enable)) {\n            return ArrayFillWith(Unknown, this.numBits)\n        }\n\n        if (!enable) {\n            return ArrayFillWith(HighImpedance, this.numBits)\n        }\n\n        return this.inputValues(this.inputs.In)\n    }\n\n    protected override propagateValue(newValue: LogicValue[]) {\n        this.outputValues(this.outputs.Out, newValue)\n    }\n\n    protected override doDraw(g: GraphicsRendering, ctx: DrawContext) {\n        this.doDrawDefault(g, ctx, {\n            skipLabels: true,\n            drawInside: ({ top, bottom, left, right }) => {\n                const enable = this.inputs.E.value\n\n                g.lineWidth = 2\n                g.strokeStyle = colorForLogicValue(enable)\n                g.beginPath()\n                if (this.controlPinsAtBottom) {\n                    g.moveTo(this.posX, bottom)\n                    g.lineTo(this.posX, this.posY + 4)\n                } else {\n                    g.moveTo(this.posX, top)\n                    g.lineTo(this.posX, this.posY - 4)\n                }\n                g.stroke()\n\n                g.strokeStyle = COLOR_COMPONENT_BORDER\n                g.beginPath()\n                g.moveTo(left + 12, this.posY - 8)\n                g.lineTo(right - 13, this.posY)\n                g.lineTo(left + 12, this.posY + 8)\n                g.closePath()\n                g.stroke()\n            },\n        })\n    }\n\n    protected override makeComponentSpecificContextMenuItems(): MenuItems {\n        const s = S.Components.Generic.contextMenu\n        return [\n            this.makeChangeParamsContextMenuItem(\"inputs\", s.ParamNumBits, this.numBits, \"bits\"),\n            this.makeChangeBooleanParamsContextMenuItem(s.ParamControlBitAtBottom, this.controlPinsAtBottom, \"bottom\"),\n            ...this.makeForceOutputsContextMenuItem(true),\n        ]\n    }\n\n}\nTristateBufferArrayDef.impl = TristateBufferArray\n", "import { Branded } from \"io-ts\"\nimport JSON5 from \"json5\"\nimport { ButtonDataset } from \"./ComponentFactory\"\nimport { LogicEditor } from \"./LogicEditor\"\nimport { ALUDef } from \"./components/ALU\"\nimport { AdderDef } from \"./components/Adder\"\nimport { AdderArrayDef } from \"./components/AdderArray\"\nimport { ClockDef } from \"./components/Clock\"\nimport { ComparatorDef } from \"./components/Comparator\"\nimport { ParamDef, ParametrizedComponentDef, ParamsFromDefs } from \"./components/Component\"\nimport { ControlledInverterDef } from \"./components/ControlledInverter\"\nimport { CounterDef } from \"./components/Counter\"\nimport { CustomComponentDef, CustomComponentImageHeight, CustomComponentImageWidth } from \"./components/CustomComponent\"\nimport { DecoderDef } from \"./components/Decoder\"\nimport { Decoder16SegDef } from \"./components/Decoder16Seg\"\nimport { Decoder7SegDef } from \"./components/Decoder7Seg\"\nimport { DecoderBCD4Def } from \"./components/DecoderBCD4\"\nimport { DemuxDef } from \"./components/Demux\"\nimport { DisplayDef } from \"./components/Display\"\nimport { Display16SegDef } from \"./components/Display16Seg\"\nimport { Display7SegDef } from \"./components/Display7Seg\"\nimport { DisplayAsciiDef } from \"./components/DisplayAscii\"\nimport { DisplayBarDef } from \"./components/DisplayBar\"\nimport { FlipflopDDef } from \"./components/FlipflopD\"\nimport { FlipflopJKDef } from \"./components/FlipflopJK\"\nimport { FlipflopTDef } from \"./components/FlipflopT\"\nimport { Gate1Def, GateNDef, GateTypePrefix } from \"./components/Gate\"\nimport { GateArrayDef } from \"./components/GateArray\"\nimport { HalfAdderDef } from \"./components/HalfAdder\"\nimport { InputDef } from \"./components/Input\"\nimport { LabelDef } from \"./components/Label\"\nimport { LatchSRDef } from \"./components/LatchSR\"\nimport { MuxDef } from \"./components/Mux\"\nimport { OutputDef } from \"./components/Output\"\nimport { PassthroughDef } from \"./components/Passthrough\"\nimport { PixelDef } from \"./components/Pixel\"\nimport { RAMDef } from \"./components/RAM\"\nimport { ROMDef } from \"./components/ROM\"\nimport { RandomDef } from \"./components/Random\"\nimport { RectangleDef } from \"./components/Rectangle\"\nimport { RegisterDef } from \"./components/Register\"\nimport { ShiftDisplayDef } from \"./components/ShiftDisplay\"\nimport { ShiftRegisterDef } from \"./components/ShiftRegister\"\nimport { TristateBufferDef } from \"./components/TristateBuffer\"\nimport { TristateBufferArrayDef } from \"./components/TristateBufferArray\"\nimport { a, button, cls, div, emptyMod, raw, span, style, title, type } from \"./htmlgen\"\nimport { ImageName, makeImage, makeSvgHolder } from \"./images\"\nimport { S, Strings } from \"./strings\"\nimport { deepObjectEquals, isArray, isString, setVisible } from \"./utils\"\n\nexport type ComponentKey = Strings[\"ComponentBar\"][\"Components\"][\"type\"]\n\nexport type DefAndParams<\n    TParamDefs extends Record<string, ParamDef<unknown>>,\n    TParams extends ParamsFromDefs<TParamDefs>\n> = {\n    def: ParametrizedComponentDef<any, any, any, any, any, any, any, any, TParams>,\n    params: TParams\n}\n\nexport type LibraryItemVisibility = \"always\" | \"withButton\" | \"ifShowOnly\"\nconst withButton = \"withButton\"\nconst ifShowOnly = \"ifShowOnly\"\n\nexport type LibraryItem = {\n    type: string\n    params?: Branded<DefAndParams<any, any>, \"params\">\n    visual: ComponentKey & ImageName | [ComponentKey, ImageName]\n    compat?: string // for compatibility with old URL params\n    width: number\n    visible?: LibraryItemVisibility\n}\n\nexport type LibraryButtonProps = { imgWidth: number }\nexport type LibraryButtonOptions = { compat?: string, visible?: LibraryItemVisibility }\n\ntype SectionNameKey = keyof Strings[\"ComponentBar\"][\"SectionNames\"]\n\ntype Section = {\n    nameKey: SectionNameKey,\n    items: Array<LibraryItem>\n}\n\nconst componentsMenu: Array<Section> = [{\n    nameKey: \"InputOutput\",\n    items: [\n        InputDef.button({ bits: 1 }, \"Input1\"),\n        OutputDef.button({ bits: 1 }, \"Output1\"),\n        DisplayBarDef.button(\"DisplayBar\", { compat: \"out.bar\", visible: withButton }),\n        PixelDef.button({ bits: 2, gray: false, touch: false }, \"Pixel\", { visible: withButton }),\n        ClockDef.button(\"Clock\"),\n\n        InputDef.button({ bits: 4 }, [\"InputN\", \"Input4\"], { compat: \"in.nibble\" }),\n        OutputDef.button({ bits: 4 }, [\"OutputN\", \"Output4\"], { compat: \"out.nibble\" }),\n        DisplayDef.button({ bits: 4 }, [\"DisplayN\", \"Display4\"], { compat: \"out.nibble-display\" }),\n\n        InputDef.button({ bits: 8 }, \"Input8\", { compat: \"in.byte\", visible: ifShowOnly }),\n        OutputDef.button({ bits: 8 }, \"Output8\", { compat: \"out.byte\", visible: ifShowOnly }),\n        DisplayDef.button({ bits: 8 }, \"Display8\", { compat: \"out.byte-display\", visible: ifShowOnly }),\n\n        Display7SegDef.button(\"Display7Seg\", { compat: \"out.7seg\", visible: withButton }),\n        Display16SegDef.button(\"Display16Seg\", { compat: \"out.16seg\", visible: withButton }),\n        DisplayAsciiDef.button(\"DisplayAscii\", { compat: \"out.ascii\", visible: withButton }),\n\n        RandomDef.button({ bits: 1 }, \"Random\", { compat: \"random\", visible: withButton }),\n        ShiftDisplayDef.button(\"ShiftDisplay\", { compat: \"out.shift-buffer\", visible: withButton }),\n    ],\n}, {\n    nameKey: \"Gates\",\n    items: [\n        Gate1Def.button({ type: \"not\" }, \"not\"),\n        Gate1Def.button({ type: \"buf\" }, \"buf\", { visible: withButton }),\n        TristateBufferDef.button({ bottom: false }, \"tri\", { compat: \"tri\", visible: withButton }),\n\n        GateNDef.button({ type: \"and\", bits: 2 }, \"and\"),\n        GateNDef.button({ type: \"or\", bits: 2 }, \"or\"),\n        GateNDef.button({ type: \"xor\", bits: 2 }, \"xor\"),\n        GateNDef.button({ type: \"nand\", bits: 2 }, \"nand\"),\n        GateNDef.button({ type: \"nor\", bits: 2 }, \"nor\"),\n\n        GateNDef.button({ type: \"xnor\", bits: 2 }, \"xnor\", { visible: withButton }),\n        GateNDef.button({ type: \"imply\", bits: 2 }, \"imply\", { visible: withButton }),\n        GateNDef.button({ type: \"nimply\", bits: 2 }, \"nimply\", { visible: withButton }),\n        GateNDef.button({ type: \"txa\", bits: 2 }, [\"transfer\", \"txa\"], { visible: withButton }),\n\n        GateNDef.button({ type: \"and\", bits: 3 }, \"and3\", { compat: \"and3\", visible: ifShowOnly }),\n        GateNDef.button({ type: \"or\", bits: 3 }, \"or3\", { compat: \"or3\", visible: ifShowOnly }),\n        GateNDef.button({ type: \"xor\", bits: 3 }, \"xor3\", { compat: \"xor3\", visible: ifShowOnly }),\n        GateNDef.button({ type: \"nand\", bits: 3 }, \"nand3\", { compat: \"nand3\", visible: ifShowOnly }),\n        GateNDef.button({ type: \"nor\", bits: 3 }, \"nor3\", { compat: \"nor3\", visible: ifShowOnly }),\n        GateNDef.button({ type: \"xnor\", bits: 3 }, \"xnor3\", { compat: \"xnor3\", visible: ifShowOnly }),\n\n        GateNDef.button({ type: \"and\", bits: 4 }, \"and4\", { compat: \"and4\", visible: ifShowOnly }),\n        GateNDef.button({ type: \"or\", bits: 4 }, \"or4\", { compat: \"or4\", visible: ifShowOnly }),\n        GateNDef.button({ type: \"xor\", bits: 4 }, \"xor4\", { compat: \"xor4\", visible: ifShowOnly }),\n        GateNDef.button({ type: \"nand\", bits: 4 }, \"nand4\", { compat: \"nand4\", visible: ifShowOnly }),\n        GateNDef.button({ type: \"nor\", bits: 4 }, \"nor4\", { compat: \"nor4\", visible: ifShowOnly }),\n        GateNDef.button({ type: \"xnor\", bits: 4 }, \"xnor4\", { compat: \"xnor4\", visible: ifShowOnly }),\n\n        ControlledInverterDef.button({ bits: 4, bottom: false }, \"ControlledInverter\", { compat: \"switched-inverter\", visible: withButton }),\n        GateArrayDef.button({ type: \"and\", bits: 4 }, \"GateArray\", { compat: \"quad-gate\", visible: withButton }),\n        TristateBufferArrayDef.button({ bits: 4, bottom: false }, \"TristateBufferArray\", { visible: withButton }),\n\n    ],\n}, {\n    nameKey: \"Layout\",\n    items: [\n        LabelDef.button(\"Label\"),\n        RectangleDef.button(\"Rectangle\", { compat: \"label.rect\" }),\n\n        PassthroughDef.button({ bits: 1 }, \"Passthrough1\"),\n        PassthroughDef.button({ bits: 4 }, \"PassthroughN\"),\n    ],\n}, {\n    nameKey: \"Components\",\n    items: [\n        HalfAdderDef.button(\"HalfAdder\"),\n        AdderDef.button(\"Adder\"),\n        ComparatorDef.button(\"Comparator\", { compat: \"comparator\", visible: withButton }),\n\n        AdderArrayDef.button({ bits: 4 }, \"AdderArray\"),\n        ALUDef.button({ bits: 4, ext: false }, \"ALU\"),\n\n        MuxDef.button({ from: 4, to: 2, bottom: false }, \"Mux\"),\n        MuxDef.button({ from: 8, to: 4, bottom: false }, \"Mux\", { visible: ifShowOnly }),\n        DemuxDef.button({ from: 2, to: 4, bottom: false }, \"Demux\"),\n\n        LatchSRDef.button(\"LatchSR\"),\n        FlipflopJKDef.button(\"FlipflopJK\", { compat: \"flipflop-jk\", visible: withButton }),\n        FlipflopTDef.button(\"FlipflopT\", { compat: \"flipflop-t\", visible: withButton }),\n        FlipflopDDef.button(\"FlipflopD\", { compat: \"flipflop-d\" }),\n\n        RegisterDef.button({ bits: 4, inc: false }, \"Register\", { compat: \"register\" }),\n        ShiftRegisterDef.button({ bits: 4 }, \"ShiftRegister\", { compat: \"shift-register\" }),\n        CounterDef.button({ bits: 4 }, \"Counter\"),\n\n        RAMDef.button({ lines: 16, bits: 4 }, \"RAM\"),\n        ROMDef.button({ lines: 16, bits: 4 }, \"ROM\", { visible: withButton }),\n\n        DecoderDef.button({ bits: 2 }, \"Decoder\", { compat: \"decoder\" }),\n        Decoder7SegDef.button(\"Decoder7Seg\", { compat: \"decoder-7seg\" }),\n        Decoder16SegDef.button(\"Decoder16Seg\", { compat: \"decoder-16seg\", visible: withButton }),\n        DecoderBCD4Def.button(\"DecoderBCD4\", { compat: \"decoder-bcd4\", visible: withButton }),\n\n    ],\n}]\n\n\ntype HtmlSection = {\n    separator?: HTMLElement\n    header: HTMLDivElement\n    buttons: HTMLButtonElement[]\n    showMoreLink?: HTMLAnchorElement\n}\n\n\nexport class ComponentMenu {\n\n    private readonly _htmlSections: HtmlSection[]\n    private _customComponentSection?: HtmlSection\n    private _restrictedToGateTypes: Set<string> | undefined\n\n    public constructor(\n        public readonly editor: LogicEditor,\n        public readonly parent: HTMLElement,\n    ) {\n        const showOnly = editor.options.showOnly\n        this._htmlSections = []\n        this._restrictedToGateTypes = showOnly === undefined ? undefined : new Set()\n        const showOnlyBuf = showOnly === undefined ? undefined : [...showOnly]\n        let lastSectionNonEmpty = false\n\n        for (const section of componentsMenu) {\n            const { allButtons, buttonsShowWithMore, buttonsShowWithURLParam, accessibleGateTypes } =\n                makeButtons(section, showOnlyBuf)\n            const htmlSection = this.makeSection(section.nameKey, allButtons, buttonsShowWithMore, buttonsShowWithURLParam, showOnlyBuf, lastSectionNonEmpty)\n            for (const type of accessibleGateTypes) {\n                this._restrictedToGateTypes?.add(type)\n            }\n            if (htmlSection !== undefined) {\n                this._htmlSections.push(htmlSection)\n                lastSectionNonEmpty = true\n            }\n        }\n\n        if (showOnlyBuf !== undefined && showOnlyBuf.filter(s => !s.endsWith(\"*\")).length > 0) {\n            console.log(`ERROR Supposed to show unknown elems: ${showOnlyBuf.join(\"; \")}`)\n        }\n    }\n\n    public allFixedButtons() {\n        return this._htmlSections.flatMap(s => s.buttons)\n    }\n\n    public allCustomButtons() {\n        return this._customComponentSection === undefined ? [] : this._customComponentSection.buttons\n    }\n\n    public allowGateType(type: string) {\n        return this._restrictedToGateTypes?.has(type) ?? true\n    }\n\n    public updateCustomComponentButtons(defs: readonly CustomComponentDef[] | undefined) {\n        const oldSec = this._customComponentSection\n        if (oldSec !== undefined) {\n            // clear old buttons\n            if (oldSec.header !== undefined) {\n                oldSec.header.remove()\n            }\n            if (oldSec.separator !== undefined) {\n                oldSec.separator.remove()\n            }\n            for (const button of oldSec.buttons) {\n                button.remove()\n            }\n            if (oldSec.showMoreLink !== undefined) {\n                oldSec.showMoreLink.remove()\n            }\n        }\n        this._customComponentSection = defs === undefined ? undefined : this.makeCustomComponentSection(defs)\n    }\n\n    public setCustomComponentsHidden(ids: readonly string[]) {\n        const section = this._customComponentSection\n        if (section === undefined) {\n            return\n        }\n        let anyVisible = false\n        for (const button of section.buttons) {\n            const show = !ids.includes(button.dataset.type!)\n            anyVisible ||= show\n            setVisible(button, show)\n        }\n        setVisible(section.header, anyVisible)\n        if (section.separator !== undefined) {\n            setVisible(section.separator, anyVisible)\n        }\n    }\n\n    private makeCustomComponentSection(defs: readonly CustomComponentDef[]): HtmlSection | undefined {\n        const showOnly = this.editor.options.showOnly\n        const showOnlyBuf = showOnly === undefined ? undefined : [...showOnly]\n\n        const allButtons: HTMLButtonElement[] = []\n        const buttonsShowWithMore: HTMLButtonElement[] = []\n        for (const def of defs) {\n            const type = def.type\n            const icon = makeSvgHolder(\"svgimg\", \"custom\", def.makeButtonSVG(),\n                CustomComponentImageWidth, CustomComponentImageHeight)\n            const caption = def.caption\n            const { compButton, hiddenNow } = makeButton(\n                type, false, [type], showOnlyBuf,\n                icon, caption, caption + S.Components.Custom.MenuButtonSuffix, undefined, true\n            )\n\n            if (hiddenNow) {\n                buttonsShowWithMore.push(compButton)\n            }\n            allButtons.push(compButton)\n        }\n\n        const makeSeparator = this._htmlSections.length > 0\n        return this.makeSection(\"Custom\", allButtons, buttonsShowWithMore, [], showOnlyBuf, makeSeparator)\n    }\n\n    private makeSection(nameKey: SectionNameKey, allButtons: HTMLButtonElement[], buttonsShowWithMore: HTMLButtonElement[], buttonsShowWithURLParam: HTMLButtonElement[], showOnlyBuf: string[] | undefined, makeSeparator: boolean): HtmlSection | undefined {\n        // component buttons\n\n        const numShowWithMoreButton = buttonsShowWithMore.length\n        const numAdded = allButtons.length\n        const numVisible = numAdded - numShowWithMoreButton - buttonsShowWithURLParam.length\n\n        if (numVisible === 0) {\n            return undefined\n        }\n\n        // separator\n        let separator: HTMLElement | undefined = undefined\n        if (makeSeparator) {\n            separator =\n                div(style(\"height: 20px\"),\n                    raw(\"&nbsp;\")\n                ).render()\n            this.parent.appendChild(separator)\n        }\n\n        // section header\n        const header: HTMLDivElement =\n            div(cls(\"leftToolbarHeader\"),\n                S.ComponentBar.SectionNames[nameKey]\n            ).render()\n        this.parent.appendChild(header)\n\n        for (const compButton of allButtons) {\n            this.parent.appendChild(compButton)\n        }\n\n        // link to show more if needed\n        let showMoreLink: HTMLAnchorElement | undefined = undefined\n        if (numShowWithMoreButton !== 0 && showOnlyBuf === undefined) {\n            let moreShown = false\n            const names = [S.ComponentBar.Labels.More + \" \u2193\", S.ComponentBar.Labels.Less + \" \u2191\"]\n            showMoreLink = a(cls(\"leftToolbarMore\"), names[0]).render()\n            showMoreLink.addEventListener(\"click\", () => {\n                moreShown = !moreShown\n                for (const button of buttonsShowWithMore) {\n                    if (moreShown) {\n                        button.style.removeProperty(\"padding\")\n                        button.style.removeProperty(\"border\")\n                        button.style.removeProperty(\"margin-bottom\")\n                        button.style.removeProperty(\"max-height\")\n                        button.style.removeProperty(\"overflow\")\n                    } else {\n                        button.style.padding = \"0\"\n                        button.style.border = \"0\"\n                        button.style.marginBottom = \"0\"\n                        button.style.maxHeight = \"0\"\n                        button.style.overflow = \"hidden\"\n                    }\n                }\n                showMoreLink!.innerHTML = names[Number(moreShown)]\n            })\n            this.parent.appendChild(showMoreLink)\n        }\n\n        return { separator, header, buttons: allButtons, showMoreLink }\n    }\n}\n\n\n// Helper functions\n\nfunction makeButtons(section: Section, showOnlyBuf: string[] | undefined) {\n    const allButtons: HTMLButtonElement[] = []\n    const buttonsShowWithMore: HTMLButtonElement[] = []\n    const buttonsShowWithURLParam: HTMLButtonElement[] = []\n    const accessibleGateTypes = new Set<string>()\n    for (const item of section.items) {\n        const normallyHidden = item.visible !== undefined && item.visible !== \"always\"\n        const [stringsKey, img] = isString(item.visual) ? [item.visual, item.visual] : item.visual\n        const compStrings = S.ComponentBar.Components.props[stringsKey]\n        const [titleStr, captionStr] = isString(compStrings) ? [compStrings, undefined] : compStrings\n        const { compButton, hiddenByShowOnly, hiddenNow } = makeButton(\n            item.type, normallyHidden, componentIdsFor(item), showOnlyBuf,\n            makeImage(img, item.width), captionStr, titleStr, item.params?.params, false\n        )\n\n        if (hiddenNow) {\n            const targetArray = item.visible === \"withButton\" ? buttonsShowWithMore : buttonsShowWithURLParam\n            targetArray.push(compButton)\n        }\n        allButtons.push(compButton)\n        const isGate = item.type.startsWith(GateTypePrefix)\n        let gateType\n        if (isGate && !hiddenByShowOnly && (gateType = item.params?.params?.type) !== undefined) {\n            accessibleGateTypes.add(gateType)\n        }\n    }\n    return { allButtons, buttonsShowWithMore, buttonsShowWithURLParam, accessibleGateTypes }\n}\n\n\nfunction makeButton(typeStr: string, normallyHidden: boolean, componentIds: string[], showOnlyBuf: string[] | undefined, buttonIcon: Element, captionStr: string | undefined, titleStr: string | undefined, params: Record<string, unknown> | undefined, isCustom: boolean) {\n\n    const hiddenByShowOnly = showOnlyBuf !== undefined ? !shouldShow(componentIds, showOnlyBuf) : false\n    const hiddenNow = showOnlyBuf !== undefined ? hiddenByShowOnly : normallyHidden\n\n    const buttonStyle = !hiddenNow ? \"\" : \"max-height: 0; transition: all 0.25s ease-out; overflow: hidden; padding: 0; border: 0; margin-bottom: 0;\"\n    const extraClasses = hiddenNow ? \" sim-component-button-extra\" : \"\"\n    const customClasses = isCustom ? \" sim-component-button-custom\" : \"\"\n    const caption = captionStr === undefined ? emptyMod : span(cls(\"barLabel\"), captionStr)\n    const buttonTitle = title(titleStr === undefined ? \"\" : (titleStr + \" \\n\") + `(\u201C${componentIds[0]}\u201D)`)\n    const compButton = button(\n        type(\"button\"), style(buttonStyle),\n        cls(`list-group-item list-group-item-action sim-component-button${extraClasses}${customClasses}`),\n        buttonIcon, caption, buttonTitle\n    ).render()\n\n    const compDataset = compButton.dataset as ButtonDataset\n    compDataset.type = typeStr\n    compDataset.componentId = componentIds[0]\n    if (params !== undefined) {\n        compDataset.params = JSON5.stringify(params)\n    }\n\n    return { compButton, hiddenByShowOnly, hiddenNow }\n}\n\n\nfunction shouldShow(componentIds: string[], showOnly: string[]) {\n    let visible = false\n    for (const componentId of componentIds) {\n        for (const showOnlySpec of showOnly) {\n            const [isMatch, isWildcard] = matchesSpec(showOnlySpec, componentId)\n            if (isMatch) {\n                visible = true\n                if (!isWildcard) {\n                    const ind = showOnly.indexOf(componentId)\n                    showOnly.splice(ind, 1)\n                }\n                break\n            }\n        }\n    }\n\n    // console.log(`buttonId '${buttonId}' is visible: ${visible}`)\n\n    return visible\n\n    function matchesSpec(showOnlySpec: string, componentId: string) {\n        if (showOnlySpec === componentId) {\n            return [true, false]\n        }\n        if (showOnlySpec.endsWith(\"*\") && componentId.startsWith(showOnlySpec.slice(0, -1))) {\n            return [true, true]\n        }\n        return [false, false]\n    }\n}\n\n\nfunction componentIdsFor(item: LibraryItem): string[] {\n    const ids: string[] = []\n    const defAndParams = item.params\n    const type = item.type\n\n    if (defAndParams === undefined) {\n        // no parameters\n        ids.push(type)\n\n    } else {\n        // with parameters; component may override primary type\n        // (e.g. gate => and, gate-array => and-array, etc)\n        const def = defAndParams.def\n\n        const variants = def.variantName(defAndParams.params)\n        if (isArray(variants)) {\n            // first returned element is base types, other are variants;\n            // we got them all\n            ids.push(...variants)\n\n        } else {\n            // is it the default variant? If so, push the base type as first id\n            if (deepObjectEquals(defAndParams.params, def.defaultParams)) {\n                ids.push(type)\n            } else {\n                // console.log(`Nonstandard for ${type}: ${JSON.stringify(params)} != ${JSON.stringify(defaultParams)}`)\n            }\n            ids.push(variants)\n        }\n    }\n\n    // compatibility variant\n    if (item.compat !== undefined) {\n        ids.push(item.compat)\n    }\n\n    return ids\n}\n", "import { LogicEditor } from \"./LogicEditor\"\nimport { applyModifierTo, cls, div, Modifier, span, style } from \"./htmlgen\"\nimport { setVisible, TimeoutHandle } from \"./utils\"\n\nexport class MessageBar {\n\n    private readonly root: HTMLElement\n    private readonly msgSpan: HTMLElement\n    private readonly closeButton: HTMLElement\n    private _currentTimeout: TimeoutHandle | undefined = undefined\n\n    public constructor(\n        editor: LogicEditor,\n    ) {\n        this.msgSpan = span().render()\n        this.closeButton = span(\"\u00D7\", style(\"padding-left: 0.5em; cursor: pointer; margin-left: 0.5em; border-left: 1px solid rgba(127,127,127,0.8);\")).render()\n        this.closeButton.onclick = () => this.hideNow()\n        this.root = div(cls(\"msgZone\"),\n            div(cls(\"msgBar\"),\n                this.msgSpan, this.closeButton,\n            ),\n        ).render()\n\n        editor.html.mainCanvas.insertAdjacentElement(\"afterend\", this.root)\n\n        this.hideNow = this.hideNow.bind(this)\n    }\n\n    private hideNow() {\n        this._currentTimeout = undefined\n        this.root.classList.remove(\"visible\")\n    }\n\n    /**\n     * @param duration If 0, the message will not disappear automatically (unless replaced by another auto-hiding message)\n     */\n    public showMessage(msg: Modifier, duration: number, withCloseButton: boolean): () => void {\n        if (this._currentTimeout !== undefined) {\n            clearTimeout(this._currentTimeout)\n            this._currentTimeout = undefined\n        }\n        this.msgSpan.innerHTML = \"\"\n        applyModifierTo(this.msgSpan, msg)\n        this.root.classList.add(\"visible\")\n        if (duration > 0) {\n            this._currentTimeout = setTimeout(this.hideNow, duration)\n        }\n        setVisible(this.closeButton, withCloseButton)\n        return this.hideNow\n    }\n\n}\n", "import { ComponentBase } from \"./components/Component\"\nimport { DrawableWithPosition } from \"./components/Drawable\"\nimport { Waypoint } from \"./components/Wire\"\nimport { LogicEditor } from \"./LogicEditor\"\n\nexport class MoveManager {\n\n    public readonly editor: LogicEditor\n    private _movingDrawables = new Set<DrawableWithPosition>()\n\n    public constructor(editor: LogicEditor) {\n        this.editor = editor\n    }\n\n    public areDrawablesMoving() {\n        return this._movingDrawables.size > 0\n    }\n\n    public getSingleMovingWaypoint(): Waypoint | undefined {\n        if (this._movingDrawables.size === 1) {\n            const drawable = this._movingDrawables.values().next().value\n            if (drawable instanceof Waypoint) {\n                return drawable\n            }\n        }\n        return undefined\n    }\n\n    public getSingleMovingComponentWithAnchors(): DrawableWithPosition | undefined {\n        if (this._movingDrawables.size === 1) {\n            const drawable = this._movingDrawables.values().next().value\n            if ((drawable instanceof DrawableWithPosition && drawable.anchor !== undefined) ||\n                (drawable instanceof ComponentBase && drawable.anchoredDrawables.length !== 0)) {\n                return drawable\n            }\n        }\n        return undefined\n    }\n\n    public setDrawableMoving(comp: DrawableWithPosition, e?: PointerEvent) {\n        this.changeMovingDrawables(() => {\n            this._movingDrawables.add(comp)\n        }, e)\n    }\n\n    public setDrawableStoppedMoving(comp: DrawableWithPosition, e?: PointerEvent) {\n        this.changeMovingDrawables(() => {\n            this._movingDrawables.delete(comp)\n        }, e)\n    }\n\n    private changeMovingDrawables(change: () => void, e?: PointerEvent) {\n        const emptyBefore = this._movingDrawables.size === 0\n        change()\n        const emptyAfter = this._movingDrawables.size === 0\n        if (emptyBefore !== emptyAfter) {\n            this.editor.updateCursor(e)\n            this.editor.editTools.redrawMgr.requestRedraw({ why: \"started or stopped moving drawables\", invalidateMask: true })\n        }\n    }\n\n    public clear() {\n        this._movingDrawables.clear()\n    }\n\n    public dump() {\n        const num = this._movingDrawables.size\n        if (num === 0) {\n            console.log(\"No moving drawables\")\n        } else {\n            console.log(`There are ${num} moving drawables:`)\n            for (const drawable of this._movingDrawables) {\n                // class name of drawable\n                const className = drawable.constructor.name\n                if (drawable instanceof ComponentBase) {\n                    console.log(className + \" - \" + (drawable.outputs._all[0]?.id ?? \"?\"))\n                } else {\n                    console.log(className)\n                }\n            }\n        }\n    }\n\n}\n", "import { doALUAdd, doALUSub } from \"./components/ALU\"\nimport { displayValuesFromArray } from \"./drawutils\"\nimport { LogicValue } from \"./utils\"\n\nexport class Tests {\n\n    public aluOps() {\n        function* nibbles(): Generator<boolean[], void, unknown> {\n            for (const a of [false, true]) {\n                for (const b of [false, true]) {\n                    for (const c of [false, true]) {\n                        for (const d of [false, true]) {\n                            yield [a, b, c, d]\n                        }\n                    }\n                }\n            }\n        }\n\n\n        function representationsOf(v: LogicValue[]): [string, number, number] {\n            const [str, uint_] = displayValuesFromArray(v, true)\n            const uint = uint_ as number\n            const sint = uint < 8 ? uint : uint - 16\n            return [str, uint, sint]\n        }\n\n        let totalTests = 0\n        let failedTests = 0\n        const verbose = false\n\n        for (const a of nibbles()) {\n            for (const b of nibbles()) {\n                for (const cin of [false, true]) {\n\n\n                    const [a_str, a_uint, a_sint] = representationsOf(a)\n                    const [b_str, b_uint, b_sint] = representationsOf(b)\n\n                    a.reverse()\n                    b.reverse()\n                    const { s: sum, v: v_sum, cout: c_sum } = doALUAdd(a, b, cin)\n                    const { s: diff, v: v_diff, cout: c_diff } = doALUSub(a, b, cin)\n                    a.reverse()\n                    b.reverse()\n                    sum.reverse()\n                    diff.reverse()\n                    const [sum_str, sum_uint, sum_sint] = representationsOf(sum)\n                    const [diff_str, diff_uint, diff_sint] = representationsOf(diff)\n\n\n                    //// TEST: unsigned addition\n\n                    const should_sum_uint = a_uint + b_uint + Number(cin)\n                    const should_c_sum = should_sum_uint > 15\n\n                    let carryError = false\n                    if (should_c_sum) {\n                        // if this is an unsigned overflow, the sum has to be wrong and carry has to be set\n                        carryError = sum_uint === should_sum_uint || c_sum !== true\n                    } else {\n                        // else the sum has to be correct and carry has to be clear\n                        carryError = sum_uint !== should_sum_uint || c_sum !== false\n                    }\n                    if (carryError) {\n                        console.log(`ERROR carry - ${a_uint} (${a_str}) + ${b_uint} (${b_str}) + ${Number(cin)} = ${sum_uint} (${sum_str}) (c=${c_sum})`)\n                        failedTests++\n                    } else if (verbose) {\n                        console.log(`carry - ${a_uint} (${a_str}) + ${b_uint} (${b_str}) + ${Number(cin)} = ${sum_uint} (${sum_str}) (c=${c_sum})`)\n                    }\n                    totalTests++\n\n\n                    //// TEST: unsigned subtraction\n\n                    const should_diff_uint = a_uint - b_uint - Number(cin)\n\n                    let borrowError = false\n                    if (a_uint - Number(cin) < b_uint) {\n                        // if this is an unsigned underflow, the difference has to be wrong and borrow has to be set\n                        borrowError = diff_uint === should_diff_uint || c_diff !== true\n                    } else {\n                        // else the difference has to be correct and borrow has to be clear\n                        borrowError = diff_uint !== should_diff_uint || c_diff !== false\n                    }\n                    if (borrowError) {\n                        console.log(`ERROR borrow - ${a_uint} (${a_str}) - ${b_uint} (${b_str}) - ${Number(cin)} = ${diff_uint} (${diff_str}) (c=${c_diff})`)\n                        failedTests++\n                    } else if (verbose) {\n                        console.log(`borrow - ${a_uint} (${a_str}) - ${b_uint} (${b_str}) - ${Number(cin)} = ${diff_uint} (${diff_str}) (c=${c_diff})`)\n                    }\n                    totalTests++\n\n\n\n                    //// TEST: signed addition\n\n                    const should_sum_sint = a_sint + b_sint + Number(cin)\n                    const should_v_sum = should_sum_sint > 7 || should_sum_sint < -8\n\n                    let overflowError = false\n                    if (should_v_sum) {\n                        // if this is a signed overflow, the sum has to be wrong and overflow has to be set\n                        overflowError = sum_sint === should_sum_sint || v_sum !== true\n                    } else {\n                        // else the sum has to be correct and overflow has to be clear\n                        overflowError = sum_sint !== should_sum_sint || v_sum !== false\n                    }\n                    if (overflowError) {\n                        console.log(`ERROR overflow - ${a_sint} (${a_str}) + ${b_sint} (${b_str}) + ${Number(cin)} = ${sum_sint} (${sum_str}) (v=${v_sum})`)\n                        failedTests++\n                    } else if (verbose) {\n                        console.log(`overflow - ${a_sint} (${a_str}) + ${b_sint} (${b_str}) + ${Number(cin)} = ${sum_sint} (${sum_str}) (v=${v_sum})`)\n                    }\n                    totalTests++\n\n\n\n                    //// TEST: signed subtraction\n\n                    const should_diff_sint = a_sint - b_sint - Number(cin)\n                    const should_v_diff = should_diff_sint > 7 || should_diff_sint < -8\n\n                    let overflowError2 = false\n                    if (should_v_diff) {\n                        // if this is a signed overflow, the sum has to be wrong and overflow has to be set\n                        overflowError2 = diff_sint === should_diff_sint || v_diff !== true\n                    } else {\n                        // else the sum has to be correct and overflow has to be clear\n                        overflowError2 = diff_sint !== should_diff_sint || v_diff !== false\n                    }\n                    if (overflowError2) {\n                        console.log(`ERROR overflow - ${a_sint} (${a_str}) - ${b_sint} (${b_str}) - ${Number(cin)} = ${diff_sint} (${diff_str}) (v=${v_diff})`)\n                        failedTests++\n                    } else if (verbose) {\n                        console.log(`overflow - ${a_sint} (${a_str}) - ${b_sint} (${b_str}) - ${Number(cin)} = ${diff_sint} (${diff_str}) (v=${v_diff})`)\n                    }\n                    totalTests++\n                }\n            }\n        }\n\n        console.log(`Tests: ${totalTests} total, ${failedTests} failed, ${totalTests - failedTests} passed`)\n    }\n\n}\n", "import { type Input } from \"./components/Input\"\nimport { type Output } from \"./components/Output\"\nimport { a, cls, data, div, href, Modifier, mods, span, style, table, tbody, td, th, thead, title, tr } from \"./htmlgen\"\nimport { makeIcon } from \"./images\"\nimport { LogicEditor, TestSuiteRunOptions } from \"./LogicEditor\"\nimport { Serialization } from \"./Serialization\"\nimport { S } from \"./strings\"\nimport { TestCaseCombinational, TestCaseResult, TestCaseResultFail, TestSuite, TestSuiteResults } from \"./TestSuite\"\nimport { UIPermissions } from \"./UIPermissions\"\nimport { isString, reprForLogicValues, setDisplay, setHidden, setVisible } from \"./utils\"\n\n\nexport class TestsPalette {\n\n    public readonly rootElem: HTMLDivElement\n    private readonly scroller: HTMLDivElement\n    private readonly suiteContainer: HTMLDivElement\n    private readonly testSuites = new Map<TestSuite, TestSuiteUI>()\n    private _isDisplayingResults = false\n    private _skipUpdates = false\n\n    public constructor(\n        public readonly editor: LogicEditor,\n    ) {\n        const s = S.Tests\n\n        const testsTitleElem = div(cls(\"toolbar-title\"), s.Title).render()\n        editor.eventMgr.registerTitleDragListenersOn(testsTitleElem, () => {\n            editor.setTestsPaletteVisible(false)\n        })\n\n        this.suiteContainer = div(cls(\"noselect\"), style(\"width: 100%\")).render()\n        this.scroller = div(style(\"width: 100%; font-size: 80%; overflow-y: auto; min-height: 28px; resize: vertical\"), this.suiteContainer).render()\n\n        this.rootElem = div(cls(\"sim-toolbar-right\"),\n            style(\"display: none\"),\n            data(\"prev-display\")(\"block\"),\n            testsTitleElem,\n            this.scroller\n        ).render()\n    }\n\n    public updateMaxHeight() {\n        const maxHeight = Math.min(this.suiteContainer.clientHeight, this.editor.html.mainCanvas.clientHeight - 38)\n        this.scroller.style.maxHeight = maxHeight + \"px\"\n    }\n\n    public setVisible(visible: boolean) {\n        setVisible(this.rootElem, visible)\n        if (visible) {\n            this.updateMaxHeight()\n        }\n    }\n\n    public clearAllSuites() {\n        this.suiteContainer.innerHTML = \"\"\n        this.testSuites.clear()\n    }\n\n    public update() {\n        this.clearAllSuites()\n        const parentSuites = this.editor.editorRoot.testSuites\n        for (const suite of parentSuites.suites) {\n            this.addTestSuite(suite)\n        }\n        this.editor.didLoadTests(parentSuites)\n    }\n\n    public addTestSuite(testSuite: TestSuite): TestSuiteUI {\n        const numExisting = this.testSuites.size\n        const ui = new TestSuiteUI(this.editor, this, testSuite)\n        ui.expanded = numExisting === 0\n        this.testSuites.set(testSuite, ui)\n        this.suiteContainer.appendChild(ui.rootElem)\n        return ui\n    }\n\n    public getOrMakeUIFor(testSuite: TestSuite): TestSuiteUI {\n        return this.testSuites.get(testSuite) ?? this.addTestSuite(testSuite)\n    }\n\n    public setDisplayingResults() {\n        this._isDisplayingResults = true\n    }\n\n    public clearDisplayedResults() {\n        if (this._isDisplayingResults && !this._skipUpdates) {\n            // console.log(\"Clearing displayed results\")\n            this.update()\n            this._isDisplayingResults = false\n        }\n    }\n\n    public async skipUpdatesWhile<T>(f: () => Promise<T>): Promise<T> {\n        this._skipUpdates = true\n        try {\n            return await f()\n        } finally {\n            this._skipUpdates = false\n        }\n    }\n\n    public async runAllTestSuites(options?: TestSuiteRunOptions): Promise<TestSuiteResults[]> {\n        const results: TestSuiteResults[] = []\n        for (const testSuiteUI of this.testSuites.values()) {\n            const result = await testSuiteUI.runTestCases(options)\n            if (result !== undefined) {\n                results.push(result)\n            }\n        }\n\n        // circuit built for event detail, to save it from e.g. Moodle\n        const circuit = this.editor.save()\n        const jsonStr = Serialization.stringifyObject(circuit, true)\n        this.editor.dispatchEvent(new CustomEvent(\"testsexecuted\", {\n            detail: { results, circuit: jsonStr },\n        }))\n        // console.log(\"Dispatched 'testsexecuted' event with results for\", results.length, \"test suites.\")\n\n        return results\n    }\n\n}\n\n\ntype TestCaseHTML = { line: HTMLElement, details: HTMLElement, container: HTMLElement, toggle: (force?: boolean) => void }\n\nexport class TestSuiteUI {\n\n    public readonly rootElem: HTMLDivElement\n    private readonly header: HTMLDivElement\n    private readonly setHiddenTrueButton: HTMLSpanElement\n    private readonly setHiddenFalseButton: HTMLSpanElement\n    private readonly runTestCasesButton: HTMLSpanElement\n    private readonly content: HTMLDivElement\n    private _expanded = false\n\n    private readonly htmlResults: TestCaseHTML[]\n\n    public constructor(\n        private readonly editor: LogicEditor,\n        private readonly palette: TestsPalette,\n        private readonly testSuite: TestSuite,\n    ) {\n        const s = S.Tests\n\n        this.htmlResults = testSuite.testCases.map(tc => this.makeTestCaseUI(tc))\n\n        const makeVisibilityButton = (elem: HTMLElement, titleStr: string) => {\n            return span(cls(\"testcase-change-button\"), style(\"cursor: pointer; margin-left: 10px;\"),\n                title(titleStr), elem\n            ).render()\n        }\n\n        this.setHiddenTrueButton = makeVisibilityButton(makeIcon(\"eye\"), s.TestSuiteShownClickToHide)\n        this.setHiddenFalseButton = makeVisibilityButton(makeIcon(\"eyecrossed\"), s.TestSuiteHiddenClickToShow)\n        this.setHiddenTrueButton.addEventListener(\"click\", this.toggleHidden.bind(this))\n        this.setHiddenFalseButton.addEventListener(\"click\", this.toggleHidden.bind(this))\n\n        const runAllIcon = makeIcon(\"play\")\n        style(\"position: relative; top: -2px;\").applyTo(runAllIcon)\n        this.runTestCasesButton = span(cls(\"sim-mode-link\"), style(\"flex: none; font-size: 85%; opacity: 0.9; margin: -2px 0 -2px 4px; padding: 2px 4px 0 0;\"),\n            title(s.RunTestSuite), runAllIcon, s.Run\n        ).render()\n\n        this.runTestCasesButton.addEventListener(\"click\", () => this.runTestCases())\n\n        this.header =\n            div(cls(\"test-suite test-disclosable expanded\"), style(\"display: flex\"),\n                span(style(\"flex: auto\"), testSuite.name ?? s.DefaultTestSuiteName),\n                this.setHiddenTrueButton, this.setHiddenFalseButton,\n                this.runTestCasesButton\n            ).render()\n        this.content =\n            div(cls(\"test-cases\"), style(\"display: block\"), ...this.htmlResults.map(p => p.container)).render()\n\n        this.header.addEventListener(\"click\", (e) => {\n            if (e.target === this.header) {\n                this.expanded = !this.expanded\n            }\n        })\n\n        this.rootElem = div(this.header, this.content).render()\n\n        this.updateHiddenButtons(testSuite.isHidden)\n    }\n\n    private toggleHidden() {\n        const newHidden = !this.testSuite.isHidden\n        this.testSuite.isHidden = newHidden\n        this.updateHiddenButtons(newHidden)\n    }\n\n    private updateHiddenButtons(isHidden: boolean) {\n        this.rootElem.classList.toggle(\"hidden-test-suite\", isHidden)\n        setDisplay(this.setHiddenTrueButton, isHidden ? \"hide\" : \"show\")\n        setDisplay(this.setHiddenFalseButton, isHidden ? \"show\" : \"hide\")\n    }\n\n    private makeTestCaseUI(testCase: TestCaseCombinational): TestCaseHTML {\n        const s = S.Tests\n\n        const editButton = span(cls(\"sim-mode-link testcase-change-button\"), style(\"flex: none; font-size: 80%; opacity: 0.85; margin: -1px; padding: 1px\"),\n            title(s.EditTestCaseName), makeIcon(\"pen\")\n        ).render()\n\n        const deleteButton = span(cls(\"sim-mode-link testcase-change-button\"), style(\"flex: none; font-size: 80%; opacity: 0.85; margin: -1px; padding: 1px\"),\n            title(s.DeleteTestCase), makeIcon(\"trash\")\n        ).render()\n\n        const nameSpan = span(style(\"flex: auto\"), testCase.name ?? s.DefaultTestCaseName).render()\n        const line = div(cls(\"test-disclosable testcase-button\"),\n            nameSpan,\n            editButton,\n            deleteButton,\n        ).render()\n        const details = div(cls(\"testcase-details\"), style(\"display: none\"), this.makeTestCaseDetailsTable(testCase)).render()\n        const toggle = (force?: boolean) => {\n            const expanded = line.classList.toggle(\"expanded\", force)\n            setVisible(details, expanded)\n            this.palette.updateMaxHeight()\n        }\n        line.addEventListener(\"click\", () => {\n            toggle()\n        })\n        const container = div(cls(\"testcase wait\"), line, details).render()\n\n        editButton.addEventListener(\"click\", e => {\n            e.stopPropagation()\n            if (!UIPermissions.canModifyTestCases(this.editor)) {\n                // button should be hidden anyway\n                window.alert(S.Messages.NoPermission)\n                return\n            }\n            const newName = window.prompt(s.EnterNewTestCaseName, testCase.name ?? \"\")\n            if (newName === null || newName.length === 0) {\n                return\n            }\n            testCase.name = newName\n            nameSpan.textContent = newName\n        })\n        deleteButton.addEventListener(\"click\", e => {\n            if (!UIPermissions.canModifyTestCases(this.editor)) {\n                // button should be hidden anyway\n                window.alert(S.Messages.NoPermission)\n                return\n            }\n            this.editor.removeTestCase(testCase)\n            e.stopPropagation()\n        })\n\n        return { line, details, container, toggle } as const\n    }\n\n    public get expanded() {\n        return this._expanded\n    }\n\n    public set expanded(expanded: boolean) {\n        this._expanded = this.header.classList.toggle(\"expanded\", expanded)\n        setVisible(this.content, this._expanded)\n        this.palette.updateMaxHeight()\n    }\n\n    public async runTestCases(options?: TestSuiteRunOptions): Promise<TestSuiteResults | undefined> {\n        const oldExpanded = this.expanded\n        setHidden(this.runTestCasesButton, true)\n        let testResult: TestSuiteResults | undefined\n        try {\n            testResult = await this.editor.runTestSuite(this.testSuite, options ?? { fast: true })\n            if (testResult !== undefined && testResult.isAllPass()) {\n                this.expanded = oldExpanded\n            }\n        } finally {\n            setHidden(this.runTestCasesButton, false)\n        }\n        return testResult\n    }\n\n    public setRunning(i: number) {\n        if (!this._expanded) {\n            this.expanded = true\n        }\n        const htmlResult = this.htmlResults[i]\n        htmlResult.container.className = \"testcase running\"\n        htmlResult.toggle(true)\n    }\n\n    public setResult(i: number, result: TestCaseResult) {\n        const htmlResult = this.htmlResults[i]\n        if (result._tag === \"fail\") {\n            // replace table with more detailed version\n            htmlResult.details.innerHTML = \"\"\n            htmlResult.details.appendChild(this.makeTestCaseDetailsTable(this.testSuite.testCases[i], result))\n        } else {\n            htmlResult.toggle() // close details if no failure\n        }\n        htmlResult.container.className = \"testcase \" + result._tag\n        this.palette.setDisplayingResults()\n    }\n\n    private makeComponentRefSpan(elem: Input | Output | string): HTMLElement {\n        const compStr = isString(elem) ? elem\n            : isString(elem.name) ? elem.name\n                : elem.ref ?? \"?\"\n        const link = a(compStr, href(\"#\")).render()\n        link.addEventListener(\"click\", (e) => {\n            e.preventDefault()\n            this.editor.highlight(elem)\n        })\n        return link\n    }\n\n    private makeTestCaseDetailsTable(testCase: TestCaseCombinational, failed?: TestCaseResultFail): HTMLTableElement {\n        const s = S.Tests\n        const tableBody = tbody().render()\n        const ins = [...testCase.in]\n        const outs = [...testCase.out]\n        for (let i = 0; i < Math.max(ins.length, outs.length); i++) {\n            const inStr = i >= ins.length ? \"\" : mods(this.makeComponentRefSpan(ins[i][0]), `: ${ins[i][1]}`)\n\n            let outStr: Modifier = \"\"\n            if (i < outs.length) {\n                const [output, expectedRepr] = outs[i]\n                let outValue: Modifier = String(expectedRepr)\n                if (failed !== undefined) {\n                    const mismatch = failed.mismatches.find(m => m.output === output)\n                    if (mismatch !== undefined) {\n                        outValue = mods(span(cls(\"testcase-wrongvalue\"), `${reprForLogicValues(mismatch.actual, false)}`), ` \u2260 ${outValue}`)\n                    }\n                }\n                outStr = mods(this.makeComponentRefSpan(output), `: `, outValue)\n            }\n            tr(td(inStr), td(outStr)).applyTo(tableBody)\n        }\n\n\n        const setTheseInputsButton = span(cls(\"sim-mode-link\"), style(\"margin: 2px; padding: 3px\"),\n            title(s.SetTheseInputs), makeIcon(\"setinput\")\n        ).render()\n        setTheseInputsButton.addEventListener(\"click\", async () => {\n            testCase.tryFixReferences(this.editor.components)\n            this.palette.skipUpdatesWhile(async () => {\n                this.editor.trySetInputsAndRecalc(testCase.in)\n                await this.editor.waitForPropagation()\n            })\n        })\n\n        return table(cls(\"testcase-table\"),\n            thead(tr(th(s.SetInputs, setTheseInputsButton), th(s.WantedOutputs))),\n            tableBody\n        ).render()\n    }\n\n}", "import { LogicEditor } from \"./LogicEditor\"\nimport { TimeoutHandle } from \"./utils\"\n\nexport type Timestamp = number\nexport type CallbackFn = () => unknown\nexport type TimelineState = {\n    hasCallbacks: boolean,\n    enablesPause: boolean,\n    isPaused: boolean,\n    nextStepDesc: string | undefined,\n}\n\nfunction areStatesEqual(s1: TimelineState, s2: TimelineState): boolean {\n    return s1.hasCallbacks === s2.hasCallbacks\n        && s1.enablesPause === s2.enablesPause\n        && s1.isPaused === s2.isPaused\n        && s1.enablesPause === s2.enablesPause\n        && s1.nextStepDesc === s2.nextStepDesc\n}\n\ntype Callback = { callback: CallbackFn, desc: string, enablesPause: boolean }\ntype ScheduledCallbacks = { [time: Timestamp]: Callback[] }\n\nexport class Timeline {\n\n    public readonly editor: LogicEditor\n\n    // what in the system time is our zero time (adjusted on pause, reset on reload)\n    private _epochStart!: Timestamp\n    private _sortedNextCallbackTimes!: Timestamp[]\n    // per callback time, a list of callbacks\n    private _schedule!: ScheduledCallbacks\n    // cached value indicating if we have callbacks that always enables pausing, like a clock\n    private _numCallbacksEnablingPause!: number\n    // allows canceling the next tick if (a) we pause, (b) we enqueue something before\n    private _nextTimeout: { handle: TimeoutHandle, tickTime: number } | undefined\n    // set when callbacks are running to return a constant time\n    private _fixedLogicalTime: Timestamp | undefined\n    // when we are paused: the (absolute) start time of the pause\n    private _pausedSince: Timestamp | undefined\n    // remember last sent state to avoid fake events\n    private _lastSentState: TimelineState | undefined\n\n    // public callback function\n    public onStateChanged: (state: TimelineState) => unknown = __ => null\n\n    public constructor(editor: LogicEditor) {\n        this.editor = editor\n        this.reset()\n    }\n\n    public reset() {\n        this._epochStart = this.unadjustedTime()\n        this._sortedNextCallbackTimes = []\n        this._schedule = {}\n        this._numCallbacksEnablingPause = 0\n        if (this._nextTimeout !== undefined) {\n            clearTimeout(this._nextTimeout.handle)\n            this._nextTimeout = undefined\n        }\n        this._fixedLogicalTime = undefined\n        this._pausedSince = undefined\n    }\n\n    public get isPaused() {\n        return this._pausedSince !== undefined\n    }\n\n    public get nextTickDesc(): string | undefined {\n        if (this._sortedNextCallbackTimes.length === 0) {\n            return undefined\n        }\n        const nextTime = this._sortedNextCallbackTimes[0]\n        const nextCallbacks = this._schedule[nextTime]\n        if (nextCallbacks.length === 1) {\n            return nextCallbacks[0].desc\n        }\n\n        // else, build a summary\n        const counts = new Map<string, number>()\n        for (const c of nextCallbacks) {\n            counts.set(c.desc, (counts.get(c.desc) ?? 0) + 1)\n        }\n        return [...counts.entries()].map(([desc, count]) => `${count} \u00D7 ${desc}`).join(\"\\n\")\n    }\n\n    public get state(): TimelineState {\n        const hasCallbacks = this._sortedNextCallbackTimes.length > 0\n        const enablesPause = this._numCallbacksEnablingPause > 0\n        const isPaused = this.isPaused\n        const canStep = isPaused && hasCallbacks\n        const nextStepDesc = !canStep ? undefined : this.nextTickDesc\n        return { hasCallbacks, enablesPause, isPaused, nextStepDesc }\n    }\n\n    public unadjustedTime(): Timestamp {\n        return new Date().getTime()\n    }\n\n    public logicalTime(): Timestamp {\n        if (this._fixedLogicalTime !== undefined) {\n            // we're in a callback, return constant value\n            return this._fixedLogicalTime\n        }\n\n        if (this._pausedSince !== undefined) {\n            // return constant value of \"stuck\" time\n            return this._pausedSince - this._epochStart\n        }\n\n        // return absolute time minus when we started to count\n        return this.unadjustedTime() - this._epochStart\n    }\n\n    public hasPendingCallbacksNow(): boolean {\n        // console.log(`  hasPendingCallbacksNow: ${this._sortedNextCallbackTimes}; now: ${this.logicalTime()}`)\n        return this._sortedNextCallbackTimes.length > 0\n            && this._sortedNextCallbackTimes[0] <= this.logicalTime()\n    }\n\n    public scheduleAt(time: Timestamp, callback: CallbackFn, desc: string, enablesPause: boolean) {\n        // console.log(`Scheduling '${desc}' at ${time}`)\n        const callbackRec = { callback, desc, enablesPause }\n        this._numCallbacksEnablingPause += enablesPause ? 1 : 0\n\n        if (time in this._schedule) {\n            // add callback to existing time\n            this._schedule[time].push(callbackRec)\n\n        } else {\n            if (time < this.logicalTime()) {\n                console.log(`WARNING Scheduling this in the past (${time - this.logicalTime()} ms), may behave strangely: ` + desc)\n            }\n\n            // add new time to sorted list of times\n            let i = 0\n            do {\n                if (i >= this._sortedNextCallbackTimes.length) {\n                    // push as last value\n                    this._sortedNextCallbackTimes.push(time)\n                    break\n                }\n                if (time < this._sortedNextCallbackTimes[i]) {\n                    // insert at position i\n                    this._sortedNextCallbackTimes.splice(i, 0, time)\n                    break\n                }\n                i++\n                // eslint-disable-next-line no-constant-condition\n            } while (true)\n            this._schedule[time] = [callbackRec]\n\n            if (i === 0) {\n                // inserted in front of queue\n                this.rescheduleNextIfNeeded()\n            }\n            // console.log(\"Schedule: \", this._schedule)\n        }\n\n        this.fireStateChangedIfNeeded()\n    }\n\n    private rescheduleNextIfNeeded() {\n        // schedules a timeout for the next wanted tick time\n\n        if (this._sortedNextCallbackTimes.length === 0) {\n            // make sure nothing is scheduled\n            if (this._nextTimeout !== undefined) {\n                clearTimeout(this._nextTimeout.handle)\n                this._nextTimeout = undefined\n            }\n\n        } else {\n            // check if we need to reschedule\n            const tickTime = this._sortedNextCallbackTimes[0]\n            if (this._nextTimeout !== undefined) {\n                if (this._nextTimeout.tickTime <= tickTime) {\n                    // something's scheduled before\n                    return\n                } else {\n                    // something's scheduled after, cancel it\n                    clearTimeout(this._nextTimeout.handle)\n                    this._nextTimeout = undefined\n                }\n            }\n            const now = this.logicalTime()\n            const waitDuration = tickTime - now\n            // console.log(`Now is ${now}; scheduling next timeline event for ${tickTime} in ${waitDuration} ms`, this._sortedNextCallbackTimes)\n            const handle = setTimeout(() => this.nextTickCallback(), waitDuration)\n            this._nextTimeout = { handle, tickTime }\n        }\n    }\n\n    private nextTickCallback() {\n        this._nextTimeout = undefined\n        // don't do anything if this was called while we are paused\n        if (this._pausedSince !== undefined) {\n            return\n        }\n        this.handleNextTick()\n    }\n\n    private handleNextTick() {\n        // run all the handlers from the next tick\n        const wantedTime = this._sortedNextCallbackTimes.shift()\n        if (wantedTime === undefined) {\n            return\n        }\n        const now = this.logicalTime()\n        // console.log(`Running callbacks for ${wantedTime} (now is ${now})`)\n        const callbacks = this._schedule[wantedTime]\n        const late = now - wantedTime\n        if (late > 100) {\n            // adjust time; probably, the page was hidden and then shown again or callbacks are running slowly\n            this._epochStart += late\n            // console.log(`Adjusted time by ${late} ms`)\n        }\n        // console.log(`Running ${callbacks.length} callbacks at adjusted time ${now} (wanted for ${wantedTime}, late by ${late} ms)`)\n\n        const runAllCallbacks = () => {\n            // use while and shift() to allow callbacks to enqueue new callbacks\n            // without causing iteration issues\n            let elem\n            this._fixedLogicalTime = wantedTime\n            while ((elem = callbacks.shift()) !== undefined) {\n                const { callback, desc, enablesPause } = elem\n                this._numCallbacksEnablingPause -= enablesPause ? 1 : 0\n                // console.log(`  -> Running '${desc}'`)\n                try {\n                    callback()\n                } catch (err) {\n                    console.log(`ERROR running callback '${desc}': ` + err)\n                }\n            }\n            this._fixedLogicalTime = undefined\n        }\n\n        // use wrapHandler to do any recalc/redraws after\n        // calling the handlers if necessary\n        this.editor.wrapHandler(runAllCallbacks)()\n\n        // remove the time from the schedule\n        delete this._schedule[wantedTime]\n\n        // move on to the next tick\n        this.rescheduleNextIfNeeded()\n        this.fireStateChangedIfNeeded()\n    }\n\n    public pause() {\n        if (this._pausedSince !== undefined) {\n            return\n        }\n        if (this._nextTimeout !== undefined) {\n            clearTimeout(this._nextTimeout.handle)\n            this._nextTimeout = undefined\n        }\n        // console.log(`Pausing timeline at ${this.adjustedTime()} ms`)\n        this._pausedSince = this.unadjustedTime()\n        this.fireStateChangedIfNeeded()\n    }\n\n    public play() {\n        if (this._pausedSince === undefined) {\n            return\n        }\n        this._epochStart += (this.unadjustedTime() - this._pausedSince)\n        this._pausedSince = undefined\n        // console.log(`Resuming timeline at ${this.adjustedTime()} ms`)\n        this.editor.editTools.redrawMgr.requestRedraw({ why: \"timeline-play\", invalidateTests: true })\n        this.rescheduleNextIfNeeded()\n        this.fireStateChangedIfNeeded()\n    }\n\n    public step() {\n        if (this._pausedSince === undefined || this._sortedNextCallbackTimes.length === 0) {\n            return\n        }\n        // move back epoch start time to simulate that the time\n        // between now and the next tick has been elapsed\n        const nextTickTime = this._sortedNextCallbackTimes[0]\n        const currentPauseTime = this.logicalTime()\n        this._epochStart -= nextTickTime - currentPauseTime\n        this.handleNextTick()\n        this.fireStateChangedIfNeeded()\n    }\n\n    private fireStateChangedIfNeeded() {\n        const newState = this.state\n        if (this._lastSentState === undefined || !areStatesEqual(this._lastSentState, newState)) {\n            this.onStateChanged(newState)\n            this._lastSentState = newState\n        }\n    }\n}\n", "import { LogicEditor, PointerAction } from \"./LogicEditor\"\nimport { Serialization } from \"./Serialization\"\nimport { TimelineState } from \"./Timeline\"\nimport { UndoState } from \"./UndoManager\"\nimport { CustomComponentDef } from \"./components/CustomComponent\"\nimport { Modifier, a, attr, button, cls, div, emptyMod, i, input, mods, raw, span, style, title, type } from \"./htmlgen\"\nimport { IconName, inlineIconSvgFor } from \"./images\"\nimport { S } from \"./strings\"\nimport { Mode, UIDisplay, setActive, setDisplay, setEnabled, setVisible } from \"./utils\"\n\nexport class TopBar {\n\n    private readonly root: HTMLDivElement\n    private readonly alwaysShowCircuitName: boolean\n    private _showingCompactUI: boolean = false\n\n    private readonly circuitNameGroup: HTMLDivElement\n    private _showingCircuitName: boolean = false\n    private _customComponentShown: CustomComponentDef | undefined = undefined\n    private readonly dirtyIndicator: HTMLSpanElement\n    private readonly circuitNameLabel: HTMLSpanElement\n    private readonly mainCircuitTab: HTMLDivElement\n    private readonly customComponentChevron: HTMLSpanElement\n    private readonly customComponentNameLabel: HTMLSpanElement\n    private readonly customComponentTab: HTMLDivElement\n\n    private readonly openButton: HTMLButtonElement\n    private readonly loadFromBrowserButton: HTMLButtonElement\n    private readonly closeCustomComponentButton: HTMLButtonElement\n    private readonly undoButton: HTMLButtonElement\n    private readonly redoButton: HTMLButtonElement\n    private readonly downloadButton: HTMLButtonElement\n    private readonly screenshotButton: HTMLButtonElement\n    private readonly resetButton: HTMLButtonElement\n\n    private readonly timelineButtonSep: HTMLElement\n    private readonly pauseButton: HTMLButtonElement\n    private readonly playButton: HTMLButtonElement\n    private readonly stepButton: HTMLButtonElement\n    private readonly timeLabel: HTMLSpanElement\n    private _showingTimelineUI: boolean = false\n\n    private readonly designButton: HTMLButtonElement\n    private readonly deleteButton: HTMLButtonElement\n    private readonly testsButton: HTMLButtonElement\n\n    private readonly flexibleSep: HTMLElement\n\n    private readonly moveButton: HTMLButtonElement\n    private readonly zoomLevelInput: HTMLInputElement\n\n    public constructor(\n        public readonly editor: LogicEditor,\n    ) {\n        const s = S.TopBar\n        this.alwaysShowCircuitName = editor.isSingleton\n\n        this.dirtyIndicator = this.makeLabel(mods(style(\"margin: 3px 3px 0 -2px; font-size: 20pt\"), \"\u2022\", title(s.DirtyTooltip)))\n        this.circuitNameLabel = this.makeLink(mods(\"\", title(s.CircuitNameTooltip)), this.runSetCircuitNameDialog.bind(this))\n        this.mainCircuitTab = this.makeTab(\n            this.circuitNameLabel,\n        )\n        this.customComponentChevron = this.makeLabel(\"\u276F\")\n        this.customComponentChevron.style.fontSize = \"14pt\"\n        this.customComponentNameLabel = this.makeLink(mods(\"\", title(s.CustomComponentCaptionTooltip)), this.runSetCustomComponentCaptionDialog.bind(this))\n        this.customComponentNameLabel.style.fontWeight = \"bolder\"\n        this.closeCustomComponentButton = this.makeButton(\"close\", s.CloseCircuit, () => editor.tryCloseCustomComponentEditor())\n        this.closeCustomComponentButton.style.padding = \"0\"\n        this.customComponentTab = this.makeTab(\n            this.closeCustomComponentButton,\n            this.customComponentNameLabel,\n        )\n        this.circuitNameGroup =\n            div(cls(\"path\"), style(\"flex: none; display: flex; align-items: stretch; margin: -3px 0 -3px -5px; padding: 3px 5px\"),\n                this.dirtyIndicator,\n                this.mainCircuitTab,\n                this.customComponentChevron,\n                this.customComponentTab,\n            ).render()\n\n        this.undoButton = this.makeButtonWithLabel(\"undo\", s.Undo,\n            () => this.editor.editTools.undoMgr.undo())\n        this.redoButton = this.makeButtonWithLabel(\"redo\", s.Redo,\n            () => this.editor.editTools.undoMgr.redoOrRepeat())\n\n        this.resetButton = this.makeButtonWithLabel(\"reset\", s.Reset,\n            () => this.editor.resetCircuit())\n\n        this.openButton = this.makeButtonWithLabel(\"open\", s.Open,\n            this.openHandler.bind(this))\n        this.loadFromBrowserButton = this.makeButtonWithLabel(\"browserload\", s.Restore,\n            this.loadFromBrowserHandler.bind(this))\n        this.downloadButton = this.makeButtonWithLabel(\"download\", s.Download,\n            this.saveHandler.bind(this))\n        this.screenshotButton = this.makeButtonWithLabel(\"screenshot\", s.Screenshot,\n            this.screenshotHandler.bind(this))\n\n        this.timelineButtonSep = this.makeSep()\n        this.pauseButton = this.makeButtonWithLabel(\"pause\", s.TimelinePause,\n            () => this.editor.timeline.pause())\n        this.playButton = this.makeButtonWithLabel(\"play\", s.TimelinePlay,\n            () => this.editor.timeline.play())\n        this.stepButton = this.makeButtonWithLabel(\"step\", s.TimelineStep,\n            () => this.editor.timeline.step())\n\n        this.timeLabel = this.makeLabel(s.TimeLabel + \"0\")\n        this.timeLabel.style.fontSize = \"8pt\"\n\n        this.designButton = this.makeButtonWithLabel(\"mouse\", s.Design,\n            () => this.editor.setCurrentPointerAction(\"edit\"))\n\n        this.deleteButton = this.makeButtonWithLabel(\"trash\", s.Delete,\n            () => this.editor.setCurrentPointerAction(\"delete\"))\n\n        this.testsButton = this.makeButtonWithLabel(\"check\", s.Tests,\n            () => this.editor.setTestsPaletteVisible(!this.testsButton.classList.contains(\"active\")))\n\n        this.flexibleSep = div(style(\"flex: auto\")).render()\n        this.moveButton = this.makeButton(\"move\", s.Move[1],\n            () => this.editor.setCurrentPointerAction(\"move\"))\n        this.zoomLevelInput = input(type(\"number\"),\n            style(\"margin: 0 2px 0 0; width: 4em; background-color: inherit;\"),\n            attr(\"min\", \"0\"), attr(\"step\", \"10\"),\n            attr(\"value\", String(editor.options.zoom)),\n            attr(\"title\", S.Settings.zoomLevel),\n        ).render()\n        this.zoomLevelInput.addEventListener(\"change\",\n            editor.wrapHandler(this.zoomLevelHandler.bind(this)))\n\n        const zoomControl = this.makeLabel(mods(\n            this.zoomLevelInput, S.Settings.zoomLevelField[1]\n        ))\n\n        this.root =\n            div(cls(\"topBar\"), style(\"flex:none; height: 30px; padding: 3px 5px; display: flex; align-items: stretch;\"),\n                this.circuitNameGroup,\n\n                this.undoButton,\n                this.redoButton,\n\n                this.makeSep(),\n                this.resetButton,\n\n                this.makeSep(),\n                this.openButton,\n                this.editor.autosave ? this.loadFromBrowserButton : emptyMod,\n                this.downloadButton,\n                this.screenshotButton,\n\n                this.timelineButtonSep,\n                this.pauseButton,\n                this.playButton,\n                this.stepButton,\n                this.timeLabel,\n\n                this.makeSep(true),\n                this.designButton,\n                this.deleteButton,\n\n                this.makeSep(),\n                this.testsButton,\n\n                this.flexibleSep,\n\n                this.moveButton,\n                zoomControl,\n\n            ).render()\n\n        editor.html.centerCol.insertAdjacentElement(\"afterbegin\", this.root)\n\n        const undoMgr = editor.editTools.undoMgr\n        undoMgr.onStateChanged = newState => this.setUndoButtonsEnabled(newState)\n        this.setUndoButtonsEnabled(undoMgr.state)\n\n        editor.timeline.onStateChanged = newState => this.setTimelineButtonsVisible(newState)\n        this.setTimelineButtonsVisible(editor.timeline.state)\n\n        this.setDirty(false)\n\n        this.setEditingCustomComponent(undefined)\n        this.setCircuitName(editor.documentDisplayName)\n        this.updateCompactMode()\n    }\n\n\n    // Handlers\n\n    private runSetCircuitNameDialog() {\n        const currentValue = this.editor.options.name ?? \"\"\n        const newName = window.prompt(S.TopBar.SetCircuitName, currentValue)\n        if (newName === null || newName === currentValue) {\n            return\n        }\n        this.editor.setCircuitName(newName)\n        this.editor.editTools.undoMgr.takeSnapshot()\n        // will call our own setCircuitName\n    }\n\n    private runSetCustomComponentCaptionDialog() {\n        if (this._customComponentShown === undefined) {\n            return\n        }\n        this.editor.factory.runChangeCustomComponentCaptionDialog(this._customComponentShown)\n    }\n\n\n    private openHandler() {\n        this.editor.runFileChooser(\"text/plain|image/png|application/json|application/json5\", file => {\n            this.editor.tryLoadFrom(file)\n        })\n    }\n\n    private loadFromBrowserHandler() {\n        this.editor.tryLoadFromLocalStorage()\n    }\n\n    private saveHandler(e: MouseEvent) {\n        if (e.altKey && this.editor.factory.hasCustomComponents()) {\n            Serialization.saveLibraryToFile(this.editor)\n        } else {\n            Serialization.saveCircuitToFile(this.editor)\n        }\n    }\n\n    private screenshotHandler(e: MouseEvent) {\n        const editor = this.editor\n        if (e.altKey) {\n            editor.download(editor.toSVG(true), \".svg\")\n        } else {\n            editor.download(editor.toPNG(true), \".png\")\n        }\n    }\n\n    private zoomLevelHandler() {\n        const zoom = this.zoomLevelInput.valueAsNumber\n        const validatedZoom = this.editor.setZoom(zoom, false)\n        if (validatedZoom !== zoom) {\n            this.setZoom(validatedZoom)\n        }\n    }\n\n\n    // Visibility methods\n\n    public updateCompactMode() {\n        const getSepWidth = () => this.flexibleSep.getBoundingClientRect().width\n        const MinSepWidth = 5\n        const sepWidth = getSepWidth()\n        if (!this._showingCompactUI) {\n            if (sepWidth <= MinSepWidth) {\n                // we need to shrink for sure\n                this._showingCompactUI = true\n                this.root.classList.add(\"compact\")\n            }\n        } else {\n            // can we expand? (if not, we'll stay in compact mode)\n            if (sepWidth > MinSepWidth) {\n                this.root.classList.remove(\"compact\")\n                if (getSepWidth() <= MinSepWidth) {\n                    // we can't expand, so stay in compact mode\n                    this.root.classList.add(\"compact\")\n                } else {\n                    // keep being expanded\n                    this._showingCompactUI = false\n                }\n            }\n        }\n    }\n\n    public getActiveTabCoords(): [number, number] {\n        const tab = this._customComponentShown !== undefined ? this.customComponentTab : this.mainCircuitTab\n        const rect = tab.getBoundingClientRect()\n        return [rect.left, rect.right]\n    }\n\n    public setButtonStateFromMode(state: { showComponentsAndEditControls: UIDisplay, showReset: boolean }, mode: Mode) {\n        setDisplay(this.root, state.showComponentsAndEditControls)\n\n        setVisible(this.resetButton, state.showReset)\n\n        const showUndoRedo = mode >= Mode.CONNECT\n        setVisible(this.undoButton, showUndoRedo)\n        setVisible(this.redoButton, showUndoRedo)\n\n        const showToolButtons = state.showComponentsAndEditControls === \"show\"\n        setVisible(this.designButton, showToolButtons)\n        setVisible(this.deleteButton, showToolButtons)\n        setVisible(this.moveButton, showToolButtons)\n        this.updateCompactMode()\n    }\n\n    public setCircuitName(name: string | undefined) {\n        let show = true\n        if (name !== undefined) {\n            this.circuitNameLabel.textContent = name\n        } else {\n            // either a default name or a hidden \n            if (this.alwaysShowCircuitName) {\n                this.circuitNameLabel.textContent = this.editor.documentDisplayName\n            } else {\n                show = false\n                this.circuitNameLabel.textContent = \"\"\n            }\n        }\n\n        this._showingCircuitName = show\n        setVisible(this.circuitNameLabel, show)\n        setVisible(this.dirtyIndicator, show)\n\n        this.updateCircuitNameUI()\n    }\n\n    private updateCircuitNameUI() {\n        setVisible(this.circuitNameGroup, this._showingCircuitName || this._customComponentShown !== undefined)\n        this.updateCompactMode()\n    }\n\n    public setZoom(zoom: number) {\n        this.zoomLevelInput.value = String(zoom)\n    }\n\n    public setDirty(dirty: boolean) {\n        this.dirtyIndicator.style.visibility = dirty ? \"inherit\" : \"hidden\"\n        setEnabled(this.resetButton, dirty)\n    }\n\n    public setEditingCustomComponent(customDef: CustomComponentDef | undefined) {\n        const showSubcircuitUI = customDef !== undefined\n        setVisible(this.customComponentChevron, showSubcircuitUI)\n        setVisible(this.customComponentTab, showSubcircuitUI)\n        setActive(this.mainCircuitTab, !showSubcircuitUI)\n        setActive(this.customComponentTab, showSubcircuitUI)\n        if (showSubcircuitUI) {\n            this.circuitNameLabel.style.removeProperty(\"font-weight\")\n            this.customComponentNameLabel.textContent = customDef.caption\n        } else {\n            this.circuitNameLabel.style.fontWeight = \"bolder\"\n            this.customComponentNameLabel.textContent = \"\"\n        }\n        this._customComponentShown = customDef\n        this.updateCircuitNameUI()\n    }\n\n    public updateCustomComponentCaption() {\n        if (this._customComponentShown !== undefined) {\n            this.customComponentNameLabel.textContent = this._customComponentShown.caption\n            this.updateCompactMode()\n        }\n    }\n\n    private setTimelineButtonsVisible({ enablesPause, hasCallbacks, isPaused, nextStepDesc }: TimelineState) {\n        const showTimelineUI = enablesPause || (this.editor.options.allowPausePropagation && hasCallbacks)\n        this._showingTimelineUI = showTimelineUI\n        if (showTimelineUI) {\n            // show part of the interface\n            setVisible(this.timelineButtonSep, true)\n            setVisible(this.playButton, isPaused)\n            setVisible(this.pauseButton, !isPaused)\n            setVisible(this.stepButton, nextStepDesc !== undefined)\n            this.stepButton.title = S.TopBar.TimelineStep[1] + \"\\n\" + (nextStepDesc ?? \"\")\n            setVisible(this.timeLabel, isPaused)\n            this.updateTimeLabelIfNeeded()\n        } else {\n            // show nothing\n            setVisible(this.timelineButtonSep, false)\n            setVisible(this.playButton, false)\n            setVisible(this.pauseButton, false)\n            setVisible(this.stepButton, false)\n            setVisible(this.timeLabel, false)\n        }\n        this.updateCompactMode()\n    }\n\n    private setUndoButtonsEnabled({ canUndo, canRedoOrRepeat }: UndoState) {\n        setEnabled(this.undoButton, canUndo)\n        setEnabled(this.redoButton, canRedoOrRepeat)\n    }\n\n    public updateTimeLabelIfNeeded() {\n        if (!this._showingTimelineUI) {\n            return\n        }\n\n        const t = this.editor.timeline.logicalTime()\n        // make nice string from milliseconds\n        const ms = t % 1000\n        const s = Math.floor(t / 1000) % 60\n        const m = Math.floor(t / 60000) % 60\n        const h = Math.floor(t / 3600000)\n        this.timeLabel.textContent = S.TopBar.TimeLabel + (h === 0 ? \"\" : h + \":\") +\n            (m < 10 ? \"0\" + m : m) + \":\" +\n            (s < 10 ? \"0\" + s : s) + \".\" +\n            (ms < 100 ? (ms < 10 ? \"00\" : \"0\") : \"\") + ms\n    }\n\n    public updateActiveTool(tool: PointerAction) {\n        setActive(this.designButton, tool === \"edit\")\n        setActive(this.deleteButton, tool === \"delete\")\n        setActive(this.moveButton, tool === \"move\")\n    }\n\n    public updateTestPaletteVisible(visible: boolean) {\n        this.testsButton.classList.toggle(\"active\", visible)\n    }\n\n    public setTestPaletteButtonVisible(numHint: number) {\n        const visible = numHint !== 0\n        if (visible) {\n            const newCaption = numHint > 0 ? S.TopBar.Tests[0] + ` (${numHint})` : S.TopBar.Tests[0]\n            this.setCaption(this.testsButton, newCaption)\n        }\n        setVisible(this.testsButton, visible)\n    }\n\n\n    // Factory methods\n\n    private makeTab(...modifiers: Modifier[]): HTMLDivElement {\n        return div(cls(\"barTab\"), ...modifiers).render()\n    }\n\n    private makeButtonWithLabel(icon: IconName, labelTooltip: [Modifier, string], handler: (e: MouseEvent) => void): HTMLButtonElement {\n        return this.makeButton(icon, labelTooltip[1], handler, labelTooltip[0])\n    }\n\n    private makeButton(icon: IconName, tooltip: string, handler: (e: MouseEvent) => void, label?: Modifier): HTMLButtonElement {\n        const labelSpan = label === undefined ? emptyMod : span(cls(\"btnLabel\"), label)\n        const but =\n            button(\n                i(cls(\"svgicon\"), raw(inlineIconSvgFor(icon))),\n                title(tooltip),\n                labelSpan\n            ).render()\n        but.addEventListener(\"click\", this.editor.wrapHandler(handler))\n        return but\n    }\n\n    private makeLabel(label: Modifier): HTMLSpanElement {\n        return span(cls(\"barLabel\"), label).render()\n    }\n\n    private makeLink(label: Modifier, handler: (e: MouseEvent) => void): HTMLSpanElement {\n        const link = a(cls(\"barLabel\"), label).render()\n        link.addEventListener(\"click\", this.editor.wrapHandler(handler))\n        return link\n    }\n\n    private makeSep(fat: boolean = false): HTMLElement {\n        const classes = fat ? \"sep fat\" : \"sep\"\n        return div(cls(classes)).render()\n    }\n\n    private setCaption(button: HTMLButtonElement, caption: string) {\n        const label = button.querySelector(\".btnLabel\")\n        if (label !== null) {\n            label.textContent = caption\n        }\n    }\n\n}\n\n", "export var top = 'top';\nexport var bottom = 'bottom';\nexport var right = 'right';\nexport var left = 'left';\nexport var auto = 'auto';\nexport var basePlacements = [top, bottom, right, left];\nexport var start = 'start';\nexport var end = 'end';\nexport var clippingParents = 'clippingParents';\nexport var viewport = 'viewport';\nexport var popper = 'popper';\nexport var reference = 'reference';\nexport var variationPlacements = /*#__PURE__*/basePlacements.reduce(function (acc, placement) {\n  return acc.concat([placement + \"-\" + start, placement + \"-\" + end]);\n}, []);\nexport var placements = /*#__PURE__*/[].concat(basePlacements, [auto]).reduce(function (acc, placement) {\n  return acc.concat([placement, placement + \"-\" + start, placement + \"-\" + end]);\n}, []); // modifiers that need to read the DOM\n\nexport var beforeRead = 'beforeRead';\nexport var read = 'read';\nexport var afterRead = 'afterRead'; // pure-logic modifiers\n\nexport var beforeMain = 'beforeMain';\nexport var main = 'main';\nexport var afterMain = 'afterMain'; // modifier with the purpose to write to the DOM (or write into a framework state)\n\nexport var beforeWrite = 'beforeWrite';\nexport var write = 'write';\nexport var afterWrite = 'afterWrite';\nexport var modifierPhases = [beforeRead, read, afterRead, beforeMain, main, afterMain, beforeWrite, write, afterWrite];", "export default function getNodeName(element) {\n  return element ? (element.nodeName || '').toLowerCase() : null;\n}", "export default function getWindow(node) {\n  if (node == null) {\n    return window;\n  }\n\n  if (node.toString() !== '[object Window]') {\n    var ownerDocument = node.ownerDocument;\n    return ownerDocument ? ownerDocument.defaultView || window : window;\n  }\n\n  return node;\n}", "import getWindow from \"./getWindow.js\";\n\nfunction isElement(node) {\n  var OwnElement = getWindow(node).Element;\n  return node instanceof OwnElement || node instanceof Element;\n}\n\nfunction isHTMLElement(node) {\n  var OwnElement = getWindow(node).HTMLElement;\n  return node instanceof OwnElement || node instanceof HTMLElement;\n}\n\nfunction isShadowRoot(node) {\n  // IE 11 has no ShadowRoot\n  if (typeof ShadowRoot === 'undefined') {\n    return false;\n  }\n\n  var OwnElement = getWindow(node).ShadowRoot;\n  return node instanceof OwnElement || node instanceof ShadowRoot;\n}\n\nexport { isElement, isHTMLElement, isShadowRoot };", "import getNodeName from \"../dom-utils/getNodeName.js\";\nimport { isHTMLElement } from \"../dom-utils/instanceOf.js\"; // This modifier takes the styles prepared by the `computeStyles` modifier\n// and applies them to the HTMLElements such as popper and arrow\n\nfunction applyStyles(_ref) {\n  var state = _ref.state;\n  Object.keys(state.elements).forEach(function (name) {\n    var style = state.styles[name] || {};\n    var attributes = state.attributes[name] || {};\n    var element = state.elements[name]; // arrow is optional + virtual elements\n\n    if (!isHTMLElement(element) || !getNodeName(element)) {\n      return;\n    } // Flow doesn't support to extend this property, but it's the most\n    // effective way to apply styles to an HTMLElement\n    // $FlowFixMe[cannot-write]\n\n\n    Object.assign(element.style, style);\n    Object.keys(attributes).forEach(function (name) {\n      var value = attributes[name];\n\n      if (value === false) {\n        element.removeAttribute(name);\n      } else {\n        element.setAttribute(name, value === true ? '' : value);\n      }\n    });\n  });\n}\n\nfunction effect(_ref2) {\n  var state = _ref2.state;\n  var initialStyles = {\n    popper: {\n      position: state.options.strategy,\n      left: '0',\n      top: '0',\n      margin: '0'\n    },\n    arrow: {\n      position: 'absolute'\n    },\n    reference: {}\n  };\n  Object.assign(state.elements.popper.style, initialStyles.popper);\n  state.styles = initialStyles;\n\n  if (state.elements.arrow) {\n    Object.assign(state.elements.arrow.style, initialStyles.arrow);\n  }\n\n  return function () {\n    Object.keys(state.elements).forEach(function (name) {\n      var element = state.elements[name];\n      var attributes = state.attributes[name] || {};\n      var styleProperties = Object.keys(state.styles.hasOwnProperty(name) ? state.styles[name] : initialStyles[name]); // Set all values to an empty string to unset them\n\n      var style = styleProperties.reduce(function (style, property) {\n        style[property] = '';\n        return style;\n      }, {}); // arrow is optional + virtual elements\n\n      if (!isHTMLElement(element) || !getNodeName(element)) {\n        return;\n      }\n\n      Object.assign(element.style, style);\n      Object.keys(attributes).forEach(function (attribute) {\n        element.removeAttribute(attribute);\n      });\n    });\n  };\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'applyStyles',\n  enabled: true,\n  phase: 'write',\n  fn: applyStyles,\n  effect: effect,\n  requires: ['computeStyles']\n};", "import { auto } from \"../enums.js\";\nexport default function getBasePlacement(placement) {\n  return placement.split('-')[0];\n}", "export default function getBoundingClientRect(element) {\n  var rect = element.getBoundingClientRect();\n  return {\n    width: rect.width,\n    height: rect.height,\n    top: rect.top,\n    right: rect.right,\n    bottom: rect.bottom,\n    left: rect.left,\n    x: rect.left,\n    y: rect.top\n  };\n}", "import getBoundingClientRect from \"./getBoundingClientRect.js\"; // Returns the layout rect of an element relative to its offsetParent. Layout\n// means it doesn't take into account transforms.\n\nexport default function getLayoutRect(element) {\n  var clientRect = getBoundingClientRect(element); // Use the clientRect sizes if it's not been transformed.\n  // Fixes https://github.com/popperjs/popper-core/issues/1223\n\n  var width = element.offsetWidth;\n  var height = element.offsetHeight;\n\n  if (Math.abs(clientRect.width - width) <= 1) {\n    width = clientRect.width;\n  }\n\n  if (Math.abs(clientRect.height - height) <= 1) {\n    height = clientRect.height;\n  }\n\n  return {\n    x: element.offsetLeft,\n    y: element.offsetTop,\n    width: width,\n    height: height\n  };\n}", "import { isShadowRoot } from \"./instanceOf.js\";\nexport default function contains(parent, child) {\n  var rootNode = child.getRootNode && child.getRootNode(); // First, attempt with faster native method\n\n  if (parent.contains(child)) {\n    return true;\n  } // then fallback to custom implementation with Shadow DOM support\n  else if (rootNode && isShadowRoot(rootNode)) {\n      var next = child;\n\n      do {\n        if (next && parent.isSameNode(next)) {\n          return true;\n        } // $FlowFixMe[prop-missing]: need a better way to handle this...\n\n\n        next = next.parentNode || next.host;\n      } while (next);\n    } // Give up, the result is false\n\n\n  return false;\n}", "import getWindow from \"./getWindow.js\";\nexport default function getComputedStyle(element) {\n  return getWindow(element).getComputedStyle(element);\n}", "import getNodeName from \"./getNodeName.js\";\nexport default function isTableElement(element) {\n  return ['table', 'td', 'th'].indexOf(getNodeName(element)) >= 0;\n}", "import { isElement } from \"./instanceOf.js\";\nexport default function getDocumentElement(element) {\n  // $FlowFixMe[incompatible-return]: assume body is always available\n  return ((isElement(element) ? element.ownerDocument : // $FlowFixMe[prop-missing]\n  element.document) || window.document).documentElement;\n}", "import getNodeName from \"./getNodeName.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport { isShadowRoot } from \"./instanceOf.js\";\nexport default function getParentNode(element) {\n  if (getNodeName(element) === 'html') {\n    return element;\n  }\n\n  return (// this is a quicker (but less type safe) way to save quite some bytes from the bundle\n    // $FlowFixMe[incompatible-return]\n    // $FlowFixMe[prop-missing]\n    element.assignedSlot || // step into the shadow DOM of the parent of a slotted node\n    element.parentNode || ( // DOM Element detected\n    isShadowRoot(element) ? element.host : null) || // ShadowRoot detected\n    // $FlowFixMe[incompatible-call]: HTMLElement is a Node\n    getDocumentElement(element) // fallback\n\n  );\n}", "import getWindow from \"./getWindow.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport getComputedStyle from \"./getComputedStyle.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nimport isTableElement from \"./isTableElement.js\";\nimport getParentNode from \"./getParentNode.js\";\n\nfunction getTrueOffsetParent(element) {\n  if (!isHTMLElement(element) || // https://github.com/popperjs/popper-core/issues/837\n  getComputedStyle(element).position === 'fixed') {\n    return null;\n  }\n\n  return element.offsetParent;\n} // `.offsetParent` reports `null` for fixed elements, while absolute elements\n// return the containing block\n\n\nfunction getContainingBlock(element) {\n  var isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') !== -1;\n  var currentNode = getParentNode(element);\n\n  while (isHTMLElement(currentNode) && ['html', 'body'].indexOf(getNodeName(currentNode)) < 0) {\n    var css = getComputedStyle(currentNode); // This is non-exhaustive but covers the most common CSS properties that\n    // create a containing block.\n    // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n\n    if (css.transform !== 'none' || css.perspective !== 'none' || css.contain === 'paint' || ['transform', 'perspective'].indexOf(css.willChange) !== -1 || isFirefox && css.willChange === 'filter' || isFirefox && css.filter && css.filter !== 'none') {\n      return currentNode;\n    } else {\n      currentNode = currentNode.parentNode;\n    }\n  }\n\n  return null;\n} // Gets the closest ancestor positioned element. Handles some edge cases,\n// such as table ancestors and cross browser bugs.\n\n\nexport default function getOffsetParent(element) {\n  var window = getWindow(element);\n  var offsetParent = getTrueOffsetParent(element);\n\n  while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === 'static') {\n    offsetParent = getTrueOffsetParent(offsetParent);\n  }\n\n  if (offsetParent && (getNodeName(offsetParent) === 'html' || getNodeName(offsetParent) === 'body' && getComputedStyle(offsetParent).position === 'static')) {\n    return window;\n  }\n\n  return offsetParent || getContainingBlock(element) || window;\n}", "export default function getMainAxisFromPlacement(placement) {\n  return ['top', 'bottom'].indexOf(placement) >= 0 ? 'x' : 'y';\n}", "export var max = Math.max;\nexport var min = Math.min;\nexport var round = Math.round;", "import { max as mathMax, min as mathMin } from \"./math.js\";\nexport default function within(min, value, max) {\n  return mathMax(min, mathMin(value, max));\n}", "export default function getFreshSideObject() {\n  return {\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0\n  };\n}", "import getFreshSideObject from \"./getFreshSideObject.js\";\nexport default function mergePaddingObject(paddingObject) {\n  return Object.assign({}, getFreshSideObject(), paddingObject);\n}", "export default function expandToHashMap(value, keys) {\n  return keys.reduce(function (hashMap, key) {\n    hashMap[key] = value;\n    return hashMap;\n  }, {});\n}", "import getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getLayoutRect from \"../dom-utils/getLayoutRect.js\";\nimport contains from \"../dom-utils/contains.js\";\nimport getOffsetParent from \"../dom-utils/getOffsetParent.js\";\nimport getMainAxisFromPlacement from \"../utils/getMainAxisFromPlacement.js\";\nimport within from \"../utils/within.js\";\nimport mergePaddingObject from \"../utils/mergePaddingObject.js\";\nimport expandToHashMap from \"../utils/expandToHashMap.js\";\nimport { left, right, basePlacements, top, bottom } from \"../enums.js\";\nimport { isHTMLElement } from \"../dom-utils/instanceOf.js\"; // eslint-disable-next-line import/no-unused-modules\n\nvar toPaddingObject = function toPaddingObject(padding, state) {\n  padding = typeof padding === 'function' ? padding(Object.assign({}, state.rects, {\n    placement: state.placement\n  })) : padding;\n  return mergePaddingObject(typeof padding !== 'number' ? padding : expandToHashMap(padding, basePlacements));\n};\n\nfunction arrow(_ref) {\n  var _state$modifiersData$;\n\n  var state = _ref.state,\n      name = _ref.name,\n      options = _ref.options;\n  var arrowElement = state.elements.arrow;\n  var popperOffsets = state.modifiersData.popperOffsets;\n  var basePlacement = getBasePlacement(state.placement);\n  var axis = getMainAxisFromPlacement(basePlacement);\n  var isVertical = [left, right].indexOf(basePlacement) >= 0;\n  var len = isVertical ? 'height' : 'width';\n\n  if (!arrowElement || !popperOffsets) {\n    return;\n  }\n\n  var paddingObject = toPaddingObject(options.padding, state);\n  var arrowRect = getLayoutRect(arrowElement);\n  var minProp = axis === 'y' ? top : left;\n  var maxProp = axis === 'y' ? bottom : right;\n  var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets[axis] - state.rects.popper[len];\n  var startDiff = popperOffsets[axis] - state.rects.reference[axis];\n  var arrowOffsetParent = getOffsetParent(arrowElement);\n  var clientSize = arrowOffsetParent ? axis === 'y' ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;\n  var centerToReference = endDiff / 2 - startDiff / 2; // Make sure the arrow doesn't overflow the popper if the center point is\n  // outside of the popper bounds\n\n  var min = paddingObject[minProp];\n  var max = clientSize - arrowRect[len] - paddingObject[maxProp];\n  var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;\n  var offset = within(min, center, max); // Prevents breaking syntax highlighting...\n\n  var axisProp = axis;\n  state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset, _state$modifiersData$.centerOffset = offset - center, _state$modifiersData$);\n}\n\nfunction effect(_ref2) {\n  var state = _ref2.state,\n      options = _ref2.options;\n  var _options$element = options.element,\n      arrowElement = _options$element === void 0 ? '[data-popper-arrow]' : _options$element;\n\n  if (arrowElement == null) {\n    return;\n  } // CSS selector\n\n\n  if (typeof arrowElement === 'string') {\n    arrowElement = state.elements.popper.querySelector(arrowElement);\n\n    if (!arrowElement) {\n      return;\n    }\n  }\n\n  if (process.env.NODE_ENV !== \"production\") {\n    if (!isHTMLElement(arrowElement)) {\n      console.error(['Popper: \"arrow\" element must be an HTMLElement (not an SVGElement).', 'To use an SVG arrow, wrap it in an HTMLElement that will be used as', 'the arrow.'].join(' '));\n    }\n  }\n\n  if (!contains(state.elements.popper, arrowElement)) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.error(['Popper: \"arrow\" modifier\\'s `element` must be a child of the popper', 'element.'].join(' '));\n    }\n\n    return;\n  }\n\n  state.elements.arrow = arrowElement;\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'arrow',\n  enabled: true,\n  phase: 'main',\n  fn: arrow,\n  effect: effect,\n  requires: ['popperOffsets'],\n  requiresIfExists: ['preventOverflow']\n};", "import { top, left, right, bottom } from \"../enums.js\";\nimport getOffsetParent from \"../dom-utils/getOffsetParent.js\";\nimport getWindow from \"../dom-utils/getWindow.js\";\nimport getDocumentElement from \"../dom-utils/getDocumentElement.js\";\nimport getComputedStyle from \"../dom-utils/getComputedStyle.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\";\nimport { round } from \"../utils/math.js\"; // eslint-disable-next-line import/no-unused-modules\n\nvar unsetSides = {\n  top: 'auto',\n  right: 'auto',\n  bottom: 'auto',\n  left: 'auto'\n}; // Round the offsets to the nearest suitable subpixel based on the DPR.\n// Zooming can change the DPR, but it seems to report a value that will\n// cleanly divide the values into the appropriate subpixels.\n\nfunction roundOffsetsByDPR(_ref) {\n  var x = _ref.x,\n      y = _ref.y;\n  var win = window;\n  var dpr = win.devicePixelRatio || 1;\n  return {\n    x: round(round(x * dpr) / dpr) || 0,\n    y: round(round(y * dpr) / dpr) || 0\n  };\n}\n\nexport function mapToStyles(_ref2) {\n  var _Object$assign2;\n\n  var popper = _ref2.popper,\n      popperRect = _ref2.popperRect,\n      placement = _ref2.placement,\n      offsets = _ref2.offsets,\n      position = _ref2.position,\n      gpuAcceleration = _ref2.gpuAcceleration,\n      adaptive = _ref2.adaptive,\n      roundOffsets = _ref2.roundOffsets;\n\n  var _ref3 = roundOffsets === true ? roundOffsetsByDPR(offsets) : typeof roundOffsets === 'function' ? roundOffsets(offsets) : offsets,\n      _ref3$x = _ref3.x,\n      x = _ref3$x === void 0 ? 0 : _ref3$x,\n      _ref3$y = _ref3.y,\n      y = _ref3$y === void 0 ? 0 : _ref3$y;\n\n  var hasX = offsets.hasOwnProperty('x');\n  var hasY = offsets.hasOwnProperty('y');\n  var sideX = left;\n  var sideY = top;\n  var win = window;\n\n  if (adaptive) {\n    var offsetParent = getOffsetParent(popper);\n    var heightProp = 'clientHeight';\n    var widthProp = 'clientWidth';\n\n    if (offsetParent === getWindow(popper)) {\n      offsetParent = getDocumentElement(popper);\n\n      if (getComputedStyle(offsetParent).position !== 'static') {\n        heightProp = 'scrollHeight';\n        widthProp = 'scrollWidth';\n      }\n    } // $FlowFixMe[incompatible-cast]: force type refinement, we compare offsetParent with window above, but Flow doesn't detect it\n\n\n    offsetParent = offsetParent;\n\n    if (placement === top) {\n      sideY = bottom; // $FlowFixMe[prop-missing]\n\n      y -= offsetParent[heightProp] - popperRect.height;\n      y *= gpuAcceleration ? 1 : -1;\n    }\n\n    if (placement === left) {\n      sideX = right; // $FlowFixMe[prop-missing]\n\n      x -= offsetParent[widthProp] - popperRect.width;\n      x *= gpuAcceleration ? 1 : -1;\n    }\n  }\n\n  var commonStyles = Object.assign({\n    position: position\n  }, adaptive && unsetSides);\n\n  if (gpuAcceleration) {\n    var _Object$assign;\n\n    return Object.assign({}, commonStyles, (_Object$assign = {}, _Object$assign[sideY] = hasY ? '0' : '', _Object$assign[sideX] = hasX ? '0' : '', _Object$assign.transform = (win.devicePixelRatio || 1) < 2 ? \"translate(\" + x + \"px, \" + y + \"px)\" : \"translate3d(\" + x + \"px, \" + y + \"px, 0)\", _Object$assign));\n  }\n\n  return Object.assign({}, commonStyles, (_Object$assign2 = {}, _Object$assign2[sideY] = hasY ? y + \"px\" : '', _Object$assign2[sideX] = hasX ? x + \"px\" : '', _Object$assign2.transform = '', _Object$assign2));\n}\n\nfunction computeStyles(_ref4) {\n  var state = _ref4.state,\n      options = _ref4.options;\n  var _options$gpuAccelerat = options.gpuAcceleration,\n      gpuAcceleration = _options$gpuAccelerat === void 0 ? true : _options$gpuAccelerat,\n      _options$adaptive = options.adaptive,\n      adaptive = _options$adaptive === void 0 ? true : _options$adaptive,\n      _options$roundOffsets = options.roundOffsets,\n      roundOffsets = _options$roundOffsets === void 0 ? true : _options$roundOffsets;\n\n  if (process.env.NODE_ENV !== \"production\") {\n    var transitionProperty = getComputedStyle(state.elements.popper).transitionProperty || '';\n\n    if (adaptive && ['transform', 'top', 'right', 'bottom', 'left'].some(function (property) {\n      return transitionProperty.indexOf(property) >= 0;\n    })) {\n      console.warn(['Popper: Detected CSS transitions on at least one of the following', 'CSS properties: \"transform\", \"top\", \"right\", \"bottom\", \"left\".', '\\n\\n', 'Disable the \"computeStyles\" modifier\\'s `adaptive` option to allow', 'for smooth transitions, or remove these properties from the CSS', 'transition declaration on the popper element if only transitioning', 'opacity or background-color for example.', '\\n\\n', 'We recommend using the popper element as a wrapper around an inner', 'element that can have any CSS property transitioned for animations.'].join(' '));\n    }\n  }\n\n  var commonStyles = {\n    placement: getBasePlacement(state.placement),\n    popper: state.elements.popper,\n    popperRect: state.rects.popper,\n    gpuAcceleration: gpuAcceleration\n  };\n\n  if (state.modifiersData.popperOffsets != null) {\n    state.styles.popper = Object.assign({}, state.styles.popper, mapToStyles(Object.assign({}, commonStyles, {\n      offsets: state.modifiersData.popperOffsets,\n      position: state.options.strategy,\n      adaptive: adaptive,\n      roundOffsets: roundOffsets\n    })));\n  }\n\n  if (state.modifiersData.arrow != null) {\n    state.styles.arrow = Object.assign({}, state.styles.arrow, mapToStyles(Object.assign({}, commonStyles, {\n      offsets: state.modifiersData.arrow,\n      position: 'absolute',\n      adaptive: false,\n      roundOffsets: roundOffsets\n    })));\n  }\n\n  state.attributes.popper = Object.assign({}, state.attributes.popper, {\n    'data-popper-placement': state.placement\n  });\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'computeStyles',\n  enabled: true,\n  phase: 'beforeWrite',\n  fn: computeStyles,\n  data: {}\n};", "import getWindow from \"../dom-utils/getWindow.js\"; // eslint-disable-next-line import/no-unused-modules\n\nvar passive = {\n  passive: true\n};\n\nfunction effect(_ref) {\n  var state = _ref.state,\n      instance = _ref.instance,\n      options = _ref.options;\n  var _options$scroll = options.scroll,\n      scroll = _options$scroll === void 0 ? true : _options$scroll,\n      _options$resize = options.resize,\n      resize = _options$resize === void 0 ? true : _options$resize;\n  var window = getWindow(state.elements.popper);\n  var scrollParents = [].concat(state.scrollParents.reference, state.scrollParents.popper);\n\n  if (scroll) {\n    scrollParents.forEach(function (scrollParent) {\n      scrollParent.addEventListener('scroll', instance.update, passive);\n    });\n  }\n\n  if (resize) {\n    window.addEventListener('resize', instance.update, passive);\n  }\n\n  return function () {\n    if (scroll) {\n      scrollParents.forEach(function (scrollParent) {\n        scrollParent.removeEventListener('scroll', instance.update, passive);\n      });\n    }\n\n    if (resize) {\n      window.removeEventListener('resize', instance.update, passive);\n    }\n  };\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'eventListeners',\n  enabled: true,\n  phase: 'write',\n  fn: function fn() {},\n  effect: effect,\n  data: {}\n};", "var hash = {\n  left: 'right',\n  right: 'left',\n  bottom: 'top',\n  top: 'bottom'\n};\nexport default function getOppositePlacement(placement) {\n  return placement.replace(/left|right|bottom|top/g, function (matched) {\n    return hash[matched];\n  });\n}", "var hash = {\n  start: 'end',\n  end: 'start'\n};\nexport default function getOppositeVariationPlacement(placement) {\n  return placement.replace(/start|end/g, function (matched) {\n    return hash[matched];\n  });\n}", "import getWindow from \"./getWindow.js\";\nexport default function getWindowScroll(node) {\n  var win = getWindow(node);\n  var scrollLeft = win.pageXOffset;\n  var scrollTop = win.pageYOffset;\n  return {\n    scrollLeft: scrollLeft,\n    scrollTop: scrollTop\n  };\n}", "import getBoundingClientRect from \"./getBoundingClientRect.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport getWindowScroll from \"./getWindowScroll.js\";\nexport default function getWindowScrollBarX(element) {\n  // If <html> has a CSS width greater than the viewport, then this will be\n  // incorrect for RTL.\n  // Popper 1 is broken in this case and never had a bug report so let's assume\n  // it's not an issue. I don't think anyone ever specifies width on <html>\n  // anyway.\n  // Browsers where the left scrollbar doesn't cause an issue report `0` for\n  // this (e.g. Edge 2019, IE11, Safari)\n  return getBoundingClientRect(getDocumentElement(element)).left + getWindowScroll(element).scrollLeft;\n}", "import getWindow from \"./getWindow.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport getWindowScrollBarX from \"./getWindowScrollBarX.js\";\nexport default function getViewportRect(element) {\n  var win = getWindow(element);\n  var html = getDocumentElement(element);\n  var visualViewport = win.visualViewport;\n  var width = html.clientWidth;\n  var height = html.clientHeight;\n  var x = 0;\n  var y = 0; // NB: This isn't supported on iOS <= 12. If the keyboard is open, the popper\n  // can be obscured underneath it.\n  // Also, `html.clientHeight` adds the bottom bar height in Safari iOS, even\n  // if it isn't open, so if this isn't available, the popper will be detected\n  // to overflow the bottom of the screen too early.\n\n  if (visualViewport) {\n    width = visualViewport.width;\n    height = visualViewport.height; // Uses Layout Viewport (like Chrome; Safari does not currently)\n    // In Chrome, it returns a value very close to 0 (+/-) but contains rounding\n    // errors due to floating point numbers, so we need to check precision.\n    // Safari returns a number <= 0, usually < -1 when pinch-zoomed\n    // Feature detection fails in mobile emulation mode in Chrome.\n    // Math.abs(win.innerWidth / visualViewport.scale - visualViewport.width) <\n    // 0.001\n    // Fallback here: \"Not Safari\" userAgent\n\n    if (!/^((?!chrome|android).)*safari/i.test(navigator.userAgent)) {\n      x = visualViewport.offsetLeft;\n      y = visualViewport.offsetTop;\n    }\n  }\n\n  return {\n    width: width,\n    height: height,\n    x: x + getWindowScrollBarX(element),\n    y: y\n  };\n}", "import getDocumentElement from \"./getDocumentElement.js\";\nimport getComputedStyle from \"./getComputedStyle.js\";\nimport getWindowScrollBarX from \"./getWindowScrollBarX.js\";\nimport getWindowScroll from \"./getWindowScroll.js\";\nimport { max } from \"../utils/math.js\"; // Gets the entire size of the scrollable document area, even extending outside\n// of the `<html>` and `<body>` rect bounds if horizontally scrollable\n\nexport default function getDocumentRect(element) {\n  var _element$ownerDocumen;\n\n  var html = getDocumentElement(element);\n  var winScroll = getWindowScroll(element);\n  var body = (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body;\n  var width = max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);\n  var height = max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);\n  var x = -winScroll.scrollLeft + getWindowScrollBarX(element);\n  var y = -winScroll.scrollTop;\n\n  if (getComputedStyle(body || html).direction === 'rtl') {\n    x += max(html.clientWidth, body ? body.clientWidth : 0) - width;\n  }\n\n  return {\n    width: width,\n    height: height,\n    x: x,\n    y: y\n  };\n}", "import getComputedStyle from \"./getComputedStyle.js\";\nexport default function isScrollParent(element) {\n  // Firefox wants us to check `-x` and `-y` variations as well\n  var _getComputedStyle = getComputedStyle(element),\n      overflow = _getComputedStyle.overflow,\n      overflowX = _getComputedStyle.overflowX,\n      overflowY = _getComputedStyle.overflowY;\n\n  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);\n}", "import getParentNode from \"./getParentNode.js\";\nimport isScrollParent from \"./isScrollParent.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nexport default function getScrollParent(node) {\n  if (['html', 'body', '#document'].indexOf(getNodeName(node)) >= 0) {\n    // $FlowFixMe[incompatible-return]: assume body is always available\n    return node.ownerDocument.body;\n  }\n\n  if (isHTMLElement(node) && isScrollParent(node)) {\n    return node;\n  }\n\n  return getScrollParent(getParentNode(node));\n}", "import getScrollParent from \"./getScrollParent.js\";\nimport getParentNode from \"./getParentNode.js\";\nimport getWindow from \"./getWindow.js\";\nimport isScrollParent from \"./isScrollParent.js\";\n/*\ngiven a DOM element, return the list of all scroll parents, up the list of ancesors\nuntil we get to the top window object. This list is what we attach scroll listeners\nto, because if any of these parent elements scroll, we'll need to re-calculate the\nreference element's position.\n*/\n\nexport default function listScrollParents(element, list) {\n  var _element$ownerDocumen;\n\n  if (list === void 0) {\n    list = [];\n  }\n\n  var scrollParent = getScrollParent(element);\n  var isBody = scrollParent === ((_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body);\n  var win = getWindow(scrollParent);\n  var target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(scrollParent) ? scrollParent : []) : scrollParent;\n  var updatedList = list.concat(target);\n  return isBody ? updatedList : // $FlowFixMe[incompatible-call]: isBody tells us target will be an HTMLElement here\n  updatedList.concat(listScrollParents(getParentNode(target)));\n}", "export default function rectToClientRect(rect) {\n  return Object.assign({}, rect, {\n    left: rect.x,\n    top: rect.y,\n    right: rect.x + rect.width,\n    bottom: rect.y + rect.height\n  });\n}", "import { viewport } from \"../enums.js\";\nimport getViewportRect from \"./getViewportRect.js\";\nimport getDocumentRect from \"./getDocumentRect.js\";\nimport listScrollParents from \"./listScrollParents.js\";\nimport getOffsetParent from \"./getOffsetParent.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport getComputedStyle from \"./getComputedStyle.js\";\nimport { isElement, isHTMLElement } from \"./instanceOf.js\";\nimport getBoundingClientRect from \"./getBoundingClientRect.js\";\nimport getParentNode from \"./getParentNode.js\";\nimport contains from \"./contains.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport rectToClientRect from \"../utils/rectToClientRect.js\";\nimport { max, min } from \"../utils/math.js\";\n\nfunction getInnerBoundingClientRect(element) {\n  var rect = getBoundingClientRect(element);\n  rect.top = rect.top + element.clientTop;\n  rect.left = rect.left + element.clientLeft;\n  rect.bottom = rect.top + element.clientHeight;\n  rect.right = rect.left + element.clientWidth;\n  rect.width = element.clientWidth;\n  rect.height = element.clientHeight;\n  rect.x = rect.left;\n  rect.y = rect.top;\n  return rect;\n}\n\nfunction getClientRectFromMixedType(element, clippingParent) {\n  return clippingParent === viewport ? rectToClientRect(getViewportRect(element)) : isHTMLElement(clippingParent) ? getInnerBoundingClientRect(clippingParent) : rectToClientRect(getDocumentRect(getDocumentElement(element)));\n} // A \"clipping parent\" is an overflowable container with the characteristic of\n// clipping (or hiding) overflowing elements with a position different from\n// `initial`\n\n\nfunction getClippingParents(element) {\n  var clippingParents = listScrollParents(getParentNode(element));\n  var canEscapeClipping = ['absolute', 'fixed'].indexOf(getComputedStyle(element).position) >= 0;\n  var clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;\n\n  if (!isElement(clipperElement)) {\n    return [];\n  } // $FlowFixMe[incompatible-return]: https://github.com/facebook/flow/issues/1414\n\n\n  return clippingParents.filter(function (clippingParent) {\n    return isElement(clippingParent) && contains(clippingParent, clipperElement) && getNodeName(clippingParent) !== 'body';\n  });\n} // Gets the maximum area that the element is visible in due to any number of\n// clipping parents\n\n\nexport default function getClippingRect(element, boundary, rootBoundary) {\n  var mainClippingParents = boundary === 'clippingParents' ? getClippingParents(element) : [].concat(boundary);\n  var clippingParents = [].concat(mainClippingParents, [rootBoundary]);\n  var firstClippingParent = clippingParents[0];\n  var clippingRect = clippingParents.reduce(function (accRect, clippingParent) {\n    var rect = getClientRectFromMixedType(element, clippingParent);\n    accRect.top = max(rect.top, accRect.top);\n    accRect.right = min(rect.right, accRect.right);\n    accRect.bottom = min(rect.bottom, accRect.bottom);\n    accRect.left = max(rect.left, accRect.left);\n    return accRect;\n  }, getClientRectFromMixedType(element, firstClippingParent));\n  clippingRect.width = clippingRect.right - clippingRect.left;\n  clippingRect.height = clippingRect.bottom - clippingRect.top;\n  clippingRect.x = clippingRect.left;\n  clippingRect.y = clippingRect.top;\n  return clippingRect;\n}", "export default function getVariation(placement) {\n  return placement.split('-')[1];\n}", "import getBasePlacement from \"./getBasePlacement.js\";\nimport getVariation from \"./getVariation.js\";\nimport getMainAxisFromPlacement from \"./getMainAxisFromPlacement.js\";\nimport { top, right, bottom, left, start, end } from \"../enums.js\";\nexport default function computeOffsets(_ref) {\n  var reference = _ref.reference,\n      element = _ref.element,\n      placement = _ref.placement;\n  var basePlacement = placement ? getBasePlacement(placement) : null;\n  var variation = placement ? getVariation(placement) : null;\n  var commonX = reference.x + reference.width / 2 - element.width / 2;\n  var commonY = reference.y + reference.height / 2 - element.height / 2;\n  var offsets;\n\n  switch (basePlacement) {\n    case top:\n      offsets = {\n        x: commonX,\n        y: reference.y - element.height\n      };\n      break;\n\n    case bottom:\n      offsets = {\n        x: commonX,\n        y: reference.y + reference.height\n      };\n      break;\n\n    case right:\n      offsets = {\n        x: reference.x + reference.width,\n        y: commonY\n      };\n      break;\n\n    case left:\n      offsets = {\n        x: reference.x - element.width,\n        y: commonY\n      };\n      break;\n\n    default:\n      offsets = {\n        x: reference.x,\n        y: reference.y\n      };\n  }\n\n  var mainAxis = basePlacement ? getMainAxisFromPlacement(basePlacement) : null;\n\n  if (mainAxis != null) {\n    var len = mainAxis === 'y' ? 'height' : 'width';\n\n    switch (variation) {\n      case start:\n        offsets[mainAxis] = offsets[mainAxis] - (reference[len] / 2 - element[len] / 2);\n        break;\n\n      case end:\n        offsets[mainAxis] = offsets[mainAxis] + (reference[len] / 2 - element[len] / 2);\n        break;\n\n      default:\n    }\n  }\n\n  return offsets;\n}", "import getBoundingClientRect from \"../dom-utils/getBoundingClientRect.js\";\nimport getClippingRect from \"../dom-utils/getClippingRect.js\";\nimport getDocumentElement from \"../dom-utils/getDocumentElement.js\";\nimport computeOffsets from \"./computeOffsets.js\";\nimport rectToClientRect from \"./rectToClientRect.js\";\nimport { clippingParents, reference, popper, bottom, top, right, basePlacements, viewport } from \"../enums.js\";\nimport { isElement } from \"../dom-utils/instanceOf.js\";\nimport mergePaddingObject from \"./mergePaddingObject.js\";\nimport expandToHashMap from \"./expandToHashMap.js\"; // eslint-disable-next-line import/no-unused-modules\n\nexport default function detectOverflow(state, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _options = options,\n      _options$placement = _options.placement,\n      placement = _options$placement === void 0 ? state.placement : _options$placement,\n      _options$boundary = _options.boundary,\n      boundary = _options$boundary === void 0 ? clippingParents : _options$boundary,\n      _options$rootBoundary = _options.rootBoundary,\n      rootBoundary = _options$rootBoundary === void 0 ? viewport : _options$rootBoundary,\n      _options$elementConte = _options.elementContext,\n      elementContext = _options$elementConte === void 0 ? popper : _options$elementConte,\n      _options$altBoundary = _options.altBoundary,\n      altBoundary = _options$altBoundary === void 0 ? false : _options$altBoundary,\n      _options$padding = _options.padding,\n      padding = _options$padding === void 0 ? 0 : _options$padding;\n  var paddingObject = mergePaddingObject(typeof padding !== 'number' ? padding : expandToHashMap(padding, basePlacements));\n  var altContext = elementContext === popper ? reference : popper;\n  var referenceElement = state.elements.reference;\n  var popperRect = state.rects.popper;\n  var element = state.elements[altBoundary ? altContext : elementContext];\n  var clippingClientRect = getClippingRect(isElement(element) ? element : element.contextElement || getDocumentElement(state.elements.popper), boundary, rootBoundary);\n  var referenceClientRect = getBoundingClientRect(referenceElement);\n  var popperOffsets = computeOffsets({\n    reference: referenceClientRect,\n    element: popperRect,\n    strategy: 'absolute',\n    placement: placement\n  });\n  var popperClientRect = rectToClientRect(Object.assign({}, popperRect, popperOffsets));\n  var elementClientRect = elementContext === popper ? popperClientRect : referenceClientRect; // positive = overflowing the clipping rect\n  // 0 or negative = within the clipping rect\n\n  var overflowOffsets = {\n    top: clippingClientRect.top - elementClientRect.top + paddingObject.top,\n    bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,\n    left: clippingClientRect.left - elementClientRect.left + paddingObject.left,\n    right: elementClientRect.right - clippingClientRect.right + paddingObject.right\n  };\n  var offsetData = state.modifiersData.offset; // Offsets can be applied only to the popper element\n\n  if (elementContext === popper && offsetData) {\n    var offset = offsetData[placement];\n    Object.keys(overflowOffsets).forEach(function (key) {\n      var multiply = [right, bottom].indexOf(key) >= 0 ? 1 : -1;\n      var axis = [top, bottom].indexOf(key) >= 0 ? 'y' : 'x';\n      overflowOffsets[key] += offset[axis] * multiply;\n    });\n  }\n\n  return overflowOffsets;\n}", "import getVariation from \"./getVariation.js\";\nimport { variationPlacements, basePlacements, placements as allPlacements } from \"../enums.js\";\nimport detectOverflow from \"./detectOverflow.js\";\nimport getBasePlacement from \"./getBasePlacement.js\";\nexport default function computeAutoPlacement(state, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _options = options,\n      placement = _options.placement,\n      boundary = _options.boundary,\n      rootBoundary = _options.rootBoundary,\n      padding = _options.padding,\n      flipVariations = _options.flipVariations,\n      _options$allowedAutoP = _options.allowedAutoPlacements,\n      allowedAutoPlacements = _options$allowedAutoP === void 0 ? allPlacements : _options$allowedAutoP;\n  var variation = getVariation(placement);\n  var placements = variation ? flipVariations ? variationPlacements : variationPlacements.filter(function (placement) {\n    return getVariation(placement) === variation;\n  }) : basePlacements;\n  var allowedPlacements = placements.filter(function (placement) {\n    return allowedAutoPlacements.indexOf(placement) >= 0;\n  });\n\n  if (allowedPlacements.length === 0) {\n    allowedPlacements = placements;\n\n    if (process.env.NODE_ENV !== \"production\") {\n      console.error(['Popper: The `allowedAutoPlacements` option did not allow any', 'placements. Ensure the `placement` option matches the variation', 'of the allowed placements.', 'For example, \"auto\" cannot be used to allow \"bottom-start\".', 'Use \"auto-start\" instead.'].join(' '));\n    }\n  } // $FlowFixMe[incompatible-type]: Flow seems to have problems with two array unions...\n\n\n  var overflows = allowedPlacements.reduce(function (acc, placement) {\n    acc[placement] = detectOverflow(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      padding: padding\n    })[getBasePlacement(placement)];\n    return acc;\n  }, {});\n  return Object.keys(overflows).sort(function (a, b) {\n    return overflows[a] - overflows[b];\n  });\n}", "import getOppositePlacement from \"../utils/getOppositePlacement.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getOppositeVariationPlacement from \"../utils/getOppositeVariationPlacement.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\nimport computeAutoPlacement from \"../utils/computeAutoPlacement.js\";\nimport { bottom, top, start, right, left, auto } from \"../enums.js\";\nimport getVariation from \"../utils/getVariation.js\"; // eslint-disable-next-line import/no-unused-modules\n\nfunction getExpandedFallbackPlacements(placement) {\n  if (getBasePlacement(placement) === auto) {\n    return [];\n  }\n\n  var oppositePlacement = getOppositePlacement(placement);\n  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];\n}\n\nfunction flip(_ref) {\n  var state = _ref.state,\n      options = _ref.options,\n      name = _ref.name;\n\n  if (state.modifiersData[name]._skip) {\n    return;\n  }\n\n  var _options$mainAxis = options.mainAxis,\n      checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis,\n      _options$altAxis = options.altAxis,\n      checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis,\n      specifiedFallbackPlacements = options.fallbackPlacements,\n      padding = options.padding,\n      boundary = options.boundary,\n      rootBoundary = options.rootBoundary,\n      altBoundary = options.altBoundary,\n      _options$flipVariatio = options.flipVariations,\n      flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio,\n      allowedAutoPlacements = options.allowedAutoPlacements;\n  var preferredPlacement = state.options.placement;\n  var basePlacement = getBasePlacement(preferredPlacement);\n  var isBasePlacement = basePlacement === preferredPlacement;\n  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));\n  var placements = [preferredPlacement].concat(fallbackPlacements).reduce(function (acc, placement) {\n    return acc.concat(getBasePlacement(placement) === auto ? computeAutoPlacement(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      padding: padding,\n      flipVariations: flipVariations,\n      allowedAutoPlacements: allowedAutoPlacements\n    }) : placement);\n  }, []);\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var checksMap = new Map();\n  var makeFallbackChecks = true;\n  var firstFittingPlacement = placements[0];\n\n  for (var i = 0; i < placements.length; i++) {\n    var placement = placements[i];\n\n    var _basePlacement = getBasePlacement(placement);\n\n    var isStartVariation = getVariation(placement) === start;\n    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;\n    var len = isVertical ? 'width' : 'height';\n    var overflow = detectOverflow(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      altBoundary: altBoundary,\n      padding: padding\n    });\n    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;\n\n    if (referenceRect[len] > popperRect[len]) {\n      mainVariationSide = getOppositePlacement(mainVariationSide);\n    }\n\n    var altVariationSide = getOppositePlacement(mainVariationSide);\n    var checks = [];\n\n    if (checkMainAxis) {\n      checks.push(overflow[_basePlacement] <= 0);\n    }\n\n    if (checkAltAxis) {\n      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);\n    }\n\n    if (checks.every(function (check) {\n      return check;\n    })) {\n      firstFittingPlacement = placement;\n      makeFallbackChecks = false;\n      break;\n    }\n\n    checksMap.set(placement, checks);\n  }\n\n  if (makeFallbackChecks) {\n    // `2` may be desired in some cases \u2013 research later\n    var numberOfChecks = flipVariations ? 3 : 1;\n\n    var _loop = function _loop(_i) {\n      var fittingPlacement = placements.find(function (placement) {\n        var checks = checksMap.get(placement);\n\n        if (checks) {\n          return checks.slice(0, _i).every(function (check) {\n            return check;\n          });\n        }\n      });\n\n      if (fittingPlacement) {\n        firstFittingPlacement = fittingPlacement;\n        return \"break\";\n      }\n    };\n\n    for (var _i = numberOfChecks; _i > 0; _i--) {\n      var _ret = _loop(_i);\n\n      if (_ret === \"break\") break;\n    }\n  }\n\n  if (state.placement !== firstFittingPlacement) {\n    state.modifiersData[name]._skip = true;\n    state.placement = firstFittingPlacement;\n    state.reset = true;\n  }\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'flip',\n  enabled: true,\n  phase: 'main',\n  fn: flip,\n  requiresIfExists: ['offset'],\n  data: {\n    _skip: false\n  }\n};", "import { top, bottom, left, right } from \"../enums.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\n\nfunction getSideOffsets(overflow, rect, preventedOffsets) {\n  if (preventedOffsets === void 0) {\n    preventedOffsets = {\n      x: 0,\n      y: 0\n    };\n  }\n\n  return {\n    top: overflow.top - rect.height - preventedOffsets.y,\n    right: overflow.right - rect.width + preventedOffsets.x,\n    bottom: overflow.bottom - rect.height + preventedOffsets.y,\n    left: overflow.left - rect.width - preventedOffsets.x\n  };\n}\n\nfunction isAnySideFullyClipped(overflow) {\n  return [top, right, bottom, left].some(function (side) {\n    return overflow[side] >= 0;\n  });\n}\n\nfunction hide(_ref) {\n  var state = _ref.state,\n      name = _ref.name;\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var preventedOffsets = state.modifiersData.preventOverflow;\n  var referenceOverflow = detectOverflow(state, {\n    elementContext: 'reference'\n  });\n  var popperAltOverflow = detectOverflow(state, {\n    altBoundary: true\n  });\n  var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);\n  var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);\n  var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);\n  var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);\n  state.modifiersData[name] = {\n    referenceClippingOffsets: referenceClippingOffsets,\n    popperEscapeOffsets: popperEscapeOffsets,\n    isReferenceHidden: isReferenceHidden,\n    hasPopperEscaped: hasPopperEscaped\n  };\n  state.attributes.popper = Object.assign({}, state.attributes.popper, {\n    'data-popper-reference-hidden': isReferenceHidden,\n    'data-popper-escaped': hasPopperEscaped\n  });\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'hide',\n  enabled: true,\n  phase: 'main',\n  requiresIfExists: ['preventOverflow'],\n  fn: hide\n};", "import getBasePlacement from \"../utils/getBasePlacement.js\";\nimport { top, left, right, placements } from \"../enums.js\";\nexport function distanceAndSkiddingToXY(placement, rects, offset) {\n  var basePlacement = getBasePlacement(placement);\n  var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;\n\n  var _ref = typeof offset === 'function' ? offset(Object.assign({}, rects, {\n    placement: placement\n  })) : offset,\n      skidding = _ref[0],\n      distance = _ref[1];\n\n  skidding = skidding || 0;\n  distance = (distance || 0) * invertDistance;\n  return [left, right].indexOf(basePlacement) >= 0 ? {\n    x: distance,\n    y: skidding\n  } : {\n    x: skidding,\n    y: distance\n  };\n}\n\nfunction offset(_ref2) {\n  var state = _ref2.state,\n      options = _ref2.options,\n      name = _ref2.name;\n  var _options$offset = options.offset,\n      offset = _options$offset === void 0 ? [0, 0] : _options$offset;\n  var data = placements.reduce(function (acc, placement) {\n    acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset);\n    return acc;\n  }, {});\n  var _data$state$placement = data[state.placement],\n      x = _data$state$placement.x,\n      y = _data$state$placement.y;\n\n  if (state.modifiersData.popperOffsets != null) {\n    state.modifiersData.popperOffsets.x += x;\n    state.modifiersData.popperOffsets.y += y;\n  }\n\n  state.modifiersData[name] = data;\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'offset',\n  enabled: true,\n  phase: 'main',\n  requires: ['popperOffsets'],\n  fn: offset\n};", "import computeOffsets from \"../utils/computeOffsets.js\";\n\nfunction popperOffsets(_ref) {\n  var state = _ref.state,\n      name = _ref.name;\n  // Offsets are the actual position the popper needs to have to be\n  // properly positioned near its reference element\n  // This is the most basic placement, and will be adjusted by\n  // the modifiers in the next step\n  state.modifiersData[name] = computeOffsets({\n    reference: state.rects.reference,\n    element: state.rects.popper,\n    strategy: 'absolute',\n    placement: state.placement\n  });\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'popperOffsets',\n  enabled: true,\n  phase: 'read',\n  fn: popperOffsets,\n  data: {}\n};", "export default function getAltAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}", "import { top, left, right, bottom, start } from \"../enums.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getMainAxisFromPlacement from \"../utils/getMainAxisFromPlacement.js\";\nimport getAltAxis from \"../utils/getAltAxis.js\";\nimport within from \"../utils/within.js\";\nimport getLayoutRect from \"../dom-utils/getLayoutRect.js\";\nimport getOffsetParent from \"../dom-utils/getOffsetParent.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\nimport getVariation from \"../utils/getVariation.js\";\nimport getFreshSideObject from \"../utils/getFreshSideObject.js\";\nimport { max as mathMax, min as mathMin } from \"../utils/math.js\";\n\nfunction preventOverflow(_ref) {\n  var state = _ref.state,\n      options = _ref.options,\n      name = _ref.name;\n  var _options$mainAxis = options.mainAxis,\n      checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis,\n      _options$altAxis = options.altAxis,\n      checkAltAxis = _options$altAxis === void 0 ? false : _options$altAxis,\n      boundary = options.boundary,\n      rootBoundary = options.rootBoundary,\n      altBoundary = options.altBoundary,\n      padding = options.padding,\n      _options$tether = options.tether,\n      tether = _options$tether === void 0 ? true : _options$tether,\n      _options$tetherOffset = options.tetherOffset,\n      tetherOffset = _options$tetherOffset === void 0 ? 0 : _options$tetherOffset;\n  var overflow = detectOverflow(state, {\n    boundary: boundary,\n    rootBoundary: rootBoundary,\n    padding: padding,\n    altBoundary: altBoundary\n  });\n  var basePlacement = getBasePlacement(state.placement);\n  var variation = getVariation(state.placement);\n  var isBasePlacement = !variation;\n  var mainAxis = getMainAxisFromPlacement(basePlacement);\n  var altAxis = getAltAxis(mainAxis);\n  var popperOffsets = state.modifiersData.popperOffsets;\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var tetherOffsetValue = typeof tetherOffset === 'function' ? tetherOffset(Object.assign({}, state.rects, {\n    placement: state.placement\n  })) : tetherOffset;\n  var data = {\n    x: 0,\n    y: 0\n  };\n\n  if (!popperOffsets) {\n    return;\n  }\n\n  if (checkMainAxis || checkAltAxis) {\n    var mainSide = mainAxis === 'y' ? top : left;\n    var altSide = mainAxis === 'y' ? bottom : right;\n    var len = mainAxis === 'y' ? 'height' : 'width';\n    var offset = popperOffsets[mainAxis];\n    var min = popperOffsets[mainAxis] + overflow[mainSide];\n    var max = popperOffsets[mainAxis] - overflow[altSide];\n    var additive = tether ? -popperRect[len] / 2 : 0;\n    var minLen = variation === start ? referenceRect[len] : popperRect[len];\n    var maxLen = variation === start ? -popperRect[len] : -referenceRect[len]; // We need to include the arrow in the calculation so the arrow doesn't go\n    // outside the reference bounds\n\n    var arrowElement = state.elements.arrow;\n    var arrowRect = tether && arrowElement ? getLayoutRect(arrowElement) : {\n      width: 0,\n      height: 0\n    };\n    var arrowPaddingObject = state.modifiersData['arrow#persistent'] ? state.modifiersData['arrow#persistent'].padding : getFreshSideObject();\n    var arrowPaddingMin = arrowPaddingObject[mainSide];\n    var arrowPaddingMax = arrowPaddingObject[altSide]; // If the reference length is smaller than the arrow length, we don't want\n    // to include its full size in the calculation. If the reference is small\n    // and near the edge of a boundary, the popper can overflow even if the\n    // reference is not overflowing as well (e.g. virtual elements with no\n    // width or height)\n\n    var arrowLen = within(0, referenceRect[len], arrowRect[len]);\n    var minOffset = isBasePlacement ? referenceRect[len] / 2 - additive - arrowLen - arrowPaddingMin - tetherOffsetValue : minLen - arrowLen - arrowPaddingMin - tetherOffsetValue;\n    var maxOffset = isBasePlacement ? -referenceRect[len] / 2 + additive + arrowLen + arrowPaddingMax + tetherOffsetValue : maxLen + arrowLen + arrowPaddingMax + tetherOffsetValue;\n    var arrowOffsetParent = state.elements.arrow && getOffsetParent(state.elements.arrow);\n    var clientOffset = arrowOffsetParent ? mainAxis === 'y' ? arrowOffsetParent.clientTop || 0 : arrowOffsetParent.clientLeft || 0 : 0;\n    var offsetModifierValue = state.modifiersData.offset ? state.modifiersData.offset[state.placement][mainAxis] : 0;\n    var tetherMin = popperOffsets[mainAxis] + minOffset - offsetModifierValue - clientOffset;\n    var tetherMax = popperOffsets[mainAxis] + maxOffset - offsetModifierValue;\n\n    if (checkMainAxis) {\n      var preventedOffset = within(tether ? mathMin(min, tetherMin) : min, offset, tether ? mathMax(max, tetherMax) : max);\n      popperOffsets[mainAxis] = preventedOffset;\n      data[mainAxis] = preventedOffset - offset;\n    }\n\n    if (checkAltAxis) {\n      var _mainSide = mainAxis === 'x' ? top : left;\n\n      var _altSide = mainAxis === 'x' ? bottom : right;\n\n      var _offset = popperOffsets[altAxis];\n\n      var _min = _offset + overflow[_mainSide];\n\n      var _max = _offset - overflow[_altSide];\n\n      var _preventedOffset = within(tether ? mathMin(_min, tetherMin) : _min, _offset, tether ? mathMax(_max, tetherMax) : _max);\n\n      popperOffsets[altAxis] = _preventedOffset;\n      data[altAxis] = _preventedOffset - _offset;\n    }\n  }\n\n  state.modifiersData[name] = data;\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'preventOverflow',\n  enabled: true,\n  phase: 'main',\n  fn: preventOverflow,\n  requiresIfExists: ['offset']\n};", "export default function getHTMLElementScroll(element) {\n  return {\n    scrollLeft: element.scrollLeft,\n    scrollTop: element.scrollTop\n  };\n}", "import getWindowScroll from \"./getWindowScroll.js\";\nimport getWindow from \"./getWindow.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nimport getHTMLElementScroll from \"./getHTMLElementScroll.js\";\nexport default function getNodeScroll(node) {\n  if (node === getWindow(node) || !isHTMLElement(node)) {\n    return getWindowScroll(node);\n  } else {\n    return getHTMLElementScroll(node);\n  }\n}", "import getBoundingClientRect from \"./getBoundingClientRect.js\";\nimport getNodeScroll from \"./getNodeScroll.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nimport getWindowScrollBarX from \"./getWindowScrollBarX.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport isScrollParent from \"./isScrollParent.js\"; // Returns the composite rect of an element relative to its offsetParent.\n// Composite means it takes into account transforms as well as layout.\n\nexport default function getCompositeRect(elementOrVirtualElement, offsetParent, isFixed) {\n  if (isFixed === void 0) {\n    isFixed = false;\n  }\n\n  var documentElement = getDocumentElement(offsetParent);\n  var rect = getBoundingClientRect(elementOrVirtualElement);\n  var isOffsetParentAnElement = isHTMLElement(offsetParent);\n  var scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  var offsets = {\n    x: 0,\n    y: 0\n  };\n\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {\n    if (getNodeName(offsetParent) !== 'body' || // https://github.com/popperjs/popper-core/issues/1078\n    isScrollParent(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n\n    if (isHTMLElement(offsetParent)) {\n      offsets = getBoundingClientRect(offsetParent);\n      offsets.x += offsetParent.clientLeft;\n      offsets.y += offsetParent.clientTop;\n    } else if (documentElement) {\n      offsets.x = getWindowScrollBarX(documentElement);\n    }\n  }\n\n  return {\n    x: rect.left + scroll.scrollLeft - offsets.x,\n    y: rect.top + scroll.scrollTop - offsets.y,\n    width: rect.width,\n    height: rect.height\n  };\n}", "import { modifierPhases } from \"../enums.js\"; // source: https://stackoverflow.com/questions/49875255\n\nfunction order(modifiers) {\n  var map = new Map();\n  var visited = new Set();\n  var result = [];\n  modifiers.forEach(function (modifier) {\n    map.set(modifier.name, modifier);\n  }); // On visiting object, check for its dependencies and visit them recursively\n\n  function sort(modifier) {\n    visited.add(modifier.name);\n    var requires = [].concat(modifier.requires || [], modifier.requiresIfExists || []);\n    requires.forEach(function (dep) {\n      if (!visited.has(dep)) {\n        var depModifier = map.get(dep);\n\n        if (depModifier) {\n          sort(depModifier);\n        }\n      }\n    });\n    result.push(modifier);\n  }\n\n  modifiers.forEach(function (modifier) {\n    if (!visited.has(modifier.name)) {\n      // check for visited object\n      sort(modifier);\n    }\n  });\n  return result;\n}\n\nexport default function orderModifiers(modifiers) {\n  // order based on dependencies\n  var orderedModifiers = order(modifiers); // order based on phase\n\n  return modifierPhases.reduce(function (acc, phase) {\n    return acc.concat(orderedModifiers.filter(function (modifier) {\n      return modifier.phase === phase;\n    }));\n  }, []);\n}", "export default function debounce(fn) {\n  var pending;\n  return function () {\n    if (!pending) {\n      pending = new Promise(function (resolve) {\n        Promise.resolve().then(function () {\n          pending = undefined;\n          resolve(fn());\n        });\n      });\n    }\n\n    return pending;\n  };\n}", "export default function mergeByName(modifiers) {\n  var merged = modifiers.reduce(function (merged, current) {\n    var existing = merged[current.name];\n    merged[current.name] = existing ? Object.assign({}, existing, current, {\n      options: Object.assign({}, existing.options, current.options),\n      data: Object.assign({}, existing.data, current.data)\n    }) : current;\n    return merged;\n  }, {}); // IE11 does not support Object.values\n\n  return Object.keys(merged).map(function (key) {\n    return merged[key];\n  });\n}", "import getCompositeRect from \"./dom-utils/getCompositeRect.js\";\nimport getLayoutRect from \"./dom-utils/getLayoutRect.js\";\nimport listScrollParents from \"./dom-utils/listScrollParents.js\";\nimport getOffsetParent from \"./dom-utils/getOffsetParent.js\";\nimport getComputedStyle from \"./dom-utils/getComputedStyle.js\";\nimport orderModifiers from \"./utils/orderModifiers.js\";\nimport debounce from \"./utils/debounce.js\";\nimport validateModifiers from \"./utils/validateModifiers.js\";\nimport uniqueBy from \"./utils/uniqueBy.js\";\nimport getBasePlacement from \"./utils/getBasePlacement.js\";\nimport mergeByName from \"./utils/mergeByName.js\";\nimport detectOverflow from \"./utils/detectOverflow.js\";\nimport { isElement } from \"./dom-utils/instanceOf.js\";\nimport { auto } from \"./enums.js\";\nvar INVALID_ELEMENT_ERROR = 'Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.';\nvar INFINITE_LOOP_ERROR = 'Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.';\nvar DEFAULT_OPTIONS = {\n  placement: 'bottom',\n  modifiers: [],\n  strategy: 'absolute'\n};\n\nfunction areValidElements() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  return !args.some(function (element) {\n    return !(element && typeof element.getBoundingClientRect === 'function');\n  });\n}\n\nexport function popperGenerator(generatorOptions) {\n  if (generatorOptions === void 0) {\n    generatorOptions = {};\n  }\n\n  var _generatorOptions = generatorOptions,\n      _generatorOptions$def = _generatorOptions.defaultModifiers,\n      defaultModifiers = _generatorOptions$def === void 0 ? [] : _generatorOptions$def,\n      _generatorOptions$def2 = _generatorOptions.defaultOptions,\n      defaultOptions = _generatorOptions$def2 === void 0 ? DEFAULT_OPTIONS : _generatorOptions$def2;\n  return function createPopper(reference, popper, options) {\n    if (options === void 0) {\n      options = defaultOptions;\n    }\n\n    var state = {\n      placement: 'bottom',\n      orderedModifiers: [],\n      options: Object.assign({}, DEFAULT_OPTIONS, defaultOptions),\n      modifiersData: {},\n      elements: {\n        reference: reference,\n        popper: popper\n      },\n      attributes: {},\n      styles: {}\n    };\n    var effectCleanupFns = [];\n    var isDestroyed = false;\n    var instance = {\n      state: state,\n      setOptions: function setOptions(options) {\n        cleanupModifierEffects();\n        state.options = Object.assign({}, defaultOptions, state.options, options);\n        state.scrollParents = {\n          reference: isElement(reference) ? listScrollParents(reference) : reference.contextElement ? listScrollParents(reference.contextElement) : [],\n          popper: listScrollParents(popper)\n        }; // Orders the modifiers based on their dependencies and `phase`\n        // properties\n\n        var orderedModifiers = orderModifiers(mergeByName([].concat(defaultModifiers, state.options.modifiers))); // Strip out disabled modifiers\n\n        state.orderedModifiers = orderedModifiers.filter(function (m) {\n          return m.enabled;\n        }); // Validate the provided modifiers so that the consumer will get warned\n        // if one of the modifiers is invalid for any reason\n\n        if (process.env.NODE_ENV !== \"production\") {\n          var modifiers = uniqueBy([].concat(orderedModifiers, state.options.modifiers), function (_ref) {\n            var name = _ref.name;\n            return name;\n          });\n          validateModifiers(modifiers);\n\n          if (getBasePlacement(state.options.placement) === auto) {\n            var flipModifier = state.orderedModifiers.find(function (_ref2) {\n              var name = _ref2.name;\n              return name === 'flip';\n            });\n\n            if (!flipModifier) {\n              console.error(['Popper: \"auto\" placements require the \"flip\" modifier be', 'present and enabled to work.'].join(' '));\n            }\n          }\n\n          var _getComputedStyle = getComputedStyle(popper),\n              marginTop = _getComputedStyle.marginTop,\n              marginRight = _getComputedStyle.marginRight,\n              marginBottom = _getComputedStyle.marginBottom,\n              marginLeft = _getComputedStyle.marginLeft; // We no longer take into account `margins` on the popper, and it can\n          // cause bugs with positioning, so we'll warn the consumer\n\n\n          if ([marginTop, marginRight, marginBottom, marginLeft].some(function (margin) {\n            return parseFloat(margin);\n          })) {\n            console.warn(['Popper: CSS \"margin\" styles cannot be used to apply padding', 'between the popper and its reference element or boundary.', 'To replicate margin, use the `offset` modifier, as well as', 'the `padding` option in the `preventOverflow` and `flip`', 'modifiers.'].join(' '));\n          }\n        }\n\n        runModifierEffects();\n        return instance.update();\n      },\n      // Sync update \u2013 it will always be executed, even if not necessary. This\n      // is useful for low frequency updates where sync behavior simplifies the\n      // logic.\n      // For high frequency updates (e.g. `resize` and `scroll` events), always\n      // prefer the async Popper#update method\n      forceUpdate: function forceUpdate() {\n        if (isDestroyed) {\n          return;\n        }\n\n        var _state$elements = state.elements,\n            reference = _state$elements.reference,\n            popper = _state$elements.popper; // Don't proceed if `reference` or `popper` are not valid elements\n        // anymore\n\n        if (!areValidElements(reference, popper)) {\n          if (process.env.NODE_ENV !== \"production\") {\n            console.error(INVALID_ELEMENT_ERROR);\n          }\n\n          return;\n        } // Store the reference and popper rects to be read by modifiers\n\n\n        state.rects = {\n          reference: getCompositeRect(reference, getOffsetParent(popper), state.options.strategy === 'fixed'),\n          popper: getLayoutRect(popper)\n        }; // Modifiers have the ability to reset the current update cycle. The\n        // most common use case for this is the `flip` modifier changing the\n        // placement, which then needs to re-run all the modifiers, because the\n        // logic was previously ran for the previous placement and is therefore\n        // stale/incorrect\n\n        state.reset = false;\n        state.placement = state.options.placement; // On each update cycle, the `modifiersData` property for each modifier\n        // is filled with the initial data specified by the modifier. This means\n        // it doesn't persist and is fresh on each update.\n        // To ensure persistent data, use `${name}#persistent`\n\n        state.orderedModifiers.forEach(function (modifier) {\n          return state.modifiersData[modifier.name] = Object.assign({}, modifier.data);\n        });\n        var __debug_loops__ = 0;\n\n        for (var index = 0; index < state.orderedModifiers.length; index++) {\n          if (process.env.NODE_ENV !== \"production\") {\n            __debug_loops__ += 1;\n\n            if (__debug_loops__ > 100) {\n              console.error(INFINITE_LOOP_ERROR);\n              break;\n            }\n          }\n\n          if (state.reset === true) {\n            state.reset = false;\n            index = -1;\n            continue;\n          }\n\n          var _state$orderedModifie = state.orderedModifiers[index],\n              fn = _state$orderedModifie.fn,\n              _state$orderedModifie2 = _state$orderedModifie.options,\n              _options = _state$orderedModifie2 === void 0 ? {} : _state$orderedModifie2,\n              name = _state$orderedModifie.name;\n\n          if (typeof fn === 'function') {\n            state = fn({\n              state: state,\n              options: _options,\n              name: name,\n              instance: instance\n            }) || state;\n          }\n        }\n      },\n      // Async and optimistically optimized update \u2013 it will not be executed if\n      // not necessary (debounced to run at most once-per-tick)\n      update: debounce(function () {\n        return new Promise(function (resolve) {\n          instance.forceUpdate();\n          resolve(state);\n        });\n      }),\n      destroy: function destroy() {\n        cleanupModifierEffects();\n        isDestroyed = true;\n      }\n    };\n\n    if (!areValidElements(reference, popper)) {\n      if (process.env.NODE_ENV !== \"production\") {\n        console.error(INVALID_ELEMENT_ERROR);\n      }\n\n      return instance;\n    }\n\n    instance.setOptions(options).then(function (state) {\n      if (!isDestroyed && options.onFirstUpdate) {\n        options.onFirstUpdate(state);\n      }\n    }); // Modifiers have the ability to execute arbitrary code before the first\n    // update cycle runs. They will be executed in the same order as the update\n    // cycle. This is useful when a modifier adds some persistent data that\n    // other modifiers need to use, but the modifier is run after the dependent\n    // one.\n\n    function runModifierEffects() {\n      state.orderedModifiers.forEach(function (_ref3) {\n        var name = _ref3.name,\n            _ref3$options = _ref3.options,\n            options = _ref3$options === void 0 ? {} : _ref3$options,\n            effect = _ref3.effect;\n\n        if (typeof effect === 'function') {\n          var cleanupFn = effect({\n            state: state,\n            name: name,\n            instance: instance,\n            options: options\n          });\n\n          var noopFn = function noopFn() {};\n\n          effectCleanupFns.push(cleanupFn || noopFn);\n        }\n      });\n    }\n\n    function cleanupModifierEffects() {\n      effectCleanupFns.forEach(function (fn) {\n        return fn();\n      });\n      effectCleanupFns = [];\n    }\n\n    return instance;\n  };\n}\nexport var createPopper = /*#__PURE__*/popperGenerator(); // eslint-disable-next-line import/no-unused-modules\n\nexport { detectOverflow };", "import { popperGenerator, detectOverflow } from \"./createPopper.js\";\nimport eventListeners from \"./modifiers/eventListeners.js\";\nimport popperOffsets from \"./modifiers/popperOffsets.js\";\nimport computeStyles from \"./modifiers/computeStyles.js\";\nimport applyStyles from \"./modifiers/applyStyles.js\";\nimport offset from \"./modifiers/offset.js\";\nimport flip from \"./modifiers/flip.js\";\nimport preventOverflow from \"./modifiers/preventOverflow.js\";\nimport arrow from \"./modifiers/arrow.js\";\nimport hide from \"./modifiers/hide.js\";\nvar defaultModifiers = [eventListeners, popperOffsets, computeStyles, applyStyles, offset, flip, preventOverflow, arrow, hide];\nvar createPopper = /*#__PURE__*/popperGenerator({\n  defaultModifiers: defaultModifiers\n}); // eslint-disable-next-line import/no-unused-modules\n\nexport { createPopper, popperGenerator, defaultModifiers, detectOverflow }; // eslint-disable-next-line import/no-unused-modules\n\nexport { createPopper as createPopperLite } from \"./popper-lite.js\"; // eslint-disable-next-line import/no-unused-modules\n\nexport * from \"./modifiers/index.js\";", "import { createPopper as createTooltip, Instance as TooltipInstance } from '@popperjs/core'\nimport { ButtonDataset } from './ComponentFactory'\nimport { Component, ComponentBase, ComponentState } from './components/Component'\nimport { CustomComponent } from './components/CustomComponent'\nimport { Drawable, DrawableWithDraggablePosition, DrawableWithPosition, MenuData, MenuItem } from \"./components/Drawable\"\nimport { Node, NodeBase } from \"./components/Node\"\nimport { Waypoint, Wire } from './components/Wire'\nimport { distSquared, DrawZIndex, GRID_STEP, setColorPointerOverIsDanger } from \"./drawutils\"\nimport { applyModifiersTo, button, cls, emptyMod, li, Modifier, ModifierObject, mods, span, type, ul } from './htmlgen'\nimport { IconName, makeIcon } from './images'\nimport { LogicEditor, PointerAction, PoionterActionParams } from './LogicEditor'\nimport { S } from './strings'\nimport { getScrollParent, InteractionResult, Mode, targetIsFieldOrOtherInput, TimeoutHandle } from \"./utils\"\n\ntype PointerDownData = {\n    mainComp: Drawable | Element\n    selectionComps: Drawable[]\n    firedPointerDraggedAlready: boolean\n    fireClickedOnFinish: boolean\n    initialXY: [number, number]\n    triggeredContextMenu: boolean\n}\n\nexport type PointerDragEvent = PointerEvent & { dragStartX: number, dragStartY: number }\n\nfunction setDragStartOnEvent(e: PointerEvent, dragStartX: number, dragStartY: number): asserts e is PointerDragEvent {\n    const _e = e as any\n    _e.dragStartX = dragStartX\n    _e.dragStartY = dragStartY\n}\nfunction preventDefaultAlways(e: Event) {\n    e.preventDefault()\n}\n\n\nexport class EditorSelection {\n\n    /**\n     * The elements that are selected, independently of the potential\n     * rectangle that is currently drawn\n     */\n    public previouslySelectedElements = new Set<Drawable>()\n\n    public constructor(\n        public currentlyDrawnRect: DOMRect | undefined,\n    ) { }\n\n    public toggle(elem: Drawable) {\n        if (this.previouslySelectedElements.has(elem)) {\n            this.previouslySelectedElements.delete(elem)\n        } else {\n            this.previouslySelectedElements.add(elem)\n        }\n    }\n\n    public finishCurrentRect(editor: LogicEditor) {\n        let rect\n        if ((rect = this.currentlyDrawnRect) !== undefined) {\n            for (const comp of editor.components.all()) {\n                if (comp.isInRect(rect)) {\n                    this.toggle(comp)\n                }\n            }\n\n            for (const wire of editor.linkMgr.wires) {\n                for (const point of wire.waypoints) {\n                    if (point.isInRect(rect)) {\n                        this.toggle(point)\n                    }\n                }\n            }\n\n            this.currentlyDrawnRect = undefined\n        }\n    }\n\n    public isSelected(component: Drawable): boolean {\n        const prevSelected = this.previouslySelectedElements.has(component)\n        const rect = this.currentlyDrawnRect\n        if (rect === undefined) {\n            return prevSelected\n        } else {\n            const inverted = component.isInRect(rect)\n            return inverted ? !prevSelected : prevSelected\n        }\n    }\n\n}\n\n\nexport class UIEventManager {\n\n    public readonly editor: LogicEditor\n    private _currentComponentUnderPointer: Drawable | null = null\n    private _currentTooltip: [tooltip: TooltipInstance, removeScrollListener: () => void] | null = null\n    private _currentPointerDownData: PointerDownData | null = null\n    private _startHoverTimeoutHandle: TimeoutHandle | null = null\n    private _longPressTimeoutHandle: TimeoutHandle | null = null\n    private _currentAction: PointerAction\n    private _currentHandlers: ToolHandlers\n    private _lastTouchEnd: [Drawable, number] | undefined = undefined\n    public currentSelection: EditorSelection | undefined = undefined\n\n    public constructor(editor: LogicEditor) {\n        this.editor = editor\n        this._currentAction = \"edit\"\n        this._currentHandlers = new EditHandlers(editor)\n    }\n\n    public get currentComponentUnderPointer() {\n        return this._currentComponentUnderPointer\n    }\n\n    public get currentPointerDownData() {\n        return this._currentPointerDownData\n    }\n\n\n    public setHandlersFor<M extends PointerAction>(action: M, ...params: PoionterActionParams<M>): boolean {\n        if (action === this._currentAction) {\n            return false\n        }\n        this._currentAction = action\n        const newHandlers = (() => {\n            switch (action) {\n                case \"delete\":\n                    return new DeleteHandlers(this.editor)\n                case \"move\":\n                    return new MoveHandlers(this.editor)\n                case \"setanchor\":\n                    return new SetAnchorHandlers(this.editor, ...(params as PoionterActionParams<\"setanchor\">))\n                case \"edit\": default:\n                    return new EditHandlers(this.editor)\n            }\n        })()\n        this._currentHandlers.unmount()\n        this._currentHandlers = newHandlers\n        setColorPointerOverIsDanger(action === \"delete\")\n        return true\n    }\n\n    public startLongPressTimeout(startPointerDownData: PointerDownData, e: PointerEvent) {\n        // we do this because firefox otherwise sets back offsetX/Y to 0\n        const _e = e as any\n        _e._savedOffsetX = _e.offsetX\n        _e._savedOffsetY = _e.offsetY\n        _e._savedTarget = _e.target\n\n        this._longPressTimeoutHandle = setTimeout(\n            this.editor.wrapHandler(() => {\n                let cancelLongPressAction = false\n                const endPointerDownData = this._currentPointerDownData\n                if (endPointerDownData !== null) {\n                    // mark this as handled and not needing a click event\n                    endPointerDownData.fireClickedOnFinish = false\n                    if (endPointerDownData.triggeredContextMenu) {\n                        // cancel the long press action if a context menu was already triggered\n                        cancelLongPressAction = true\n                    }\n                }\n                if (cancelLongPressAction) {\n                    return\n                }\n\n                // for mouse events, we trigger a drag after some time\n                if (e.pointerType === \"mouse\") {\n                    const [dragStartX, dragStartY] = this.editor.offsetXY(e, true)\n                    setDragStartOnEvent(e, dragStartX, dragStartY)\n                    if (startPointerDownData.mainComp instanceof Drawable) {\n                        this._currentHandlers.pointerDraggedOn(startPointerDownData.mainComp, e)\n                    }\n                    for (const comp of startPointerDownData.selectionComps) {\n                        this._currentHandlers.pointerDraggedOn(comp, e)\n                    }\n                } else {\n                    // for touch events, we trigger a context menu\n                    if (this.editor.mode >= Mode.CONNECT && startPointerDownData.mainComp instanceof Drawable) {\n                        this._currentHandlers.contextMenuOn(startPointerDownData.mainComp, e)\n                    }\n                }\n            }),\n            500\n        )\n    }\n\n    public clearLongPressTimeout() {\n        if (this._longPressTimeoutHandle !== null) {\n            clearTimeout(this._longPressTimeoutHandle)\n            this._longPressTimeoutHandle = null\n        }\n    }\n\n    public clearHoverTimeoutHandle() {\n        if (this._startHoverTimeoutHandle !== null) {\n            clearTimeout(this._startHoverTimeoutHandle)\n            this._startHoverTimeoutHandle = null\n        }\n    }\n\n    public setCurrentComponentUnderPointer(comp: Drawable | null) {\n        if (comp !== this._currentComponentUnderPointer) {\n            this.clearTooltipIfNeeded()\n            this.clearHoverTimeoutHandle()\n\n            this._currentComponentUnderPointer = comp\n            if (comp !== null) {\n                this._startHoverTimeoutHandle = setTimeout(() => {\n                    this._currentHandlers.pointerHoverOn(comp)\n                    this._startHoverTimeoutHandle = null\n                }, 1200)\n            }\n            this.editor.editTools.redrawMgr.requestRedraw({ why: \"pointerover changed\" })\n            // console.log(\"Over component: \", comp)\n        }\n    }\n\n    public currentSelectionEmpty() {\n        return this.currentSelection === undefined || this.currentSelection.previouslySelectedElements.size === 0\n    }\n\n    public updateComponentUnderPointer([x, y]: [number, number], pullingWire: boolean, settingAnchor: boolean, isTouch: boolean) {\n\n        // Here is the pointerover search order:\n        // * Components - overlays\n        // * Components - normal, and nodes, sometimes\n        // * Wires, sometimes\n        // * Components - background\n        // We use isTouchMove to determine if we should make finger connections to nodes easier by being more tolerant\n\n        const findComponenentUnderPointer: () => Drawable | null = () => {\n            // easy optimization: maybe we're still over the\n            // same component as before, so quickly check this\n            const prevCompUnderPointer = this._currentComponentUnderPointer\n            if (prevCompUnderPointer !== null && prevCompUnderPointer.drawZIndex !== 0) {\n                // second condition says: always revalidate the pointerover of background components (with z index 0)\n\n                // we always revalidate wires and nodes (because of tolerant hit radiuses)\n                // if we're setting an anchor, we only want components, not drawables\n                const rejectThis = prevCompUnderPointer instanceof Wire ||\n                    prevCompUnderPointer instanceof NodeBase ||\n                    (settingAnchor && !(prevCompUnderPointer instanceof ComponentBase))\n                if (!rejectThis && prevCompUnderPointer.isOver(x, y)) {\n                    return this._currentComponentUnderPointer\n                }\n            }\n            const root = this.editor.editorRoot\n\n            // overlays\n            if (!pullingWire) {\n                for (const comp of root.components.withZIndex(DrawZIndex.Overlay)) {\n                    if (comp.isOver(x, y)) {\n                        return comp\n                    }\n                }\n            }\n\n            // normal components or their nodes\n            for (const comp of root.components.withZIndex(DrawZIndex.Normal)) {\n                let nodeOver: Node | undefined = undefined\n                let bestDistanceSquared = Number.POSITIVE_INFINITY\n                if (!settingAnchor) {\n                    // check nodes -- all of them to be able to get the smallest distance,\n                    // which prevents too big hit radius from making \"hidden\" nodes unreachable\n                    for (const node of comp.allNodes()) {\n                        const dist = node.distSquaredIfOver(x, y, isTouch)\n                        if (dist !== undefined && dist < bestDistanceSquared) {\n                            bestDistanceSquared = dist\n                            nodeOver = node\n                        }\n                    }\n                }\n                if (nodeOver !== undefined && (!pullingWire || root.linkMgr.isValidNodeToConnect(nodeOver))) {\n                    return nodeOver\n                }\n                if (!pullingWire && comp.isOver(x, y)) {\n                    return comp\n                }\n            }\n\n            if (!pullingWire && !settingAnchor) {\n                // wires\n                for (const wire of root.linkMgr.wires) {\n                    for (const waypoint of wire.waypoints) {\n                        if (waypoint.isOver(x, y)) {\n                            return waypoint\n                        }\n                    }\n                    if (wire.isOver(x, y)) {\n                        return wire\n                    }\n                }\n            }\n\n            if (!pullingWire) {\n                // background elems\n                for (const comp of root.components.withZIndex(DrawZIndex.Background)) {\n                    if (comp.isOver(x, y)) {\n                        return comp\n                    }\n                }\n            }\n\n            return null\n        }\n\n        const comp = findComponenentUnderPointer()\n        this.setCurrentComponentUnderPointer(comp)\n    }\n\n    public selectAll() {\n        const sel = new EditorSelection(undefined)\n        this.currentSelection = sel\n        const root = this.editor.editorRoot\n        for (const comp of root.components.all()) {\n            sel.previouslySelectedElements.add(comp)\n        }\n        for (const wire of root.linkMgr.wires) {\n            for (const waypoint of wire.waypoints) {\n                sel.previouslySelectedElements.add(waypoint)\n            }\n        }\n        this.editor.editTools.redrawMgr.requestRedraw({ why: \"selected all\" })\n    }\n\n    public toggleSelect(comp: Drawable) {\n        let sel\n        if ((sel = this.currentSelection) === undefined) {\n            sel = new EditorSelection(undefined)\n            this.currentSelection = sel\n        }\n        sel.toggle(comp)\n        this.editor.editTools.redrawMgr.requestRedraw({ why: \"toggled selection\" })\n    }\n\n    private moveSelection(dx: number, dy: number, snapToGrid: boolean): boolean {\n        const sel = this.currentSelection\n        if (sel === undefined || sel.previouslySelectedElements.size === 0) {\n            return false\n        }\n        for (const comp of sel.previouslySelectedElements) {\n            if (comp instanceof DrawableWithDraggablePosition) {\n                comp.setPosition(comp.posX + dx, comp.posY + dy, snapToGrid)\n            }\n        }\n        return true\n    }\n\n\n    public clearTooltipIfNeeded() {\n        if (this._currentTooltip !== null) {\n            const [tooltip, removeListener] = this._currentTooltip\n            removeListener()\n            tooltip.destroy()\n            this._currentTooltip = null\n            this.editor.html.tooltipElem.style.display = \"none\"\n        }\n    }\n\n    public makeTooltip(tooltipHtml: ModifierObject, rect: () => DOMRect) {\n        const { tooltipContents, tooltipElem, mainCanvas } = this.editor.html\n        tooltipContents.innerHTML = \"\"\n        tooltipHtml.applyTo(tooltipContents)\n        tooltipElem.style.removeProperty(\"display\")\n        const tooltip = createTooltip({\n            getBoundingClientRect: rect,\n            contextElement: mainCanvas,\n        }, tooltipElem, {\n            placement: 'right',\n            modifiers: [{ name: 'offset', options: { offset: [4, 8] } }],\n        })\n\n        const scrollParent = getScrollParent(mainCanvas)\n        const scrollListener = () => tooltip.update()\n        scrollParent.addEventListener(\"scroll\", scrollListener)\n        const removeListener = () => scrollParent.removeEventListener(\"scroll\", scrollListener)\n        this._currentTooltip = [tooltip, removeListener]\n\n        tooltipElem.setAttribute('data-show', '')\n        tooltip.update()\n    }\n\n    public hideContextMenuIfNeeded(e: PointerEvent) {\n        this._currentHandlers.hideContextMenuIfNeeded(e)\n    }\n\n    public registerCanvasListenersOn(canvas: HTMLCanvasElement) {\n        const editor = this.editor\n\n        const returnFalse = () => false\n        const preventDefaultIfCanConnect = (e: Event) => {\n            // prevent scrolling when we can connect\n            if (this.editor.mode >= Mode.CONNECT) {\n                e.preventDefault()\n            }\n        }\n\n        // Prevent scrolling\n        canvas.ontouchstart = preventDefaultIfCanConnect\n        canvas.ontouchmove = preventDefaultIfCanConnect\n        canvas.ontouchend = preventDefaultAlways\n\n        // Handle pointer events\n\n        // Typical sequence:\n        // pointerenter -> pointerover -> pointerdown? -> pointermove* -> pointerup || pointercancel -> pointerout -> pointerleave\n        // We're interested in:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n        // We don't use e.isPrimary since there could be several primary pointers, one\n        // per pointer type. Instead, we use the pointerId to determine the one to listen to.\n        // We still use custom logic to move and zoom the canvas when two pointers are used.\n\n        // This tracks the active pointers, the first one being our main pointer\n        const downPointers: Map<number, PointerEvent> = new Map()\n        let trackedPointerId: number | undefined = undefined\n\n        type Transform = { zoom: number, tX: number, tY: number }\n        type PointersLoc = { dist: number, centerX: number, centerY: number }\n        let currentZoomSession: { initialTransform: Transform, initialPointersLoc: PointersLoc } | undefined = undefined\n\n        const cancelZoomSession = () => {\n            if (currentZoomSession !== undefined) {\n                // round final translation offset to not be off-grid\n                const translationRoundTo = GRID_STEP / 2\n                const tX = Math.round(editor.translationX / translationRoundTo) * translationRoundTo\n                const tY = Math.round(editor.translationY / translationRoundTo) * translationRoundTo\n                editor.setTranslation(tX, tY)\n                currentZoomSession = undefined\n            }\n        }\n\n        const applyZoomAndTranslation = (zoom: number, startGestureX: number, startGestureY: number, endGestureX: number, endGestureY: number) => {\n            const effectiveZoom = editor.setZoom(zoom, true)\n            const effectiveScale = effectiveZoom / 100\n            const tX = endGestureX / effectiveScale - startGestureX\n            const tY = endGestureY / effectiveScale - startGestureY\n            editor.setTranslation(tX, tY)\n        }\n\n        const getTwoPointersLoc = (skipTransform: boolean): PointersLoc => {\n            if (downPointers.size !== 2) {\n                throw new Error(\"Pointer distance called with \" + downPointers.size + \" pointers instead of 2\")\n            }\n            const pointerEvents = downPointers.values()\n            const p1 = pointerEvents.next().value!\n            const p2 = pointerEvents.next().value!\n            const [p1X, p1Y] = editor.offsetXY(p1, skipTransform)\n            const [p2X, p2Y] = editor.offsetXY(p2, skipTransform)\n            const centerX = (p1X + p2X) / 2\n            const centerY = (p1Y + p2Y) / 2\n            const dx = p1X - p2X\n            const dy = p1Y - p2Y\n            const dist = Math.sqrt(dx * dx + dy * dy)\n            return { dist, centerX, centerY }\n        }\n\n        canvas.onpointerdown = editor.wrapHandler(e => {\n            const pointerId = e.pointerId\n            canvas.setPointerCapture(pointerId)\n            downPointers.set(pointerId, e)\n\n            const numPointers = downPointers.size\n            if (numPointers === 2) {\n                // finish previous pointer session\n                this.doPointerUp(e)\n                trackedPointerId = undefined\n\n                if (editor.mode >= Mode.CONNECT) {\n                    // we'll start a zoom session\n                    const initialTransform = {\n                        zoom: this.editor.userDrawingScale * 100,\n                        tX: this.editor.translationX,\n                        tY: this.editor.translationY,\n                    }\n                    currentZoomSession = {\n                        initialTransform,\n                        initialPointersLoc: getTwoPointersLoc(false),\n                    }\n                }\n            } else {\n                cancelZoomSession()\n            }\n\n            if (numPointers === 1) {\n                // start handling these pointer's events\n                trackedPointerId = pointerId\n                this.doPointerDown(e)\n            }\n        })\n        canvas.onpointermove = editor.wrapHandler(e => {\n            const pointerId = e.pointerId\n            if (downPointers.has(pointerId)) {\n                // update it if it was down; otherwise, it's a mousemove without\n                // a pointerdown so we don't track it\n                downPointers.set(pointerId, e)\n            }\n\n            const numPointers = downPointers.size\n            let handle = false\n            if (numPointers === 2 && currentZoomSession !== undefined) {\n                const initLoc = currentZoomSession.initialPointersLoc\n                const newLoc = getTwoPointersLoc(true)\n                const factor = newLoc.dist / initLoc.dist * 100 / currentZoomSession.initialTransform.zoom\n                const targetZoom = currentZoomSession.initialTransform.zoom * factor\n                const stickyZoom = targetZoom > 95 && targetZoom < 105 ? 100 : targetZoom\n                applyZoomAndTranslation(stickyZoom, initLoc.centerX, initLoc.centerY, newLoc.centerX, newLoc.centerY)\n            } else {\n                handle = pointerId === trackedPointerId\n            }\n\n            if (e.pointerType !== \"touch\" || handle) {\n                this.doPointerMove(e)\n            }\n        })\n        // pointerleave: outside of canvas incl. descendants\n        canvas.onpointerleave = this.clearTooltipIfNeeded.bind(this)\n        // no need to handle pointerout because it also fires when entering a child element\n\n        const onpointerupcancel = editor.wrapHandler((e: PointerEvent) => {\n            const pointerId = e.pointerId\n            downPointers.delete(pointerId)\n\n            if (pointerId === trackedPointerId) {\n                this.doPointerUp(e)\n                trackedPointerId = undefined\n            }\n\n            cancelZoomSession()\n        })\n\n        canvas.onpointerup = onpointerupcancel\n        canvas.onpointercancel = onpointerupcancel\n\n        // Wheel events for zooming and panning\n        let wheelEndTimer: TimeoutHandle | null = null\n        canvas.onwheel = editor.wrapHandler(e => {\n            if (editor.mode >= Mode.CONNECT) {\n                e.preventDefault()\n                const isZoomGesture = e.ctrlKey || e.metaKey\n                if (isZoomGesture) {\n                    // Calculate zoom factor based on deltaY\n                    const delta = -e.deltaY\n                    const zoomFactor = 1 + delta * 0.005\n                    const oldZoom = editor.userDrawingScale * 100\n                    const [oldCenterX, oldCenterY] = editor.offsetXY(e, false)\n                    const [newCenterX, newCenterY] = editor.offsetXY(e, true)\n                    applyZoomAndTranslation(oldZoom * zoomFactor, oldCenterX, oldCenterY, newCenterX, newCenterY)\n                } else {\n                    // Handle as a pan gesture if not a zoom\n                    const speedFactor = 1 / editor.userDrawingScale // slower if zoomed in\n                    const panX = -e.deltaX * speedFactor\n                    const panY = -e.deltaY * speedFactor\n                    editor.setTranslation(editor.translationX + panX, editor.translationY + panY)\n                }\n\n                // detect end of wheel interaction\n                if (wheelEndTimer !== null) {\n                    clearTimeout(wheelEndTimer)\n                }\n                wheelEndTimer = setTimeout(() => {\n                    wheelEndTimer = null\n                    editor.finishAutoZoomTranslationIfActive()\n                }, 200)\n            }\n        })\n\n        // Context menu\n        canvas.oncontextmenu = editor.wrapHandler((e) => {\n            e.preventDefault()\n            if (this.editor.mode >= Mode.CONNECT && this._currentComponentUnderPointer !== null) {\n                this._currentHandlers.contextMenuOn(this._currentComponentUnderPointer, e)\n            }\n        })\n        // there is a global 'pointerdown' listener that is used to hide the context menu\n\n        // Key events\n        canvas.addEventListener(\"keyup\", editor.wrapHandler(e => {\n            if (targetIsFieldOrOtherInput(e)) {\n                return\n            }\n\n            const keyLower = e.key.toLowerCase()\n            switch (keyLower) {\n                case \"escape\": {\n                    let handled: boolean\n                    handled = editor.eventMgr.tryDeleteComponentsWhere(comp => comp.state === ComponentState.SPAWNING, false) > 0\n                    if (!handled) {\n                        handled = editor.linkMgr.tryCancelWireOrAnchor()\n                    }\n                    if (!handled && this.editor.editorRoot instanceof CustomComponent) {\n                        handled = this.editor.tryCloseCustomComponentEditor()\n                    }\n                    if (!handled) {\n                        handled = editor.setCurrentPointerAction(\"edit\")\n                    }\n\n                    if (handled) {\n                        e.preventDefault()\n                    }\n                    return\n                }\n\n                case \"backspace\":\n                case \"delete\": {\n                    e.preventDefault()\n                    if (!editor.deleteSelection()) {\n                        // if nothing was deleted, we try to delete the hovered component\n                        if (this.currentComponentUnderPointer !== null) {\n                            const result = editor.eventMgr.tryDeleteDrawable(this.currentComponentUnderPointer)\n                            if (result.isChange) {\n                                editor.editTools.undoMgr.takeSnapshot(result)\n                            }\n                        }\n                    }\n                    return\n                }\n\n                case \"e\":\n                    editor.setCurrentPointerAction(\"edit\")\n                    e.preventDefault()\n                    return\n\n                case \"d\":\n                    editor.setCurrentPointerAction(\"delete\")\n                    e.preventDefault()\n                    return\n\n                case \"m\":\n                    editor.setCurrentPointerAction(\"move\")\n                    e.preventDefault()\n                    return\n\n                case \"t\":\n                    if (editor.editorRoot.testSuites.totalCases() > 0) {\n                        editor.setTestsPaletteVisible(true)\n                        editor.editTools.testsPalette.runAllTestSuites()\n                        e.preventDefault()\n                        return\n                    }\n            }\n        }))\n\n        canvas.addEventListener(\"keydown\", editor.wrapAsyncHandler(async e => {\n            const ctrlOrCommand = e.ctrlKey || e.metaKey\n            const keyLower = e.key.toLowerCase()\n            const shift = e.shiftKey || (keyLower !== e.key)\n            switch (keyLower) {\n                case \"a\":\n                    if (ctrlOrCommand && editor.mode >= Mode.CONNECT && !targetIsFieldOrOtherInput(e)) {\n                        e.preventDefault()\n                        this.selectAll()\n                    }\n                    return\n\n                case \"s\":\n                    if (ctrlOrCommand && editor.isSingleton) {\n                        e.preventDefault()\n                        editor.saveCurrentStateToUrl()\n                    }\n                    return\n\n                case \"z\":\n                    if (ctrlOrCommand && !targetIsFieldOrOtherInput(e)) {\n                        e.preventDefault()\n                        if (shift) {\n                            editor.editTools.undoMgr.redoOrRepeat()\n                        } else {\n                            editor.editTools.undoMgr.undo()\n                        }\n                    }\n                    return\n                case \"y\":\n                    if (ctrlOrCommand && !targetIsFieldOrOtherInput(e)) {\n                        e.preventDefault()\n                        editor.editTools.undoMgr.redoOrRepeat()\n                    }\n                    return\n                case \"x\":\n                    if (ctrlOrCommand && !targetIsFieldOrOtherInput(e)) {\n                        e.preventDefault()\n                        await editor.cut()\n                    }\n                    return\n                case \"c\":\n                    if (ctrlOrCommand && !targetIsFieldOrOtherInput(e)) {\n                        e.preventDefault()\n                        await editor.copy()\n                    }\n                    return\n                case \"v\":\n                    if (ctrlOrCommand && !targetIsFieldOrOtherInput(e)) {\n                        e.preventDefault()\n                        await editor.paste()\n                    }\n                    return\n                case \"g\":\n                    if (ctrlOrCommand && editor.mode >= Mode.CONNECT) {\n                        e.preventDefault()\n                        editor.makeGroupWithSelection()\n                    }\n                    return\n\n                case \"arrowright\":\n                    if (this.moveSelection(ctrlOrCommand ? 1 : GRID_STEP / 2, 0, e.altKey)) {\n                        return\n                    }\n                    break\n                case \"arrowleft\":\n                    if (this.moveSelection(ctrlOrCommand ? -1 : -GRID_STEP / 2, 0, e.altKey)) {\n                        return\n                    }\n                    break\n                case \"arrowdown\":\n                    if (this.moveSelection(0, ctrlOrCommand ? 1 : GRID_STEP / 2, e.altKey)) {\n                        return\n                    }\n                    break\n                case \"arrowup\":\n                    if (this.moveSelection(0, ctrlOrCommand ? -1 : -GRID_STEP / 2, e.altKey)) {\n                        return\n                    }\n                    break\n            }\n\n            // console.log(\"keydown %o %o, comp: %o\", e, keyLower, this._currentPointerOverComp)\n\n            if (this._currentComponentUnderPointer !== null) {\n                this._currentComponentUnderPointer.keyDown(e)\n            }\n        }))\n\n\n        // Drag and drop on canvas\n        canvas.ondragenter = returnFalse\n        canvas.ondragover = returnFalse\n        canvas.ondragend = returnFalse\n        canvas.ondrop = e => {\n            if (e.dataTransfer === null) {\n                return false\n            }\n\n            e.preventDefault()\n            const file = e.dataTransfer.files?.[0]\n            if (file !== undefined) {\n                editor.tryLoadFrom(file)\n            } else {\n                const dataItems = e.dataTransfer.items\n                if (dataItems !== undefined) {\n                    for (const dataItem of dataItems) {\n                        if (dataItem.kind === \"string\" && (dataItem.type === \"application/json\" || dataItem.type === \"application/json5\" || dataItem.type === \"text/plain\")) {\n                            dataItem.getAsString(content => {\n                                e.dataTransfer!.dropEffect = \"copy\"\n                                editor.loadCircuitOrLibrary(content)\n                            })\n                            break\n                        }\n                    }\n                }\n            }\n            return false\n        }\n    }\n\n    private doPointerDown(e: PointerEvent) {\n        this.clearHoverTimeoutHandle()\n        this.clearTooltipIfNeeded()\n        if (this._currentPointerDownData === null) {\n            const xy = this.editor.offsetXY(e)\n            this.updateComponentUnderPointer(xy, false, false, e.pointerType === \"touch\")\n            if (this._currentComponentUnderPointer !== null) {\n                // pointer down on component\n                const { wantsDragEvents } = this._currentHandlers.pointerDownOn(this._currentComponentUnderPointer, e)\n                if (wantsDragEvents) {\n                    const selectedComps = this.currentSelection === undefined ? [] : [...this.currentSelection.previouslySelectedElements]\n                    for (const comp of selectedComps) {\n                        if (comp !== this._currentComponentUnderPointer) {\n                            this._currentHandlers.pointerDownOn(comp, e)\n                        }\n                    }\n                    const pointerDownData: PointerDownData = {\n                        mainComp: this._currentComponentUnderPointer,\n                        selectionComps: selectedComps,\n                        firedPointerDraggedAlready: false,\n                        fireClickedOnFinish: true,\n                        initialXY: xy,\n                        triggeredContextMenu: false,\n                    }\n                    this._currentPointerDownData = pointerDownData\n                    this.startLongPressTimeout(pointerDownData, e)\n                }\n                this.editor.editTools.redrawMgr.requestRedraw({ why: \"pointerdown\" })\n            } else {\n                // pointer down on background\n                this._currentPointerDownData = {\n                    mainComp: this.editor.html.canvasContainer,\n                    selectionComps: [], // ignore selection\n                    firedPointerDraggedAlready: false,\n                    fireClickedOnFinish: true,\n                    initialXY: xy,\n                    triggeredContextMenu: false,\n                }\n                this._currentHandlers.pointerDownOnBackground(e)\n            }\n            this.editor.updateCursor(e)\n        } else {\n            // we got a pointerdown while a component had programmatically\n            // been determined as being pointerdown'd; ignore\n        }\n    }\n\n    private doPointerMove(e: PointerEvent) {\n        if (this._currentPointerDownData !== null) {\n            if (this._currentPointerDownData.triggeredContextMenu) {\n                // cancel it all\n                this._currentPointerDownData = null\n            } else {\n                const initialXY = this._currentPointerDownData.initialXY\n                setDragStartOnEvent(e, initialXY[0], initialXY[1])\n                if (this._currentPointerDownData.mainComp instanceof Drawable) {\n                    // check if the drag is too small to be taken into account now\n                    // (e.g., touchmove is fired very quickly)\n                    let fireDragEvent =\n                        // if we fired a drag event already for this \"click session\", we go on\n                        this._currentPointerDownData.firedPointerDraggedAlready\n\n                    if (!fireDragEvent) {\n                        // we check if we should fire a drag event and cancel it if the move is too small,\n                        const d2 = distSquared(...this.editor.offsetXY(e), ...this._currentPointerDownData.initialXY)\n                        // NaN is returned when no input point was specified and\n                        // dragging should then happen regardless\n                        fireDragEvent = isNaN(d2) || d2 >= 5 * 5 // 5 pixels\n                    }\n\n                    if (fireDragEvent) {\n                        // dragging component\n                        this.clearLongPressTimeout()\n                        this._currentPointerDownData.fireClickedOnFinish = false\n                        this._currentHandlers.pointerDraggedOn(this._currentPointerDownData.mainComp, e)\n                        for (const comp of this._currentPointerDownData.selectionComps) {\n                            if (comp !== this._currentPointerDownData.mainComp) {\n                                this._currentHandlers.pointerDraggedOn(comp, e)\n                            }\n                        }\n                        this._currentPointerDownData.firedPointerDraggedAlready = true\n                    }\n                } else {\n                    // dragging background\n                    this._currentHandlers.pointerDraggedOnBackground(e)\n                }\n            }\n        } else {\n            // moving pointer or dragging without a locked component\n            const linkMgr = this.editor.editorRoot.linkMgr\n            this.updateComponentUnderPointer(this.editor.offsetXY(e), linkMgr.isAddingWire, linkMgr.isSettingAnchor, e.pointerType === \"touch\")\n        }\n        this.editor.updateCursor(e)\n    }\n\n    private doPointerUp(e: PointerEvent) {\n        // our target is either the locked component that\n        // was clicked or the latest poin ter over component\n        const pointerUpTarget = this._currentPointerDownData?.mainComp ?? this._currentComponentUnderPointer\n        if (pointerUpTarget instanceof Drawable) {\n            // pointerup on component\n            this.clearLongPressTimeout()\n            let change = this._currentHandlers.pointerUpOn(pointerUpTarget, e)\n            for (const comp of this._currentPointerDownData?.selectionComps ?? []) {\n                if (comp !== pointerUpTarget) {\n                    const newChange = this._currentHandlers.pointerUpOn(comp, e)\n                    change = InteractionResult.merge(change, newChange)\n                }\n            }\n\n            const pointerDownData = this._currentPointerDownData\n            const firePointerClicked = pointerDownData === null ? false : pointerDownData.fireClickedOnFinish && !pointerDownData.triggeredContextMenu\n            if (firePointerClicked) {\n                let newChange\n                if (this.isDoubleClick(pointerUpTarget, e)) {\n                    newChange = this._currentHandlers.pointerDoubleClickedOn(pointerUpTarget, e)\n                    if (!newChange.isChange) {\n                        // no double click handler, so we trigger a normal click\n                        newChange = this._currentHandlers.pointerClickedOn(pointerUpTarget, e)\n                    }\n                } else {\n                    newChange = this._currentHandlers.pointerClickedOn(pointerUpTarget, e)\n                }\n                change = InteractionResult.merge(change, newChange)\n            }\n\n            if (change.isChange) {\n                this.editor.editTools.undoMgr.takeSnapshot(change)\n            }\n\n        } else {\n            // pointerup on background\n            this._currentHandlers.pointerUpOnBackground(e)\n        }\n        this._currentPointerDownData = null\n\n        if (e.pointerType === \"touch\") {\n            this.setCurrentComponentUnderPointer(null)\n        } else {\n            this.updateComponentUnderPointer(this.editor.offsetXY(e), false, false, false)\n            this.editor.updateCursor(e)\n        }\n        this.editor.editTools.redrawMgr.requestRedraw({ why: \"pointerup\" })\n        this.editor.focus()\n    }\n\n    private isDoubleClick(clickedComp: Drawable, e: PointerEvent) {\n        if (e.pointerType === \"mouse\") {\n            return e.detail === 2\n        } else {\n            const oldLastTouchEnd = this._lastTouchEnd\n            const now = new Date().getTime()\n            this._lastTouchEnd = [clickedComp, now]\n            if (oldLastTouchEnd === undefined) {\n                return false\n            }\n            const [lastComp, lastTime] = oldLastTouchEnd\n            const elapsedTimeMillis = now - lastTime\n            const isDoubleTouch = lastComp === clickedComp && elapsedTimeMillis > 0 && elapsedTimeMillis < 300\n            if (isDoubleTouch) {\n                this._lastTouchEnd = undefined\n            }\n            return isDoubleTouch\n        }\n    }\n\n    public registerButtonListenersOn(componentButtons: HTMLButtonElement[], isCustomElement: boolean) {\n        const editor = this.editor\n\n        const pointermoveHandler = editor.wrapHandler((e: PointerEvent) => {\n            // e.preventDefault()\n            this.doPointerMove(e)\n            // this.setCurrentComponentUnderPointer(null)\n        })\n        const pointerupHandler = editor.wrapHandler((e: PointerEvent) => {\n            // e.preventDefault()\n            this.doPointerUp(e)\n            // this.setCurrentComponentUnderPointer(null)\n        })\n\n        for (const compButton of componentButtons) {\n\n            compButton.ontouchstart = preventDefaultAlways\n            compButton.ontouchmove = preventDefaultAlways\n            compButton.ontouchend = preventDefaultAlways\n\n            compButton.onpointermove = pointermoveHandler\n            compButton.onpointerup = pointerupHandler\n            compButton.onpointerdown = editor.wrapHandler((e) => {\n                // console.log(\"button pointerdown %o %o\", editor.offsetXY(e), e)\n                if (e.button === 2 || (e.button === 0 && e.ctrlKey)) {\n                    // will be handled by context menu\n                    return\n                }\n                this.editor.setCurrentPointerAction(\"edit\")\n                e.preventDefault()\n                compButton.setPointerCapture(e.pointerId)\n                this.editor.eventMgr.currentSelection = undefined\n                const newComponent = editor.factory.makeFromButton(editor.editorRoot, compButton)\n                if (newComponent === undefined) {\n                    return\n                }\n                this._currentComponentUnderPointer = newComponent\n                const { wantsDragEvents } = this._currentHandlers.pointerDownOn(newComponent, e)\n                if (wantsDragEvents) {\n                    this._currentPointerDownData = {\n                        mainComp: this._currentComponentUnderPointer,\n                        selectionComps: [], // ignore selection when dragging new component\n                        firedPointerDraggedAlready: false,\n                        fireClickedOnFinish: false,\n                        initialXY: [NaN, NaN],\n                        triggeredContextMenu: false,\n                    }\n                }\n                const [x, y] = editor.offsetXY(e, true)\n                setDragStartOnEvent(e, x, y)\n                this._currentHandlers.pointerDraggedOn(newComponent, e)\n            })\n\n            compButton.addEventListener(\"contextmenu\", editor.wrapHandler((e) => {\n                // console.log(\"button contextmenu %o %o\", editor.offsetXY(e), e)\n                e.preventDefault()\n                e.stopPropagation()\n\n                if (isCustomElement && this.editor.mode >= Mode.DESIGN) {\n                    this._currentHandlers.contextMenuOnButton(compButton.dataset as ButtonDataset, e)\n                }\n            }))\n        }\n    }\n\n    public registerTitleDragListenersOn(title: HTMLDivElement, closeHandler?: () => unknown) {\n        let isDragging = false\n        let startX: number, startY: number, startTop: number, startRight: number\n\n        let closeButton: HTMLElement | undefined = undefined\n        if (closeHandler) {\n            closeButton = makeIcon(\"close\")\n            closeButton.classList.add(\"close-palette\")\n            closeButton.addEventListener(\"click\", closeHandler)\n            closeButton.addEventListener(\"click\", () => {\n                console.log(\"close palette\")\n            })\n            title.appendChild(closeButton)\n        }\n\n        title.addEventListener('pointerdown', (e) => {\n            if (isDragging) { return }\n            if (e.composedPath().includes(closeButton as any)) { return } // don't start drag when clicking close button\n\n            title.setPointerCapture(e.pointerId)\n            isDragging = true\n\n            // Store the initial mouse position\n            startX = e.clientX\n            startY = e.clientY\n\n            // Get the current computed top and right values of the element\n            const parent = title.parentElement!\n            const computedStyle = window.getComputedStyle(parent)\n            startTop = parseInt(computedStyle.top, 10)\n            startRight = parseInt(computedStyle.right, 10)\n\n            // Change cursor to grabbing\n            title.style.cursor = 'grabbing'\n\n            // Prevent text selection while dragging\n            e.preventDefault()\n        })\n\n        title.addEventListener('pointermove', (e) => {\n            if (!isDragging) { return }\n\n            // Calculate the movement\n            const deltaX = e.clientX - startX\n            const deltaY = e.clientY - startY\n\n            // Update top and right based on movement\n            const parent = title.parentElement!\n            parent.style.top = `${startTop + deltaY}px`\n            parent.style.right = `${startRight - deltaX}px`\n        })\n\n        title.addEventListener('pointerup', () => {\n            if (isDragging) {\n                isDragging = false\n\n                // Restore cursor\n                title.style.removeProperty(\"cursor\")\n            }\n        })\n    }\n\n    public tryDeleteDrawable(comp: Drawable): InteractionResult {\n        if (comp instanceof ComponentBase) {\n            const ref = comp.ref\n            if (this.editor.editorRoot.testSuites.hasReferenceTo(ref)) {\n                if (!window.confirm(S.Tests.ComponentUsedInTestSuite.expand({ ref }))) {\n                    return InteractionResult.NoChange\n                }\n            }\n            const numDeleted = this.tryDeleteComponentsWhere(c => c === comp, true)\n            return InteractionResult.fromBoolean(numDeleted !== 0)\n        } else if (comp instanceof Wire) {\n            return this.editor.editorRoot.linkMgr.deleteWire(comp)\n        } else if (comp instanceof Waypoint) {\n            comp.removeFromParent()\n            return InteractionResult.SimpleChange\n        }\n        return InteractionResult.NoChange\n    }\n\n    public tryDeleteComponentsWhere(cond: (e: Component) => boolean, onlyOne: boolean) {\n        const numDeleted = this.editor.editorRoot.components.tryDeleteWhere(cond, onlyOne).length\n        if (numDeleted > 0) {\n            this.clearTooltipIfNeeded()\n            this.editor.editTools.redrawMgr.requestRedraw({ why: \"component(s) deleted\", invalidateMask: true, invalidateTests: true })\n        }\n        return numDeleted\n    }\n\n}\n\nabstract class ToolHandlers {\n\n    public readonly editor: LogicEditor\n\n    public constructor(editor: LogicEditor) {\n        this.editor = editor\n    }\n\n    public pointerHoverOn(__comp: Drawable) {\n        // empty\n    }\n    public pointerDownOn(__comp: Drawable, __e: PointerEvent) {\n        return { wantsDragEvents: true }\n    }\n    public pointerDraggedOn(__comp: Drawable, __e: PointerDragEvent) {\n        // empty\n    }\n    public pointerUpOn(__comp: Drawable, __e: PointerEvent): InteractionResult {\n        return InteractionResult.NoChange\n    }\n    public pointerClickedOn(__comp: Drawable, __e: PointerEvent): InteractionResult {\n        return InteractionResult.NoChange\n    }\n    public pointerDoubleClickedOn(__comp: Drawable, __e: PointerEvent): InteractionResult {\n        return InteractionResult.NoChange\n    }\n    public contextMenuOn(__comp: Drawable, __e: MouseEvent): boolean {\n        return false // false means unhandled\n    }\n    public contextMenuOnButton(__props: ButtonDataset, __e: MouseEvent) {\n        // empty\n    }\n    public hideContextMenuIfNeeded(__e?: PointerEvent) {\n        // empty\n    }\n    public pointerDownOnBackground(__e: PointerEvent) {\n        // empty\n    }\n    public pointerDraggedOnBackground(__e: PointerDragEvent) {\n        // empty\n    }\n    public pointerUpOnBackground(__e: PointerEvent) {\n        // empty\n    }\n    public unmount() {\n        // empty\n    }\n}\n\ntype PanningSession = {\n    startX: number,\n    startY: number,\n    initialTranslationX: number,\n    initialTranslationY: number,\n}\n\nclass EditHandlers extends ToolHandlers {\n\n    private _openedContextMenu: HTMLElement | null = null\n    private _currentPanningSession: PanningSession | undefined = undefined\n\n    public constructor(editor: LogicEditor) {\n        super(editor)\n    }\n\n    public override pointerHoverOn(comp: Drawable) {\n        const editor = this.editor\n        editor.eventMgr.clearTooltipIfNeeded()\n        if (editor.options.hideTooltips) {\n            return\n        }\n        // maybe the component is now dead\n        if ((comp instanceof ComponentBase) && comp.state === ComponentState.DEAD) {\n            return\n        }\n        const tooltip = comp.makeTooltip()\n        if (tooltip !== undefined) {\n            const rect = () => {\n                const containerRect = editor.html.canvasContainer.getBoundingClientRect()\n                const f = editor.userDrawingScale\n                const dx = editor.translationX\n                const dy = editor.translationY\n                const [cx, cy, w, h] =\n                    comp instanceof DrawableWithPosition\n                        ? [(comp.posX + dx) * f, (comp.posY + dy) * f, comp.width * f, comp.height * f]\n                        : [editor.pointerX, editor.pointerY, 4, 4]\n                return new DOMRect(containerRect.x + cx - w / 2, containerRect.y + cy - h / 2, w, h)\n            }\n            editor.eventMgr.makeTooltip(tooltip, rect)\n        }\n    }\n    public override pointerDownOn(comp: Drawable, e: PointerEvent) {\n        return comp.pointerDown(e)\n    }\n    public override pointerDraggedOn(comp: Drawable, e: PointerDragEvent) {\n        comp.pointerDragged(e)\n    }\n    public override pointerUpOn(comp: Drawable, e: PointerEvent) {\n        const change = comp.pointerUp(e)\n        this.editor.editorRoot.linkMgr.tryCancelWireOrAnchor()\n        return change\n    }\n    public override pointerClickedOn(comp: Drawable, e: PointerEvent) {\n        // console.log(\"pointerClickedOn %o\", comp)\n        return comp.pointerClicked(e)\n    }\n    public override pointerDoubleClickedOn(comp: Drawable, e: PointerEvent) {\n        return comp.pointerDoubleClicked(e)\n    }\n    public override contextMenuOn(comp: Drawable, e: PointerEvent) {\n        // console.log(\"contextMenuOn: %o\", comp)\n        return this.showContextMenu(comp.makeContextMenu(), e)\n    }\n    public override contextMenuOnButton(props: ButtonDataset, e: PointerEvent) {\n        return this.showContextMenu(this.editor.factory.makeContextMenu(props.type), e)\n    }\n\n    public override pointerDownOnBackground(e: PointerEvent) {\n        const editor = this.editor\n        if (LogicEditor.spaceDown && editor.mode >= Mode.CONNECT) {\n            editor.setToolCursor(\"grabbing\")\n            const [startX, startY] = editor.offsetXY(e, true)\n            this._currentPanningSession = { startX, startY, initialTranslationX: editor.translationX, initialTranslationY: editor.translationY }\n        } else {\n            const eventMgr = editor.eventMgr\n            const currentSelection = eventMgr.currentSelection\n            if (currentSelection !== undefined) {\n                const allowSelection = editor.mode >= Mode.CONNECT\n                if (e.shiftKey && allowSelection) {\n                    if (currentSelection.currentlyDrawnRect !== undefined) {\n                        console.log(\"unexpected defined current rect when about to begin a new one\")\n                    }\n                    // augment selection\n                    const [left, top] = editor.offsetXY(e)\n                    const rect = new DOMRect(left, top, 1, 1)\n                    currentSelection.currentlyDrawnRect = rect\n                } else {\n                    // clear selection\n                    eventMgr.currentSelection = undefined\n                }\n                editor.editTools.redrawMgr.requestRedraw({ why: \"selection rect changed\" })\n            }\n        }\n    }\n    public override pointerDraggedOnBackground(e: PointerDragEvent) {\n        const editor = this.editor\n        if (this._currentPanningSession !== undefined) {\n            const { startX, startY, initialTranslationX, initialTranslationY } = this._currentPanningSession\n            const [x, y] = editor.offsetXY(e, true)\n            const dx = x - startX\n            const dy = y - startY\n            const scaleFactor = editor.userDrawingScale\n            editor.setTranslation(initialTranslationX + dx / scaleFactor, initialTranslationY + dy / scaleFactor)\n        } else {\n            const allowSelection = editor.mode >= Mode.CONNECT\n            if (allowSelection) {\n                const eventMgr = editor.eventMgr\n                const currentSelection = eventMgr.currentSelection\n                const [x, y] = editor.offsetXY(e)\n                if (currentSelection === undefined) {\n                    const rect = new DOMRect(x, y, 1, 1)\n                    eventMgr.currentSelection = new EditorSelection(rect)\n                } else {\n                    const rect = currentSelection.currentlyDrawnRect\n                    if (rect === undefined) {\n                        console.log(\"trying to update a selection rect that is not defined\")\n                    } else {\n                        rect.width = x - rect.x\n                        rect.height = y - rect.y\n                        editor.editTools.redrawMgr.requestRedraw({ why: \"selection rect changed\" })\n                    }\n                }\n            }\n        }\n    }\n\n    public override pointerUpOnBackground(__e: PointerEvent) {\n        const editor = this.editor\n        editor.linkMgr.tryCancelWireOrAnchor()\n\n        const eventMgr = editor.eventMgr\n        const currentSelection = eventMgr.currentSelection\n        if (currentSelection !== undefined) {\n            currentSelection.finishCurrentRect(this.editor)\n            editor.editTools.redrawMgr.requestRedraw({ why: \"selection rect changed\" })\n        }\n        editor.setToolCursor(null)\n        if (this._currentPanningSession !== undefined) {\n            editor.finishAutoZoomTranslationIfActive()\n            this._currentPanningSession = undefined\n        }\n    }\n\n    public override hideContextMenuIfNeeded(e?: PointerEvent) {\n        // if e is passed, only hide if the target is not the context menu\n        if (this._openedContextMenu !== null) {\n            const menuContainsTarget = e !== undefined && this._openedContextMenu.contains(e.composedPath()[0] as Element)\n            if (!menuContainsTarget) {\n                this._openedContextMenu.classList.remove('show-menu')\n                this._openedContextMenu.innerHTML = \"\"\n                this._openedContextMenu = null\n            }\n        }\n    }\n\n    private showContextMenu(menuData: MenuData | undefined, e: PointerEvent) {\n        this.hideContextMenuIfNeeded()\n\n        // console.log(\"asking for menu: %o got: %o\", comp, MenuData)\n        if (menuData === undefined) {\n            return false\n        }\n\n        // console.log(\"setting triggered\")\n        const currentPointerDownData = this.editor.eventMgr.currentPointerDownData\n        if (currentPointerDownData !== null) {\n            currentPointerDownData.triggeredContextMenu = true\n        }\n\n        // console.log(\"building menu for %o\", MenuData)\n\n        let hasContentJustifyingSeparator = false\n\n        const defToElem = (item: MenuItem): Modifier => {\n            function mkButton(spec: { icon?: IconName | undefined, caption: Modifier }, shortcut: string | undefined, danger: boolean) {\n                return button(type(\"button\"), cls(`menu-btn${(danger ? \" danger\" : \"\")}`),\n                    spec.icon === undefined\n                        ? spec.caption\n                        : mods(\n                            makeIcon(spec.icon),\n                            span(cls(\"menu-text\"), spec.caption)\n                        ),\n                    shortcut === undefined ? emptyMod : span(cls(\"menu-shortcut\"), shortcut),\n                )\n            }\n\n            hasContentJustifyingSeparator ||= item._tag !== \"sep\"\n            switch (item._tag) {\n                case \"sep\":\n                    if (hasContentJustifyingSeparator) {\n                        hasContentJustifyingSeparator = false\n                        return li(cls(\"menu-separator\")).render()\n                    } else {\n                        return emptyMod\n                    }\n                case \"text\":\n                    return li(cls(\"menu-item-static\"), item.caption).render()\n                case \"item\": {\n                    const but = mkButton(item, item.shortcut, item.danger ?? false).render()\n                    but.addEventListener(\"click\", this.editor.wrapAsyncHandler(async (itemEvent: MouseEvent) => {\n                        this.hideContextMenuIfNeeded()\n                        const result = await Promise.resolve(item.action(itemEvent, e))\n                        this.editor.editTools.undoMgr.takeSnapshot(result as Exclude<typeof result, void>)\n                        this.editor.focus()\n                    }))\n                    return li(cls(\"menu-item\"), but).render()\n                }\n                case \"submenu\": {\n                    return li(cls(\"menu-item submenu\"),\n                        mkButton(item, undefined, false),\n                        ul(cls(\"menu\"),\n                            ...item.items.map(defToElem)\n                        )\n                    ).render()\n                }\n            }\n        }\n\n        const items = menuData.map(defToElem)\n\n        const mainContextMenu = this.editor.html.mainContextMenu\n        applyModifiersTo(mainContextMenu, items)\n        mainContextMenu.classList.add(\"show-menu\")\n\n        let menuTop = e.pageY\n        mainContextMenu.style.top = menuTop + 'px'\n        mainContextMenu.style.left = e.pageX + 'px'\n\n        let needsScrollY = false\n        const menuRect = mainContextMenu.getBoundingClientRect()\n        const hOverflow = window.innerHeight - menuRect.bottom\n        if (hOverflow < 0) {\n            menuTop += Math.min(0, hOverflow)\n            if (menuTop < 5) {\n                menuTop = 5\n                needsScrollY = true\n            }\n            mainContextMenu.style.top = menuTop + 'px'\n        }\n\n        // TODO this causes some weird behavior with submenus, to be fixed\n        if (needsScrollY) {\n            mainContextMenu.style.setProperty(\"max-height\", (window.innerHeight - 10) + \"px\")\n            mainContextMenu.style.setProperty(\"overflow-y\", \"scroll\")\n        } else {\n            mainContextMenu.style.removeProperty(\"max-height\")\n            mainContextMenu.style.removeProperty(\"overflow-y\")\n        }\n\n        this._openedContextMenu = mainContextMenu\n\n        return true // handled\n    }\n}\n\nclass DeleteHandlers extends ToolHandlers {\n\n    public constructor(editor: LogicEditor) {\n        super(editor)\n    }\n\n    public override pointerClickedOn(comp: Drawable, __: PointerEvent) {\n        return this.editor.eventMgr.tryDeleteDrawable(comp)\n    }\n}\n\n\nclass SetAnchorHandlers extends ToolHandlers {\n\n    private _from: DrawableWithPosition\n\n    public constructor(editor: LogicEditor, from: DrawableWithPosition) {\n        super(editor)\n        this._from = from\n        editor.linkMgr.startSettingAnchorFrom(from)\n    }\n\n    public override unmount() {\n        // e.g. on escape, make sure to cancel the anchor set\n        this.editor.linkMgr.tryCancelSetAnchor()\n    }\n\n    private finish() {\n        // always go back to edit mode after setting an anchor\n        this.editor.setCurrentPointerAction(\"edit\")\n    }\n\n    public override pointerClickedOn(comp: Drawable, __: PointerEvent) {\n        let result: InteractionResult = InteractionResult.NoChange\n        if (comp instanceof ComponentBase) {\n            result = this.editor.linkMgr.trySetAnchor(this._from, comp)\n        } else {\n            this.editor.linkMgr.tryCancelSetAnchor()\n        }\n        this.finish()\n        return result\n    }\n\n    public override pointerUpOnBackground(__: PointerEvent) {\n        this.editor.linkMgr.tryCancelSetAnchor()\n        this.finish()\n    }\n}\n\nclass MoveHandlers extends ToolHandlers {\n\n    public constructor(editor: LogicEditor) {\n        super(editor)\n    }\n\n    public override pointerDownOnBackground(e: PointerEvent) {\n        for (const comp of this.editor.components.all()) {\n            comp.pointerDown(e)\n        }\n        for (const wire of this.editor.linkMgr.wires) {\n            for (const waypoint of wire.waypoints) {\n                waypoint.pointerDown(e)\n            }\n        }\n    }\n    public override pointerDraggedOnBackground(e: PointerDragEvent) {\n        for (const comp of this.editor.components.all()) {\n            comp.pointerDragged(e)\n        }\n        for (const wire of this.editor.linkMgr.wires) {\n            for (const waypoint of wire.waypoints) {\n                waypoint.pointerDragged(e)\n            }\n        }\n    }\n    public override pointerUpOnBackground(e: PointerEvent) {\n        for (const comp of this.editor.components.all()) {\n            comp.pointerUp(e)\n        }\n        for (const wire of this.editor.linkMgr.wires) {\n            for (const waypoint of wire.waypoints) {\n                waypoint.pointerUp(e)\n            }\n        }\n    }\n}\n", "import { LogicEditor } from \"./LogicEditor\"\nimport { PostLoadActions_None, Serialization } from \"./Serialization\"\nimport { S } from \"./strings\"\nimport { InteractionResult, RepeatFunction } from \"./utils\"\n\nconst MAX_UNDO_SNAPSHOTS = 100\n\ntype Snapshot = {\n    time: number\n    circuitStr: string\n    repeatAction?: RepeatFunction\n}\n\nexport type UndoState = {\n    canUndo: boolean\n    canRedoOrRepeat: boolean\n}\n\nfunction areStatesEqual(s1: UndoState, s2: UndoState): boolean {\n    return s1.canUndo === s2.canUndo\n        && s1.canRedoOrRepeat === s2.canRedoOrRepeat\n}\n\n\nexport class UndoManager {\n\n    public readonly editor: LogicEditor\n    private _undoSnapshots: Snapshot[] = []\n    private _redoSnapshots: Snapshot[] = []\n\n    // remember last sent state to avoid fake events\n    private _lastSentState: UndoState | undefined\n    // public callback function\n    public onStateChanged: (state: UndoState) => unknown = __ => null\n\n    public constructor(editor: LogicEditor) {\n        this.editor = editor\n    }\n\n    public get state(): UndoState {\n        return {\n            canUndo: this.canUndo(),\n            canRedoOrRepeat: this.canRedoOrRepeat(),\n        }\n    }\n\n    public canUndo() {\n        return this._undoSnapshots.length > 1 // the first snapshot is the initial state which cannot be undone\n    }\n\n    public canRedoOrRepeat() {\n        return this._redoSnapshots.length > 0 ||\n            (this._undoSnapshots.length > 0 &&\n                this._undoSnapshots[this._undoSnapshots.length - 1].repeatAction !== undefined)\n    }\n\n    public takeSnapshot(interactionResult?: InteractionResult, skipStorage?: boolean) {\n        const isChange = interactionResult?.isChange ?? true\n        if (!isChange) {\n            return\n        }\n\n        const repeatAction = interactionResult === undefined ? undefined\n            : interactionResult._tag === \"RepeatableChange\" ? interactionResult.repeat : undefined\n        this.doTakeSnapshot(repeatAction, skipStorage)\n    }\n\n    private doTakeSnapshot(repeatAction?: RepeatFunction, skipStorage?: boolean) {\n        const now = Date.now()\n        const doStorage = !(skipStorage ?? false)\n        // const nowStr = new Date(now).toISOString()\n        // console.log(\"Taking snapshot at \" + nowStr + \" (repeatAction=\" + repeatAction + \", skipStorage=\" + skipStorage + \", doStorage=\" + doStorage + \")\")\n\n        const circuit = this.editor.save()\n        const jsonStr = Serialization.stringifyObject(circuit, true)\n        if (doStorage) {\n            this.editor.trySaveInBrowserStorage(circuit)\n        }\n        this._undoSnapshots.push({ time: now, circuitStr: jsonStr, repeatAction })\n        while (this._undoSnapshots.length > MAX_UNDO_SNAPSHOTS) {\n            this._undoSnapshots.shift()\n        }\n        if (this._redoSnapshots.length > 0) {\n            this._redoSnapshots = []\n        }\n        // this.dump()\n        this.fireStateChangedIfNeeded()\n    }\n\n    public undo() {\n        if (!this.canUndo()) {\n            this.editor.showMessage(S.Messages.NothingToUndo)\n            return\n        }\n        const stateNow = this._undoSnapshots.pop()!\n        const prevState = this._undoSnapshots[this._undoSnapshots.length - 1]\n        this._redoSnapshots.push(stateNow)\n        this.loadSnapshot(prevState)\n        this.editor.trySaveInBrowserStorage(Serialization.buildCircuitObject(this.editor))\n        this.editor.showMessage(S.Messages.DidUndo)\n        // this.dump()\n        this.fireStateChangedIfNeeded()\n    }\n\n    public redoOrRepeat() {\n        if (!this.canRedoOrRepeat()) {\n            this.editor.showMessage(S.Messages.NothingToRedo)\n            return\n        }\n        const snapshot = this._redoSnapshots.pop()\n        if (snapshot !== undefined) {\n            this._undoSnapshots.push(snapshot)\n            this.loadSnapshot(snapshot)\n            this.editor.trySaveInBrowserStorage(Serialization.buildCircuitObject(this.editor))\n            this.editor.showMessage(S.Messages.DidRedo)\n        } else {\n            const repeatAction = this._undoSnapshots[this._undoSnapshots.length - 1].repeatAction\n            if (repeatAction !== undefined) {\n                const result = repeatAction()\n                const newRepeatAction = result === false ? undefined : result === true ? repeatAction : result\n                this.doTakeSnapshot(newRepeatAction)\n                this.editor.showMessage(S.Messages.DidRepeat)\n            }\n        }\n        // this.dump()\n        this.fireStateChangedIfNeeded()\n    }\n\n    public dump() {\n        function printStack(name: string, stack: Snapshot[]) {\n            const title = name + (stack.length === 0 ? \" (empty)\" : \"\")\n            console.group(title)\n            for (let i = stack.length - 1; i >= 0; i--) {\n                const snapshot = stack[i]\n                const timeStr = new Date(snapshot.time).toISOString()\n                console.log(timeStr + \"\\t\" + snapshot.circuitStr)\n            }\n            console.groupEnd()\n        }\n        printStack(\"Undo stack\", this._undoSnapshots)\n        printStack(\"Redo stack\", this._redoSnapshots)\n    }\n\n    private loadSnapshot(snapshot: Snapshot) {\n        Serialization.loadCircuitOrLibrary(this.editor, snapshot.circuitStr, PostLoadActions_None)\n    }\n\n    private fireStateChangedIfNeeded() {\n        const newState = this.state\n        if (this._lastSentState === undefined || !areStatesEqual(this._lastSentState, newState)) {\n            // console.log(\"UndoManager state changed: \", newState)\n            this.onStateChanged(newState)\n            this._lastSentState = newState\n        }\n    }\n\n}", "export const gallery = {\n    CharacterComparator: {\n        \"v\": 5,\n        \"in\": [\n            { \"pos\": [50, 130], \"id\": 0, \"val\": 1 },\n            { \"pos\": [50, 160], \"id\": 1, \"val\": 1 },\n            { \"pos\": [50, 190], \"id\": 2, \"val\": 1 },\n            { \"pos\": [50, 220], \"id\": 3, \"val\": 0 },\n            { \"pos\": [50, 250], \"id\": 4, \"val\": 1 },\n            { \"pos\": [50, 280], \"id\": 13, \"val\": 0 },\n            { \"pos\": [50, 310], \"id\": 14, \"val\": 1 },\n            { \"pos\": [50, 360], \"id\": 15, \"val\": 1 },\n            { \"pos\": [50, 390], \"id\": 16, \"val\": 0 },\n            { \"pos\": [50, 420], \"id\": 17, \"val\": 1 },\n            { \"pos\": [50, 450], \"id\": 18, \"val\": 0 },\n            { \"pos\": [50, 480], \"id\": 19, \"val\": 1 },\n            { \"pos\": [50, 510], \"id\": 20, \"val\": 0 },\n            { \"pos\": [50, 540], \"id\": 21, \"val\": 1 },\n        ],\n        \"out\": [\n            { \"pos\": [870, 310], \"id\": 5 },\n            { \"type\": \"ascii\", \"pos\": [180, 60], \"id\": [6, 7, 8, 9, 10, 11, 12] },\n            { \"type\": \"ascii\", \"pos\": [180, 620], \"id\": [22, 23, 24, 25, 26, 27, 28] },\n        ],\n        \"gates\": [\n            { \"type\": \"XOR\", \"pos\": [360, 140], \"in\": [29, 30], \"out\": 31 },\n            { \"type\": \"XOR\", \"pos\": [360, 200], \"in\": [32, 33], \"out\": 34 },\n            { \"type\": \"XOR\", \"pos\": [360, 260], \"in\": [35, 36], \"out\": 37 },\n            { \"type\": \"XOR\", \"pos\": [360, 320], \"in\": [38, 39], \"out\": 40 },\n            { \"type\": \"XOR\", \"pos\": [360, 380], \"in\": [41, 42], \"out\": 43 },\n            { \"type\": \"XOR\", \"pos\": [360, 440], \"in\": [44, 45], \"out\": 46 },\n            { \"type\": \"XOR\", \"pos\": [360, 500], \"in\": [47, 48], \"out\": 49 },\n            { \"type\": \"OR\", \"pos\": [470, 170], \"in\": [68, 69], \"out\": 70 },\n            { \"type\": \"OR\", \"pos\": [500, 280], \"in\": [71, 72], \"out\": 73 },\n            { \"type\": \"OR\", \"pos\": [490, 410], \"in\": [74, 75], \"out\": 76 },\n            { \"type\": \"OR\", \"pos\": [630, 250], \"in\": [77, 78], \"out\": 79 },\n            { \"type\": \"OR\", \"pos\": [630, 410], \"in\": [80, 81], \"out\": 82 },\n            { \"type\": \"OR\", \"pos\": [730, 310], \"in\": [83, 84], \"out\": 85 },\n            { \"type\": \"NOT\", \"pos\": [800, 310], \"in\": 50, \"out\": 51 },\n        ],\n        \"wires\": [\n            [0, 6],\n            [1, 7],\n            [2, 8],\n            [3, 9],\n            [4, 10],\n            [13, 11],\n            [14, 12],\n            [15, 22],\n            [16, 23],\n            [17, 24],\n            [18, 25],\n            [19, 26],\n            [20, 27],\n            [21, 28],\n            [0, 29],\n            [15, 30],\n            [79, 83],\n            [82, 84],\n            [31, 68],\n            [34, 69],\n            [37, 71],\n            [40, 72],\n            [43, 74],\n            [46, 75],\n            [49, 81],\n            [76, 80],\n            [73, 78],\n            [70, 77],\n            [85, 50],\n            [51, 5],\n            [1, 32],\n            [16, 33],\n            [2, 35],\n            [17, 36],\n            [18, 39],\n            [3, 38],\n            [4, 41],\n            [19, 42],\n            [13, 44],\n            [20, 45],\n            [21, 48],\n            [14, 47],\n        ],\n    },\n    Counters: {\n        \"v\": 5,\n        \"in\": [\n            { \"type\": \"clock\", \"pos\": [70, 40], \"id\": 0, \"name\": \"bit 0\", \"period\": 2000, \"phase\": 1000, \"showLabel\": false },\n            { \"type\": \"clock\", \"pos\": [70, 80], \"id\": 10, \"name\": \"bit 1\", \"period\": 4000, \"phase\": 2000, \"showLabel\": false },\n            { \"type\": \"clock\", \"pos\": [70, 120], \"id\": 23, \"name\": \"bit 2\", \"period\": 8000, \"phase\": 4000, \"showLabel\": false },\n            { \"type\": \"clock\", \"pos\": [70, 160], \"id\": 24, \"name\": \"bit 3\", \"period\": 16000, \"phase\": 8000, \"showLabel\": false },\n            { \"type\": \"clock\", \"pos\": [430, 30], \"id\": 5, \"period\": 500, \"phase\": 250, \"showLabel\": false },\n            { \"type\": \"clock\", \"pos\": [430, 70], \"id\": 6, \"period\": 1000, \"phase\": 500, \"showLabel\": false },\n            { \"type\": \"clock\", \"pos\": [430, 110], \"id\": 7, \"period\": 2000, \"phase\": 1000, \"showLabel\": false },\n            { \"type\": \"clock\", \"pos\": [430, 150], \"id\": 8, \"period\": 4000, \"phase\": 2000, \"showLabel\": false },\n            { \"type\": \"clock\", \"pos\": [430, 190], \"id\": 9, \"period\": 8000, \"phase\": 4000, \"showLabel\": false },\n            { \"type\": \"clock\", \"pos\": [430, 230], \"id\": 11, \"period\": 16000, \"phase\": 8000, \"showLabel\": false },\n            { \"type\": \"clock\", \"pos\": [430, 270], \"id\": 12, \"period\": 32000, \"phase\": 16000, \"showLabel\": false },\n        ],\n        \"out\": [\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [240, 90], \"id\": [1, 2, 3, 4] },\n            { \"type\": \"ascii\", \"pos\": [580, 150], \"id\": [13, 14, 15, 16, 17, 18, 19] },\n        ],\n        \"wires\": [\n            [0, 1], [24, 4], [23, 3], [10, 2], [5, 13],\n            [6, 14], [7, 15], [8, 16], [9, 17], [11, 18], [12, 19],\n        ],\n    },\n    AllGates: {\n        \"v\": 5,\n        \"in\": [\n            { \"pos\": [40, 320], \"id\": 0, \"val\": 0 },\n            { \"pos\": [40, 490], \"id\": 1, \"val\": 0 },\n        ],\n        \"out\": [\n            { \"pos\": [400, 30], \"id\": 48 },\n            { \"pos\": [400, 80], \"id\": 49 },\n            { \"pos\": [400, 140], \"id\": 50 },\n            { \"pos\": [400, 260], \"id\": 51 },\n            { \"pos\": [400, 380], \"id\": 52 },\n            { \"pos\": [400, 200], \"id\": 53 },\n            { \"pos\": [400, 320], \"id\": 54 },\n            { \"pos\": [400, 440], \"id\": 55 },\n            { \"pos\": [400, 560], \"id\": 56 },\n            { \"pos\": [400, 680], \"id\": 57 },\n            { \"pos\": [400, 500], \"id\": 58 },\n            { \"pos\": [400, 620], \"id\": 59 },\n            { \"pos\": [400, 740], \"id\": 60 },\n            { \"pos\": [400, 860], \"id\": 61 },\n            { \"pos\": [400, 800], \"id\": 62 },\n            { \"pos\": [400, 920], \"id\": 63 },\n        ],\n        \"gates\": [\n            { \"type\": \"NOT\", \"pos\": [290, 80], \"in\": 2, \"out\": 3 },\n            { \"type\": \"BUF\", \"pos\": [290, 30], \"in\": 4, \"out\": 5 },\n            { \"type\": \"AND\", \"pos\": [290, 140], \"in\": [6, 7], \"out\": 8 },\n            { \"type\": \"OR\", \"pos\": [290, 260], \"in\": [9, 10], \"out\": 11 },\n            { \"type\": \"XOR\", \"pos\": [290, 380], \"in\": [12, 13], \"out\": 14 },\n            { \"type\": \"NAND\", \"pos\": [290, 200], \"in\": [15, 16], \"out\": 17 },\n            { \"type\": \"NOR\", \"pos\": [290, 320], \"in\": [18, 19], \"out\": 20 },\n            { \"type\": \"XNOR\", \"pos\": [290, 440], \"in\": [21, 22], \"out\": 23 },\n            { \"type\": \"IMPLY\", \"pos\": [290, 560], \"in\": [24, 25], \"out\": 26 },\n            { \"type\": \"RIMPLY\", \"pos\": [290, 680], \"in\": [27, 28], \"out\": 29 },\n            { \"type\": \"NIMPLY\", \"pos\": [290, 500], \"in\": [30, 31], \"out\": 32 },\n            { \"type\": \"RNIMPLY\", \"pos\": [290, 620], \"in\": [33, 34], \"out\": 35 },\n            { \"type\": \"TXA\", \"pos\": [290, 740], \"in\": [36, 37], \"out\": 38 },\n            { \"type\": \"TXB\", \"pos\": [290, 860], \"in\": [39, 40], \"out\": 41 },\n            { \"type\": \"TXNA\", \"pos\": [290, 800], \"in\": [42, 43], \"out\": 44 },\n            { \"type\": \"TXNB\", \"pos\": [290, 920], \"in\": [45, 46], \"out\": 47 },\n        ],\n        \"wires\": [\n            [0, 4],\n            [0, 2],\n            [0, 6],\n            [0, 9],\n            [0, 12],\n            [0, 15],\n            [0, 18],\n            [0, 21],\n            [0, 24],\n            [0, 27],\n            [0, 30],\n            [0, 33],\n            [0, 36],\n            [0, 39],\n            [0, 42],\n            [0, 45],\n            [1, 7],\n            [1, 10],\n            [1, 13],\n            [1, 16],\n            [1, 19],\n            [1, 22],\n            [1, 25],\n            [1, 28],\n            [1, 31],\n            [1, 34],\n            [1, 37],\n            [1, 40],\n            [1, 43],\n            [1, 46],\n            [5, 48],\n            [3, 49],\n            [8, 50],\n            [11, 51],\n            [14, 52],\n            [17, 53],\n            [20, 54],\n            [23, 55],\n            [26, 56],\n            [29, 57],\n            [32, 58],\n            [35, 59],\n            [38, 60],\n            [41, 61],\n            [44, 62],\n            [47, 63],\n        ],\n    },\n    SevenSegmentDisplay: {\n        \"v\": 5,\n        \"opts\": {\n            \"propagationDelay\": 20,\n        },\n        \"in\": [\n            { type: \"clock\", \"pos\": [90, 60], \"orient\": \"s\", \"id\": 21, \"period\": 16000, \"phase\": 8000 },\n            { type: \"clock\", \"pos\": [130, 60], \"orient\": \"s\", \"id\": 22, \"period\": 8000, \"phase\": 4000 },\n            { type: \"clock\", \"pos\": [170, 60], \"orient\": \"s\", \"id\": 23, \"period\": 4000, \"phase\": 2000 },\n            { type: \"clock\", \"pos\": [210, 60], \"orient\": \"s\", \"id\": 24, \"period\": 2000, \"phase\": 1000 },\n        ],\n        \"out\": [\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [1320, 140], \"id\": [132, 133, 134, 135], \"radix\": 16 },\n            { \"type\": \"bar\", \"pos\": [1330, 310], \"id\": 117, \"display\": \"h\" },\n            { \"type\": \"bar\", \"pos\": [1270, 490], \"id\": 118, \"display\": \"v\" },\n            { \"type\": \"bar\", \"pos\": [1390, 370], \"id\": 119, \"display\": \"v\" },\n            { \"type\": \"bar\", \"pos\": [1270, 370], \"id\": 120, \"display\": \"v\" },\n            { \"type\": \"bar\", \"pos\": [1330, 430], \"id\": 121, \"display\": \"h\" },\n            { \"type\": \"bar\", \"pos\": [1390, 490], \"id\": 122, \"display\": \"v\" },\n            { \"type\": \"bar\", \"pos\": [1330, 550], \"id\": 123, \"display\": \"h\" },\n        ],\n        \"gates\": [\n            { \"type\": \"NOT\", \"pos\": [1170, 310], \"in\": 103, \"out\": 104 },\n            { \"type\": \"NOT\", \"pos\": [1170, 350], \"in\": 105, \"out\": 106 },\n            { \"type\": \"NOT\", \"pos\": [1170, 390], \"in\": 107, \"out\": 108 },\n            { \"type\": \"NOT\", \"pos\": [1170, 430], \"in\": 109, \"out\": 110 },\n            { \"type\": \"NOT\", \"pos\": [1170, 550], \"in\": 111, \"out\": 112 },\n            { \"type\": \"NOT\", \"pos\": [1170, 510], \"in\": 113, \"out\": 114 },\n            { \"type\": \"NOT\", \"pos\": [1170, 470], \"in\": 115, \"out\": 116 },\n            { \"type\": \"XOR\", \"pos\": [210, 180], \"in\": [0, 1], \"out\": 2 },\n            { \"type\": \"AND\", \"pos\": [220, 340], \"in\": [3, 4], \"out\": 5 },\n            { \"type\": \"XOR\", \"pos\": [200, 420], \"in\": [6, 7], \"out\": 8 },\n            { \"type\": \"XOR\", \"pos\": [330, 220], \"in\": [9, 10], \"out\": 11 },\n            { \"type\": \"XOR\", \"pos\": [340, 280], \"in\": [12, 13], \"out\": 14 },\n            { \"type\": \"OR\", \"pos\": [320, 480], \"in\": [15, 16], \"out\": 17 },\n            { \"type\": \"NOR\", \"pos\": [440, 220], \"in\": [18, 19], \"out\": 20 },\n            { \"type\": \"XOR\", \"pos\": [450, 290], \"in\": [25, 26], \"out\": 27 },\n            { \"type\": \"NOR\", \"pos\": [430, 450], \"in\": [31, 32], \"out\": 33 },\n            { \"type\": \"NOR\", \"pos\": [560, 410], \"in\": [34, 35], \"out\": 36 },\n            { \"type\": \"NOR\", \"pos\": [600, 190], \"in\": [37, 38], \"out\": 39 },\n            { \"type\": \"NOR\", \"pos\": [540, 360], \"in\": [40, 41], \"out\": 42 },\n            { \"type\": \"XOR\", \"pos\": [650, 320], \"in\": [43, 44], \"out\": 45 },\n            { \"type\": \"OR\", \"pos\": [670, 430], \"in\": [46, 47], \"out\": 48 },\n            { \"type\": \"XOR\", \"pos\": [770, 490], \"in\": [49, 50], \"out\": 51 },\n            { \"type\": \"NOR\", \"pos\": [770, 540], \"in\": [52, 53], \"out\": 54 },\n            { \"type\": \"NOR\", \"pos\": [800, 390], \"in\": [55, 56], \"out\": 57 },\n            { \"type\": \"OR\", \"pos\": [960, 250], \"in\": [58, 59], \"out\": 60 },\n            { \"type\": \"NOR\", \"pos\": [940, 310], \"in\": [61, 62], \"out\": 63 },\n            { \"type\": \"AND\", \"pos\": [1050, 270], \"in\": [64, 65], \"out\": 66 },\n            { \"type\": \"AND\", \"pos\": [950, 380], \"in\": [67, 68], \"out\": 69 },\n            { \"type\": \"AND\", \"pos\": [950, 440], \"in\": [70, 71], \"out\": 72 },\n            { \"type\": \"OR\", \"pos\": [1030, 410], \"in\": [73, 74], \"out\": 75 },\n            { \"type\": \"XOR\", \"pos\": [1030, 520], \"in\": [76, 77], \"out\": 78 },\n        ],\n        \"wires\": [\n            [104, 117],\n            [106, 119],\n            [108, 122],\n            [110, 123],\n            [112, 121],\n            [114, 120],\n            [116, 118],\n            [21, 135],\n            [22, 134],\n            [23, 133],\n            [24, 132],\n            [21, 0],\n            [23, 1],\n            [24, 3],\n            [22, 4],\n            [24, 6],\n            [21, 7],\n            [2, 9],\n            [22, 10],\n            [23, 12],\n            [5, 13],\n            [5, 15],\n            [8, 16],\n            [11, 18],\n            [14, 19],\n            [11, 25],\n            [8, 26],\n            [5, 32],\n            [14, 31],\n            [33, 34],\n            [21, 35],\n            [20, 37],\n            [2, 38],\n            [27, 40],\n            [8, 41],\n            [42, 43],\n            [21, 44],\n            [39, 46],\n            [17, 47],\n            [48, 49],\n            [21, 50],\n            [48, 52],\n            [33, 53],\n            [36, 56],\n            [45, 55],\n            [57, 103],\n            [39, 58],\n            [24, 59],\n            [60, 64],\n            [27, 65],\n            [66, 109],\n            [39, 61],\n            [45, 62],\n            [63, 113],\n            [69, 73],\n            [72, 74],\n            [75, 105],\n            [39, 67],\n            [24, 68],\n            [45, 70],\n            [22, 71],\n            [51, 115],\n            [20, 111],\n            [78, 107],\n            [72, 76],\n            [54, 77],\n        ],\n    },\n    SevenSegmentBCDDisplay: {\n        \"v\": 5,\n        \"in\": [\n            { \"bits\": 4, \"pos\": [50, 80], \"id\": [0, 1, 2, 3], \"val\": [0, 1, 0, 1] },\n        ],\n        \"out\": [\n            { \"type\": \"bar\", \"pos\": [560, 100], \"id\": 4, \"display\": \"h\" },\n            { \"type\": \"bar\", \"pos\": [620, 280], \"id\": 5, \"display\": \"v\" },\n            { \"type\": \"bar\", \"pos\": [500, 160], \"id\": 6, \"display\": \"v\" },\n            { \"type\": \"bar\", \"pos\": [560, 220], \"id\": 7, \"display\": \"h\" },\n            { \"type\": \"bar\", \"pos\": [560, 340], \"id\": 8, \"display\": \"h\" },\n            { \"type\": \"bar\", \"pos\": [500, 280], \"id\": 9, \"display\": \"v\" },\n            { \"type\": \"bar\", \"pos\": [620, 160], \"id\": 10, \"display\": \"v\" },\n            { \"type\": \"bar\", \"pos\": [420, 160], \"id\": 50, \"display\": \"v\" },\n            { \"type\": \"bar\", \"pos\": [420, 280], \"id\": 51, \"display\": \"v\" },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [170, 250], \"id\": [11, 23, 24, 25] },\n        ],\n        \"ic\": [\n            { \"type\": \"decoder-7seg\", \"pos\": [280, 60], \"in\": [12, 13, 14, 15], \"out\": [16, 17, 18, 19, 20, 21, 22] },\n            { \"type\": \"decoder-bcd4\", \"pos\": [180, 80], \"in\": [26, 27, 28, 29], \"out\": [30, 31, 32, 33, 34] },\n        ],\n        \"wires\": [\n            [16, 4], [17, 10], [18, 5], [19, 8], [20, 9], [21, 6], [22, 7], [0, 11],\n            [1, 23], [2, 24], [3, 25], [0, 26], [1, 27], [2, 28], [3, 29], [30, 12],\n            [31, 13], [32, 14], [33, 15], [34, 50], [34, 51],\n        ],\n    },\n    SixteenVsSevenSegmentDisplays: {\n        \"v\": 5,\n        \"in\": [\n            { \"bits\": 4, \"pos\": [50, 90], \"id\": [74, 75, 76, 77], \"val\": [1, 0, 0, 1] },\n            { \"bits\": 4, \"pos\": [50, 170], \"id\": [78, 79, 80, 81], \"val\": [1, 1, 0, 0] },\n        ],\n        \"out\": [\n            { \"type\": \"16seg\", \"pos\": [440, 170], \"id\": [57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73] },\n            { \"type\": \"ascii\", \"pos\": [230, 60], \"id\": [82, 83, 84, 85, 86, 87, 88], \"additionalReprRadix\": 10 },\n            { \"type\": \"7seg\", \"pos\": [440, 330], \"id\": [93, 94, 95, 96, 97, 98, 99, 100] },\n        ],\n        \"gates\": [{ \"type\": \"OR\", \"pos\": [330, 250], \"in\": [90, 91], \"out\": 92 }],\n        \"ic\": [\n            { \"type\": \"decoder-16seg\", \"pos\": [230, 170], \"in\": [34, 35, 36, 37, 38, 39, 40], \"out\": [41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 89] },\n            { \"type\": \"decoder-7seg\", \"pos\": [230, 320], \"in\": [101, 102, 103, 104], \"out\": [105, 106, 107, 108, 109, 110, 111] },\n        ],\n        \"wires\": [\n            [74, 82], [75, 83], [76, 84], [77, 85], [78, 86], [79, 87], [80, 88], [41, 57], [42, 58],\n            [43, 59], [44, 60], [45, 61], [46, 62], [47, 63], [48, 64], [49, 65], [50, 66], [51, 67],\n            [52, 68], [53, 69], [54, 70], [55, 71], [56, 72], [74, 34], [75, 35], [76, 36], [77, 37],\n            [78, 38], [79, 39], [80, 40], [89, 90], [92, 73], [81, 91], [105, 93], [106, 94], [107, 95],\n            [108, 96], [109, 97], [110, 98], [111, 99], [74, 101], [75, 102], [76, 103], [77, 104],\n            [81, 100, { \"via\": [[200, 370]] }],\n        ],\n    },\n    NibbleAdder: {\n        \"v\": 5,\n        \"in\": [\n            { \"pos\": [100, 40], \"orient\": \"s\", \"id\": 3, \"name\": \"A3\", \"val\": 0 },\n            { \"pos\": [200, 40], \"orient\": \"s\", \"id\": 0, \"name\": \"A2\", \"val\": 0 },\n            { \"pos\": [300, 40], \"orient\": \"s\", \"id\": 1, \"name\": \"A1\", \"val\": 0 },\n            { \"pos\": [400, 40], \"orient\": \"s\", \"id\": 2, \"name\": \"A0\", \"val\": 0 },\n            { \"pos\": [140, 180], \"orient\": \"s\", \"id\": 15, \"name\": \"B3\", \"val\": 0 },\n            { \"pos\": [240, 180], \"orient\": \"s\", \"id\": 14, \"name\": \"B2\", \"val\": 0 },\n            { \"pos\": [340, 180], \"orient\": \"s\", \"id\": 13, \"name\": \"B1\", \"val\": 0 },\n            { \"pos\": [440, 180], \"orient\": \"s\", \"id\": 12, \"name\": \"B0\", \"val\": 0 },\n        ],\n        \"out\": [\n            { \"pos\": [30, 450], \"orient\": \"s\", \"id\": 37, \"name\": \"S4\" },\n            { \"pos\": [120, 450], \"orient\": \"s\", \"id\": 36, \"name\": \"S3\" },\n            { \"pos\": [220, 450], \"orient\": \"s\", \"id\": 38, \"name\": \"S2\" },\n            { \"pos\": [320, 450], \"orient\": \"s\", \"id\": 39, \"name\": \"S1\" },\n            { \"pos\": [420, 450], \"orient\": \"s\", \"id\": 40, \"name\": \"S0\" },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [530, 100], \"id\": [4, 5, 6, 7] },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [530, 240], \"id\": [8, 9, 10, 11] },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [530, 390], \"id\": [41, 42, 43, 44] },\n        ],\n        \"ic\": [\n            { \"type\": \"adder\", \"pos\": [420, 320], \"in\": [16, 17, 18], \"out\": [19, 20] },\n            { \"type\": \"adder\", \"pos\": [320, 320], \"in\": [21, 22, 23], \"out\": [24, 25] },\n            { \"type\": \"adder\", \"pos\": [220, 320], \"in\": [26, 27, 28], \"out\": [29, 30] },\n            { \"type\": \"adder\", \"pos\": [120, 320], \"in\": [31, 32, 33], \"out\": [34, 35] },\n        ],\n        \"wires\": [\n            [12, 8],\n            [13, 9],\n            [14, 10],\n            [15, 11],\n            [2, 4],\n            [1, 5],\n            [0, 6],\n            [3, 7],\n            [20, 23],\n            [25, 28],\n            [30, 33],\n            [2, 16],\n            [12, 17],\n            [1, 21],\n            [13, 22],\n            [0, 26],\n            [14, 27],\n            [3, 31],\n            [15, 32],\n            [19, 41],\n            [24, 42],\n            [29, 43],\n            [34, 44],\n            [35, 37],\n            [34, 36],\n            [29, 38],\n            [24, 39],\n            [19, 40],\n        ],\n    },\n    ALU: {\n        \"v\": 5,\n        \"in\": [\n            { \"pos\": [290, 60], \"orient\": \"s\", \"id\": 16, \"name\": \"Op1\", \"val\": 0 },\n            { \"pos\": [330, 60], \"orient\": \"s\", \"id\": 17, \"name\": \"Op0\", \"val\": 0 },\n            { \"pos\": [50, 140], \"id\": 18, \"val\": 0 },\n            { \"pos\": [50, 160], \"id\": 19, \"name\": \"A\", \"val\": 0 },\n            { \"pos\": [50, 180], \"id\": 20, \"val\": 0 },\n            { \"pos\": [50, 200], \"id\": 21, \"val\": 0 },\n            { \"pos\": [50, 240], \"id\": 26, \"val\": 0 },\n            { \"pos\": [50, 260], \"id\": 27, \"name\": \"B\", \"val\": 0 },\n            { \"pos\": [50, 280], \"id\": 28, \"val\": 0 },\n            { \"pos\": [50, 300], \"id\": 29, \"val\": 0 },\n        ],\n        \"out\": [\n            { \"pos\": [420, 320], \"id\": 38, \"name\": \"Zero\" },\n            { \"pos\": [420, 350], \"id\": 39, \"name\": \"oVerflow\" },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [110, 60], \"orient\": \"n\", \"id\": [22, 23, 24, 25], \"name\": \"A (non sign\u00E9)\" },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [110, 350], \"orient\": \"s\", \"id\": [30, 31, 32, 33], \"name\": \"B (non sign\u00E9)\" },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [420, 250], \"id\": [34, 35, 36, 37], \"name\": \"Y (sign\u00E9)\", \"radix\": -10 },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [420, 150], \"id\": [40, 41, 42, 43], \"name\": \"Y (non sign\u00E9)\" },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [210, 60], \"orient\": \"n\", \"id\": [44, 45, 46, 47], \"name\": \"A (sign\u00E9)\", \"radix\": -10 },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [210, 350], \"orient\": \"s\", \"id\": [48, 49, 50, 51], \"name\": \"B (sign\u00E9)\", \"radix\": -10 },\n        ],\n        \"ic\": [\n            { \"type\": \"alu\", \"pos\": [280, 220], \"in\": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], \"out\": [10, 11, 12, 13, 14, 15] },\n        ],\n        \"wires\": [\n            [16, 9],\n            [17, 8],\n            [21, 3],\n            [20, 2],\n            [19, 1],\n            [18, 0],\n            [18, 22],\n            [19, 23],\n            [20, 24],\n            [21, 25],\n            [26, 4],\n            [27, 5],\n            [28, 6],\n            [29, 7],\n            [26, 30],\n            [27, 31],\n            [28, 32],\n            [29, 33],\n            [10, 34],\n            [11, 35],\n            [12, 36],\n            [13, 37],\n            [15, 38],\n            [14, 39],\n            [10, 40],\n            [11, 41],\n            [12, 42],\n            [13, 43],\n            [18, 44],\n            [19, 45],\n            [20, 46],\n            [21, 47],\n            [26, 48],\n            [27, 49],\n            [28, 50],\n            [29, 51],\n        ],\n    },\n\n    MiniAlu: {\n        \"v\": 5,\n        \"in\": [\n            { \"pos\": [340, 40], \"orient\": \"s\", \"id\": 10, \"val\": 1 },\n            { \"pos\": [470, 40], \"orient\": \"s\", \"id\": 11, \"val\": 1 },\n            { \"pos\": [370, 180], \"orient\": \"s\", \"id\": 12, \"val\": 0 },\n            { \"pos\": [500, 180], \"orient\": \"s\", \"id\": 13, \"val\": 1 },\n            { \"pos\": [80, 40], \"orient\": \"s\", \"id\": 26, \"val\": 0 },\n            { \"pos\": [210, 40], \"orient\": \"s\", \"id\": 27, \"val\": 0 },\n            { \"pos\": [110, 180], \"orient\": \"s\", \"id\": 28, \"val\": 0 },\n            { \"pos\": [240, 180], \"orient\": \"s\", \"id\": 34, \"val\": 0 },\n            { \"pos\": [600, 370], \"orient\": \"w\", \"id\": 98, \"name\": \"Add/Sub\", \"val\": 0 },\n        ],\n        \"out\": [\n            { \"pos\": [600, 690], \"id\": 49, \"name\": \"V\" },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [600, 120], \"id\": [18, 19, 20, 21], \"name\": \"A\" },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [600, 260], \"id\": [22, 23, 24, 25], \"name\": \"B\" },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [600, 620], \"id\": [45, 46, 47, 48], \"name\": \"S\" },\n        ],\n        \"gates\": [\n            { \"type\": \"XOR\", \"pos\": [120, 450], \"orient\": \"s\", \"in\": [86, 87], \"out\": 88 },\n            { \"type\": \"XOR\", \"pos\": [250, 450], \"orient\": \"s\", \"in\": [89, 90], \"out\": 91 },\n            { \"type\": \"XOR\", \"pos\": [380, 450], \"orient\": \"s\", \"in\": [92, 93], \"out\": 94 },\n            { \"type\": \"XOR\", \"pos\": [510, 450], \"orient\": \"s\", \"in\": [95, 96], \"out\": 97 },\n        ],\n        \"ic\": [\n            { \"type\": \"adder\", \"pos\": [490, 530], \"in\": [0, 1, 2], \"out\": [3, 4] },\n            { \"type\": \"adder\", \"pos\": [360, 530], \"in\": [5, 6, 7], \"out\": [8, 9] },\n            { \"type\": \"adder\", \"pos\": [230, 530], \"in\": [35, 36, 37], \"out\": [38, 39] },\n            { \"type\": \"adder\", \"pos\": [100, 530], \"in\": [40, 41, 42], \"out\": [43, 44] },\n        ],\n        \"wires\": [\n            [4, 7],\n            [11, 0],\n            [10, 5],\n            [11, 18],\n            [10, 19],\n            [13, 22],\n            [12, 23],\n            [9, 37],\n            [39, 42],\n            [3, 45],\n            [8, 46],\n            [38, 47],\n            [43, 48],\n            [44, 49, { \"via\": [[50, 690]] }],\n            [27, 35],\n            [26, 40],\n            [28, 87],\n            [34, 90],\n            [34, 24],\n            [28, 25],\n            [27, 20],\n            [26, 21],\n            [12, 93],\n            [13, 96],\n            [97, 1],\n            [94, 6],\n            [91, 36],\n            [88, 41],\n            [98, 2],\n            [98, 95],\n            [98, 92],\n            [98, 89],\n            [98, 86],\n        ],\n    },\n\n    LatchedAdder: {\n        \"v\": 5,\n        \"in\": [\n            { \"pos\": [340, 570], \"orient\": \"n\", \"id\": 40, \"name\": \"Reset\", \"val\": 0, \"isPushButton\": true },\n            { \"pos\": [40, 220], \"id\": 41, \"val\": 0 },\n            { \"pos\": [40, 250], \"id\": 42, \"val\": 0 },\n            { \"pos\": [40, 280], \"id\": 43, \"val\": 0 },\n            { \"pos\": [40, 310], \"id\": 44, \"val\": 0 },\n            { \"pos\": [280, 570], \"orient\": \"n\", \"id\": 45, \"name\": \"Horloge\", \"val\": 0, \"isPushButton\": true },\n            { \"pos\": [190, 400], \"orient\": \"n\", \"id\": 60, \"name\": \"Add./soustr.\", \"val\": 0 },\n        ],\n        \"out\": [\n            { \"pos\": [550, 380], \"id\": 61, \"name\": \"V\" },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [100, 390], \"orient\": \"s\", \"id\": [50, 51, 52, 53], \"name\": \"B\" },\n            { \"type\": \"display\", \"bits\": 4, \"pos\": [550, 230], \"id\": [46, 47, 48, 49], \"name\": \"Acc.\" },\n        ],\n        \"ic\": [\n            { \"type\": \"alu\", \"pos\": [180, 210], \"in\": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], \"out\": [10, 11, 12, 13, 14, 15] },\n            { \"type\": \"flipflop-d\", \"pos\": [390, 100], \"in\": [17, 18, 19, 16], \"out\": [20, 21], \"state\": 0 },\n            { \"type\": \"flipflop-d\", \"pos\": [390, 200], \"in\": [23, 24, 25, 22], \"out\": [26, 27], \"state\": 0 },\n            { \"type\": \"flipflop-d\", \"pos\": [390, 300], \"in\": [29, 30, 31, 28], \"out\": [32, 33], \"state\": 0 },\n            { \"type\": \"flipflop-d\", \"pos\": [390, 400], \"in\": [35, 36, 37, 34], \"out\": [38, 39], \"state\": 0 },\n            { \"type\": \"flipflop-d\", \"pos\": [390, 500], \"in\": [55, 56, 57, 54], \"out\": [58, 59], \"state\": 0 },\n        ],\n        \"wires\": [\n            [10, 16, { \"via\": [[260, 80]] }],\n            [11, 22, { \"via\": [[260, 180]] }],\n            [12, 28, { \"via\": [[260, 280]] }],\n            [13, 34, { \"via\": [[260, 380]] }],\n            [40, 37, { \"via\": [[340, 440]] }],\n            [40, 31, { \"via\": [[340, 340, \"n\"]] }],\n            [40, 25, { \"via\": [[340, 240, \"n\"]] }],\n            [40, 19, { \"via\": [[340, 140, \"n\"]] }],\n            [20, 0, { \"via\": [[430, 80], [430, 50], [130, 50], [130, 130]] }],\n            [26, 1, { \"via\": [[440, 180], [440, 40], [120, 40], [120, 150]] }],\n            [32, 2, { \"via\": [[450, 280], [450, 30], [110, 30], [110, 170]] }],\n            [38, 3, { \"via\": [[460, 380, \"n\"], [460, 20], [100, 20], [100, 190]] }],\n            [41, 4],\n            [42, 5],\n            [43, 6],\n            [44, 7],\n            [45, 35, { \"via\": [[280, 420]] }],\n            [45, 29, { \"via\": [[280, 320, \"n\"]] }],\n            [45, 23, { \"via\": [[280, 220, \"n\"]] }],\n            [45, 17, { \"via\": [[280, 120, \"n\"]] }],\n            [41, 50],\n            [42, 51],\n            [43, 52],\n            [44, 53],\n            [20, 46, { \"via\": [[480, 80]] }],\n            [26, 47, { \"via\": [[480, 180]] }],\n            [32, 48, { \"via\": [[480, 280]] }],\n            [38, 49, { \"via\": [[480, 380]] }],\n            [60, 8, { \"via\": [[230, 320, \"n\"], [230, 110, \"n\"]] }],\n            [40, 57],\n            [45, 55, { \"via\": [[280, 520]] }],\n            [14, 54, { \"via\": [[260, 420, \"s\"], [260, 480]] }],\n            [58, 61],\n        ],\n    },\n\n    LatchedCounter: {\n        \"v\": 5,\n        \"ic\": [\n            { \"type\": \"flipflop-d\", \"pos\": [170, 160], \"in\": [7, 8, 9, 6], \"out\": [10, 11], \"state\": 0, \"trigger\": \"falling\", \"showContent\": true },\n            { \"type\": \"flipflop-d\", \"pos\": [300, 160], \"in\": [15, 16, 17, 14], \"out\": [18, 19], \"state\": 0, \"trigger\": \"falling\", \"showContent\": true },\n            { \"type\": \"flipflop-d\", \"pos\": [440, 160], \"in\": [21, 22, 23, 20], \"out\": [24, 25], \"state\": 0, \"trigger\": \"falling\", \"showContent\": true },\n            { \"type\": \"flipflop-d\", \"pos\": [580, 160], \"in\": [35, 36, 37, 34], \"out\": [38, 39], \"state\": 0, \"trigger\": \"falling\", \"showContent\": true },\n        ],\n        \"in\": [\n            { \"pos\": [100, 180], \"id\": 12, \"name\": \"Horloge\", \"val\": 0, \"isPushButton\": true },\n            { \"pos\": [100, 240], \"id\": 41, \"name\": \"Reset\", \"val\": 0, \"isPushButton\": true },\n        ],\n        \"out\": [{ \"type\": \"display\", \"bits\": 4, \"pos\": [660, 60], \"id\": [26, 27, 28, 29] }],\n        \"wires\": [\n            [12, 7],\n            [10, 15],\n            [18, 21],\n            [19, 14],\n            [11, 6],\n            [25, 20],\n            [10, 26, { \"via\": [[400, 30]] }],\n            [18, 27, { \"via\": [[520, 50]] }],\n            [24, 28],\n            [39, 34],\n            [24, 35],\n            [38, 29],\n            [41, 9],\n            [41, 17],\n            [41, 23],\n            [41, 37],\n        ],\n    },\n\n    Decoder2To4: {\n        \"v\": 5,\n        \"in\": [\n            { \"pos\": [60, 80], \"id\": 0, \"name\": \"S0\", \"val\": 0 },\n            { \"pos\": [60, 220], \"id\": 1, \"name\": \"S1\", \"val\": 0 },\n        ],\n        \"gates\": [\n            { \"type\": \"NOT\", \"pos\": [130, 50], \"in\": 2, \"out\": 3 },\n            { \"type\": \"NOT\", \"pos\": [130, 190], \"in\": 4, \"out\": 5 },\n            { \"type\": \"AND\", \"pos\": [280, 60], \"in\": [6, 7], \"out\": 8 },\n            { \"type\": \"AND\", \"pos\": [280, 120], \"in\": [9, 10], \"out\": 11 },\n            { \"type\": \"AND\", \"pos\": [280, 180], \"in\": [12, 13], \"out\": 14 },\n            { \"type\": \"AND\", \"pos\": [280, 240], \"in\": [15, 16], \"out\": 17 },\n            { \"type\": \"BUF\", \"pos\": [130, 110], \"in\": 22, \"out\": 23 },\n            { \"type\": \"BUF\", \"pos\": [130, 250], \"in\": 24, \"out\": 25 },\n        ],\n        \"out\": [\n            { \"pos\": [370, 60], \"id\": 18, \"name\": \"0\" },\n            { \"pos\": [370, 120], \"id\": 19, \"name\": \"1\" },\n            { \"pos\": [370, 180], \"id\": 20, \"name\": \"2\" },\n            { \"pos\": [370, 240], \"id\": 21, \"name\": \"3\" },\n        ],\n        \"wires\": [\n            [0, 2],\n            [1, 4],\n            [11, 19],\n            [17, 21],\n            [14, 20],\n            [8, 18],\n            [3, 6],\n            [5, 7],\n            [5, 10],\n            [3, 12],\n            [0, 22],\n            [1, 24],\n            [23, 9],\n            [23, 15],\n            [25, 13],\n            [25, 16],\n        ],\n    },\n\n    Decoder3To8: {\n        \"v\": 5,\n        \"in\": [\n            { \"pos\": [60, 130], \"id\": 26, \"name\": \"S0\", \"val\": 1 },\n            { \"pos\": [60, 290], \"id\": 27, \"name\": \"S1\", \"val\": 1 },\n            { \"pos\": [60, 460], \"id\": 28, \"name\": \"S2\", \"val\": 0 },\n        ],\n        \"gates\": [\n            { \"type\": \"NOT\", \"pos\": [130, 90], \"in\": 30, \"out\": 31 },\n            { \"type\": \"NOT\", \"pos\": [130, 250], \"in\": 32, \"out\": 33 },\n            { \"type\": \"NOT\", \"pos\": [130, 420], \"in\": 34, \"out\": 35 },\n            { \"type\": \"AND\", \"bits\": 3, \"pos\": [340, 120], \"in\": [36, 37, 38], \"out\": 39 },\n            { \"type\": \"AND\", \"bits\": 3, \"pos\": [340, 190], \"in\": [40, 41, 42], \"out\": 43 },\n            { \"type\": \"AND\", \"bits\": 3, \"pos\": [340, 260], \"in\": [44, 45, 46], \"out\": 47 },\n            { \"type\": \"AND\", \"bits\": 3, \"pos\": [340, 330], \"in\": [48, 49, 50], \"out\": 51 },\n            { \"type\": \"AND\", \"bits\": 3, \"pos\": [340, 400], \"in\": [52, 53, 54], \"out\": 55 },\n            { \"type\": \"AND\", \"bits\": 3, \"pos\": [340, 470], \"in\": [56, 57, 58], \"out\": 59 },\n            { \"type\": \"AND\", \"bits\": 3, \"pos\": [340, 540], \"in\": [60, 61, 62], \"out\": 63 },\n            { \"type\": \"AND\", \"bits\": 3, \"pos\": [340, 50], \"in\": [64, 65, 66], \"out\": 67 },\n            { \"type\": \"BUF\", \"pos\": [130, 170], \"in\": 76, \"out\": 77 },\n            { \"type\": \"BUF\", \"pos\": [130, 330], \"in\": 78, \"out\": 79 },\n            { \"type\": \"BUF\", \"pos\": [130, 500], \"in\": 80, \"out\": 81 },\n        ],\n        \"out\": [\n            { \"pos\": [420, 50], \"id\": 68, \"name\": \"0\" },\n            { \"pos\": [420, 120], \"id\": 69, \"name\": \"1\" },\n            { \"pos\": [420, 190], \"id\": 70, \"name\": \"2\" },\n            { \"pos\": [420, 260], \"id\": 71, \"name\": \"3\" },\n            { \"pos\": [420, 330], \"id\": 72, \"name\": \"4\" },\n            { \"pos\": [420, 400], \"id\": 73, \"name\": \"5\" },\n            { \"pos\": [420, 470], \"id\": 74, \"name\": \"6\" },\n            { \"pos\": [420, 540], \"id\": 75, \"name\": \"7\" },\n        ],\n        \"wires\": [\n            [26, 30],\n            [27, 32],\n            [28, 34],\n            [67, 68],\n            [39, 69],\n            [43, 70],\n            [47, 71],\n            [51, 72],\n            [55, 73],\n            [59, 74],\n            [63, 75],\n            [31, 64],\n            [33, 65],\n            [35, 66],\n            [26, 76],\n            [27, 78],\n            [28, 80],\n            [77, 36],\n            [33, 37],\n            [35, 38],\n            [31, 40],\n            [79, 41],\n            [35, 42],\n            [35, 46],\n            [79, 45],\n            [77, 44],\n            [31, 48],\n            [77, 52],\n            [31, 56],\n            [77, 60],\n            [33, 49],\n            [33, 53],\n            [79, 57],\n            [79, 61],\n            [81, 50],\n            [81, 54],\n            [81, 58],\n            [81, 62],\n        ],\n    },\n\n    ParityGenerator: {\n        \"v\": 5,\n        \"in\": [\n            { \"pos\": [70, 180], \"id\": 0, \"name\": \"D1\", \"val\": 0 },\n            { \"pos\": [70, 300], \"id\": 1, \"name\": \"D2\", \"val\": 0 },\n            { \"pos\": [70, 360], \"id\": 2, \"name\": \"D3\", \"val\": 0 },\n            { \"pos\": [70, 420], \"id\": 3, \"name\": \"D4\", \"val\": 0 },\n        ],\n        \"out\": [\n            { \"pos\": [530, 60], \"id\": 4, \"name\": \"P1\" },\n            { \"pos\": [530, 120], \"id\": 5, \"name\": \"P2\" },\n            { \"pos\": [530, 180], \"id\": 6, \"name\": \"D1\" },\n            { \"pos\": [530, 240], \"id\": 7, \"name\": \"P3\" },\n            { \"pos\": [530, 300], \"id\": 8, \"name\": \"D2\" },\n            { \"pos\": [530, 360], \"id\": 9, \"name\": \"D3\" },\n            { \"pos\": [530, 420], \"id\": 10, \"name\": \"D4\" },\n        ],\n        \"gates\": [\n            { \"type\": \"XOR\", \"pos\": [460, 240], \"in\": [11, 12], \"out\": 13 },\n            { \"type\": \"XOR\", \"pos\": [380, 230], \"in\": [14, 15], \"out\": 16 },\n            { \"type\": \"XOR\", \"pos\": [340, 120], \"in\": [17, 18], \"out\": 19 },\n            { \"type\": \"XOR\", \"pos\": [260, 110], \"in\": [20, 21], \"out\": 22 },\n            { \"type\": \"XOR\", \"pos\": [300, 60], \"in\": [23, 24], \"out\": 25 },\n            { \"type\": \"XOR\", \"pos\": [220, 40], \"in\": [26, 27], \"out\": 28 },\n        ],\n        \"wires\": [\n            [3, 10],\n            [2, 9],\n            [1, 8],\n            [0, 6],\n            [22, 17],\n            [16, 11],\n            [28, 23],\n            [25, 4],\n            [19, 5],\n            [13, 7],\n            [3, 18, { \"via\": [[280, 420], [280, 130]] }],\n            [3, 12, { \"via\": [[420, 420]] }],\n            [2, 15, { \"via\": [[340, 360]] }],\n            [1, 14, { \"via\": [[310, 300], [310, 220]] }],\n            [2, 21, { \"via\": [[220, 360]] }],\n            [0, 20, { \"via\": [[190, 180], [190, 100]] }],\n            [3, 24, { \"via\": [[150, 420], [150, 70]] }],\n            [1, 27, { \"via\": [[120, 300], [120, 50]] }],\n            [0, 26, { \"via\": [[100, 30]] }],\n        ],\n    },\n\n    ShiftRegister: {\n        \"v\": 5,\n        \"in\": [\n            { \"pos\": [110, 130], \"id\": 0, \"name\": \"D\", \"val\": 1 },\n            { \"pos\": [100, 210], \"id\": 1, \"name\": \"Horloge\", \"val\": 0, \"isPushButton\": true },\n            { \"pos\": [100, 260], \"id\": 38, \"name\": \"Reset\", \"val\": 0, \"isPushButton\": true },\n        ],\n        \"out\": [{ \"type\": \"display\", \"bits\": 4, \"pos\": [650, 60], \"id\": [39, 40, 41, 42] }],\n        \"ic\": [\n            { \"type\": \"flipflop-d\", \"pos\": [560, 150], \"in\": [21, 22, 23, 20], \"out\": [24, 25], \"state\": 1, \"showContent\": true },\n            { \"type\": \"flipflop-d\", \"pos\": [450, 150], \"in\": [15, 16, 17, 14], \"out\": [18, 19], \"state\": 0, \"showContent\": true },\n            { \"type\": \"flipflop-d\", \"pos\": [340, 150], \"in\": [9, 10, 11, 8], \"out\": [12, 13], \"state\": 1, \"showContent\": true },\n            { \"type\": \"flipflop-d\", \"pos\": [230, 150], \"in\": [3, 4, 5, 2], \"out\": [6, 7], \"state\": 1, \"showContent\": true },\n        ],\n        \"wires\": [\n            [6, 8],\n            [12, 14],\n            [18, 20],\n            [38, 5, { \"via\": [[230, 260]] }],\n            [38, 11, { \"via\": [[340, 260]] }],\n            [38, 17, { \"via\": [[450, 260]] }],\n            [38, 23, { \"via\": [[560, 260]] }],\n            [1, 21, { \"via\": [[490, 210]] }],\n            [1, 15, { \"via\": [[380, 210]] }],\n            [1, 9, { \"via\": [[270, 210]] }],\n            [1, 3, { \"via\": [[160, 210]] }],\n            [0, 2],\n            [24, 39],\n            [18, 40, { \"via\": [[530, 50]] }],\n            [12, 41, { \"via\": [[410, 70]] }],\n            [6, 42, { \"via\": [[300, 90]] }],\n        ],\n    },\n\n    Muxes: {\n        \"v\": 5,\n        \"in\": [\n            { \"pos\": [160, 70], \"orient\": \"s\", \"id\": 59, \"name\": \"S0\", \"val\": 0 },\n            { \"pos\": [160, 340], \"orient\": \"s\", \"id\": 64, \"name\": \"S0\", \"val\": 0 },\n            { \"pos\": [450, 360], \"orient\": \"s\", \"id\": 69, \"name\": \"S0\", \"val\": 0 },\n            { \"bits\": 4, \"pos\": [270, 60], \"orient\": \"s\", \"id\": [0, 1, 2, 3], \"val\": [1, 1, 0, 0] },\n            { \"bits\": 4, \"pos\": [460, 70], \"orient\": \"s\", \"id\": [60, 61, 62, 63], \"val\": [0, 0, 0, 0] },\n            { \"bits\": 4, \"pos\": [270, 300], \"orient\": \"s\", \"id\": [65, 66, 67, 68], \"val\": [0, 0, 0, 0] },\n            { \"bits\": 4, \"pos\": [110, 180], \"id\": [86, 87, 88, 89], \"val\": [0, 0, 0, 0] },\n            { \"bits\": 4, \"pos\": [230, 180], \"id\": [90, 91, 92, 93], \"val\": [0, 0, 0, 0] },\n            { \"bits\": 4, \"pos\": [400, 170], \"id\": [94, 95, 96, 97], \"val\": [0, 0, 0, 0] },\n            { \"bits\": 4, \"pos\": [400, 250], \"id\": [98, 99, 100, 101], \"val\": [0, 0, 0, 0] },\n            { \"bits\": 4, \"pos\": [110, 420], \"id\": [102, 103, 104, 105], \"val\": [0, 0, 0, 0] },\n            { \"bits\": 4, \"pos\": [110, 520], \"id\": [106, 107, 108, 109], \"val\": [0, 0, 0, 0] },\n            { \"bits\": 4, \"pos\": [400, 540], \"id\": [110, 111, 112, 113], \"val\": [0, 0, 0, 0] },\n            { \"bits\": 4, \"pos\": [400, 440], \"id\": [114, 115, 116, 117], \"val\": [0, 0, 0, 0] },\n            { \"bits\": 4, \"pos\": [230, 400], \"id\": [118, 119, 120, 121], \"val\": [0, 0, 0, 0] },\n            { \"bits\": 4, \"pos\": [230, 460], \"id\": [122, 123, 124, 125], \"val\": [0, 0, 0, 0] },\n            { \"bits\": 4, \"pos\": [230, 520], \"id\": [126, 127, 128, 129], \"val\": [0, 0, 0, 0] },\n            { \"bits\": 4, \"pos\": [230, 580], \"id\": [130, 131, 132, 133], \"val\": [0, 0, 0, 0] },\n        ],\n        \"ic\": [\n            { \"type\": \"mux\", \"from\": 2, \"to\": 1, \"pos\": [160, 160], \"in\": [5, 6, 7], \"out\": 8 },\n            { \"type\": \"mux\", \"from\": 4, \"to\": 1, \"pos\": [290, 180], \"in\": [4, 9, 10, 11, 12, 13], \"out\": 14 },\n            { \"type\": \"mux\", \"from\": 8, \"to\": 1, \"pos\": [470, 210], \"in\": [15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25], \"out\": 26 },\n            { \"type\": \"mux\", \"from\": 4, \"to\": 2, \"pos\": [160, 470], \"in\": [27, 28, 29, 30, 31], \"out\": [32, 33] },\n            { \"type\": \"mux\", \"from\": 8, \"to\": 2, \"pos\": [290, 490], \"in\": [34, 35, 36, 37, 38, 39, 40, 41, 42, 43], \"out\": [44, 45] },\n            { \"type\": \"mux\", \"from\": 8, \"to\": 4, \"pos\": [450, 490], \"in\": [46, 47, 48, 49, 50, 51, 52, 53, 54], \"out\": [55, 56, 57, 58] },\n            { \"type\": \"alu\", \"pos\": [630, 450], \"in\": [70, 71, 72, 73, 74, 75, 76, 77, 78, 79], \"out\": [80, 81, 82, 83, 84, 85] },\n        ],\n        \"wires\": [\n            [59, 7],\n            [0, 12],\n            [1, 13],\n            [60, 23],\n            [61, 24],\n            [62, 25],\n            [64, 31],\n            [65, 42],\n            [66, 43],\n            [69, 54],\n            [86, 5],\n            [87, 6],\n            [90, 4],\n            [91, 9],\n            [92, 10],\n            [93, 11],\n            [94, 15],\n            [95, 16],\n            [96, 17],\n            [97, 18],\n            [98, 19],\n            [99, 20],\n            [100, 21],\n            [101, 22],\n            [104, 27],\n            [105, 28],\n            [106, 29],\n            [107, 30],\n            [110, 50],\n            [111, 51],\n            [112, 52],\n            [113, 53],\n            [114, 46],\n            [115, 47],\n            [116, 48],\n            [117, 49],\n            [119, 34],\n            [120, 35],\n            [123, 36],\n            [124, 37],\n            [127, 38],\n            [128, 39],\n            [131, 40],\n            [132, 41],\n        ],\n    },\n}\n"],
  "mappings": "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",
  "names": ["b", "a", "__name", "c", "g", "d", "e", "f", "h", "i", "j", "k", "l", "m", "module", "require_dist", "__commonJSMin", "exports", "module", "global", "factory", "createCommonjsModule", "fn", "__name", "_global", "_core", "core", "_core_1", "_isObject", "it", "_anObject", "_fails", "exec", "_descriptors", "document", "is", "_domCreate", "_ie8DomDefine", "_toPrimitive", "S", "val", "dP", "f", "O", "P", "Attributes", "_objectDp", "_propertyDesc", "bitmap", "value", "_hide", "object", "key", "hasOwnProperty", "_has", "id", "px", "_uid", "_library", "_shared", "SHARED", "store", "_functionToString", "_redefine", "SRC", "TO_STRING", "TPL", "safe", "isFunction", "_aFunction", "_ctx", "that", "length", "a", "b", "c", "PROTOTYPE", "$export", "type", "name", "source", "IS_FORCED", "IS_GLOBAL", "IS_STATIC", "IS_PROTO", "IS_BIND", "target", "expProto", "own", "out", "exp", "_export", "ceil", "floor", "_toInteger", "_defined", "_stringAt", "pos", "s", "i", "l", "$at", "codePointAt", "max", "min", "_toAbsoluteIndex", "index", "fromCharCode", "$fromCodePoint", "x", "arguments$1", "res", "aLen", "code", "fromCodePoint", "Space_Separator", "ID_Start", "ID_Continue", "unicode", "util", "parseState", "stack", "line", "column", "token", "root", "parse", "text", "reviver", "lex", "parseStates", "internalize", "holder", "replacement", "key$1", "replacement$1", "lexState", "buffer", "doubleQuote", "sign", "peek", "lexStates", "read", "newToken", "invalidChar", "literal", "u", "unicodeEscape", "invalidIdentifier", "escape", "separatorChar", "list", "p", "hexEscape", "count", "invalidEOF", "push", "pop", "parent", "current", "syntaxError", "formatChar", "replacements", "hexString", "message", "err", "stringify", "replacer", "space", "indent", "propertyList", "replacerFunc", "gap", "quote", "v", "item", "serializeProperty", "quoteString", "serializeArray", "serializeObject", "quotes", "product", "quoteChar", "stepback", "keys", "partial", "propertyString", "member", "serializeKey", "final", "properties", "separator", "firstChar", "properties$1", "JSON5", "lib", "es5", "require_lz_string", "__commonJSMin", "exports", "module", "LZString", "f", "keyStrBase64", "keyStrUriSafe", "baseReverseDic", "getBaseValue", "alphabet", "character", "i", "__name", "input", "res", "a", "index", "compressed", "uncompressed", "buf", "TotalLen", "current_value", "result", "c", "bitsPerChar", "getCharFromInt", "value", "context_dictionary", "context_dictionaryToCreate", "context_c", "context_wc", "context_w", "context_enlargeIn", "context_dictSize", "context_numBits", "context_data", "context_data_val", "context_data_position", "ii", "length", "resetValue", "getNextValue", "dictionary", "next", "enlargeIn", "dictSize", "numBits", "entry", "bits", "resb", "maxpower", "power", "data", "require_crc32", "__commonJSMin", "exports", "Crc32", "factory", "module", "CRC32", "signed_crc_table", "c", "table", "n", "__name", "T", "crc32_bstr", "bstr", "seed", "C", "L", "i", "crc32_buf", "buf", "crc32_buf_8", "crc32_str", "str", "d", "require_png_metadata_writer", "__commonJSMin", "exports", "module", "crc32", "uint8", "int32", "uint32", "RESOLUTION_UNITS", "sliced", "args", "slice", "sliceEnd", "ret", "len", "start", "__name", "textEncode", "keyword", "content", "chunkName", "totalSize", "output", "idx", "code", "i", "j", "textDecode", "data", "naming", "text", "name", "extractChunks", "ended", "chunks", "length", "chunk", "crcActual", "chunkData", "encodeChunks", "size", "nameChars", "crcCheck", "readUint32", "uint8array", "offset", "byte1", "byte2", "byte3", "byte4", "writeUInt32", "num", "readMetadata", "buffer", "result", "textChunk", "writeMetadata", "metadata", "insertMetadata", "pHYs", "require_function", "__commonJSMin", "exports", "getBooleanAlgebra", "__name", "B", "x", "y", "a", "getSemigroup", "S", "f", "g", "getMonoid", "M", "getSemigroupM", "getSemiring", "getRing", "R", "apply", "identity", "constant", "flip", "args", "_i", "flow", "ab", "bc", "cd", "de", "ef", "fg", "gh", "hi", "ij", "tuple", "t", "increment", "n", "decrement", "absurd", "_", "tupled", "untupled", "pipe", "ret", "i", "SK", "b", "not", "predicate", "getEndomorphismMonoid", "first", "second", "require_internal", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "isNone", "__name", "fa", "isSome", "some", "a", "isLeft", "ma", "isRight", "left", "e", "right", "singleton", "isNonEmpty", "as", "head", "tail", "fromReadonlyNonEmptyArray", "require_Apply", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__setModuleDefault", "v", "__importStar", "mod", "result", "function_1", "_", "ap", "F", "G", "fa", "fab", "gab", "ga", "__name", "apFirst", "A", "second", "first", "a", "apSecond", "b", "apS", "name", "fb", "_a", "getApplySemigroup", "S", "x", "y", "curried", "f", "acc", "combined", "i", "tupleConstructors", "c", "d", "e", "getTupleConstructor", "len", "sequenceT", "args", "_i", "fas", "getRecordConstructor", "keys", "r", "sequenceS", "fr", "require_Functor", "__commonJSMin", "exports", "function_1", "map", "F", "G", "f", "fa", "ga", "__name", "flap", "a", "fab", "bindTo", "name", "_a", "let_", "getFunctorComposition", "_map", "fga", "require_Applicative", "__commonJSMin", "exports", "Apply_1", "function_1", "Functor_1", "getApplicativeMonoid", "F", "f", "M", "__name", "getApplicativeComposition", "G", "map", "_ap", "a", "fgab", "fga", "require_Chain", "__commonJSMin", "exports", "chainFirst", "M", "f", "first", "a", "__name", "bind", "name", "ma", "b", "_a", "require_ChainRec", "__commonJSMin", "exports", "tailRec", "__name", "startWith", "f", "ab", "require_FromEither", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__setModuleDefault", "v", "__importStar", "mod", "result", "Chain_1", "function_1", "_", "fromOption", "F", "onNone", "ma", "__name", "fromPredicate", "predicate", "onFalse", "a", "fromOptionK", "fromOptionF", "from", "f", "chainOptionK", "M", "fromOptionKF", "fromEitherK", "chainEitherK", "fromEitherKF", "chainFirstEitherK", "filterOrElse", "require_Separated", "__commonJSMin", "exports", "function_1", "Functor_1", "separated", "__name", "left", "right", "_map", "fa", "f", "_mapLeft", "_bimap", "g", "map", "mapLeft", "bimap", "s", "require_Witherable", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__setModuleDefault", "v", "__importStar", "mod", "result", "_", "wiltDefault", "T", "C", "F", "traverseF", "wa", "f", "__name", "witherDefault", "filterE", "W", "witherF", "predicate", "ga", "a", "b", "require_Either", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__setModuleDefault", "v", "__importStar", "mod", "result", "Applicative_1", "Apply_1", "Chain_1", "ChainRec_1", "FromEither_1", "function_1", "Functor_1", "_", "Separated_1", "Witherable_1", "_map", "__name", "fa", "f", "_ap", "fab", "_chain", "ma", "_reduce", "b", "_foldMap", "M", "foldMapM", "_reduceRight", "_traverse", "F", "traverseF", "ta", "_bimap", "g", "_mapLeft", "_alt", "that", "_extend", "wa", "_chainRec", "a", "getShow", "SE", "SA", "getEq", "EL", "EA", "x", "y", "getSemigroup", "S", "getCompactable", "empty", "getFilterable", "_a", "compact", "separate", "filter", "predicate", "partition", "p", "ob", "e", "getWitherable", "F_", "C", "getApplicativeValidation", "getAltValidation", "me", "ea", "map", "apW", "chainW", "reduce", "foldMap", "reduceRight", "traverse", "sequence", "bimap", "mapLeft", "altW", "extend", "matchW", "onLeft", "onRight", "getOrElseW", "swap", "orElseW", "fromNullable", "tryCatch", "onThrow", "tryCatchK", "_i", "fromNullableK", "from", "chainNullableK", "toError", "elem", "E", "elemE_1", "exists", "let_", "traverseReadonlyNonEmptyArrayWithIndex", "as", "out", "e_1", "traverseReadonlyArrayWithIndex", "traverseArray", "parseJSON", "s", "onError", "stringifyJSON", "u", "getValidationSemigroup", "getValidationMonoid", "MA", "getValidation", "ap", "alt", "require_lib", "__commonJSMin", "exports", "__extends", "extendStatics", "__name", "d", "b", "p", "__", "__assign", "t", "s", "i", "n", "__spreadArrays", "il", "r", "k", "a", "j", "jl", "Either_1", "failure", "value", "context", "message", "Type", "name", "is", "validate", "encode", "ab", "_this", "c", "e", "identity", "getFunctionName", "f", "getContextEntry", "key", "decoder", "appendContext", "actual", "len", "pushAll", "xs", "ys", "l", "hasOwnProperty", "getNameFromProps", "props", "useIdentity", "codecs", "getInterfaceTypeName", "getPartialTypeName", "inner", "enumerableRecord", "keys", "domain", "codomain", "DictionaryType", "u", "o", "errors", "changed", "ok", "codomainResult", "vok", "getDomainKeys", "_a", "isLiteralC", "literal_1", "isKeyofC", "isUnionC", "type", "undefinedType", "nonEnumerableRecord", "isAnyC", "domainResult", "vk", "getUnionName", "mergeAll", "base", "us", "equal", "primitive", "baseIsNotADictionary", "_i", "us_1", "us_2", "getProps", "codec", "stripKeys", "shouldStrip", "getExactTypeName", "isTypeC", "isPartialC", "isNonEmpty", "as", "intersect", "a_1", "v", "mergeTags", "intersection_1", "intersectTags", "intersection_2", "isStrictC", "isExactC", "isRefinementC", "isIntersectionC", "isRecursiveC", "lazyCodecs", "getTags", "index", "prop", "tags", "getIndex", "_loop_1", "all", "ctags", "values", "keys_1", "state_1", "NullType", "_super", "UndefinedType", "VoidType", "UnknownType", "_", "StringType", "NumberType", "BigIntType", "BooleanType", "AnyArrayType", "AnyDictionaryType", "LiteralType", "literal", "KeyofType", "keyof", "RefinementType", "predicate", "brand", "refinement", "RecursiveType", "runDefinition", "recursion", "definition", "cache", "Self", "ArrayType", "array", "item", "ui", "result", "ai", "InterfaceType", "types", "uk", "ak", "type_1", "vak", "PartialType", "partial", "type_2", "record", "UnionType", "union", "tag_1", "groups_1", "len_1", "find_1", "TaggedUnionType", "codecs_1", "IntersectionType", "intersection", "TupleType", "tuple", "type_3", "va", "ReadonlyType", "readonly", "ReadonlyArrayType", "readonlyArray", "strict", "exact", "ExactType", "ce", "FunctionType", "tag", "taggedUnion", "U", "getValidationError", "getDefaultContext", "NeverType", "AnyType", "ObjectType", "StrictType", "clean", "alias", "require_unicode", "__commonJSMin", "exports", "module", "require_util", "__commonJSMin", "exports", "module", "unicode", "c", "require_PathReporter", "__commonJSMin", "exports", "_1", "Either_1", "stringify", "v", "__name", "getContextPath", "context", "_a", "key", "type", "getMessage", "e", "failure", "es", "success", "supportCustomEvent", "__name", "event", "x", "ev", "safeDispatchEvent", "target", "check", "createsStackingContext", "el", "s", "invalid", "k", "ok", "findNearestDialog", "safeBlur", "inNodeList", "nodeList", "node", "i", "isFormMethodDialog", "findFocusableElementWithin", "hostElement", "opts", "query", "elems", "isConnected", "element", "findFormSubmitter", "form", "submitter", "dialogPolyfill", "root", "maybeHandleSubmit", "value", "dialog", "formmethod", "dialogPolyfillInfo", "mo", "removed", "cb", "timeout", "delayModel", "cand", "name", "e", "fake", "redirectedEvent", "dialogZ", "backdropZ", "opt_returnValue", "closeEvent", "scrollTop", "topValue", "styleSheet", "cssRules", "j", "rule", "selectedNodes", "cssTop", "cssBottom", "computedStyle", "checkDOM", "records", "rec", "c", "zIndex", "dpi", "last", "p", "candidate", "position", "cancelEvent", "clone", "allowed", "index", "testForm", "methodDescriptor", "realGet", "realSet", "v", "path", "valid", "nativeFormSubmit", "replacementFormSubmit", "dialog_polyfill_esm_default", "import_file_saver", "import_json5", "LZString", "pngMeta", "t", "import_json5", "import_file_saver", "import_json5", "json5util", "import_Either", "t", "import_PathReporter", "import_json5", "InBrowser", "Any", "keysOf", "o", "__name", "RichStringEnum", "props", "i", "defs", "val", "tuple", "items", "mergeWhereDefined", "a", "b", "obj", "k", "v", "randomString", "n", "chars", "str", "brand", "defineADTStatics", "cases", "statics", "isString", "isArray", "arg", "isNumber", "isBoolean", "isRecord", "ArrayFillWith", "ArrayFillUsing", "arr", "ArrayClampOrPad", "len", "padValue", "missing", "FixedArrayFillWith", "val", "ArrayFillWith", "__name", "FixedArrayMap", "items", "fn", "__name", "FixedArrayAssert", "arr", "JSONParseObject", "str", "parsed", "JSON5", "isRecord", "isTruthyString", "isFalsyString", "getURLParameter", "sParam", "defaultValue", "sURLVariables", "sURLVariable", "sParameterName", "isEmbeddedInIframe", "e", "onVisible", "element", "callback", "entries", "observer", "entry", "setEnabled", "elem", "enabled", "setVisible", "visible", "prevDisplay", "currentDisplay", "toggleVisible", "setHidden", "hidden", "setDisplay", "display", "setActive", "active", "showModal", "dlog", "listener", "InteractionResultCases", "repeat", "InteractionResult", "defineADTStatics", "changed", "r0", "r1", "EdgeTrigger", "ComponentTypeInput", "ComponentTypeOutput", "repeatString", "c", "__name", "formatString", "str", "varargs", "t", "args", "key", "deepObjectEquals", "v1", "v2", "keys1", "keys2", "deepArrayEquals", "isArray", "i", "typeOrUndefined", "tpe", "typeOrNull", "validateJson", "obj", "repr", "what", "validated", "__name", "HighImpedance", "isHighImpedance", "v", "Unknown", "isUnknown", "TUnknown", "input", "context", "LogicValue", "LogicValueRepr", "toLogicValueRepr", "toLogicValue", "toLogicValueFromChar", "char", "InputOutputValueRepr", "allBooleans", "values", "isAllZeros", "s", "c", "binaryStringRepr", "valuesReprForTest", "hexStringRepr", "hexWidth", "binStr", "valuesFromBinaryOrHexRepr", "wordRepr", "numBits", "binaryRepr", "row", "i", "valuesFromReprForInput", "isString", "ArrayFillWith", "isArray", "ArrayClampOrPad", "isNumber", "reprForLogicValues", "undefinedIfTrivial", "value", "nontrivial", "copyToClipboard", "textToCopy", "e", "isOS", "__name", "textArea", "range", "selection", "ok", "pasteFromClipboard", "text", "result", "targetIsFieldOrOtherInput", "targets", "elem", "tagName", "getScrollParent", "element", "style", "excludeStaticParent", "overflowRegex", "parent", "fetchJSONP", "unique", "url", "resolve", "script", "name", "json", "JSON5", "CurrentFormatVersion", "migrateData", "data", "editorId", "_a", "jsonVersion", "savedVersion", "migrationFunc", "migrateTo", "defs", "isArray", "def", "circuit", "isRecord", "newRepr", "Serialization", "editorIdStr", "__name", "container", "compFieldsAndCategories", "oldToNewId", "newTypeFor", "category", "item", "isString", "gateType", "id", "components", "field", "list", "compRepr", "newType", "_b", "_c", "_d", "_e", "_f", "_g", "_h", "_i", "_j", "_k", "_l", "_m", "_n", "type", "match", "ins", "in_", "outs", "out", "gates", "gate", "lastChar", "maybeBit", "ramRegex", "muxRegex", "demuxRegex", "comp", "state", "binStr", "binaryStringRepr", "toLogicValue", "isAllZeros", "layouts", "passthroughRegex", "layout", "nextNewId", "findFirstFreeId", "t", "wires", "wire", "wireOptions", "displays", "display", "clocks", "clock", "inputs", "lastThree", "parsedContents", "maxId", "inspectComponentDef", "compDef", "fieldName", "inspectValue", "value", "val", "jsonField", "arr", "t", "icons", "add_icon_default", "bordercolor_icon_default", "browserload_icon_default", "check_icon_default", "close_icon_default", "connect_icon_default", "dimensions_icon_default", "direction_icon_default", "download_icon_default", "edit_icon_default", "eye_icon_default", "eyecrossed_icon_default", "font_icon_default", "force_icon_default", "inputs_icon_default", "link_icon_default", "memcontent_icon_default", "memlines_icon_default", "mouse_icon_default", "move_icon_default", "newcomponent_icon_default", "none_icon_default", "open_icon_default", "outputs_icon_default", "palette_icon_default", "pause_icon_default", "pen_icon_default", "placement_icon_default", "play_icon_default", "question_icon_default", "questioncircled_icon_default", "redo_icon_default", "ref_icon_default", "replace_icon_default", "reset_icon_default", "screenshot_icon_default", "setinput_icon_default", "settings_icon_default", "slanted_icon_default", "step_icon_default", "strokewidth_icon_default", "testcase_icon_default", "timer_icon_default", "trash_icon_default", "undo_icon_default", "wirestyle_icon_default", "images", "Adder_default", "AdderArray_default", "ALU_default", "and_default", "and3_default", "and4_default", "buf_default", "Clock_default", "Comparator_default", "Counter_default", "Decoder_default", "Decoder7Seg_default", "Decoder16Seg_default", "DecoderBCD4_default", "Demux_default", "FlipflopD_default", "FlipflopJK_default", "FlipflopT_default", "GateArray_default", "HalfAdder_default", "imply_default", "Input1_default", "Input4_default", "Input8_default", "Random_default", "Rectangle_default", "Label_default", "LatchSR_default", "Mux_default", "nand_default", "nand3_default", "nand4_default", "nimply_default", "nor_default", "nor3_default", "nor4_default", "not_default", "or_default", "or3_default", "or4_default", "Output1_default", "Output4_default", "Output8_default", "Display7Seg_default", "Display16Seg_default", "DisplayAscii_default", "DisplayBar_default", "Display4_default", "Display8_default", "ShiftDisplay_default", "Passthrough1_default", "PassthroughN_default", "Pixel_default", "RAM_default", "ROM_default", "Register_default", "ShiftRegister_default", "ControlledInverter_default", "tri_default", "TristateBufferArray_default", "txa_default", "xnor_default", "xnor3_default", "xnor4_default", "xor_default", "xor3_default", "xor4_default", "isIconName", "name", "__name", "makeImage", "name", "width", "height", "makeSvgHolder", "raw", "inlineSvgFor", "images", "__name", "makeIcon", "icons", "className", "iconName", "content", "elem", "applyModifierTo", "svgData", "inlineIconSvgFor", "isModifierObject", "mod", "__name", "isNode", "obj", "applyModifierTo", "parent", "modifier", "text", "applyModifiersTo", "modifiers", "elemBuilder", "tagName", "el", "attrBuilder", "attrName", "builder", "attrValue", "p", "data", "dataName", "attrBuilder", "__name", "raw", "rawHTML", "p", "mods", "modifiers", "p", "applyModifiersTo", "__name", "emptyMod", "__", "attr", "attrName", "attrValue", "attrBuilder", "div", "elemBuilder", "span", "a", "b", "i", "ul", "ol", "li", "table", "thead", "tbody", "tr", "th", "td", "input", "select", "option", "button", "label", "img", "canvas", "style", "type", "cls", "href", "target", "title", "src", "draggable", "br", "raw", "asValue", "bool", "isUnknown", "isHighImpedance", "Unknown", "tooltipContent", "body", "maxWidth", "fixedWidthInContextMenu", "setupSvgIcon", "_iconElem", "_a", "iconElem", "iconName", "isIconName", "inlineIconSvgFor", "Template", "templateString", "values", "match", "s", "key", "plurDecl", "plural", "singDecl", "singular", "value", "S", "__name", "template", "templ", "Strings_fr", "n", "RichStringEnum", "tuple", "gateType", "mods", "Strings_en", "langs", "isLang", "lang", "setLang", "l", "_lang", "getLang", "DefaultLang", "buildMap", "repr", "compList", "isInputOutput", "map", "ref", "value", "comp", "__name", "fixMap", "k", "v", "isString", "isInput", "ComponentTypeInput", "isOutput", "ComponentTypeOutput", "TestCaseCombinational", "InputOutputValueRepr", "_a", "S", "mapRepr", "TestSuite", "reprAndComps", "_b", "tc", "TestCaseResult", "mismatches", "msg", "TestSuiteResults", "testSuite", "testCase", "result", "m", "reprForLogicValues", "TestSuites", "parent", "acc", "suite", "testSuites", "isRef", "s", "input", "output", "abs", "cos", "sin", "acos", "atan2", "sqrt", "pow", "crt", "v", "__name", "pi", "tau", "quart", "epsilon", "nMax", "nMin", "ZERO", "utils", "t", "derivativeFn", "d", "l", "points", "_3d", "order", "mt", "p", "ret", "mt2", "t2", "a", "b", "c", "dCpts", "i", "ratios", "r", "f1", "f2", "f3", "f4", "dpoints", "list", "j", "dpt", "m", "M", "precision", "len", "sum", "ds", "de", "ts", "te", "d1", "d2", "v2", "v1", "s", "obj", "o", "dx1", "dy1", "dx2", "dy2", "cross", "dot", "pos", "p1", "p2", "dx", "dy", "LUT", "point", "mdist", "mpos", "idx", "bottom", "top", "x1", "y1", "x2", "y2", "x3", "y3", "x4", "y4", "nx", "ny", "p3", "p4", "Bezier", "sections", "mx", "my", "MX", "MY", "bbox", "s1", "bbox1", "s2", "bbox2", "curveIntersectionThreshold", "intersections", "a1", "a2", "l1", "l2", "iss", "forward", "back", "bpl", "fpl", "start", "end", "shape", "curve", "min", "max", "line", "tx", "ty", "aligned", "reduce", "m1", "m2", "pa", "pb", "pc", "pd", "q", "q2", "discriminant", "u1", "mp3", "mp33", "cosphi", "phi", "crtr", "t1", "sd", "kOnly", "num", "dnm", "adk", "dk", "k", "dd", "qdsum", "pk", "nk", "v3", "trm", "sq", "b1", "b2", "dims", "dim", "_bbox", "c1", "c2", "c1b", "c2b", "threshold", "cc1", "cc2", "pairs", "pair", "results", "dx1p", "dy1p", "dx2p", "dy2p", "mx1", "my1", "mx2", "my2", "mx1n", "my1n", "mx2n", "my2n", "arc", "e", "_", "PolyBezier", "curves", "curve", "utils", "v", "a", "b", "idx", "c", "bbox", "i", "d", "offset", "__name", "abs", "min", "max", "cos", "sin", "acos", "sqrt", "pi", "Bezier", "coords", "args", "coordlen", "newargs", "point", "d", "higher", "len", "_3d", "points", "idx", "step", "order", "dims", "aligned", "utils", "baselength", "t", "p", "abs", "p1", "p2", "p3", "abc", "S", "B", "E", "d1", "d2", "selen", "lx", "ly", "bx1", "by1", "bx2", "by2", "e1", "e2", "A", "v1", "v2", "nc1", "nc2", "PolyBezier", "x", "y", "s", "i", "last", "ratios", "print", "c", "pos", "angle", "u", "um", "C", "steps", "error", "lut", "hits", "LUT", "l", "closest", "mpos", "t1", "t2", "mdist", "ft", "np", "k", "pi", "pim", "q", "sqrt", "r1", "r2", "q1", "q2", "m", "R", "_p", "pt", "result", "roots", "dim", "mfn", "__name", "v", "extrema", "curve", "lbbox", "tbbox", "n", "ret", "nv", "a1", "a2", "n1", "n2", "acos", "segment", "pass1", "pass2", "o", "_", "distanceFn", "clockwise", "ov", "rc", "d3", "d4", "start", "end", "mid", "e", "fline", "bline", "ls", "le", "segments", "reduced", "fcurves", "bcurves", "alen", "tlen", "graduated", "linearDistanceFunction", "slen", "f1", "f2", "fs", "fe", "bs", "be", "curveIntersectionThreshold", "outline", "shapes", "shape", "line", "mx", "min", "my", "MX", "max", "MY", "results", "left", "right", "c1", "c2", "pairs", "r", "intersections", "pair", "errorThreshold", "pc", "np1", "ref", "circles", "t_s", "t_e", "safety", "np2", "np3", "arc", "prev_arc", "curr_good", "prev_good", "done", "t_m", "prev_e", "cos", "sin", "t", "t", "import_json5", "perm", "mode", "parent", "__name", "UIPermissions", "t", "MenuData", "caption", "icon", "action", "shortcut", "danger", "items", "_DrawContextImpl", "comp", "g", "drawParams", "isMouseOver", "borderColor", "f", "x", "y", "mult", "__name", "m", "Drawable", "parent", "id", "req", "_a", "fullReq", "DrawZIndex", "_b", "inSelectionRect", "isPointerOver", "COLOR_MOUSE_OVER_DANGER", "COLOR_MOUSE_OVER", "COLOR_COMPONENT_BORDER", "ctx", "__g", "__e", "currentId", "s", "S", "span", "fixedWidthInContextMenu", "newId", "ComponentBase", "componentList", "otherComp", "__", "InteractionResult", "e", "Orientations_", "Orientations", "RichStringEnum", "Orientation", "o", "compOrient", "nodeOrient", "PositionSupportRepr", "typeOrUndefined", "DrawableWithPosition", "saved", "editor", "rect", "lockPos", "newOrient", "abcd", "inRect", "posX", "posY", "snapToGrid", "newPos", "roundTo", "GRID_STEP", "delta", "shortcuts", "rotateItem", "orient", "isCurrent", "lockPosItem", "anchorItem", "DrawableWithDraggablePosition", "anchor", "offsetX", "offsetY", "wasMoving", "result", "mouseOffsetToPosX", "mouseOffsetToPosY", "lastAnchorX", "lastAnchorY", "createdClone", "targetX", "targetY", "dx", "dy", "clone", "__setSpawning", "WireColor", "DEFAULT_WIRE_COLOR", "NodeBase", "DrawableWithPosition", "component", "nodeSpec", "group", "shortName", "fullName", "_gridOffsetX", "_gridOffsetY", "hasTriangle", "relativePosition", "_leadLengthOverride", "toLogicValue", "initialValue", "leadLengthOverride", "_a", "Orientation", "isVertical", "bias", "GRID_STEP", "dir", "x", "y", "__", "Node", "WAYPOINT_DIAMETER", "color", "__color", "moreTolerant", "distSquaredToWaypointIfOver", "g", "ctx", "mode", "showForced", "showForcedWarning", "isUnknown", "parentOrientIsVertical", "neutral", "drawWaypoint", "val", "oldVisibleValue", "newVisibleValue", "newVal", "appliedGridOffsetX", "appliedGridOffsetY", "__e", "newWire", "InteractionResult", "tryMakeRepeatableNodeAction", "startNode", "endNode", "__name", "NodeIn", "wire", "__delta", "__newValue", "NodeOut", "i", "node", "newForceValue", "newValue", "now", "superChange", "Unknown", "HighImpedance", "handleNodes", "startGroup", "endGroup", "startIndex", "startIncrement", "endIndex", "endIncrement", "repeat", "makeRepeatFunction", "NodeSeqRepr", "__name", "fullNodeRepr", "InputNodeRepr", "OutputNodeRepr", "LogicValueRepr", "WireColor", "InputNodeSeqRepr", "OutputNodeSeqRepr", "OnlyInNodeIds", "OnlyOutNodeIds", "InAndOutNodeIds", "NoNodeIds", "NodeIDsRepr", "hasIn", "hasOut", "ComponentRepr", "PositionSupportRepr", "isNodeArray", "obj", "isArray", "NodeGroup", "parent", "name", "node", "x", "y", "len", "GRID_STEP", "i", "isDynamicName", "obj", "isRecord", "key", "__name", "ComponentNameRepr", "typeOrUndefined", "isNodeDesc", "desc", "isNumber", "ComponentBase", "DrawableWithDraggablePosition", "parent", "def", "saved", "GRID_STEP", "ins", "outs", "countNodes", "rec", "count", "innerDesc", "numInputs", "numOutputs", "inputSpecs", "outputSpecs", "hasAnyPrecomputedInitialValues", "NodeIn", "NodeOut", "_a", "repr", "nodeRec", "specs", "node", "nodes", "allNodes", "nodeGroups", "makeNode", "group", "shortName", "_b", "_c", "spec", "nextSpecIndex", "offsetX", "offsetY", "orient", "nameOrOptions", "options_", "nameOverride", "options", "isString", "isClock", "prefersSpike", "leadLength", "hasTriangle", "fullName", "newNode", "fieldName", "makeNodesForGroup", "groupDesc", "groupName", "namePrefix", "NodeGroup", "i", "groupMultiDesc", "_repr", "nodeMgr", "makeDefaultSpec", "makeDefaultSpecArray", "len", "ArrayFillUsing", "makeNormalizedSpecs", "num", "seqRepr", "pushId", "sourceId", "id", "isArray", "start", "end", "s", "inNodeReprs", "reprOne", "compactRepr", "outNodeReprs", "valueNotForced", "noInitialValue", "hasStandardColor", "DEFAULT_WIRE_COLOR", "toLogicValueRepr", "reprs", "newArray", "currentRangeStart", "currentRangeEnd", "pushRange", "drawable", "d", "maybeName", "newValue", "forcePropagate", "oldValue", "deepArrayEquals", "__newValue", "values", "reverse", "j", "honorRotation", "DrawingRect", "g", "drawParams", "bounds", "ctx", "opts_", "opts", "COLOR_BACKGROUND", "outline", "drawLabels", "name", "onRight", "value", "val", "drawComponentName", "labelSize", "COLOR_COMPONENT_INNER_LABELS", "drawClockInput", "EdgeTrigger", "drawWireLineToComponent", "shouldDrawLeadsTo", "groupWidth", "Orientation", "first", "last", "beforeAfterMargin", "COLOR_GROUP_SPAN", "isTrivialNodeName", "drawLabel", "elem", "offset", "newComp", "saveWires", "getWires", "savedWires", "wires", "keyName", "savedWiresIn", "savedWiresOut", "restoreNodes", "setWires", "wire", "now", "componentList", "ref", "setSpawning", "eventMgr", "elems", "wasSpawning", "wasMoving", "newLinks", "InteractionResult", "linkMgr", "__newLinks", "x", "y", "snapToGrid", "e", "delta", "anchored", "doChange", "mode", "menuItems", "baseItems", "specificItems", "lastWasSep", "addItemsAt", "placement", "items", "insertSep", "MenuData", "pl", "it", "editor", "S", "nonEmptySelectionInMainEditor", "makeNewComponentItems", "UIPermissions", "result", "makeNewTestCaseItems", "setRefItems", "resetItem", "deleteItem", "withSepBefore", "makeOutputItems", "out", "currentForceValue", "Unknown", "HighImpedance", "newForceValue", "footerItems", "icon", "currentName", "handler", "caption", "currentDisplayName", "JSON5", "promptReturnValue", "newName", "parsedValue", "currentFont", "defaultIfEmpty", "callback", "newFont", "ParametrizedComponentBase", "instance", "itemCaption", "currentValue", "makeChangeValueItem", "isCurrent", "action", "newParams", "newRepr", "paramIndex", "increase", "params", "numParams", "paramName", "currentParamValue", "paramDef", "newParamValue", "isBoolean", "FixedArrayMap", "groupVertical", "yCenter", "spacing", "spacing_", "useCompact", "span", "yTop", "groupVerticalMulti", "numOuter", "numInner", "innerSpacing", "groupSpacing", "groupOffset", "groupHorizontal", "xCenter", "xRight", "makeComponentRepr", "type", "hasIn", "hasOut", "props", "ComponentRepr", "ComponentDef", "idPrefix", "aults", "size", "_buttonProps", "_initialValue", "makeNodes", "visual", "comp", "data", "validated", "validateJson", "defineComponent", "button", "valueDefaults", "initialValue", "defineAbstractComponent", "ParamDef", "defaultValue", "range", "isAllowed", "context", "param", "paramBool", "paramDefaults", "defs", "k", "v", "ParametrizedComponentDef", "variantName", "paramDefs", "_makeNodes", "_validateParams", "defParams", "fullParams", "mergeWhereDefined", "resolvedParams", "jsonType", "className", "paramValue", "validatedValue", "defineParametrizedComponent", "validateParams", "brand", "GRID_STEP", "WIRE_WIDTH", "WIRE_WIDTH_HALF_SQUARED", "WAYPOINT_DIAMETER", "WAYPOINT_HIT_RADIUS_SQUARED", "WAYPOINT_HIT_RADIUS_SQUARED_TOLERANT", "pxToGrid", "x", "__name", "distSquared", "x0", "y0", "x1", "y1", "dx", "dy", "inRect", "centerX", "centerY", "width", "height", "pointX", "pointY", "w2", "h2", "DrawingRect", "comp", "honorRotation", "Orientation", "g", "margin", "path", "DrawZIndex", "COLOR_TRANSPARENT", "USER_COLORS", "COLOR_BACKGROUND", "COLOR_OFF_BACKGROUND", "COLOR_BACKGROUND_UNUSED_REGION", "COLOR_BACKGROUND_INVALID", "COLOR_BORDER", "COLOR_GRID_LINES", "COLOR_GRID_LINES_GUIDES", "COLOR_LABEL_OFF", "COLOR_LABEL_ON", "COLORCOMP_COMPONENT_BORDER", "COLOR_COMPONENT_BORDER", "COLOR_COMPONENT_INNER_LABELS", "COLOR_COMPONENT_ID", "COLOR_GROUP_SPAN", "COLOR_WIRE_BORDER", "COLOR_MOUSE_OVER", "COLOR_MOUSE_OVER_NORMAL", "COLOR_MOUSE_OVER_DANGER", "COLOR_NODE_MOUSE_OVER", "COLORCOMPS_FULL", "COLOR_FULL", "COLOR_FULL_ALT", "COLOR_DARK_RED", "COLORCOMPS_EMPTY", "COLOR_EMPTY", "COLOR_EMPTY_ALT", "COLORCOMPS_UNKNOWN", "COLOR_UNKNOWN", "COLOR_UNKNOWN_ALT", "COLOR_HIGH_IMPEDANCE", "COLOR_ANCHOR_IN", "COLOR_ANCHOR_OUT", "COLOR_ANCHOR_NEW", "COLOR_GATE_NAMES", "COLOR_LED_ON", "COLOR_WIRE", "COLOR_RECTANGLE_BACKGROUND", "COLOR_RECTANGLE_BORDER", "PATTERN_STRIPED_GRAY", "OPACITY_HIDDEN_ITEMS", "_currentModeIsDark", "doSetColors", "setDarkMode", "darkMode", "force", "editor", "LogicEditor", "isDarkMode", "_a", "ColorString", "createStripedPattern", "setColorPointerOverIsDanger", "ligherColor", "background", "stripeColor", "InBrowser", "canvas", "step", "pattern", "mouseOverIsDanger", "input", "isArray", "colorCompsRGB", "c", "PREFIX", "SUFFIX", "comps", "compStr", "FixedArrayAssert", "col", "offset", "components", "newComponents", "colorForLogicValue", "value", "isUnknown", "isHighImpedance", "colorsForLogicValue", "colorForFraction", "fraction", "parseColorToRGBA", "ctx", "computed", "FONT_LABEL_DEFAULT", "_cachedAscents", "fontAscentHalf", "font", "halfAscent", "TextVAlign", "strokeTextVAlign", "valign", "text", "y", "fillTextVAlign", "useCompact", "numNodes", "trivialNameMatcher", "isTrivialNodeName", "name", "triangle", "x2", "y2", "circle", "cx", "cy", "d", "r", "strokeSingleLine", "shouldDrawLeadsTo", "nodes", "whatToDrawForNode", "x", "__name", "node", "editor", "wires", "connected", "drawHiddenMark", "w", "shouldDrawNodeLabel", "nodeOrArray", "isArray", "drawWireLineToComponent", "g", "drawLead", "drawTriangle", "x1", "y1", "x0", "y0", "neutral", "drawStraightWireLine", "COLOR_COMPONENT_BORDER", "shift", "triangle", "COLOR_WIRE", "Orientation", "value", "color", "timeFraction", "strokeWireOutlineAndSingleValue", "strokeWireOutline", "strokeWireValue", "isMouseOver", "oldLineCap", "mainStrokeWidth", "WIRE_WIDTH", "COLOR_MOUSE_OVER", "lengthToDrawAndTotal", "baseColor", "altColor", "COLOR_UNKNOWN", "COLOR_UNKNOWN_ALT", "colorsForLogicValue", "animationDashSize", "lengthToDraw", "totalLength", "distSquaredToWaypointIfOver", "y", "waypointX", "waypointY", "moreTolerant", "distSq", "distSquared", "WAYPOINT_HIT_RADIUS_SQUARED_TOLERANT", "WAYPOINT_HIT_RADIUS_SQUARED", "drawWaypoint", "g", "ctx", "x", "y", "style", "value", "isMouseOver", "neutral", "showForced", "showForcedWarning", "parentOrientIsVertical", "circleColor", "thickness", "COLOR_DARK_RED", "COLOR_WIRE_BORDER", "COLOR_BACKGROUND", "COLOR_UNKNOWN", "colorForLogicValue", "circle", "WAYPOINT_DIAMETER", "COLOR_NODE_MOUSE_OVER", "fillTextVAlign", "TextVAlign", "__name", "drawClockInput", "left", "clockNode", "trigger", "clockY", "COLOR_COMPONENT_BORDER", "EdgeTrigger", "drawWireLineToComponent", "drawLabel", "compOrient", "text", "anchor", "referenceNode", "isNumber", "showLabel", "shouldDrawNodeLabel", "halign", "valign", "dx", "dy", "Orientation", "xx", "isNodeArray", "yy", "finalX", "finalY", "drawValueTextCentered", "comp", "opts", "drawValueText", "_a", "spec", "label", "small", "fillStyle", "sizeStrBig", "sizeStrSmall", "isUnknown", "COLOR_LABEL_OFF", "isHighImpedance", "COLOR_LABEL_ON", "INPUT_OUTPUT_DIAMETER", "NAME_POSITION_SETTINGS", "textSettingsForName", "onRight", "orient", "drawComponentName", "name", "displayName", "isString", "Unknown", "hAlign", "vAlign", "deltaX", "point", "drawAnchorsAroundComponent", "includeTo", "color", "COLOR_ANCHOR_IN", "COLOR_ANCHOR_NEW", "drawAnchorTo", "drawAllTo", "drawable", "ComponentBase", "anchoredComp", "Waypoint", "COLOR_ANCHOR_OUT", "drawAnchorTo", "g", "sX", "sY", "tX", "tY", "distOrDim", "color", "whileDraggingComp", "dt", "tWidth", "tHeight", "isNumber", "c", "dirX", "dirY", "magn", "perpX", "perpY", "st", "sb", "th", "mt", "at", "mb", "ab", "__name", "bezierPoint", "t", "coords", "u", "f1", "f2", "f3", "f4", "x", "y", "bezierExtrema", "forY", "di", "start", "end", "c1", "c2", "a", "b", "roots", "r", "discriminant", "sqrtD", "bezierBoundingBox", "margin", "xExtrema", "yExtrema", "ts", "minX", "maxX", "minY", "maxY", "isPointOnStraightWire", "x1", "y1", "x2", "y2", "length2", "closestX", "closestY", "WIRE_WIDTH_HALF_SQUARED", "makeBezierCoords", "startX", "startY", "endX", "endY", "endpointDist", "tStepSize", "WIRE_WIDTH", "boundingBox", "bezierMEta", "isPointOnBezierWire", "bezierMeta", "left", "top", "right", "bottom", "stepSize", "wx", "wy", "displayValuesFromArray", "values", "mostSignificantFirst", "binaryStringRep", "hasUnset", "add", "v", "value", "isUnknown", "isHighImpedance", "Unknown", "formatWithRadix", "radix", "numBits", "withPrefix", "asBinStr", "rest", "padWidth", "caption", "t", "Slant", "PassthroughDef", "defineParametrizedComponent", "bits", "typeOrUndefined", "param", "numBits", "useCompact", "groupVertical", "saved", "ArrayFillWith", "Passthrough", "ParametrizedComponentBase", "parent", "params", "_a", "savedWireEnds", "nodeOut", "NodeOut", "nodeIns", "wire", "endNode", "linkMgr", "nodeIn", "style", "newValue", "x", "y", "yPosWithNoHOffset", "f", "deltaX", "tooltipContent", "mods", "div", "S", "g", "ctx", "height", "top", "bottom", "mouseoverMargin", "topShift", "bottomShift", "input", "drawWireLineToComponent", "output", "COLOR_NODE_MOUSE_OVER", "COLOR_COMPONENT_BORDER", "COLOR_UNKNOWN", "s", "makeItemSetSlant", "__name", "desc", "slant", "isCurrent", "icon", "action", "MenuData", "n", "i", "shift", "GRID_STEP", "WirePath", "parts", "helperElement", "buildPathDesc", "g", "start", "part", "bezierMeta", "left", "top", "right", "bottom", "stepSize", "t", "x", "y", "bezierPoint", "circle", "WIRE_WIDTH", "i", "isPointOnStraightWire", "isPointOnBezierWire", "__name", "pathDescParts", "Waypoint", "DrawableWithDraggablePosition", "wire", "saved", "Orientations_", "typeOrNull", "posX", "posY", "orient", "anchor", "options", "_a", "Orientation", "newOrient", "WAYPOINT_DIAMETER", "x", "y", "distSquaredToWaypointIfOver", "__delta", "mode", "waypoints", "index", "prev", "next", "g", "ctx", "OPACITY_HIDDEN_ITEMS", "neutral", "drawWaypoint", "it", "MenuData", "S", "__name", "WireStyles", "Wire", "Drawable", "startNode", "endNode", "parent", "longAgo", "simpleRepr", "fullRepr", "typeOrUndefined", "wireOptions", "componentsByRef", "endID", "w", "__rect", "reprs", "repr", "wp", "anchorRef", "isString", "startX", "startY", "prevX", "prevY", "prevProlong", "endLeadX", "endLeadY", "endNodeX", "endNodeY", "endNodeProlong", "lastWaypointData", "allWaypoints", "pathParts", "wireStyle", "waypoint", "nextX", "nextY", "deltaX", "deltaY", "nextProlong", "c1x", "c1y", "c2x", "c2y", "bezierAnchorPointDistX", "bezierAnchorPointDistY", "bezierAnchorForWire", "makeBezierCoords", "WirePath", "style", "hidden", "now", "newValue", "logicalTime", "propagationDelay", "desc", "toLogicValueRepr", "Node", "passthrough", "PassthroughDef", "newWire", "wirePath", "partIndex", "endX", "endY", "i", "removeBefore", "_b", "_c", "isAnimating", "drawTime", "drawParams", "color", "strokeWireOutline", "value", "timeSet", "frac", "strokeWireValue", "totalLength", "lengthToDraw", "InteractionResult", "s", "currentPropDelayStr", "makeItemUseColor", "isCurrent", "icon", "action", "cssColor", "COLOR_WIRE", "span", "title", "WIRE_WIDTH", "makeItemDisplayStyle", "hiddenMenuItem", "setWireOptionsItems", "__itemEvent", "currentStr", "defaultDelay", "message", "newValueStr", "asInt", "WireColor", "setRefItems", "contextEvent", "Ribbon", "startNodeGroup", "endNodeGroup", "newNodeGroupStartIndex", "newNodeGroupEndIndex", "__wire", "startOrient", "endOrient", "anchor1X", "anchor1Y", "anchor2X", "anchor2Y", "b", "Bezier", "values", "isMouseOver", "numWires", "WIRE_MARGIN_OUTER", "WIRE_MARGIN_INNER", "totalWidth", "addBezierToPath", "p0", "a0", "a1", "p1", "drawBezier", "drawBeziers", "bs", "isArray", "bb", "oldLineCap", "COLOR_MOUSE_OVER", "dist", "COLOR_UNKNOWN", "colorForLogicValue", "b1", "nodeGroup", "startIndex", "endIndex", "nodes", "numNodes", "minX", "minY", "maxX", "maxY", "sumX", "sumY", "node", "mid", "drawStraightWireLine", "__x", "__y", "LinkManager", "useRibbons", "ribbon", "nodeFrom", "x1", "y1", "editor", "x2", "y2", "outgoingOrient", "a1x", "a1y", "a2x", "a2y", "strokeWireOutlineAndSingleValue", "drawable", "drawAnchorTo", "COLOR_ANCHOR_NEW", "tryOffset", "comp", "anchorBeingSetFrom", "from", "to", "forbidden", "current", "newNode", "otherNode", "otherStartNode", "dx2", "dy2", "midpointX", "midpointY", "addToX", "dir", "calcOffsetFromDim", "dim", "GRID_STEP", "isVertical", "waypointX", "waypointY", "startGroup", "endGroup", "findWire", "group1", "i1", "group2", "i2", "indexStart", "indexEnd", "wireBefore", "oldStartNode", "oldEndNode", "tryMakeRepeatableNodeAction", "wireProlongDirection", "distX", "distY", "PostLoadActions_None", "PostLoadActions_SnapshotStorage", "PostLoadActions_SnapshotNoStorage", "_Serialization", "editor", "jsonStr", "blob", "filename", "content", "postLoadActions", "opts", "parsed", "isString", "JSONParseObject", "err", "parent", "offsetPos", "isArray", "ceil10", "__name", "x", "compReprs", "isRecord", "nodeMapping", "components", "componentsByRef", "migrateData", "numLoaded", "S", "parsed_", "_a", "_b", "_c", "componentList", "stringifySmart", "elem", "immediateWirePropagation", "testSuiteReprs", "validateJson", "TestSuite", "testSuites", "ts", "skipStorage", "scratch", "customComp_", "customComp", "error", "unhandledData", "keysOf", "anchorsToSet", "add", "repr", "anchor", "factory", "compRepr", "id", "comp", "anchorRef", "wires", "linkMgr", "nodeMgr", "recalcMgr", "obj", "wireData", "Wire", "nodeID1", "nodeID2", "wireOptions", "node1", "node2", "completedWire", "dataObject", "CurrentFormatVersion", "editorRoot", "LogicEditor", "sourcePos", "nodeIn", "wire", "w", "showOnly", "_dataObject", "compact", "JSON5", "parts", "stringifyCompactReprTo", "defs", "defparts", "def", "circuit", "subpart", "compparts", "stringifyComponentWiresTestsReprsTo", "circuitRepr", "scratchparts", "unprocessedFields", "Serialization", "container", "key", "value", "stringifyKey", "outerLevel", "noWireDelay", "outerIndent", "innerIndent", "entries", "comps", "subparts", "wireOpts", "allValuesUndefined", "tests", "innerIndent2", "testSuiteRepr", "Cases", "testCases", "testCasesReprStrs", "testCase", "s", "baseSuiteRepr", "sep", "casesRepr", "stringOrChar", "passedObj", "options", "indent", "maxLength", "replacer", "_stringify", "currentIndent", "reserved", "string", "length", "prettified", "match", "stringLiteral", "nextIndent", "items", "index", "start", "end", "keys", "keyPart", "quoteString", "firstChar", "i", "replacements", "quotes", "product", "c", "hexString", "quoteChar", "a", "b", "t", "t", "Gate1Types", "RichStringEnum", "in_", "Unknown", "S", "Gate1TypeRepr", "Gate2toNTypes", "logicAnd", "logicOr", "logicXor", "ins", "LogicValue", "Gate2toNTypeRepr", "Gate2OnlyTypes", "logicImply", "Gate2OnlyTypeRepr", "GateNTypes", "GateNTypeRepr", "HighImpedance", "__name", "count", "in1", "in0", "ALUDef", "defineParametrizedComponent", "bits", "ext", "typeOrUndefined", "param", "paramBool", "numBits", "usesExtendedOpcode", "gridWidth", "gridHeight", "inputCenterY", "outputX", "bottom", "top", "topGroup", "groupHorizontal", "cin", "opMode", "groupVertical", "S", "saved", "ArrayFillWith", "ALUOp", "op", "ALUOps", "ALUOpsReduced", "ALU", "ParametrizedComponentBase", "parent", "params", "_a", "s", "opDesc", "isUnknown", "tooltipContent", "mods", "div", "opValues", "opIndex", "displayValuesFromArray", "Unknown", "a", "b", "doALUOp", "newValue", "allZeros", "g", "ctx", "bounds", "left", "right", "lowerTop", "GRID_STEP", "input", "drawWireLineToComponent", "output", "COLOR_BACKGROUND", "opGroupHeight", "opGroupLeft", "opGroupRight", "opGroupLeftTop", "opGroupRightTop", "COLOR_GROUP_SPAN", "COLOR_COMPONENT_INNER_LABELS", "carryHOffsetF", "Orientation", "drawLabel", "opName", "size", "COLOR_COMPONENT_BORDER", "fillTextVAlign", "TextVAlign", "showOp", "icon", "MenuData", "__name", "vals", "v", "isHighImpedance", "doALUAdd", "doALUSub", "cout", "doALUBinOp", "doALUNot", "sum3bits", "c", "asNumber", "numUnset", "sum", "cins", "i", "ss", "isBoolean", "toInt", "vs", "col", "aInt", "bInt", "yInt", "yBinStr", "lastIdx", "aNeg", "bNeg", "yNeg", "not", "Gate1Types", "ArrayFillUsing", "func", "Gate2toNTypes", "AdderDef", "defineComponent", "s", "S", "Adder", "ComponentBase", "parent", "saved", "tooltipContent", "mods", "div", "a", "b", "cIn", "isUnknown", "isHighImpedance", "Unknown", "newValue", "g", "ctx", "COLOR_COMPONENT_BORDER", "fillTextVAlign", "TextVAlign", "__name", "t", "AdderArrayDef", "defineParametrizedComponent", "bits", "typeOrUndefined", "param", "numBits", "ALUDef", "gridHeight", "inputCenterY", "coutY", "cinY", "groupVertical", "saved", "ArrayFillWith", "AdderArray", "ParametrizedComponentBase", "parent", "params", "s", "S", "tooltipContent", "mods", "div", "a", "b", "cin", "doALUAdd", "newValue", "g", "ctx", "COLOR_COMPONENT_BORDER", "fillTextVAlign", "TextVAlign", "__name", "t", "t", "InputBase", "ParametrizedComponentBase", "parent", "SubclassDef", "saved", "_a", "x", "y", "distSquared", "INPUT_OUTPUT_DIAMETER", "inRect", "newValue", "g", "ctx", "output", "drawWireLineToComponent", "displayValue", "Unknown", "shouldDrawBorder", "COLOR_COMPONENT_BORDER", "triangleLeft", "triangleRight", "triangleVOffset", "triangle", "colorForLogicValue", "circle", "drawComponentName", "toLogicValueRepr", "forcedFillStyle", "drawValueTextCentered", "outputs", "bounds", "left", "top", "width", "outline", "COLOR_BACKGROUND", "displayValues", "ArrayFillWith", "drawMouseOver", "cellHeight", "useCompact", "GRID_STEP", "i", "valueString", "drawValueText", "newLinks", "outNode", "comp", "inNode", "NodeIn", "isTrivialNodeName", "Orientation", "__isPushButton", "name", "__name", "InputDef", "defineParametrizedComponent", "ComponentTypeInput", "bits", "typeOrUndefined", "InputOutputValueRepr", "ComponentNameRepr", "param", "numBits", "d", "groupVertical", "valuesFromReprForInput", "Input", "params", "_b", "undefinedIfTrivial", "reprForLogicValues", "mode", "s", "S", "tooltipContent", "mods", "out", "w", "result", "InteractionResult", "altKey", "doChange", "nextValue", "h", "v", "e", "newValues", "values", "isPushButton", "isConstant", "makeItemBehaveAs", "desc", "value", "isCurrent", "icon", "action", "MenuData", "newItems", "makeToggleConstantItem", "replaceWithClockItem", "ClockDef", "HighImpedance", "ClockDef", "defineComponent", "ComponentNameRepr", "typeOrUndefined", "Clock", "InputBase", "parent", "saved", "_a", "_b", "s", "S", "tooltipContent", "mods", "br", "emptyMod", "logicalTime", "timeOverPeriod", "onDuration", "offDuration", "value", "timeOverLastTick", "nextTick", "timeline", "desc", "g", "ctx", "offsetY", "COLOR_COMPONENT_BORDER", "left", "mid1", "mid2", "right", "bottom", "top", "periodStr", "fillTextVAlign", "TextVAlign", "period", "periodPresets", "matchesSomePreset", "makeItemSetPeriod", "__name", "data", "isCurrent", "icon", "MenuData", "presetPeriodItems", "customPeriodItem", "replaceWithInputItem", "InputDef", "newPeriodStr", "newPeriod", "ComparatorDef", "defineComponent", "Comparator", "ComponentBase", "parent", "saved", "s", "S", "tooltipContent", "mods", "div", "a", "b", "e", "isUnknown", "isHighImpedance", "Unknown", "g", "eq", "newValue", "ctx", "COLOR_COMPONENT_BORDER", "fillTextVAlign", "TextVAlign", "__name", "t", "ControlledInverterDef", "defineParametrizedComponent", "bits", "bottom", "typeOrUndefined", "param", "paramBool", "numBits", "controlPinsAtBottom", "gridHeight", "groupVertical", "saved", "ArrayFillWith", "ControlledInverter", "ParametrizedComponentBase", "parent", "params", "s", "S", "tooltipContent", "mods", "div", "input", "switch_", "isUnknown", "isHighImpedance", "Unknown", "LogicValue", "newValue", "g", "ctx", "top", "left", "right", "invert", "colorForLogicValue", "COLOR_COMPONENT_BORDER", "COLOR_UNKNOWN", "circle", "__name", "t", "t", "FlipflopOrLatchDef", "defineAbstractComponent", "typeOrUndefined", "LogicValueRepr", "s", "S", "saved", "defaults", "state", "toLogicValue", "LogicValue", "FlipflopOrLatch", "ComponentBase", "parent", "SubclassDef", "_a", "toLogicValueRepr", "newValue", "showContent", "g", "ctx", "COLOR_BACKGROUND_INVALID", "x", "y", "width", "height", "swapHeightWidth", "COLOR_COMPONENT_BORDER", "value", "cellHeight", "colorForLogicValue", "drawValueText", "__name", "FlipflopBaseDef", "EdgeTrigger", "clockYOffset", "base", "Flipflop", "Unknown", "comp", "prevClock", "clock", "preset", "clear", "trigger", "isInInvalidState", "newState", "val", "icon", "toggleShowContentItem", "MenuData", "makeTriggerItems", "currentTrigger", "handler", "makeTriggerItem", "desc", "isCurrent", "caption", "action", "CounterDef", "defineParametrizedComponent", "bits", "typeOrUndefined", "EdgeTrigger", "typeOrNull", "param", "numBits", "useCompact", "gridWidth", "gridHeight", "s", "S", "outX", "groupQ", "groupVertical", "lastQY", "qyDiff", "clockVY", "clearY", "saved", "Counter", "ParametrizedComponentBase", "parent", "params", "_a", "Unknown", "ArrayFillWith", "value", "width", "binStr", "asBits", "i", "__", "currentCountOrUnknown", "displayValuesFromArray", "currentCount", "isUnknown", "displayRadix", "tooltipContent", "mods", "div", "prevClock", "clock", "activeOverflowValue", "Flipflop", "newValue", "counter", "overflow", "trigger", "g", "ctx", "stringRep", "formatWithRadix", "labelMargin", "valueCenter", "COLOR_EMPTY", "frameWidth", "FlipflopOrLatch", "COLOR_LABEL_OFF", "fillTextVAlign", "TextVAlign", "makeItemShowRadix", "__name", "desc", "icon", "caption", "action", "MenuData", "makeTriggerItems", "t", "ComponentList", "ArrayFillUsing", "compList", "comp", "i", "zIndex", "z", "id", "oldComp", "idForOldComp", "type", "CustomComponent", "newId", "oldId", "comp1", "comp2", "id1", "id2", "ref", "prefix", "suffix", "prefixFromDef", "isString", "c", "cond", "onlyOne", "deletedComps", "outer", "anchored", "__name", "NodeManager", "sourceId", "newId", "node", "id", "mapping", "_a", "mappedId", "f", "comp", "linkMgr", "addedConnections", "nodeX", "nodeY", "component", "other", "__name", "RedrawManager", "req", "_a", "_b", "_c", "_d", "compObj", "compList", "redrawReasons", "getReasons", "__name", "reasonParts", "reason", "linkedComps", "comp", "compAny", "redrawMask", "invalidateTests", "RecalcManager", "forcePropagate", "round", "roundLimit", "r", "propagateQueue", "c", "e", "recalcQueue", "msg", "SVGRenderingContext", "optionsOrWidth", "height", "Path2DSVG", "_a", "_b", "_c", "_d", "options", "metadata", "textNode", "elementName", "properties", "resetFill", "element", "key", "value", "node", "styleState", "STYLES", "matrix", "a", "b", "c", "d", "e", "f", "elem", "type", "style", "CanvasPatternSVG", "id", "CanvasGradientSVG", "matches", "opacity", "attr", "scale", "fixNamedEntities", "serialized", "namedEntities", "regexp", "className", "group", "parent", "path", "x", "y", "width", "cp1x", "cp1y", "cp2x", "cp2y", "cpx", "cpy", "radius", "startAngle", "endAngle", "counterClockwise", "x1", "y1", "x2", "y2", "radiusX", "radiusY", "rotation", "path2d", "action", "pathElement", "rect", "rootGroup", "dashArray", "s", "fillRule", "clipPath", "randomString", "args", "image", "dx", "dy", "dw", "dh", "sx", "sy", "sw", "sh", "svg", "defs", "svgImage", "canvas", "text", "el", "valign", "getDominantBaseline", "textElement", "getTextAnchor", "arg", "grad", "x0", "y0", "r0", "r1", "__repetition", "pattern", "img", "am", "m", "angle", "__name", "g", "isString", "transform", "tx", "ty", "cmd", "tcp1x", "tcp1y", "tcp2x", "tcp2y", "tcpx", "tcpy", "endX", "endY", "startX", "startY", "sweepFlag", "largeArcFlag", "diff", "scaleX", "scaleY", "endx", "endy", "p1p0", "p1p2", "p1p0_length", "p1p2_length", "cos_phi", "factor_max", "ep", "tangent", "factor_p1p0", "t_p1p0", "orth_p1p0", "orth_p1p0_length", "factor_ra", "p", "sa", "anticlockwise", "factor_p1p2", "t_p1p2", "orth_p1p2", "orth_p1p2_length", "ea", "currentTransform", "gradientElem", "_ctx", "offset", "color", "stop", "patternElem", "holder", "chars", "randomstring", "i", "_textAnchorMapping", "textAlign", "_dominantBaselineMapping", "textBaseline", "createNamedToNumberedLookup", "itemsStr", "radix", "lookup", "items", "entity", "base10", "t", "OutputDef", "defineParametrizedComponent", "ComponentTypeOutput", "bits", "typeOrUndefined", "ComponentNameRepr", "InputDef", "numBits", "d", "INPUT_OUTPUT_DIAMETER", "GRID_STEP", "useCompact", "groupVertical", "saved", "ArrayFillWith", "Output", "ParametrizedComponentBase", "parent", "params", "_a", "x", "y", "distSquared", "undefinedIfTrivial", "reprForLogicValues", "s", "S", "tooltipContent", "mods", "g", "ctx", "input", "drawWireLineToComponent", "triangle", "valueToShow", "Unknown", "colorForLogicValue", "circle", "drawComponentName", "toLogicValueRepr", "drawValueTextCentered", "inputs", "bounds", "left", "top", "width", "outline", "COLOR_BACKGROUND", "displayValues", "drawMouseOver", "COLOR_COMPONENT_BORDER", "cellHeight", "i", "valueString", "drawValueText", "newLinks", "inNode", "comp", "outNode", "NodeOut", "group", "isTrivialNodeName", "Orientation", "name", "MenuData", "__name", "CustomComponentPrefix", "CustomComponentImageWidth", "CustomComponentImageHeight", "CustomComponentDefRepr", "typeOrUndefined", "Wire", "CustomComponentDef", "data", "_a", "_b", "_c", "totalIn", "totalOut", "components", "id", "repr_", "repr", "isIn", "isOut", "inOutRepr", "name", "isString", "orient", "Orientations", "Orientation", "numBits", "sourcePos", "isArray", "sortInputsOutputs", "spec", "caption", "minSize", "type", "alsoIndirect", "compReprs", "whitelist", "compRepr", "compType", "factory", "customId", "parent", "comp", "CustomComponent", "validated", "validateJson", "CustomComponentRepr", "width", "height", "g", "SVGRenderingContext", "maxHeight", "stdSep", "drawInsOuts", "__name", "n", "left", "right", "sep", "top", "i", "maxDrawnIO", "drawCaption", "shortened", "fontSize", "textWidth", "scale", "fillTextVAlign", "TextVAlign", "defineComponent", "gridWidth", "gridHeight", "bottom", "starts", "counts", "make", "x", "f", "nextPos", "groupHorizontal", "groupVertical", "ins", "outs", "ArrayFillWith", "ComponentRepr", "ComponentBase", "customDef", "saved", "ComponentList", "TestSuites", "NodeManager", "LinkManager", "RecalcManager", "error", "Serialization", "tools", "iIn", "Input", "num", "j", "Output", "setSpawning", "clone", "newDef", "bitOffset", "inputComp", "ArrayFillUsing", "outputs", "outputComp", "newValue", "s", "S", "tooltipContent", "mods", "b", "span", "div", "ctx", "COLOR_COMPONENT_BORDER", "MenuData", "result", "showOnly", "UIPermissions", "InteractionResult", "LogicEditor", "insOuts", "orientValue", "criterion", "a", "t", "DecoderDef", "defineParametrizedComponent", "bits", "typeOrUndefined", "param", "numTo", "numFrom", "groupVertical", "saved", "ArrayFillWith", "Decoder", "ParametrizedComponentBase", "parent", "params", "s", "S", "tooltipContent", "mods", "div", "addrArr", "displayValuesFromArray", "addr", "isUnknown", "Unknown", "output", "g", "ctx", "COLOR_COMPONENT_BORDER", "fillTextVAlign", "TextVAlign", "newValue", "MenuData", "__name", "Decoder16SegDef", "defineComponent", "group", "FixedArrayFillWith", "Decoder16Seg", "ComponentBase", "parent", "saved", "tooltipContent", "mods", "div", "S", "input", "__", "value", "displayValuesFromArray", "output", "isUnknown", "Unknown", "line", "DECODER_MAPPING", "i", "newValue", "g", "ctx", "bounds", "left", "right", "COLOR_COMPONENT_INNER_LABELS", "drawLabel", "__name", "Decoder7SegDef", "defineComponent", "group", "FixedArrayFillWith", "Decoder7Seg", "ComponentBase", "parent", "saved", "tooltipContent", "mods", "div", "S", "input", "__", "value", "displayValuesFromArray", "output", "isUnknown", "Unknown", "newValue", "__name", "DecoderBCD4Def", "defineComponent", "group", "groupVertical", "FixedArrayFillWith", "DecoderBCD4", "ComponentBase", "parent", "saved", "tooltipContent", "mods", "div", "S", "input", "__", "value", "displayValuesFromArray", "output", "isUnknown", "Unknown", "newValue", "__name", "t", "DemuxDef", "defineParametrizedComponent", "from", "to", "bottom", "typeOrUndefined", "param", "paramBool", "numTo", "numGroups", "numSel", "numFrom", "gridWidth", "spacing", "useCompact", "addByGroupSep", "numLeftSlots", "gridHeight", "controlPinsAtBottom", "outX", "inX", "groupOfOutputs", "groupVerticalMulti", "firstInputY", "lastGroup", "lastInputY", "selY", "groupVertical", "groupHorizontal", "saved", "ArrayFillWith", "Demux", "ParametrizedComponentBase", "parent", "params", "_a", "_b", "tooltipContent", "mods", "div", "S", "sels", "sel", "displayValuesFromArray", "isUnknown", "Unknown", "values", "disconnected", "HighImpedance", "g", "inputs", "input", "i", "newValues", "ctx", "top", "left", "right", "dy", "drawWireLineToComponent", "outputGroup", "output", "outline", "COLOR_BACKGROUND", "neutral", "selectedOutputs", "anchorDiffX", "wireStyle", "wireStyleBezier", "WireStyles", "timeFraction", "fromNode", "fromY", "toY", "strokeWireOutlineAndSingleValue", "showWiring", "disconnectedAsHighZ", "s", "icon", "toggleShowWiringItem", "MenuData", "toggleUseHighZItem", "x", "__name", "t", "DisplayDef", "defineParametrizedComponent", "bits", "typeOrUndefined", "ComponentNameRepr", "param", "numBits", "useCompact", "gridWidth", "inX", "groupVertical", "saved", "repeatString", "Display", "ParametrizedComponentBase", "parent", "params", "_a", "_b", "_c", "s", "S", "radixStr", "binaryStringRep", "value", "sParams", "tooltipContent", "mods", "div", "b", "isUnknown", "emptyMod", "displayValuesFromArray", "g", "ctx", "maxValue", "background", "COLOR_UNKNOWN", "colorForFraction", "width", "height", "isVertical", "Orientation", "backColorComps", "colorCompsRGB", "textColor", "ColorString", "hasSpaces", "spacedStringRep", "insertSpaces", "fillTextVAlign", "TextVAlign", "mainSize", "stringRep", "Unknown", "formatWithRadix", "superChange", "mode", "InteractionResult", "name", "showAsUnknown", "radix", "makeItemShowAs", "__name", "desc", "handler", "isCurrent", "icon", "caption", "action", "MenuData", "makeItemShowRadix", "result", "i", "n", "re", "reverseString", "str", "t", "t", "LedColors", "DisplayBarTypes", "ledColorForLogicValue", "v", "onColor", "isUnknown", "COLOR_UNKNOWN", "isHighImpedance", "COLOR_HIGH_IMPEDANCE", "COLOR_LED_ON", "COLOR_WIRE_BORDER", "__name", "DisplayBarBase", "ComponentBase", "parent", "SubclassDef", "transparentDefault", "saved", "_a", "_b", "_c", "DisplayBarDef", "name", "color", "transparent", "s", "S", "makeItemUseColor", "desc", "isCurrent", "icon", "action", "cssColor", "MenuData", "span", "title", "style", "itemTransparent", "defineComponent", "typeOrUndefined", "ComponentNameRepr", "DisplayBar", "expl", "Unknown", "HighImpedance", "mods", "asValue", "tooltipContent", "g", "ctx", "valueToShow", "background", "COLOR_TRANSPARENT", "toLogicValueRepr", "GRID_STEP", "superChange", "InteractionResult", "newDisplay", "width", "input", "pxToGrid", "makeItemShowAs", "display", "Display16SegDef", "defineComponent", "typeOrUndefined", "LedColors", "ComponentNameRepr", "group", "ArrayFillWith", "Display16Seg", "DisplayBarBase", "parent", "saved", "tooltipContent", "mods", "div", "S", "g", "ctx", "toLogicValueRepr", "left", "right", "top", "bottom", "a1", "a2", "b", "c", "d2", "d1", "e", "f", "g1", "g2", "h", "i", "j", "k", "l", "m", "p", "vMargin", "strokeHalfWidth", "drawLeft", "drawRight", "drawCenterX", "drawTop", "drawBottom", "doFill", "__name", "v", "ledColorForLogicValue", "drawH", "xLeft", "xRight", "y", "drawV", "x", "yTop", "yBottom", "dx", "dy", "drawBackslash", "drawSlash", "COLOR_OFF_BACKGROUND", "slashTop", "slashBottom", "radius", "t", "Display7SegDef", "defineComponent", "typeOrUndefined", "LedColors", "ComponentNameRepr", "group", "ArrayFillWith", "Display7Seg", "DisplayBarBase", "parent", "saved", "tooltipContent", "mods", "div", "S", "g", "ctx", "toLogicValueRepr", "left", "right", "top", "bottom", "a", "b", "e", "f", "gg", "p", "hMargin", "vMargin", "strokeHalfWidth", "drawLeft", "drawRight", "drawTop", "drawBottom", "doFill", "__name", "v", "ledColorForLogicValue", "drawH", "y", "drawV", "x", "yTop", "yBottom", "COLOR_OFF_BACKGROUND", "radius", "t", "DisplayAsciiDef", "defineComponent", "ComponentNameRepr", "typeOrUndefined", "groupVertical", "DisplayAscii", "ComponentBase", "parent", "saved", "_a", "_b", "_c", "s", "S", "binaryStringRep", "value", "tooltipContent", "mods", "div", "b", "emptyMod", "isUnknown", "values", "displayValuesFromArray", "g", "ctx", "mainText", "mainTextFont", "mainTextStyle", "COLOR_COMPONENT_BORDER", "COLOR_UNKNOWN", "width", "height", "isVertical", "Orientation", "hasAdditionalRepresentation", "mainTextPosY", "fillTextVAlign", "TextVAlign", "additionalRepr", "formatWithRadix", "n", "superChange", "mode", "InteractionResult", "name", "showAsUnknown", "additionalReprRadix", "makeItemShowAs", "__name", "desc", "handler", "isCurrent", "icon", "MenuData", "makeItemShowRadix", "radix", "FlipflopDDef", "defineComponent", "FlipflopBaseDef", "base", "s", "S", "FlipflopD", "Flipflop", "parent", "saved", "tooltipContent", "mods", "div", "LogicValue", "__name", "FlipflopJKDef", "defineComponent", "FlipflopBaseDef", "base", "s", "S", "FlipflopJK", "Flipflop", "parent", "saved", "tooltipContent", "mods", "div", "j", "k", "q", "LogicValue", "__name", "FlipflopTDef", "defineComponent", "FlipflopBaseDef", "base", "s", "S", "FlipflopT", "Flipflop", "parent", "saved", "tooltipContent", "mods", "div", "t", "isUnknown", "isHighImpedance", "Unknown", "q", "LogicValue", "__name", "t", "LEAD_LENGTH_NORMAL", "LEAD_LENGTH_OR_STYLE", "GateBase", "ParametrizedComponentBase", "parent", "SubclassDef", "type", "saved", "_a", "_b", "newType", "input", "isOrStyle", "leadLength", "ins", "node", "numBits", "iTopGate", "iBottomGate", "newPoseAs", "newUnknown", "inputs", "logicFunc", "newValue", "s", "S", "div", "myIns", "myOut", "gateProps", "genTruthTableData", "__name", "header", "ArrayFillUsing", "i", "rows", "valueCombinations", "matchesCurrent", "deepArrayEquals", "out", "desc", "explanation", "Unknown", "mods", "asValue", "fullShortDesc", "b", "explanationAndTable", "makeTruthTable", "makeGateTooltip", "g", "ctx", "gateType", "isFake", "output", "top", "left", "bottom", "right", "height", "drawArms", "armsOffset", "GRID_STEP", "useCompact", "armsTop", "armsBottom", "pi2", "nameDeltaX", "drawInversionCircle", "x", "y", "circle", "COLOR_BACKGROUND", "showAsFake", "gateBorderColor", "COLOR_MOUSE_OVER", "COLOR_DARK_RED", "COLOR_COMPONENT_BORDER", "gateFill", "PATTERN_STRIPED_GRAY", "drawWireLineToComponent", "arcBeginX", "armsHeight", "armsCurvature", "leftXorCurve", "delta", "gateRightSquare", "COLOR_UNKNOWN", "fillTextVAlign", "TextVAlign", "isUnknown", "gateShortName", "COLOR_GATE_NAMES", "oldTransform", "InteractionResult", "items", "adminMode", "replaceBy", "gateTypes", "otherTypes", "t", "MenuData", "oldType", "ref", "currentShowAsUnknown", "currentPoseAs", "validateGateType", "GateTypes", "typeFromParam", "typeFromJson", "defaultFromDef", "jsonTypeSuffix", "typeToValidate", "GateTypePrefix", "Gate1Def", "defineParametrizedComponent", "typeOrUndefined", "Gate1TypeRepr", "param", "paramType", "jsonType", "defaults", "Gate1Types", "Gate1", "params", "e", "superChange", "GateNDef", "bits", "GateNTypeRepr", "Gate2toNTypes", "GateNTypes", "groupVertical", "GateN", "Gate2OnlyTypes", "n", "curr", "max", "v", "htmlRows", "cells", "tr", "cls", "emptyMod", "td", "table", "thead", "title", "th", "tbody", "description", "numBitsDisplay", "maxWidth", "tooltipContent", "t", "GateArrayDef", "defineParametrizedComponent", "GateTypePrefix", "type", "bits", "typeOrUndefined", "param", "GateNTypes", "paramType", "jsonType", "defaults", "validateGateType", "AdderArrayDef", "numBits", "inputCenterY", "groupVertical", "saved", "ArrayFillWith", "GateArray", "ParametrizedComponentBase", "parent", "params", "_a", "s", "S", "opDesc", "tooltipContent", "mods", "div", "out", "a", "b", "ArrayFillUsing", "i", "newValue", "g", "ctx", "left", "right", "COLOR_UNKNOWN", "fillTextVAlign", "TextVAlign", "COLOR_COMPONENT_BORDER", "top", "GRID_STEP", "bottom", "gateLeft", "gateRight", "pi2", "drawRightCircle", "__name", "circle", "drawLeftCircle", "up", "savedGateLeft", "newSubtype", "showAsUnknown", "typeItems", "subtypes", "t", "subtype", "MenuData", "icon", "items", "showAsUnknownItem", "HalfAdderDef", "defineComponent", "s", "S", "HalfAdder", "ComponentBase", "parent", "saved", "tooltipContent", "mods", "div", "a", "b", "isUnknown", "isHighImpedance", "Unknown", "newValue", "g", "ctx", "COLOR_COMPONENT_BORDER", "fillTextVAlign", "TextVAlign", "__name", "t", "LabelDef", "defineComponent", "typeOrUndefined", "FONT_LABEL_DEFAULT", "Label", "ComponentBase", "parent", "saved", "_a", "_b", "GRID_STEP", "metrics", "DrawZIndex", "g", "ctx", "width", "height", "COLOR_COMPONENT_BORDER", "fillTextVAlign", "TextVAlign", "text", "font", "s", "S", "setTextItem", "MenuData", "setFontItem", "promptReturnValue", "newText", "InteractionResult", "superChange", "__name", "LatchSRDef", "defineComponent", "FlipflopOrLatchDef", "base", "s", "S", "LatchSR", "FlipflopOrLatch", "parent", "saved", "tooltipContent", "mods", "div", "r", "q", "LogicValue", "icon", "MenuData", "__name", "t", "MuxDef", "defineParametrizedComponent", "from", "to", "bottom", "typeOrUndefined", "param", "paramBool", "numFrom", "numGroups", "numSel", "numTo", "gridWidth", "spacing", "useCompact", "addByGroupSep", "numLeftSlots", "gridHeight", "controlPinsAtBottom", "outX", "inX", "groupOfInputs", "groupVerticalMulti", "firstInputY", "lastGroup", "lastInputY", "selY", "groupHorizontal", "groupVertical", "saved", "ArrayFillWith", "Mux", "ParametrizedComponentBase", "parent", "params", "_a", "tooltipContent", "mods", "div", "S", "sels", "sel", "displayValuesFromArray", "isUnknown", "Unknown", "newValues", "g", "ctx", "top", "left", "right", "dy", "inputGroup", "input", "drawWireLineToComponent", "output", "COLOR_BACKGROUND", "outline", "neutral", "selectedInputs", "anchorDiffX", "wireStyle", "wireStyleBezier", "WireStyles", "timeFraction", "i", "fromY", "toNode", "toY", "strokeWireOutlineAndSingleValue", "showWiring", "s", "icon", "toggleShowWiringItem", "MenuData", "x", "__name", "t", "PixelDef", "defineParametrizedComponent", "bits", "gray", "touch", "typeOrUndefined", "param", "paramBool", "numBits", "size", "useCompact", "isGray", "isTouch", "gridWidth", "offset", "groupHorizontal", "groupVertical", "COLORCOMPS_UNKNOWN", "Pixel", "ParametrizedComponentBase", "parent", "params", "saved", "_a", "x", "y", "s", "S", "tooltipContent", "mods", "pressed", "___", "grayOrGreen", "displayValuesFromArray", "color", "isUnknown", "__", "red", "____", "blue", "newValue", "g", "ctx", "r_", "g_", "b_", "maxVal", "colorComp", "__name", "c", "outerColor", "innerColor", "bounds", "width", "height", "padding", "full", "toggleFullItems", "MenuData", "result", "superCursor", "t", "import_file_saver", "t", "ROMRAMDef", "typeOrUndefined", "param", "bits", "lines", "numAddressBits", "numWords", "numDataBits", "gridHeight", "addrTopOffset", "groupHorizontal", "groupVertical", "saved", "ROMRAMBase", "mem", "out", "ParametrizedComponentBase", "parent", "SubclassDef", "params", "_a", "_b", "RAMDef", "v", "i", "ArrayFillWith", "stringRep", "splitContent", "isArray", "row", "valuesFromBinaryOrHexRepr", "delim", "trimEnd", "cells", "useHex", "hexWidth", "addr", "word", "wordRepr", "allBooleans", "hexStringRepr", "binaryStringRepr", "numToSkip", "isAllZeros", "addrBits", "__", "displayValuesFromArray", "newValue", "showContent", "g", "ctx", "width", "height", "contentBottom", "labelCenter", "COLOR_COMPONENT_BORDER", "fillTextVAlign", "TextVAlign", "numWordsStr", "isVertical", "Orientation", "canUseTwoCols", "addressedContentHeight", "contentCenterY", "availWidth", "availHeight", "arrowWidth", "useTwoCols", "cellHeight", "cellWidth", "drawMemoryCells", "isUnknown", "Unknown", "repr", "formatWithRadix", "additionalReprRadix", "s", "S", "sg", "ss", "makeItemShowRadix", "__name", "radix", "desc", "icon", "MenuData", "editContentItem", "current", "promptReturnValue", "RAM", "saveContentItem", "blob", "filename", "loadContentItem", "file", "content", "swapROMRAMItem", "isROM", "ROM", "newComp", "ROMDef", "InteractionResult", "additionalDisplayItems", "toggleShowContentItems", "start", "end", "centerX", "centerY", "numCellsToDraw", "contentTop", "contentLeft", "contentRight", "COLOR_EMPTY", "j", "colorForLogicValue", "y", "strokeSingleLine", "x", "borderLineWidth", "arrowY", "arrowRight", "arrowHalfHeight", "defineParametrizedComponent", "tooltipContent", "mods", "div", "RAMDef", "defineParametrizedComponent", "bits", "lines", "ROMRAMDef", "typeOrUndefined", "EdgeTrigger", "params", "defaults", "base", "numDataBits", "gridHeight", "bottomOffset", "clockYOffset", "s", "S", "groupVertical", "RAM", "ROMRAMBase", "parent", "saved", "_a", "Unknown", "trigger", "clear", "numWords", "addr", "prevClock", "clock", "oldState", "Flipflop", "out", "isUnknown", "ArrayFillWith", "newData", "LogicValue", "newState", "i", "tooltipContent", "mods", "div", "makeTriggerItems", "MenuData", "__name", "t", "t", "RegisterBaseDef", "typeOrUndefined", "EdgeTrigger", "param", "bits", "numBits", "gridHeight", "bottomOffset", "clockYOffset", "topOffset", "S", "groupVertical", "saved", "content", "ArrayFillWith", "valuesFromBinaryOrHexRepr", "RegisterBase", "ParametrizedComponentBase", "parent", "SubclassDef", "params", "_a", "_b", "Unknown", "RegisterDef", "undefinedIfTrivial", "hexWidth", "repr", "allBooleans", "hexStringRepr", "binaryStringRepr", "isAllZeros", "prevClock", "clock", "isInInvalidState", "newState", "Flipflop", "val", "newValue", "showContent", "trigger", "g", "ctx", "Orientation", "outputs", "posX", "swapHeightWidth", "cellHeight", "useCompact", "GRID_STEP", "output", "FlipflopOrLatch", "s", "icon", "toggleShowContentItem", "MenuData", "makeTriggerItems", "__name", "defineParametrizedComponent", "paramBool", "inc", "defaults", "base", "baseClear", "Register", "tooltipContent", "mods", "div", "_c", "_d", "dec", "isUnknown", "isHighImpedance", "__", "displayValuesFromArray", "newVal", "Counter", "LogicValue", "COLOR_COMPONENT_BORDER", "fillTextVAlign", "TextVAlign", "saturating", "toggleSaturatingItem", "RandomDef", "defineParametrizedComponent", "bits", "typeOrUndefined", "EdgeTrigger", "ComponentNameRepr", "param", "numBits", "useCompact", "gridHeight", "s", "S", "groupVertical", "saved", "ArrayFillWith", "Random", "ParametrizedComponentBase", "parent", "params", "_a", "_b", "_c", "Unknown", "tooltipContent", "prevClock", "clock", "Flipflop", "ArrayFillUsing", "__name", "newValue", "g", "ctx", "outputValues", "displayValuesFromArray", "top", "output", "FlipflopOrLatch", "RegisterBase", "Orientation", "isVertical", "COLOR_COMPONENT_INNER_LABELS", "probTextParts", "currentOffset", "offset", "part", "drawLabel", "probText", "name", "showProb", "icon", "MenuData", "t", "RectangleColor", "CaptionPosition", "RectangleDef", "defineComponent", "typeOrUndefined", "GRID_STEP", "FONT_LABEL_DEFAULT", "Rectangle", "ComponentBase", "parent", "saved", "_a", "_b", "_c", "_d", "_e", "_f", "_g", "_h", "_i", "_j", "DrawZIndex", "g", "ctx", "width", "height", "left", "top", "r", "COLOR_RECTANGLE_BACKGROUND", "COLOR_COMPONENT_BORDER", "metrics", "offsetV", "margin", "offsetH", "captionY", "captionX", "fillTextVAlign", "TextVAlign", "COLOR_RECTANGLE_BORDER", "color", "strokeWidth", "caption", "captionPos", "font", "s", "S", "currentSizeStr", "setSizeItem", "MenuData", "makeSetStrokeWidthItem", "__name", "desc", "icon", "makeItemUseColor", "isCurrent", "action", "fillColorProp", "roundedProp", "borderColor", "span", "title", "style", "toggleRoundedItem", "toggleNoFillItem", "setCaptionItemName", "setCaptionItem", "makeItemSetPlacement", "placement", "toggleCaptionInsideItems", "setFontItem", "promptReturnValue", "match", "parse", "dflt", "n", "w", "h", "selectedComps", "right", "bottom", "comp", "DrawableWithPosition", "tryX", "tryY", "x", "y", "newCaption", "__e", "InteractionResult", "t", "import_json5", "ShiftDisplayDecoders_", "v", "DisplayAscii", "ShiftDisplayDecoders", "RichStringEnum", "ShiftDisplayDef", "defineComponent", "typeOrUndefined", "EdgeTrigger", "s", "S", "saved", "incoming", "i", "c", "Unknown", "ShiftDisplay", "ComponentBase", "parent", "_a", "_b", "_c", "_d", "stateArray", "allBitsOf", "b", "toLogicValueRepr", "tooltipContent", "mods", "div", "JSON5", "prevClock", "clock", "oldValue", "Flipflop", "newBit", "decoder", "maxItems", "newIncoming", "valAsInt", "displayValuesFromArray", "newDecoded", "isUnknown", "trigger", "g", "ctx", "drawContents", "__name", "text", "toDraw", "COLOR_COMPONENT_INNER_LABELS", "COLOR_COMPONENT_BORDER", "fillTextVAlign", "TextVAlign", "decoded", "decodeAs", "toPad", "undecodedStr", "repeatString", "sep", "fullDecodedStr", "groupEvery", "offset", "decodedParts", "allBits", "value", "makeItemDecodeAs", "desc", "icon", "MenuData", "makeItemGroupEvery", "makeTriggerItems", "__stringRep", "bits", "ShiftRegisterDef", "defineParametrizedComponent", "bits", "RegisterBaseDef", "params", "defaults", "base", "lrYOffset", "ShiftRegister", "RegisterBase", "parent", "saved", "s", "S", "tooltipContent", "mods", "div", "dirIsRight", "isUnknown", "isHighImpedance", "Unknown", "d", "LogicValue", "current", "g", "COLOR_COMPONENT_BORDER", "fillTextVAlign", "TextVAlign", "__name", "t", "TristateBufferDef", "defineParametrizedComponent", "bottom", "typeOrUndefined", "paramBool", "controlPinsAtBottom", "HighImpedance", "TristateBuffer", "ParametrizedComponentBase", "parent", "params", "saved", "tooltipContent", "mods", "div", "S", "en", "isUnknown", "isHighImpedance", "Unknown", "i", "newValue", "g", "ctx", "drawWireLineToComponent", "top", "gateWidth", "GRID_STEP", "gateLeft", "gateRight", "COLOR_BACKGROUND", "COLOR_MOUSE_OVER", "COLOR_COMPONENT_BORDER", "__name", "t", "TristateBufferArrayDef", "defineParametrizedComponent", "bits", "bottom", "typeOrUndefined", "param", "paramBool", "ControlledInverterDef", "numBits", "controlPinsAtBottom", "gridHeight", "groupVertical", "saved", "ArrayFillWith", "HighImpedance", "TristateBufferArray", "ParametrizedComponentBase", "parent", "params", "s", "S", "tooltipContent", "mods", "div", "enable", "isUnknown", "isHighImpedance", "Unknown", "newValue", "g", "ctx", "top", "left", "right", "colorForLogicValue", "COLOR_COMPONENT_BORDER", "__name", "AllComponentDefs", "InputDef", "ClockDef", "RandomDef", "OutputDef", "DisplayDef", "Display7SegDef", "Display16SegDef", "DisplayAsciiDef", "DisplayBarDef", "PixelDef", "ShiftDisplayDef", "Gate1Def", "GateNDef", "GateArrayDef", "TristateBufferDef", "TristateBufferArrayDef", "ControlledInverterDef", "LabelDef", "RectangleDef", "PassthroughDef", "HalfAdderDef", "AdderDef", "ComparatorDef", "AdderArrayDef", "ALUDef", "MuxDef", "DemuxDef", "LatchSRDef", "FlipflopJKDef", "FlipflopTDef", "FlipflopDDef", "RegisterDef", "ShiftRegisterDef", "ROMDef", "RAMDef", "CounterDef", "DecoderDef", "Decoder7SegDef", "Decoder16SegDef", "DecoderBCD4Def", "ComponentFactory", "editor", "maker", "key", "parent", "obj_", "offsetPos", "isRecord", "JSON5", "obj", "isArray", "type", "isString", "elem", "compDataset", "paramsStr", "params", "Gate1Types", "GateNTypes", "hyphenPos", "typeStart", "CustomComponentPrefix", "customId", "defs", "def", "id", "compIds", "overwrite", "customid", "validatedDefs", "validateJson", "CustomComponentDefRepr", "numLoaded", "validatedDef", "CustomComponentDef", "s", "S", "MenuData", "compDef", "_a", "oldCaption", "oldType", "newCaption", "oldDefaultCustomId", "makeCustomIdFromCaption", "newCustomId", "newType", "compRepr", "selectionAll", "selectedComps", "e", "ComponentBase", "checkResult", "componentsToInclude", "caption", "labels", "Label", "components", "wires", "Serialization", "customDef", "customComp", "comp", "inputs", "outputs", "askName", "_b", "joiner", "inReprBuf", "outReprBuf", "mkDesc", "__name", "reprBuf", "inOut", "repr", "binaryStringRepr", "inputsStr", "outputsStr", "prompt", "testCaseName", "inMap", "input", "valuesReprForTest", "outMap", "output", "TestCaseCombinational", "max", "inputsByBit", "numInputs", "i", "setBit", "value", "bit", "newValues", "numCases", "result", "restoreAfter", "testCases", "j", "defRoot", "newComponents", "circuit", "newDef", "Input", "Output", "checkNames", "inOuts", "names", "missingNames", "name", "prefix", "queue", "node", "wire", "otherComp", "missingComponents", "missingCompsStr", "c", "uselessComponents", "uselessCompsStr", "Clock", "import_json5", "withButton", "ifShowOnly", "componentsMenu", "InputDef", "OutputDef", "DisplayBarDef", "PixelDef", "ClockDef", "DisplayDef", "Display7SegDef", "Display16SegDef", "DisplayAsciiDef", "RandomDef", "ShiftDisplayDef", "Gate1Def", "TristateBufferDef", "GateNDef", "ControlledInverterDef", "GateArrayDef", "TristateBufferArrayDef", "LabelDef", "RectangleDef", "PassthroughDef", "HalfAdderDef", "AdderDef", "ComparatorDef", "AdderArrayDef", "ALUDef", "MuxDef", "DemuxDef", "LatchSRDef", "FlipflopJKDef", "FlipflopTDef", "FlipflopDDef", "RegisterDef", "ShiftRegisterDef", "CounterDef", "RAMDef", "ROMDef", "DecoderDef", "Decoder7SegDef", "Decoder16SegDef", "DecoderBCD4Def", "ComponentMenu", "editor", "parent", "_a", "showOnly", "showOnlyBuf", "lastSectionNonEmpty", "section", "allButtons", "buttonsShowWithMore", "buttonsShowWithURLParam", "accessibleGateTypes", "makeButtons", "htmlSection", "type", "s", "_b", "defs", "oldSec", "button", "ids", "anyVisible", "show", "setVisible", "def", "icon", "makeSvgHolder", "CustomComponentImageWidth", "CustomComponentImageHeight", "caption", "compButton", "hiddenNow", "makeButton", "S", "makeSeparator", "nameKey", "numShowWithMoreButton", "separator", "div", "style", "raw", "header", "cls", "showMoreLink", "moreShown", "names", "a", "__name", "_c", "item", "normallyHidden", "stringsKey", "img", "isString", "compStrings", "titleStr", "captionStr", "hiddenByShowOnly", "componentIdsFor", "makeImage", "isGate", "GateTypePrefix", "gateType", "typeStr", "componentIds", "buttonIcon", "params", "isCustom", "shouldShow", "buttonStyle", "extraClasses", "customClasses", "emptyMod", "span", "buttonTitle", "title", "compDataset", "JSON5", "visible", "componentId", "showOnlySpec", "isMatch", "isWildcard", "matchesSpec", "ind", "defAndParams", "variants", "isArray", "deepObjectEquals", "MessageBar", "editor", "span", "style", "div", "cls", "msg", "duration", "withCloseButton", "applyModifierTo", "setVisible", "__name", "MoveManager", "editor", "drawable", "Waypoint", "DrawableWithPosition", "ComponentBase", "comp", "change", "emptyBefore", "emptyAfter", "_a", "_b", "num", "className", "__name", "Tests", "nibbles", "b", "c", "d", "__name", "representationsOf", "v", "str", "uint_", "displayValuesFromArray", "uint", "sint", "totalTests", "failedTests", "verbose", "cin", "a_str", "a_uint", "a_sint", "b_str", "b_uint", "b_sint", "sum", "v_sum", "c_sum", "doALUAdd", "diff", "v_diff", "c_diff", "doALUSub", "sum_str", "sum_uint", "sum_sint", "diff_str", "diff_uint", "diff_sint", "should_sum_uint", "should_c_sum", "carryError", "should_diff_uint", "borrowError", "should_sum_sint", "should_v_sum", "overflowError", "should_diff_sint", "should_v_diff", "overflowError2", "TestsPalette", "editor", "s", "S", "testsTitleElem", "div", "cls", "style", "data", "maxHeight", "visible", "setVisible", "parentSuites", "suite", "testSuite", "numExisting", "ui", "TestSuiteUI", "_a", "f", "options", "results", "testSuiteUI", "result", "circuit", "jsonStr", "Serialization", "__name", "palette", "tc", "makeVisibilityButton", "elem", "titleStr", "span", "title", "makeIcon", "runAllIcon", "p", "e", "newHidden", "isHidden", "setDisplay", "testCase", "editButton", "deleteButton", "nameSpan", "line", "details", "toggle", "force", "expanded", "container", "UIPermissions", "newName", "oldExpanded", "setHidden", "testResult", "i", "htmlResult", "compStr", "isString", "link", "a", "href", "failed", "tableBody", "tbody", "ins", "outs", "inStr", "mods", "outStr", "output", "expectedRepr", "outValue", "mismatch", "m", "reprForLogicValues", "tr", "td", "setTheseInputsButton", "table", "thead", "th", "areStatesEqual", "s1", "s2", "__name", "Timeline", "editor", "__", "_a", "nextTime", "nextCallbacks", "counts", "c", "desc", "count", "hasCallbacks", "enablesPause", "isPaused", "nextStepDesc", "time", "callback", "callbackRec", "i", "tickTime", "now", "waitDuration", "handle", "wantedTime", "callbacks", "late", "runAllCallbacks", "elem", "err", "nextTickTime", "currentPauseTime", "newState", "TopBar", "editor", "s", "S", "mods", "style", "title", "div", "cls", "input", "type", "attr", "zoomControl", "emptyMod", "undoMgr", "newState", "_a", "currentValue", "newName", "file", "e", "Serialization", "zoom", "validatedZoom", "getSepWidth", "__name", "MinSepWidth", "sepWidth", "rect", "state", "mode", "setDisplay", "setVisible", "showUndoRedo", "showToolButtons", "name", "show", "dirty", "setEnabled", "customDef", "showSubcircuitUI", "setActive", "enablesPause", "hasCallbacks", "isPaused", "nextStepDesc", "showTimelineUI", "canUndo", "canRedoOrRepeat", "t", "ms", "m", "h", "tool", "visible", "numHint", "newCaption", "modifiers", "icon", "labelTooltip", "handler", "tooltip", "label", "labelSpan", "span", "but", "button", "i", "raw", "inlineIconSvgFor", "link", "a", "fat", "caption", "top", "bottom", "right", "left", "auto", "basePlacements", "start", "end", "clippingParents", "viewport", "popper", "reference", "variationPlacements", "acc", "placement", "placements", "beforeRead", "read", "afterRead", "beforeMain", "main", "afterMain", "beforeWrite", "write", "afterWrite", "modifierPhases", "getNodeName", "element", "__name", "getWindow", "node", "ownerDocument", "__name", "isElement", "node", "OwnElement", "getWindow", "__name", "isHTMLElement", "isShadowRoot", "applyStyles", "_ref", "state", "name", "style", "attributes", "element", "isHTMLElement", "getNodeName", "value", "__name", "effect", "_ref2", "initialStyles", "styleProperties", "property", "attribute", "applyStyles_default", "getBasePlacement", "placement", "__name", "getBoundingClientRect", "element", "rect", "__name", "getLayoutRect", "element", "clientRect", "getBoundingClientRect", "width", "height", "__name", "contains", "parent", "child", "rootNode", "isShadowRoot", "next", "__name", "getComputedStyle", "element", "getWindow", "__name", "isTableElement", "element", "getNodeName", "__name", "getDocumentElement", "element", "isElement", "__name", "getParentNode", "element", "getNodeName", "isShadowRoot", "getDocumentElement", "__name", "getTrueOffsetParent", "element", "isHTMLElement", "getComputedStyle", "__name", "getContainingBlock", "isFirefox", "currentNode", "getParentNode", "getNodeName", "css", "getOffsetParent", "window", "getWindow", "offsetParent", "isTableElement", "getMainAxisFromPlacement", "placement", "__name", "max", "min", "round", "within", "min", "value", "max", "__name", "getFreshSideObject", "__name", "mergePaddingObject", "paddingObject", "getFreshSideObject", "__name", "expandToHashMap", "value", "keys", "hashMap", "key", "__name", "toPaddingObject", "__name", "padding", "state", "mergePaddingObject", "expandToHashMap", "basePlacements", "arrow", "_ref", "_state$modifiersData$", "name", "options", "arrowElement", "popperOffsets", "basePlacement", "getBasePlacement", "axis", "getMainAxisFromPlacement", "isVertical", "left", "right", "len", "paddingObject", "arrowRect", "getLayoutRect", "minProp", "top", "maxProp", "bottom", "endDiff", "startDiff", "arrowOffsetParent", "getOffsetParent", "clientSize", "centerToReference", "min", "max", "center", "offset", "within", "axisProp", "effect", "_ref2", "_options$element", "contains", "arrow_default", "unsetSides", "roundOffsetsByDPR", "_ref", "x", "y", "win", "dpr", "round", "__name", "mapToStyles", "_ref2", "_Object$assign2", "popper", "popperRect", "placement", "offsets", "position", "gpuAcceleration", "adaptive", "roundOffsets", "_ref3", "_ref3$x", "_ref3$y", "hasX", "hasY", "sideX", "left", "sideY", "top", "offsetParent", "getOffsetParent", "heightProp", "widthProp", "getWindow", "getDocumentElement", "getComputedStyle", "bottom", "right", "commonStyles", "_Object$assign", "computeStyles", "_ref4", "state", "options", "_options$gpuAccelerat", "_options$adaptive", "_options$roundOffsets", "transitionProperty", "getBasePlacement", "computeStyles_default", "passive", "effect", "_ref", "state", "instance", "options", "_options$scroll", "scroll", "_options$resize", "resize", "window", "getWindow", "scrollParents", "scrollParent", "__name", "eventListeners_default", "hash", "getOppositePlacement", "placement", "matched", "__name", "hash", "getOppositeVariationPlacement", "placement", "matched", "__name", "getWindowScroll", "node", "win", "getWindow", "scrollLeft", "scrollTop", "__name", "getWindowScrollBarX", "element", "getBoundingClientRect", "getDocumentElement", "getWindowScroll", "__name", "getViewportRect", "element", "win", "getWindow", "html", "getDocumentElement", "visualViewport", "width", "height", "x", "y", "getWindowScrollBarX", "__name", "getDocumentRect", "element", "_element$ownerDocumen", "html", "getDocumentElement", "winScroll", "getWindowScroll", "body", "width", "max", "height", "x", "getWindowScrollBarX", "y", "getComputedStyle", "__name", "isScrollParent", "element", "_getComputedStyle", "getComputedStyle", "overflow", "overflowX", "overflowY", "__name", "getScrollParent", "node", "getNodeName", "isHTMLElement", "isScrollParent", "getParentNode", "__name", "listScrollParents", "element", "list", "_element$ownerDocumen", "scrollParent", "getScrollParent", "isBody", "win", "getWindow", "target", "isScrollParent", "updatedList", "getParentNode", "__name", "rectToClientRect", "rect", "__name", "getInnerBoundingClientRect", "element", "rect", "getBoundingClientRect", "__name", "getClientRectFromMixedType", "clippingParent", "viewport", "rectToClientRect", "getViewportRect", "isHTMLElement", "getDocumentRect", "getDocumentElement", "getClippingParents", "clippingParents", "listScrollParents", "getParentNode", "canEscapeClipping", "getComputedStyle", "clipperElement", "getOffsetParent", "isElement", "contains", "getNodeName", "getClippingRect", "boundary", "rootBoundary", "mainClippingParents", "firstClippingParent", "clippingRect", "accRect", "max", "min", "getVariation", "placement", "__name", "computeOffsets", "_ref", "reference", "element", "placement", "basePlacement", "getBasePlacement", "variation", "getVariation", "commonX", "commonY", "offsets", "top", "bottom", "right", "left", "mainAxis", "getMainAxisFromPlacement", "len", "start", "end", "__name", "detectOverflow", "state", "options", "_options", "_options$placement", "placement", "_options$boundary", "boundary", "clippingParents", "_options$rootBoundary", "rootBoundary", "viewport", "_options$elementConte", "elementContext", "popper", "_options$altBoundary", "altBoundary", "_options$padding", "padding", "paddingObject", "mergePaddingObject", "expandToHashMap", "basePlacements", "altContext", "reference", "referenceElement", "popperRect", "element", "clippingClientRect", "getClippingRect", "isElement", "getDocumentElement", "referenceClientRect", "getBoundingClientRect", "popperOffsets", "computeOffsets", "popperClientRect", "rectToClientRect", "elementClientRect", "overflowOffsets", "offsetData", "offset", "key", "multiply", "right", "bottom", "axis", "top", "__name", "computeAutoPlacement", "state", "options", "_options", "placement", "boundary", "rootBoundary", "padding", "flipVariations", "_options$allowedAutoP", "allowedAutoPlacements", "placements", "variation", "getVariation", "variationPlacements", "basePlacements", "allowedPlacements", "overflows", "acc", "detectOverflow", "getBasePlacement", "a", "b", "__name", "getExpandedFallbackPlacements", "placement", "getBasePlacement", "auto", "oppositePlacement", "getOppositePlacement", "getOppositeVariationPlacement", "__name", "flip", "_ref", "state", "options", "name", "_options$mainAxis", "checkMainAxis", "_options$altAxis", "checkAltAxis", "specifiedFallbackPlacements", "padding", "boundary", "rootBoundary", "altBoundary", "_options$flipVariatio", "flipVariations", "allowedAutoPlacements", "preferredPlacement", "basePlacement", "isBasePlacement", "fallbackPlacements", "placements", "acc", "computeAutoPlacement", "referenceRect", "popperRect", "checksMap", "makeFallbackChecks", "firstFittingPlacement", "i", "_basePlacement", "isStartVariation", "getVariation", "start", "isVertical", "top", "bottom", "len", "overflow", "detectOverflow", "mainVariationSide", "right", "left", "altVariationSide", "checks", "check", "numberOfChecks", "_loop", "_i", "fittingPlacement", "_ret", "flip_default", "getSideOffsets", "overflow", "rect", "preventedOffsets", "__name", "isAnySideFullyClipped", "top", "right", "bottom", "left", "side", "hide", "_ref", "state", "name", "referenceRect", "popperRect", "referenceOverflow", "detectOverflow", "popperAltOverflow", "referenceClippingOffsets", "popperEscapeOffsets", "isReferenceHidden", "hasPopperEscaped", "hide_default", "distanceAndSkiddingToXY", "placement", "rects", "offset", "basePlacement", "getBasePlacement", "invertDistance", "left", "top", "_ref", "skidding", "distance", "right", "__name", "_ref2", "state", "options", "name", "_options$offset", "data", "placements", "acc", "_data$state$placement", "x", "y", "offset_default", "popperOffsets", "_ref", "state", "name", "computeOffsets", "__name", "popperOffsets_default", "getAltAxis", "axis", "__name", "preventOverflow", "_ref", "state", "options", "name", "_options$mainAxis", "checkMainAxis", "_options$altAxis", "checkAltAxis", "boundary", "rootBoundary", "altBoundary", "padding", "_options$tether", "tether", "_options$tetherOffset", "tetherOffset", "overflow", "detectOverflow", "basePlacement", "getBasePlacement", "variation", "getVariation", "isBasePlacement", "mainAxis", "getMainAxisFromPlacement", "altAxis", "getAltAxis", "popperOffsets", "referenceRect", "popperRect", "tetherOffsetValue", "data", "mainSide", "top", "left", "altSide", "bottom", "right", "len", "offset", "min", "max", "additive", "minLen", "start", "maxLen", "arrowElement", "arrowRect", "getLayoutRect", "arrowPaddingObject", "getFreshSideObject", "arrowPaddingMin", "arrowPaddingMax", "arrowLen", "within", "minOffset", "maxOffset", "arrowOffsetParent", "getOffsetParent", "clientOffset", "offsetModifierValue", "tetherMin", "tetherMax", "preventedOffset", "_mainSide", "_altSide", "_offset", "_min", "_max", "_preventedOffset", "__name", "preventOverflow_default", "getHTMLElementScroll", "element", "__name", "getNodeScroll", "node", "getWindow", "isHTMLElement", "getWindowScroll", "getHTMLElementScroll", "__name", "getCompositeRect", "elementOrVirtualElement", "offsetParent", "isFixed", "documentElement", "getDocumentElement", "rect", "getBoundingClientRect", "isOffsetParentAnElement", "isHTMLElement", "scroll", "offsets", "getNodeName", "isScrollParent", "getNodeScroll", "getWindowScrollBarX", "__name", "order", "modifiers", "map", "visited", "result", "modifier", "sort", "requires", "dep", "depModifier", "__name", "orderModifiers", "orderedModifiers", "modifierPhases", "acc", "phase", "debounce", "fn", "pending", "resolve", "__name", "mergeByName", "modifiers", "merged", "current", "existing", "key", "__name", "DEFAULT_OPTIONS", "areValidElements", "_len", "args", "_key", "element", "__name", "popperGenerator", "generatorOptions", "_generatorOptions", "_generatorOptions$def", "defaultModifiers", "_generatorOptions$def2", "defaultOptions", "reference", "popper", "options", "state", "effectCleanupFns", "isDestroyed", "instance", "cleanupModifierEffects", "isElement", "listScrollParents", "orderedModifiers", "orderModifiers", "mergeByName", "m", "modifiers", "flipModifier", "_getComputedStyle", "marginTop", "marginRight", "marginBottom", "marginLeft", "runModifierEffects", "_state$elements", "getCompositeRect", "getOffsetParent", "getLayoutRect", "modifier", "__debug_loops__", "index", "_state$orderedModifie", "fn", "_state$orderedModifie2", "_options", "name", "debounce", "resolve", "_ref3", "_ref3$options", "effect", "cleanupFn", "noopFn", "defaultModifiers", "eventListeners_default", "popperOffsets_default", "computeStyles_default", "applyStyles_default", "offset_default", "flip_default", "preventOverflow_default", "arrow_default", "hide_default", "createPopper", "popperGenerator", "setDragStartOnEvent", "e", "dragStartX", "dragStartY", "_e", "__name", "preventDefaultAlways", "EditorSelection", "currentlyDrawnRect", "elem", "editor", "rect", "comp", "wire", "point", "component", "prevSelected", "UIEventManager", "EditHandlers", "action", "params", "newHandlers", "DeleteHandlers", "MoveHandlers", "SetAnchorHandlers", "setColorPointerOverIsDanger", "startPointerDownData", "cancelLongPressAction", "endPointerDownData", "Drawable", "x", "y", "pullingWire", "settingAnchor", "isTouch", "prevCompUnderPointer", "Wire", "NodeBase", "ComponentBase", "root", "DrawZIndex", "nodeOver", "bestDistanceSquared", "node", "dist", "waypoint", "sel", "dx", "dy", "snapToGrid", "DrawableWithDraggablePosition", "tooltip", "removeListener", "tooltipHtml", "tooltipContents", "tooltipElem", "mainCanvas", "createPopper", "scrollParent", "getScrollParent", "scrollListener", "canvas", "returnFalse", "preventDefaultIfCanConnect", "downPointers", "trackedPointerId", "currentZoomSession", "cancelZoomSession", "translationRoundTo", "GRID_STEP", "tX", "tY", "applyZoomAndTranslation", "zoom", "startGestureX", "startGestureY", "endGestureX", "endGestureY", "effectiveScale", "getTwoPointersLoc", "skipTransform", "pointerEvents", "p1", "p2", "p1X", "p1Y", "p2X", "p2Y", "centerX", "centerY", "pointerId", "numPointers", "handle", "initLoc", "newLoc", "factor", "targetZoom", "stickyZoom", "onpointerupcancel", "wheelEndTimer", "zoomFactor", "oldZoom", "oldCenterX", "oldCenterY", "newCenterX", "newCenterY", "speedFactor", "panX", "panY", "targetIsFieldOrOtherInput", "handled", "CustomComponent", "result", "ctrlOrCommand", "keyLower", "shift", "_a", "file", "dataItems", "dataItem", "content", "xy", "wantsDragEvents", "selectedComps", "pointerDownData", "initialXY", "fireDragEvent", "d2", "distSquared", "linkMgr", "_b", "_c", "_d", "pointerUpTarget", "change", "newChange", "InteractionResult", "clickedComp", "oldLastTouchEnd", "now", "lastComp", "lastTime", "elapsedTimeMillis", "isDoubleTouch", "componentButtons", "isCustomElement", "pointermoveHandler", "pointerupHandler", "compButton", "newComponent", "title", "closeHandler", "isDragging", "startX", "startY", "startTop", "startRight", "closeButton", "makeIcon", "parent", "computedStyle", "deltaX", "deltaY", "ref", "S", "numDeleted", "c", "Waypoint", "cond", "onlyOne", "ToolHandlers", "__comp", "__e", "__props", "containerRect", "f", "cx", "cy", "w", "h", "DrawableWithPosition", "props", "LogicEditor", "eventMgr", "currentSelection", "allowSelection", "left", "top", "initialTranslationX", "initialTranslationY", "scaleFactor", "menuData", "currentPointerDownData", "hasContentJustifyingSeparator", "defToElem", "item", "mkButton", "spec", "shortcut", "danger", "button", "type", "cls", "mods", "span", "emptyMod", "li", "but", "itemEvent", "ul", "items", "mainContextMenu", "applyModifiersTo", "menuTop", "needsScrollY", "menuRect", "hOverflow", "__", "from", "MAX_UNDO_SNAPSHOTS", "areStatesEqual", "s1", "s2", "__name", "UndoManager", "editor", "__", "interactionResult", "skipStorage", "_a", "repeatAction", "now", "doStorage", "circuit", "jsonStr", "Serialization", "S", "stateNow", "prevState", "snapshot", "result", "newRepeatAction", "printStack", "name", "stack", "title", "i", "timeStr", "PostLoadActions_None", "newState", "gallery", "Mode", "MIN_MODE_INDEX", "MAX_MODE_INDEX", "MAX_MODE_WHEN_SINGLETON", "MAX_MODE_WHEN_EMBEDDED", "DEFAULT_MODE", "SINGLETON_INSTANCE_ID", "ATTRIBUTE_NAMES", "DEFAULT_EDITOR_OPTIONS", "WireStyles", "PointerActions", "Any", "_LogicEditor", "ComponentFactory", "UIEventManager", "Timeline", "MoveManager", "UndoManager", "RedrawManager", "TestsPalette", "ComponentList", "NodeManager", "TestSuites", "LinkManager", "RecalcManager", "html", "dialog_polyfill_esm_default", "tools", "randomString", "id", "elem", "_a", "S", "opts", "_b", "newOptions", "optionsHtml", "docName", "defaultTitle", "nonDefaultOpts", "set", "_k", "v", "k", "deepArrayEquals", "accept", "callback", "chooser", "files", "cursor", "canvasContainer", "mainCanvas", "w", "h", "f", "insts", "_c", "_d", "getNavigatorLanguage", "__name", "lang", "getSavedLang", "langStr", "getURLParameter", "DefaultLang", "isLang", "setLang", "rootDiv", "parentStyles", "isEmbeddedInIframe", "singletonAttr", "isFalsyString", "transferUrlParamToAttribute", "name", "value", "attr", "userParamPrefix", "key", "oldValue", "isArray", "darkModeQuery", "setDarkMode", "JSON5", "madeBy", "div", "cls", "style", "a", "href", "target", "e", "modeAttr", "autosaveAttr", "idAttr", "norestoreAttr", "fct", "linkedtoAttr", "throttleTimer", "json", "showonlyAttr", "x", "showgatetypesAttr", "isTruthyString", "showdisconnectedpinsAttr", "showtooltipsAttr", "dataOrSrcRef", "tryLoadFromLightDOM", "innerScriptElem", "tryLoadStorage", "PostLoadActions_SnapshotNoStorage", "setCaption", "buttonId", "strings", "tooltip", "isString", "s", "TopBar", "ComponentMenu", "MessageBar", "testResultsPalette", "groupButton", "modeChangeMenu", "titleElem", "mods", "buttonMode", "modeTitle", "expl", "addElem", "optionsDiv", "title", "makeIcon", "toggleVisible", "emptyMod", "copyLinkDiv", "__", "switchToModeDiv", "attrBuilder", "setVisible", "selectAllListener", "textArea", "settingsPalette", "settingsTitleElem", "makeCheckbox", "optionName", "mouseover", "hide", "checkbox", "input", "type", "section", "label", "span", "animateWiresCheckbox", "hideWireColorsCheckbox", "hideInputColorsCheckbox", "hideOutputColorsCheckbox", "hideMemoryContentCheckbox", "showGateTypesCheckbox", "showDisconnectedPinsCheckbox", "hideTooltipsCheckbox", "groupParallelWiresCheckbox", "showHiddenWiresCheckbox", "showAnchorsCheckbox", "showIdsCheckbox", "sw", "wireStylePopup", "select", "option", "propagationDelayField", "showUserdataLink", "showUserDataLinkContainer", "onVisible", "tagName", "TAGNAME", "child", "formatString", "gallery", "makeUpdatePointerPositionHandler", "closingContextMenus", "editor", "canvasPos", "y", "updateCursors", "registerPixelRatioListener", "pixelRatioMediaQuery", "queryString", "isDark", "mutations", "mutation", "newBackgroundColor", "mode", "doSetFocus", "modeStr", "modes", "i", "nomodes", "showComponentsAndEditControls", "showEditControls", "showReset", "showOnlyReset", "hideSettings", "setDisplay", "zoom", "updateTopBar", "roundedZoomForUI", "tX", "tY", "circuit", "selectionStart", "selectionEnd", "Serialization", "saveStr", "savedTime", "PostLoadActions_None", "keepOpen", "day", "time", "storage", "postLoadActions", "savedStr", "semicolIndex", "circuitStr", "error", "file", "reader", "content", "uintArray2", "compressedJSON", "PostLoadActions_SnapshotStorage", "temp", "metadata", "url", "response", "decodedData", "err", "contentFromLinkedField", "isConsideredDirty", "editorRoot", "CustomComponent", "def", "jsonStringOrObject", "selectedComps", "newGroup", "RectangleDef", "Rectangle", "comp", "DrawableWithDraggablePosition", "__reason", "dark", "newRoot", "customComp", "typesToHide", "action", "forceUpdate", "params", "changed", "msg", "duration", "withCloseButton", "snapToGrid", "canvasRect", "GRID_STEP", "skipTransform", "unscaledX", "unscaledY", "offsetX", "offsetY", "_e", "elemRect", "offset", "Orientation", "dx", "dy", "applyZoom", "rightmostX", "leftmostX", "lowestY", "highestY", "drawables", "wire", "cx", "width", "left", "right", "cy", "height", "top", "bottom", "idWhenExporting", "fullJson", "compressedJsonForUri", "showOnlyArr", "fullUrl", "modeParam", "embedHeight", "showOnlySpaceDelim", "markdownBlock", "showOnlyHtmlAttr", "iframeEmbed", "webcompEmbed", "showModal", "copyToClipboard", "compressedUriSafeJson", "showOnly", "removeShowOnly", "jsonObj", "jsonForUri", "loc", "showOnlyParam", "currentLang", "getLang", "langParam", "idParam", "blob", "resolve", "dataURL", "asBase64", "withMetadata", "heightHint", "pngBareBlob", "transform", "tmpCanvas", "wasDark", "isDarkMode", "pngBareData", "pngChunks", "svgCtx", "SVGRenderingContext", "serializedSVG", "data", "extension", "filename", "visible", "testSuites", "numTests", "result", "testSuite", "TestSuite", "testCase", "idx", "message", "oldMode", "restoreAfter", "hideMsg", "options", "palette", "noUI", "fast", "doLog", "testSuiteRepr", "validateJson", "results", "TestSuiteResults", "ui", "isFirst", "skip", "testCaseResult", "TestCaseResult", "oldInValues", "inputs", "valueRepr", "valuesFromReprForInput", "sourceSuite", "fullTestNameParts", "fullTestName", "mismatches", "output", "expectedRepr", "actual", "expected", "passMsg", "failMsg", "forceNow", "__recalculated", "redrawMgr", "linkMgr", "animateWires", "redrawInfo", "redrawMask", "refs", "highlightComps", "highlightWires", "start", "g", "baseDrawingScale", "baseTransform", "contentTransform", "skipBorder", "transparentBackground", "__redrawMask", "COLOR_BACKGROUND", "highlightRectFor", "t", "highlightedItems", "highlightColor", "elapsed", "highlightAlpha", "highlightRect", "moveMgr", "widthAdjusted", "heightAdjusted", "step", "COLOR_GRID_LINES", "fillTextVAlign", "TextVAlign", "singleMovingWaypoint", "guides", "COLOR_GRID_LINES_GUIDES", "guide", "COLOR_BORDER", "strokeSingleLine", "COLOR_BACKGROUND_UNUSED_REGION", "myX", "x1", "x2", "drawTime", "drawTimeAnimationFraction", "COLOR_COMPONENT_BORDER", "currentCompUnderPointer", "drawParams", "currentSelection", "drawComp", "node", "root", "DrawZIndex", "movingCompWithAnchor", "drawAnchorsAroundComponent", "COLOR_COMPONENT_ID", "strokeTextVAlign", "selRect", "drawPoint", "d", "anyDeleted", "componentsToInclude", "ComponentBase", "reprs", "jsonStr", "copied", "oldDontHogFocus", "pasteFromClipboard", "errorOrComps", "selection", "EditorSelection", "str", "canvas", "path", "LogicEditor", "LogicStatic", "template", "Tests", "diagramRefs", "componentRefs", "diagramRef", "diagram", "_opts", "isRecord", "col", "parseColorToRGBA", "rgbaString", "USER_COLORS", "looksDark", "InBrowser", "LogicEditorTemplate_default", "styles", "LogicEditor_default", "dialog_polyfill_default", "setupSvgIcon", "el"]
}
