# Environnement de travail

![Logo](image-6.png){ align=right }


## Intro

VSCode est de loin l'IDE le plus utilisé (73,6% des développeurs et 77% des étudiants du monde entier en 2024 d'après la célèbre enquête annuelle de stackoverflow)

Voici les étapes simples pour installer votre environement

- Tout votre code sera dans vos documents, dans un dossier appelé PROG-NSI
- Votre sauvegarde sera sur votre clé USB, dans un dossier appelé PROG-NSI

**Il ne faut ni déplacer, ni renommer aucun de ces fichiers**

**Ce qui suit suppose que vous faites une utilisation normale de votre PC, surtout en termes d'installation régulière (voire automatique) des dernières mises à jour**

## Windows
### 1. Installer vos utilitaires sur clé USB

Ceci est à faire une seule fois.

!!! danger "Actions simples à réaliser **DANS L'ORDRE**"

    1. Branchez votre clé USB
    2. Télécharger le fichier [`NSI-SCRIPTS.exe`](NSI-SCRIPTS.exe) .
    3. **Le mettre A LA RACINE de votre clé USB**
    4. Double-cliquer dessus.
    5. Dans la petite fenêtre qui s'affiche, **appuyer sur extract**.

    **Je vérifie que tout est OK:**

    - Un répertoire `NSI-SCRIPTS` apparaît à la racine votre clé USB
    - 2 fichiers `NSI-sauver.bat` et `NSI-importer.bat` sont aussi présents à la racine

    Ces fichiers automatisent l'installation des composants nécessaires.

    **N'exécutez aucun de ces scripts sans y avoir été invités. Certains représentent des installations de composants lourds. Si vous êtes curieux, c'est bien, mais posez-moi la question**

    Vous pouvez supprimer `NSI-SCRIPTS.exe`

---

### 2. Installer La base

Ceci est à faire une seule fois par PC -> 1 double-clic

!!! danger "VSCode et Python"
    
    **Une seule action simple**:

    - **Sur votre clé, Dans le répertoire NSI-SCRIPTS, double-cliquez sur `1.INSTALL-VSCODE-UV.bat`**

    Une fenêtre s'ouvre et installe les composants requis.
    A l'issue de l'installation, VSCode s'ouvre dans votre répertoire de développement, et python est prêt à fonctionner.

    Lorsque vous ouvrez un répertoire pour la première fois, VSCode vous demande s'il peut avoir confiance en ce répertoire. Cochez la case et cliquez sur le bouton bleu, "Yes i trust".

    ![alt text](image-2.png)

    **Je vérifie que tout est OK:**

    1. Dans VSCode, j'ouvre le fichier `python\exos\main.py`
    2. J'appuie sur la flèche en haut à droite pour exécuter le fichier
    3. Un terminal s'ouvre, et on voit le résultat du print.
    4. En bas à droite, on voit la version de python utilisée (3.13)

    ![alt text](image-19.png)

---

### Utilisation au quotidien et règles d'or

- Lorsque vous voulez sauver votre travail sur votre clé (maison ou lycée):
    - Double-cliquez sur `NSI-sauver.bat`
- Lorsque vous voulez importer le contenu de votre clé sur votre ordi (maison ou lycée)
    - Double cliquez sur `NSI-importer.bat`

Tout repose sur la synchronisation de ce répertoire `PROG-NSI` dans votre répertoire Documents et sur votre clé USB, que ce soit au lycée ou chez vous.

**Il ne faut changer ni le nom ni la localisation de ces répertoires.**

**Il ne faut pas modifier les répertoires python, structure et exos.**

VSCode s'ouvrira automatiquement dans votre répertoire.
Si ça n'est pas le cas, vous pouvez ouvrir le répertoire via le Menu "File > Open Recent..."

---

### 3. Installer MSYS2 (premières -> ne pas faire)

!!! danger "Installation simple et mise à jour de MSYS2"
    1. Sur votre clé, Dans le répertoire `NSI-SCRIPTS`, double-cliquer sur `2.INSTALL-MSYS2.bat`
    2. Lorsque c'est terminé, Double-cliquez sur `3.MAJ-MSYS2.bat`
    3. **Répétez la dernière opération jusqu'à** ce que le script dise vers la fin qu'**il n'y a plus rien à faire**.

    **Explication:** `MAJ-MSYS2.bat` sert à mettre MSYS2 à jour. Ca se fait parfois en plusieurs temps. Il faut donc le faire jusqu'à ce que MSYS2 dise qu'il n'y a plus rien à faire. 

    Parfois ça plante à cause du réseau, ça n'est pas grave, il faut juste relancer.

---


### **TROUBLESHOOTING / STARTING FRESH**

En cas de problème, ou pour repartir propre:

!!! danger "Méthode efficace"

    Ici, l'objectif est de:

    - Ne plus avoir aucun répertoire qui s'appelle `PROG-NSI`
    - Rejouer toute l'installation. (les logiciels qui seront déjà installé ne se réinstalleront en réalité pas)
    - Réinjecter vos fichiers **de code uniquement**, pas les fichiers de configuration, dans le nouveau dossier PROG-NSI de vos Documents.

    **Comment faire?**
    
    1. Dans votre répertoire Documents, renommez votre répertoire PROG-NSI en PROG-NSI-OLD
    2. Sur votre clé USB, renommez votre répertoire PROG-NSI en PROG-NSI-OLD
    3. Faire toutes les étapes d'installation (chapitre 1. 2. et 3. de cette page)
    4. Copiez vos fichiers **de code seulement** de `PROG-NSI-OLD` au nouveau `PROG-NSI` créé dans vos `Documents` tout propre
        - **Ne copiez SURTOUT PAS autre chose que le code de vos exercices ou projets.**
        - En effet, le but est justement de réinitialiser tout le reste
    5. Double cliquez sur `NSI-sauver.bat` afin d'initialiser votre clé USB

    Ensuite:
    
    - Vous pouvez alors supprimer les répertoires `PROG-NSI-OLD` sur clé et sur disque
    - il faudra refaire les `uv add`. Par exemple `uv add pyxel`

!!! danger "python ne fonctionne pas"
    
    - Supprimer le répertoire .venv
    - Exécuter la commande `uv sync` dans un terminal
    - Relancer VSCode

## MACOS

Sous mac, tout se fait par ligne de commande.

Dans un terminal, exéctutez la commande suivante afin d'installer brew, un installateur de logiciels:

```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```

Puis installez `uv`, le gestionnaire python:

```bash
brew install uv
```

Puis installez VSCode:

```bash
brew install --cask visual-studio-code
```

- Récupérez votre dossier `PROG_NSI` que vous avez mis sur clé au lycée grâce à import.bat
- Collez-le chez vous dans vos documents.
- Ouvrez VSCode et Ouvrez-y le **répertoire** `PROG_NSI`:
    - `File -> Open Folder...`

Au quotidien, vous aurez sur votre clé usb vos fichiers en cours de modification.

**Lorsqu'une mise à jour de la configuration est nécessaire:**

- Télécharger le fichier de conf python "https://mmarchand-nsi.github.io/les-outils/pyproject.toml" et le mettre dans `PROG_NSI/`
- Télécharger le fichier de conf vscode "https://mmarchand-nsi.github.io/les-outils/settings.json" et le mettre dans `PROG_NSI/.vscode/`
- Dans un terminal, exécuter la commande `uv sync` pour prendre en compte le changement de conf.


## LINUX-UBUNTU

Installer vscode (vous pouvez aussi l'installer depuis votre gestionnaire de logiciels si snap n'est pas disponible):

```bash
sudo snap install code --classic
```

Installer uv (le gestionnaire python)

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

- Récupérez votre dossier `PROG_NSI` que vous avez mis sur clé au lycée grâce à import.bat
- Collez-le chez vous dans vos documents.
- Ouvrez VSCode et Ouvrez-y le **répertoire** `PROG_NSI`:
    - `File -> Open Folder...`
- Dans le terminal, exécutez la commande `uv sync`


Installez les extensions VSCode en exécutant les 4 commandes suivantes dans un terminal:

```bash
code --install-extension ms-python.python
code --install-extension aaron-bond.better-comments
code --install-extension tomoki1207.pdf
code --install-extension tamasfe.even-better-toml
```

**Au quotidien, vous aurez sur votre clé usb vos fichiers en cours de modification.**

**Lorsqu'une mise à jour de la configuration est nécessaire:**

- Télécharger le fichier de conf python "https://mmarchand-nsi.github.io/les-outils/pyproject.toml" et le mettre dans `PROG_NSI/`
- Télécharger le fichier de conf vscode "https://mmarchand-nsi.github.io/les-outils/settings.json" et le mettre dans `PROG_NSI/.vscode/`
- Dans un terminal, exécuter la commande `uv sync` pour prendre en compte le changement de conf.

## LINUX-FEDORA

**Installer vscode:**

```bash
flatpak install flathub com.visualstudio.code -y
```

**Installer uv (le gestionnaire python)**

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

- Récupérez votre dossier `PROG_NSI` que vous avez mis sur clé au lycée grâce à import.bat
- Collez-le chez vous dans vos documents.
- Ouvrez VSCode et Ouvrez-y le répertoire `PROG_NSI`:
    - `File -> Open Folder...`
- Dans le terminal, exécutez la commande `uv sync`


Installez les extensions VSCode en exécutant les 4 commandes suivantes dans un terminal:

```bash
code --install-extension ms-python.python
code --install-extension aaron-bond.better-comments
code --install-extension tomoki1207.pdf
code --install-extension tamasfe.even-better-toml
```

**Au quotidien, vous aurez sur votre clé usb vos fichiers en cours de modification.**

**Lorsqu'une mise à jour de la configuration est nécessaire:**

- Télécharger le fichier de conf python "https://mmarchand-nsi.github.io/les-outils/pyproject.toml" et le mettre dans `PROG_NSI/`
- Télécharger le fichier de conf vscode "https://mmarchand-nsi.github.io/les-outils/settings.json" et le mettre dans `PROG_NSI/.vscode/`
- Dans un terminal, exécuter la commande `uv sync` pour prendre en compte le changement de conf.
